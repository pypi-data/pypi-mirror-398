from cryptography.fernet import Fernet as _Fernet


class Encryption:
    """
    Class to handle data encryption and decryption.
    """

    def __init__(self, key: bytes | str):
        """
        Initialize the Encryption class with a given key.

        :param key: A key that was generated by the generate_key function (required).
        """
        self.__fernet = _Fernet(key)

    def encrypt(self, data: bytes) -> bytes:
        """
        Encrypt the given data.

        :param data: Data to encrypt.
        :return: Encrypted data.
        """
        return self.__fernet.encrypt(data)

    def decrypt(self, token: bytes | str) -> bytes:
        """
        Decrypt the given token.

        :param token: Token to decrypt.
        :return: Decrypted data.
        """
        return self.__fernet.decrypt(token)


def generate_key() -> bytes:
    """
    Generate a key for encryption/decryption.

    :return: the key.
    """
    return _Fernet.generate_key()

