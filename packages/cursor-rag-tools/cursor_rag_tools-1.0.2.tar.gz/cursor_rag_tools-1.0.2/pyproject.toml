[build-system]
requires = ["setuptools>=61.0", "wheel"]
build-backend = "setuptools.build_meta"

[project]
name = "cursor-rag-tools"
version = "1.0.2"
description = "RAG indexing and search for Cursor IDE via MCP"
readme = "README.md"
requires-python = ">=3.11"
license = {text = "MIT"}
authors = [
    {name = "Cursor RAG Tools Contributors"}
]
keywords = ["rag", "cursor", "mcp", "indexing", "chromadb", "ai"]
classifiers = [
    "Development Status :: 4 - Beta",
    "Intended Audience :: Developers",
    "License :: OSI Approved :: MIT License",
    "Programming Language :: Python :: 3",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
]

dependencies = [
    "chromadb>=0.4.0",
    "sentence-transformers>=2.0.0",
    "mcp>=0.9.0",
]

[project.optional-dependencies]
dev = [
    "pytest>=7.0.0",
    "black>=23.0.0",
    "ruff>=0.1.0",
]

# Optional semantic parsers for JS/TS (and sometimes Python) chunking.
# On Python 3.13, tree_sitter_languages wheels may be unavailable; it's safe to skip.
parsers = [
    "tree-sitter>=0.21.3",
    "tree_sitter_languages>=1.10.2; python_version < '3.13'",
]

[project.scripts]
cursor-rag = "cursor_rag.cli:main"

[project.urls]
Homepage = "https://github.com/your-org/cursor-rag-tools"
Repository = "https://github.com/your-org/cursor-rag-tools"
Issues = "https://github.com/your-org/cursor-rag-tools/issues"

[tool.setuptools]
packages = ["cursor_rag"]

[tool.black]
line-length = 100
target-version = ["py311"]

[tool.ruff]
line-length = 100
target-version = "py311"

[tool.basedpyright]
# Режим проверки типов: "off" (выключено), "basic" (базовый), "standard" (стандартный), "strict" (строгий)
# "standard" - баланс между строгостью и практичностью
typeCheckingMode = "standard"

# Версия Python для проверки типов (должна соответствовать requires-python)
pythonVersion = "3.12"

# Платформа Python: "Windows", "Darwin", "Linux", "All"
# "All" - проверка для всех платформ
pythonPlatform = "All"

# ============================================================================
# Настройки для работы со сторонними библиотеками без типов
# ============================================================================

# Игнорировать отсутствие type stubs для сторонних библиотек
# false - не ругаться на библиотеки без типов (practical для большинства проектов)
reportMissingTypeStubs = false

# Игнорировать неизвестные типы параметров функций
# false - не требовать типы для всех параметров сторонних библиотек
reportUnknownParameterType = false

# Игнорировать неизвестные типы аргументов при вызове функций
# false - не требовать типы для всех аргументов
reportUnknownArgumentType = false

# Игнорировать неизвестные типы атрибутов/методов объектов
# false - не требовать типы для всех членов объектов
reportUnknownMemberType = false

# Игнорировать неизвестные типы переменных
# false - не требовать типы для всех переменных
reportUnknownVariableType = false

# ============================================================================
# Настройки для async/await и Optional типов
# ============================================================================

# Предупреждать при попытке вызвать Optional переменную без проверки на None
# true - помогает избежать AttributeError в async коде
reportOptionalCall = true

# Предупреждать при использовании Optional в циклах (for x in optional_var)
# true - помогает избежать TypeError при итерации
reportOptionalIterable = true

# Предупреждать при использовании Optional в context manager (with optional_var)
# true - помогает избежать ошибок при работе с async context managers
reportOptionalContextManager = true

# Предупреждать при использовании Optional в операциях (+, -, *, /, etc.)
# true - помогает избежать TypeError при операциях с None
reportOptionalOperand = true

# ============================================================================
# Проверки переопределений и наследования
# ============================================================================

# Предупреждать при несовместимом переопределении методов (неверная сигнатура)
# true - помогает найти ошибки в наследовании классов
reportIncompatibleMethodOverride = true

# Предупреждать при несовместимом переопределении переменных
# true - помогает найти ошибки при переопределении атрибутов класса
reportIncompatibleVariableOverride = true

# Предупреждать о декораторах функций без аннотаций типов
# false - не требовать типы для декораторов (FastAPI декораторы часто без типов)
reportUntypedFunctionDecorator = false

# Предупреждать о декораторах классов без аннотаций типов
# false - не требовать типы для декораторов классов
reportUntypedClassDecorator = false

# Предупреждать о базовых классах без типов
# false - не требовать типы для всех базовых классов
reportUntypedBaseClass = false

# Предупреждать при использовании namedtuple вместо NamedTuple
# true - рекомендует использовать типизированный NamedTuple
reportUntypedNamedTuple = true

# ============================================================================
# Проверки типов и качества кода
# ============================================================================

# Предупреждать о несовместимости типов возвращаемых значений
# true - помогает найти ошибки в типах возврата функций
reportReturnType = true

# Предупреждать при использовании приватных атрибутов (с _ или __)
# false - разрешить доступ к приватным атрибутам (часто нужно для тестов)
reportPrivateUsage = false

# Предупреждать при переопределении констант (UPPER_CASE переменные)
# true - помогает найти случайное переопределение констант
reportConstantRedefinition = true

# Предупреждать при использовании устаревших (deprecated) API
# true - помогает мигрировать на новые версии библиотек
reportDeprecated = true

# ============================================================================
# Исключения директорий из проверки
# ============================================================================

# Директории и файлы, которые basedpyright будет игнорировать
exclude = [
    "**/__pycache__",      # Кэш Python байт-кода
    "**/.venv",            # Виртуальное окружение
    "**/node_modules",     # Node.js зависимости (если есть)
    "**/migrations",       # Миграции БД (обычно генерируются автоматически)
]

# ============================================================================
# Пути для поиска типов и stub файлов
# ============================================================================

# Путь к директории со stub файлами (типами) для сторонних библиотек
# Обычно находится в виртуальном окружении
stubPath = ".venv/lib/python3.12/site-packages"

# Путь к корню проекта (относительно этого файла)
venvPath = "."

# Имя директории виртуального окружения
venv = ".venv"

