[extend]
useDefault=true

[[rules]]
id = "password-detection"
description = "Detects occurrences of the word 'password'"
regex = '''(?i)\bpassword\b'''
tags = ["password"]

    [[rules.allowlists]]  # ‚ùó Fix: Changed from array to a table (map)
    description = "Ignore common false positives"
    regexes = [ '''(?i)password\s*=\s*"?(example|test|dummy|1234)"?''' ]

[[rules]]
id = "random-password-detection"
description = "Detects occurrences of passwords"
regex = '''(?i)(password|passwd|pwd)["\']?[:=]\s*["\'][^\n\r]{6,}["\']'''
tags = ["password"]

[[rules]]
id = "private-key-detection"
description = "Detects occurrences of private keys"
regex = '''(?i)-----BEGIN (RSA|DSA|EC|OPENSSH|PGP) PRIVATE KEY-----'''
tags = ["private-key"]

[[rules]]
id = "db_login-detection"
description = "Detects occurrences of the word 'db_login'"
regex = '''(?i)\bdb_login\b'''
tags = ["login"]

[[rules]]
id = "login-detection"
description = "Detects occurrences of the word 'login'"
regex = '''(?i)\blogin\b'''
tags = ["login"]

[[rules]]
id = "token-detection"
description = "Detects occurrences of the word 'token'"
regex = '''(?i)\btoken\b'''
tags = ["token"]

[[rules]]
id = "api_key-detection"
description = "Detects occurrences of the word 'API_key'"
regex = '''(?i)\bAPI_key\b'''
tags = ["api_key"]

[allowlist]
description = "global allow list"
paths = [
    '''\.gitleaksignore''',
    '''extended-gitleaks-config\.toml''',
    '''tests/CI_docker/build_enfrosp_enmapboxapp_testsuite_image.sh'''
]
