# SVG to shinymap JSON Converter

Interactive tool for converting SVG files to shinymap JSON format.

## Usage

Run the converter app:

```bash
uv run python -m shinymap.geometry.converter
```

Or with standard Python:

```bash
python -m shinymap.geometry.converter
```

The app will start a local Shiny server (typically at `http://127.0.0.1:8000`).

## Features

### 1. Upload SVG
- Drag and drop or browse to select an SVG file
- Works with **any SVG**, even from PowerPoint or drawing tools
- **Auto-generates IDs** for paths without IDs (e.g., `path_1`, `path_2`)
- Preview list of all paths with their IDs

### 2. Configure Conversion

**Metadata**: Add source, license, and other information
```json
{
  "source": "Wikimedia Commons - File:Japan_template_large.svg",
  "license": "CC BY-SA 3.0"
}
```

**Grouping**: Merge multiple SVG paths into one region
```json
{
  "01": ["hokkaido", "northern_territories"],
  "02": ["aomori_main", "aomori_islands"]
}
```

**ID Mapping**: Rename individual path IDs (one-to-one)
```json
{
  "california": "CA",
  "texas": "TX"
}
```

**Overlays**: Mark paths as overlay geometry (non-interactive)
```json
["_divider_lines", "_border"]
```

### 3. Download Outputs

**Download JSON**: The converted shinymap JSON file

**Download Python Code**: A Python script that reproduces the conversion

Example generated code:
```python
# Generated by shinymap converter
from shinymap.geometry import svg_to_json

svg_to_json(
    "japan.svg",
    "japan_prefectures.json",
    grouping={
        "01": ["hokkaido", "northern_territories"],
    },
    overlay_ids=["_divider_lines"],
    metadata={
        "source": "Wikimedia Commons - File:Japan_template_large.svg",
        "license": "CC BY-SA 3.0",
    }
)
```

## Why Generate Code?

Generating the Python code (not just JSON) provides:

- **Reproducibility**: Run the script to regenerate JSON
- **Version Control**: Commit the script to document the conversion process
- **Tweaking**: Easy to adjust parameters and re-run
- **Documentation**: Self-documenting conversion workflow

## Workflow Example

1. **Upload**: Drop your `map.svg` file
2. **Preview**: Check the list of extracted paths
3. **Group**: Merge related paths (e.g., main territory + islands)
4. **Rename**: Apply consistent naming scheme
5. **Mark Overlays**: Identify decorative elements
6. **Download Both**: Get the JSON and the Python script
7. **Commit**: Add the Python script to your repo

Next time you need to tweak the conversion, just edit and rerun the Python script!
