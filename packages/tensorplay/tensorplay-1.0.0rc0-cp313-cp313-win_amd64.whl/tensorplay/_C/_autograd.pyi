from collections.abc import Sequence

import tensorplay._C


class PyNode(tensorplay._C.Node):
    def __init__(self, arg: object, /) -> None: ...

    def add_next_edge(self, next_node: tensorplay._C.Node | None, input_nr: int = 0) -> None: ...

def collect_next_edges(arg: tensorplay._C.TensorBase, /) -> list[tuple[tensorplay._C.Node, int]]: ...

def backward(tensors: Sequence[tensorplay._C.TensorBase], grad_tensors: Sequence[tensorplay._C.TensorBase] | None = None, retain_graph: bool | None = None, create_graph: bool = False) -> None: ...

def grad(outputs: Sequence[tensorplay._C.TensorBase], inputs: Sequence[tensorplay._C.TensorBase], grad_outputs: Sequence[tensorplay._C.TensorBase] | None = None, retain_graph: bool | None = None, create_graph: bool = False, allow_unused: bool = False) -> list[tensorplay._C.TensorBase]: ...

def is_grad_enabled() -> bool: ...

def set_grad_enabled(arg: bool, /) -> None: ...
