{
  "$defs": {
    "Assessment": {
      "additionalProperties": false,
      "properties": {
        "id": {
          "description": "Canonical unique control id in the form 'namespace:key' (no whitespace).",
          "maxLength": 256,
          "minLength": 1,
          "not": {
            "pattern": "^attck:"
          },
          "pattern": "^[a-z][a-z0-9_-]{0,31}:[^\\s]{1,223}$",
          "title": "Id",
          "type": "string"
        },
        "oscal_uuid": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional OSCAL UUID for this control assessment target. This is interoperability metadata only; referencing/joining within CRML should use the canonical 'id'.",
          "title": "Oscal Uuid"
        },
        "ref": {
          "anyOf": [
            {
              "$ref": "#/$defs/ControlStructuredRef"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional structured locator for mapping to an external standard (e.g. CIS/ISO). This is metadata only; referencing should use the canonical 'id'."
        },
        "implementation_effectiveness": {
          "anyOf": [
            {
              "maximum": 1.0,
              "minimum": 0.0,
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Organization-specific implementation strength for this control. Semantics: 0.0 = not implemented / no coverage, 1.0 = fully implemented. This represents vulnerability likelihood (susceptibility) posture used to mitigate a scenario's baseline threat frequency.",
          "title": "Implementation Effectiveness"
        },
        "coverage": {
          "anyOf": [
            {
              "$ref": "#/$defs/Coverage"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Breadth of deployment/application across the organization. This contributes to vulnerability likelihood reduction when applying this control to a scenario."
        },
        "reliability": {
          "anyOf": [
            {
              "maximum": 1.0,
              "minimum": 0.0,
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Reliability/uptime of the control as a probability of being effective in a given period.",
          "title": "Reliability"
        },
        "affects": {
          "anyOf": [
            {
              "enum": [
                "frequency",
                "severity",
                "both"
              ],
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": "frequency",
          "description": "Which loss component this assessment affects. Default is 'frequency' (frequency-first). Note: the current reference engine primarily applies controls to frequency (lambda).",
          "title": "Affects"
        },
        "scf_cmm_level": {
          "anyOf": [
            {
              "maximum": 5,
              "minimum": 0,
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "SCF Capability Maturity Model (CMM) level for this control (0..5). Levels: 0=Not Performed, 1=Performed Informally, 2=Planned & Tracked, 3=Well-Defined, 4=Quantitatively Controlled, 5=Continuously Improving.",
          "title": "Scf Cmm Level"
        },
        "question": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional assessment prompt/question text for this control (tool/community-defined). Useful for questionnaires and evidence collection.",
          "title": "Question"
        },
        "description": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional additional description for this assessment entry (tool/community-defined). Avoid embedding copyrighted standard text unless you have rights.",
          "title": "Description"
        },
        "notes": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Free-form notes about this assessment entry.",
          "title": "Notes"
        }
      },
      "required": [
        "id"
      ],
      "title": "Assessment",
      "type": "object"
    },
    "AssessmentCatalog": {
      "additionalProperties": false,
      "properties": {
        "id": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional identifier for this assessment catalog (organization-owned).",
          "title": "Id"
        },
        "framework": {
          "description": "Free-form framework label for humans/tools (e.g. 'CISv8', 'ISO27001:2022').",
          "title": "Framework",
          "type": "string"
        },
        "assessed_at": {
          "anyOf": [
            {
              "format": "date-time",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "When this assessment catalog was performed/recorded (ISO 8601 date-time). Example: '2025-12-17T10:15:30Z'.",
          "title": "Assessed At"
        },
        "assessments": {
          "description": "List of per-control assessment entries.",
          "items": {
            "$ref": "#/$defs/Assessment"
          },
          "title": "Assessments",
          "type": "array"
        }
      },
      "required": [
        "framework",
        "assessments"
      ],
      "title": "AssessmentCatalog",
      "type": "object"
    },
    "ControlStructuredRef": {
      "description": "Standard-independent structured control locator.\n\nThis is optional metadata that can be used by tools/UI to help users map\ncontrols, but *referencing* in scenarios/portfolios should be done via\n`ControlId`.\n\nExample:\n    {standard: \"CIS\", control: \"2\", requirement: \"Ensure X is implemented\"}",
      "properties": {
        "standard": {
          "description": "Standard identifier (e.g. CISv8, ISO27001).",
          "title": "Standard",
          "type": "string"
        },
        "control": {
          "description": "Control identifier within the referenced standard.",
          "title": "Control",
          "type": "string"
        },
        "requirement": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional requirement text (what the requirement specifies) within the referenced standard (if applicable and not copyrighted).",
          "title": "Requirement"
        }
      },
      "required": [
        "standard",
        "control"
      ],
      "title": "ControlStructuredRef",
      "type": "object"
    },
    "Coverage": {
      "description": "Breadth of application of a control across an organization.\n\nSemantics:\n- value=0.0 means \"not deployed/applied anywhere in the stated basis\"\n- value=1.0 means \"fully deployed/applied across the stated basis\"\n\nThe basis defines the denominator for the fraction (e.g. endpoints, employees).",
      "properties": {
        "value": {
          "description": "Coverage fraction in [0, 1] for the stated basis.",
          "maximum": 1.0,
          "minimum": 0.0,
          "title": "Value",
          "type": "number"
        },
        "basis": {
          "description": "Coverage basis/denominator (e.g. endpoints, employees).",
          "enum": [
            "endpoints",
            "employees",
            "servers",
            "applications",
            "business_units",
            "data_stores",
            "other"
          ],
          "title": "Basis",
          "type": "string"
        },
        "notes": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional free-form notes about how coverage was estimated.",
          "title": "Notes"
        }
      },
      "required": [
        "value",
        "basis"
      ],
      "title": "Coverage",
      "type": "object"
    },
    "Meta": {
      "properties": {
        "name": {
          "description": "Human-friendly name for this document.",
          "title": "Name",
          "type": "string"
        },
        "version": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional version string for this document.",
          "title": "Version"
        },
        "description": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional free-form description.",
          "title": "Description"
        },
        "author": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional author/owner.",
          "title": "Author"
        },
        "organization": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional organization name.",
          "title": "Organization"
        },
        "industries": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional list of industry tags.",
          "title": "Industries"
        },
        "locale": {
          "additionalProperties": true,
          "description": "Optional locale/region information and arbitrary locale metadata.",
          "title": "Locale",
          "type": "object"
        },
        "company_sizes": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional company size tags.",
          "title": "Company Sizes"
        },
        "regulatory_frameworks": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional list of regulatory frameworks relevant to this document.",
          "title": "Regulatory Frameworks"
        },
        "tags": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional list of user-defined tags.",
          "title": "Tags"
        },
        "attck": {
          "anyOf": [
            {
              "items": {
                "description": "ATT&CK identifier in canonical namespaced form 'namespace:key' (no whitespace). Recommended namespace is 'attck'. Examples: attck:TA0001, attck:T1059, attck:T1059.003",
                "maxLength": 256,
                "minLength": 1,
                "pattern": "^[a-z][a-z0-9_-]{0,31}:[^\\s]{1,223}$",
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional list of ATT&CK tactic/technique/sub-technique identifiers relevant to this document, expressed as namespaced ids (e.g. 'attck:T1059.003').",
          "title": "Attck"
        }
      },
      "required": [
        "name"
      ],
      "title": "Meta",
      "type": "object"
    }
  },
  "additionalProperties": false,
  "properties": {
    "crml_assessment": {
      "const": "1.0",
      "description": "Assessment document version identifier.",
      "title": "Crml Assessment",
      "type": "string"
    },
    "meta": {
      "$ref": "#/$defs/Meta",
      "description": "Document metadata (name, description, tags, etc.)."
    },
    "assessment": {
      "$ref": "#/$defs/AssessmentCatalog",
      "description": "The assessment catalog payload."
    }
  },
  "required": [
    "crml_assessment",
    "meta",
    "assessment"
  ],
  "title": "CRAssessment",
  "type": "object"
}
