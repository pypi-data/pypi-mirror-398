{
  "$defs": {
    "AttackCatalog": {
      "properties": {
        "id": {
          "description": "Catalog identifier and namespace for all attack ids in this catalog. All catalog.attacks[*].id values must begin with '<catalog.id>:' (e.g. catalog.id='attck' -> 'attck:T1566').",
          "maxLength": 32,
          "minLength": 1,
          "pattern": "^[a-z][a-z0-9_-]{0,31}$",
          "title": "Id",
          "type": "string"
        },
        "framework": {
          "description": "Free-form framework label for humans/tools. Example: 'MITRE ATT&CK Enterprise'.",
          "title": "Framework",
          "type": "string"
        },
        "attacks": {
          "description": "List of attack pattern catalog entries.",
          "items": {
            "$ref": "#/$defs/AttackCatalogEntry"
          },
          "title": "Attacks",
          "type": "array"
        }
      },
      "required": [
        "id",
        "framework",
        "attacks"
      ],
      "title": "AttackCatalog",
      "type": "object"
    },
    "AttackCatalogEntry": {
      "description": "Portable metadata about an attack id.\n\nImportant: do not embed copyrighted framework text here.\nKeep this to identifiers and tool-friendly metadata.",
      "properties": {
        "id": {
          "description": "Canonical unique attack id present in this catalog.",
          "maxLength": 256,
          "minLength": 1,
          "pattern": "^[a-z][a-z0-9_-]{0,31}:[^\\s]{1,223}$",
          "title": "Id",
          "type": "string"
        },
        "kind": {
          "description": "Required normalized entry kind for engines and tools.",
          "enum": [
            "tactic",
            "technique",
            "sub-technique",
            "attack-pattern",
            "phase",
            "function",
            "category",
            "subcategory",
            "role",
            "event"
          ],
          "title": "Kind",
          "type": "string"
        },
        "title": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional short human-readable title for the attack entry.",
          "title": "Title"
        },
        "url": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional URL for additional reference material.",
          "title": "Url"
        },
        "parent": {
          "anyOf": [
            {
              "description": "Attack identifier in canonical namespaced form 'namespace:key' (no whitespace). The namespace is expected to match the attack catalog's catalog.id.",
              "maxLength": 256,
              "minLength": 1,
              "pattern": "^[a-z][a-z0-9_-]{0,31}:[^\\s]{1,223}$",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional parent attack id (same catalog namespace). Useful for hierarchical frameworks (e.g. ATT&CK technique -> sub-technique, NIST CSF function -> category -> subcategory).",
          "title": "Parent"
        },
        "phases": {
          "anyOf": [
            {
              "items": {
                "description": "Attack identifier in canonical namespaced form 'namespace:key' (no whitespace). The namespace is expected to match the attack catalog's catalog.id.",
                "maxLength": 256,
                "minLength": 1,
                "pattern": "^[a-z][a-z0-9_-]{0,31}:[^\\s]{1,223}$",
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional list of phase-like ids (same catalog namespace) that this entry is associated with. For ATT&CK, this can point to tactic ids. For kill chains, phases are typically represented as entries themselves.",
          "title": "Phases"
        },
        "tags": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional extra tags for grouping/filtering. Tags are non-semantic and must not replace 'kind'.",
          "title": "Tags"
        }
      },
      "required": [
        "id",
        "kind"
      ],
      "title": "AttackCatalogEntry",
      "type": "object"
    },
    "Meta": {
      "properties": {
        "name": {
          "description": "Human-friendly name for this document.",
          "title": "Name",
          "type": "string"
        },
        "version": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional version string for this document.",
          "title": "Version"
        },
        "description": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional free-form description.",
          "title": "Description"
        },
        "author": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional author/owner.",
          "title": "Author"
        },
        "organization": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional organization name.",
          "title": "Organization"
        },
        "industries": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional list of industry tags.",
          "title": "Industries"
        },
        "locale": {
          "additionalProperties": true,
          "description": "Optional locale/region information and arbitrary locale metadata.",
          "title": "Locale",
          "type": "object"
        },
        "company_sizes": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional company size tags.",
          "title": "Company Sizes"
        },
        "regulatory_frameworks": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional list of regulatory frameworks relevant to this document.",
          "title": "Regulatory Frameworks"
        },
        "tags": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional list of user-defined tags.",
          "title": "Tags"
        },
        "attck": {
          "anyOf": [
            {
              "items": {
                "description": "ATT&CK identifier in canonical namespaced form 'namespace:key' (no whitespace). Recommended namespace is 'attck'. Examples: attck:TA0001, attck:T1059, attck:T1059.003",
                "maxLength": 256,
                "minLength": 1,
                "pattern": "^[a-z][a-z0-9_-]{0,31}:[^\\s]{1,223}$",
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional list of ATT&CK tactic/technique/sub-technique identifiers relevant to this document, expressed as namespaced ids (e.g. 'attck:T1059.003').",
          "title": "Attck"
        }
      },
      "required": [
        "name"
      ],
      "title": "Meta",
      "type": "object"
    }
  },
  "properties": {
    "crml_attack_catalog": {
      "const": "1.0",
      "description": "Attack catalog document version identifier.",
      "title": "Crml Attack Catalog",
      "type": "string"
    },
    "meta": {
      "$ref": "#/$defs/Meta",
      "description": "Document metadata (name, description, tags, etc.)."
    },
    "catalog": {
      "$ref": "#/$defs/AttackCatalog",
      "description": "The attack catalog payload."
    }
  },
  "required": [
    "crml_attack_catalog",
    "meta",
    "catalog"
  ],
  "title": "CRAttackCatalog",
  "type": "object"
}
