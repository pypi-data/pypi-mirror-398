Metadata-Version: 2.4
Name: easy-start-qunjielong
Version: 0.1.0
Summary: ä¸€ä¸ªç”¨äºç¾¤æ¥é¾™å¼€æ”¾å¹³å°é›†æˆçš„ Python åŒ…ï¼Œæä¾›ç®€æ´æ˜“ç”¨çš„ API æ¥å£ï¼Œæ”¯æŒåŒæ­¥å’Œå¼‚æ­¥æ“ä½œï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€Ÿå®ç°ç¾¤æ¥é¾™ç›¸å…³åŠŸèƒ½ã€‚
Home-page: https://gitee.com/guolei19850528/easy_start_qunjielong
Author: guolei
Author-email: 174000902@qq.com
Classifier: Programming Language :: Python :: 3
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Requires-Python: >=3.6
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: httpx
Requires-Dist: diskcache
Requires-Dist: redis
Requires-Dist: jsonschema
Dynamic: author
Dynamic: author-email
Dynamic: classifier
Dynamic: description
Dynamic: description-content-type
Dynamic: home-page
Dynamic: license-file
Dynamic: requires-dist
Dynamic: requires-python
Dynamic: summary

# easy-start-qunjielong

ä¸€ä¸ªç”¨äºç¾¤æ¥é¾™å¼€æ”¾å¹³å°é›†æˆçš„ Python åŒ…ï¼Œæä¾›ç®€æ´æ˜“ç”¨çš„ API æ¥å£ï¼Œæ”¯æŒåŒæ­¥å’Œå¼‚æ­¥æ“ä½œï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€Ÿå®ç°ç¾¤æ¥é¾™ç›¸å…³åŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸš€ æ”¯æŒåŒæ­¥å’Œå¼‚æ­¥ API è¯·æ±‚
- ğŸ” è‡ªåŠ¨ç®¡ç†è®¿é—®ä»¤ç‰Œçš„è·å–ä¸åˆ·æ–°
- ğŸ“Š å“åº”æ•°æ®çš„ JSON Schema éªŒè¯
- ğŸ’¾ æ”¯æŒå¤šç§ç¼“å­˜åç«¯ï¼ˆdiskcache å’Œ Redisï¼‰
- ğŸ¯ ç®€æ´æ˜“ç”¨çš„ API æ¥å£è®¾è®¡
- ğŸ”„ è‡ªåŠ¨å¤„ç†ä»¤ç‰Œè¿‡æœŸå’Œåˆ·æ–°é€»è¾‘
- âš¡ åŸºäº httpx å®ç°é«˜æ€§èƒ½ HTTP è¯·æ±‚

## å®‰è£…æ–¹æ³•

### ä½¿ç”¨ pip å®‰è£…

```bash
pip install easy-start-qunjielong
```

### ä»æºç å®‰è£…

```bash
git clone https://gitee.com/guolei19850528/easy_start_qunjielong.git
cd easy_start_qunjielong
pip install -e .
```

## å¿«é€Ÿå¼€å§‹

### åŒæ­¥æ–¹å¼

```python
from easy_start_qunjielong.open import Api

# åˆå§‹åŒ– API å®¢æˆ·ç«¯
api = Api(secret="your_secret_key")

# åˆ·æ–°è®¿é—®ä»¤ç‰Œ
api.refresh_token()

# å‘é€ API è¯·æ±‚
success, data, response = api.request(
    method="GET", 
    url="/open/api/ghome/getGhomeInfo"
)

if success:
    print(f"è¯·æ±‚æˆåŠŸï¼Œæ•°æ®: {data}")
else:
    print(f"è¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç : {response.status_code}")
```

### å¼‚æ­¥æ–¹å¼

```python
import asyncio
from easy_start_qunjielong.open import Api

async def main():
    # åˆå§‹åŒ– API å®¢æˆ·ç«¯
    api = Api(secret="your_secret_key")
    
    # å¼‚æ­¥åˆ·æ–°è®¿é—®ä»¤ç‰Œ
    await api.async_refresh_token()
    
    # å¼‚æ­¥å‘é€ API è¯·æ±‚
    success, data, response = await api.async_request(
        method="GET", 
        url="/open/api/ghome/getGhomeInfo"
    )
    
    if success:
        print(f"è¯·æ±‚æˆåŠŸï¼Œæ•°æ®: {data}")
    else:
        print(f"è¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç : {response.status_code}")

# è¿è¡Œå¼‚æ­¥å‡½æ•°
asyncio.run(main())
```

### ä½¿ç”¨ç¼“å­˜åŠŸèƒ½

```python
import diskcache
import redis
from easy_start_qunjielong.open import Api

# é€‰é¡¹1: ä½¿ç”¨ diskcache æœ¬åœ°ç¼“å­˜
cache = diskcache.Cache('./runtime/diskcache/default')

# é€‰é¡¹2: ä½¿ç”¨ Redis åˆ†å¸ƒå¼ç¼“å­˜
# cache = redis.Redis(host='localhost', port=6379, db=0)

# åˆå§‹åŒ– API å®¢æˆ·ç«¯å¹¶é…ç½®ç¼“å­˜
api = Api(
    secret="your_secret_key",
    cache_config={
        "instance": cache,
        "expire": 7100  # ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰ï¼Œå»ºè®®è®¾ç½®ä¸ºå°äº 2 å°æ—¶
    }
)

# åˆ·æ–°è®¿é—®ä»¤ç‰Œï¼ˆä¼šè‡ªåŠ¨ç¼“å­˜ï¼‰
api.refresh_token()

# å†æ¬¡è·å–ä»¤ç‰Œä¼šä»ç¼“å­˜ä¸­è¯»å–ï¼Œæé«˜æ€§èƒ½
success, data, response = api.request(
    method="GET", 
    url="/open/api/ghome/getGhomeInfo"
)
```

## API æ–‡æ¡£

### Api ç±»

#### åˆå§‹åŒ–å‚æ•°

```python
Api(base_url: str = "https://openapi.qunjielong.com", secret: str = "", cache_config: dict = None)
```

- `base_url`: ç¾¤æ¥é¾™å¼€æ”¾å¹³å° API åŸºç¡€ URLï¼Œé»˜è®¤ä¸º `"https://openapi.qunjielong.com"`
- `secret`: åº”ç”¨å¯†é’¥ï¼Œç”¨äºè·å–è®¿é—®ä»¤ç‰Œï¼Œå¿…å¡«å‚æ•°
- `cache_config`: ç¼“å­˜é…ç½®å­—å…¸ï¼Œå¯é€‰å‚æ•°ï¼Œæ”¯æŒä»¥ä¸‹é”®ï¼š
  - `key`: ç¼“å­˜é”®åï¼Œé»˜è®¤ä¸º `"qunjielong_open_access_token_{secret}"`
  - `expire`: ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰ï¼Œé»˜è®¤ä¸º `7100`
  - `instance`: ç¼“å­˜å®ä¾‹ï¼Œå¯ä»¥æ˜¯ `diskcache.Cache` æˆ– `redis.Redis`/`redis.StrictRedis`

#### ä¸»è¦æ–¹æ³•

##### åŒæ­¥æ–¹æ³•

- `client(**kwargs)`: åˆ›å»ºå¹¶è¿”å›åŒæ­¥ HTTP å®¢æˆ·ç«¯
  - å‚æ•°: `**kwargs` - ä¼ é€’ç»™ `httpx.Client` çš„é¢å¤–å‚æ•°
  - è¿”å›: `httpx.Client` å¯¹è±¡

- `token(client=None, validate_json_schema=None, **kwargs)`: è·å–è®¿é—®ä»¤ç‰Œ
  - å‚æ•°:
    - `client`: å·²é…ç½®çš„åŒæ­¥ HTTP å®¢æˆ·ç«¯ï¼Œå¯é€‰
    - `validate_json_schema`: å“åº”æ•°æ®çš„ JSON Schema éªŒè¯è§„åˆ™ï¼Œå¯é€‰
    - `**kwargs`: ä¼ é€’ç»™ `client.request` çš„é¢å¤–å‚æ•°
  - è¿”å›: `(éªŒè¯çŠ¶æ€, è®¿é—®ä»¤ç‰Œ, åŸå§‹å“åº”)` ä¸‰å…ƒç»„

- `ghome_getGhomeInfo(client=None, validate_json_schema=None, access_token=None, **kwargs)`: è·å–ç®¡å®¶ä¿¡æ¯
  - å‚æ•°:
    - `client`: å·²é…ç½®çš„åŒæ­¥ HTTP å®¢æˆ·ç«¯ï¼Œå¯é€‰
    - `validate_json_schema`: å“åº”æ•°æ®çš„ JSON Schema éªŒè¯è§„åˆ™ï¼Œå¯é€‰
    - `access_token`: è®¿é—®ä»¤ç‰Œï¼Œå¯é€‰ï¼Œé»˜è®¤ä½¿ç”¨å®¢æˆ·ç«¯å­˜å‚¨çš„ä»¤ç‰Œ
    - `**kwargs`: ä¼ é€’ç»™ `client.request` çš„é¢å¤–å‚æ•°
  - è¿”å›: `(éªŒè¯çŠ¶æ€, ç®¡å®¶ä¿¡æ¯, åŸå§‹å“åº”)` ä¸‰å…ƒç»„

- `refresh_token(client=None)`: åˆ·æ–°è®¿é—®ä»¤ç‰Œï¼ˆè‡ªåŠ¨å¤„ç†ç¼“å­˜ï¼‰
  - å‚æ•°: `client` - å·²é…ç½®çš„åŒæ­¥ HTTP å®¢æˆ·ç«¯ï¼Œå¯é€‰
  - è¿”å›: å®¢æˆ·ç«¯å®ä¾‹æœ¬èº«ï¼ˆæ”¯æŒé“¾å¼è°ƒç”¨ï¼‰

- `request(client=None, validate_json_schema=None, access_token=None, **kwargs)`: å‘é€ API è¯·æ±‚
  - å‚æ•°:
    - `client`: å·²é…ç½®çš„åŒæ­¥ HTTP å®¢æˆ·ç«¯ï¼Œå¯é€‰
    - `validate_json_schema`: å“åº”æ•°æ®çš„ JSON Schema éªŒè¯è§„åˆ™ï¼Œå¯é€‰
    - `access_token`: è®¿é—®ä»¤ç‰Œï¼Œå¯é€‰ï¼Œé»˜è®¤ä½¿ç”¨å®¢æˆ·ç«¯å­˜å‚¨çš„ä»¤ç‰Œ
    - `**kwargs`: ä¼ é€’ç»™ `client.request` çš„é¢å¤–å‚æ•°ï¼ŒåŒ…æ‹¬ `method`ã€`url`ã€`params`ã€`json` ç­‰
  - è¿”å›: `(éªŒè¯çŠ¶æ€, å“åº”æ•°æ®, åŸå§‹å“åº”)` ä¸‰å…ƒç»„

##### å¼‚æ­¥æ–¹æ³•

- `async_client(**kwargs)`: åˆ›å»ºå¹¶è¿”å›å¼‚æ­¥ HTTP å®¢æˆ·ç«¯
  - å‚æ•°: `**kwargs` - ä¼ é€’ç»™ `httpx.AsyncClient` çš„é¢å¤–å‚æ•°
  - è¿”å›: `httpx.AsyncClient` å¯¹è±¡

- `async_token(client=None, validate_json_schema=None, **kwargs)`: å¼‚æ­¥è·å–è®¿é—®ä»¤ç‰Œ
  - å‚æ•°:
    - `client`: å·²é…ç½®çš„å¼‚æ­¥ HTTP å®¢æˆ·ç«¯ï¼Œå¯é€‰
    - `validate_json_schema`: å“åº”æ•°æ®çš„ JSON Schema éªŒè¯è§„åˆ™ï¼Œå¯é€‰
    - `**kwargs`: ä¼ é€’ç»™ `client.request` çš„é¢å¤–å‚æ•°
  - è¿”å›: `(éªŒè¯çŠ¶æ€, è®¿é—®ä»¤ç‰Œ, åŸå§‹å“åº”)` ä¸‰å…ƒç»„

- `async_ghome_getGhomeInfo(client=None, validate_json_schema=None, access_token=None, **kwargs)`: å¼‚æ­¥è·å–ç®¡å®¶ä¿¡æ¯
  - å‚æ•°:
    - `client`: å·²é…ç½®çš„å¼‚æ­¥ HTTP å®¢æˆ·ç«¯ï¼Œå¯é€‰
    - `validate_json_schema`: å“åº”æ•°æ®çš„ JSON Schema éªŒè¯è§„åˆ™ï¼Œå¯é€‰
    - `access_token`: è®¿é—®ä»¤ç‰Œï¼Œå¯é€‰ï¼Œé»˜è®¤ä½¿ç”¨å®¢æˆ·ç«¯å­˜å‚¨çš„ä»¤ç‰Œ
    - `**kwargs`: ä¼ é€’ç»™ `client.request` çš„é¢å¤–å‚æ•°
  - è¿”å›: `(éªŒè¯çŠ¶æ€, ç®¡å®¶ä¿¡æ¯, åŸå§‹å“åº”)` ä¸‰å…ƒç»„

- `async_refresh_token(client=None)`: å¼‚æ­¥åˆ·æ–°è®¿é—®ä»¤ç‰Œï¼ˆè‡ªåŠ¨å¤„ç†ç¼“å­˜ï¼‰
  - å‚æ•°: `client` - å·²é…ç½®çš„å¼‚æ­¥ HTTP å®¢æˆ·ç«¯ï¼Œå¯é€‰
  - è¿”å›: å®¢æˆ·ç«¯å®ä¾‹æœ¬èº«ï¼ˆæ”¯æŒé“¾å¼è°ƒç”¨ï¼‰

- `async_request(client=None, validate_json_schema=None, access_token=None, **kwargs)`: å‘é€å¼‚æ­¥ API è¯·æ±‚
  - å‚æ•°:
    - `client`: å·²é…ç½®çš„å¼‚æ­¥ HTTP å®¢æˆ·ç«¯ï¼Œå¯é€‰
    - `validate_json_schema`: å“åº”æ•°æ®çš„ JSON Schema éªŒè¯è§„åˆ™ï¼Œå¯é€‰
    - `access_token`: è®¿é—®ä»¤ç‰Œï¼Œå¯é€‰ï¼Œé»˜è®¤ä½¿ç”¨å®¢æˆ·ç«¯å­˜å‚¨çš„ä»¤ç‰Œ
    - `**kwargs`: ä¼ é€’ç»™ `client.request` çš„é¢å¤–å‚æ•°ï¼ŒåŒ…æ‹¬ `method`ã€`url`ã€`params`ã€`json` ç­‰
  - è¿”å›: `(éªŒè¯çŠ¶æ€, å“åº”æ•°æ®, åŸå§‹å“åº”)` ä¸‰å…ƒç»„

#### å“åº”æ ¼å¼

æ‰€æœ‰ API è¯·æ±‚æ–¹æ³•è¿”å›ä¸€ä¸ªä¸‰å…ƒç»„ `(success, data, response)`:

- `success`: å¸ƒå°”å€¼ï¼Œè¡¨ç¤º API å“åº”æ˜¯å¦ç¬¦åˆ JSON Schema éªŒè¯
- `data`: API å“åº”çš„ `data` å­—æ®µå†…å®¹
- `response`: åŸå§‹çš„ `httpx.Response` å¯¹è±¡

## ä¾èµ–é¡¹

- `httpx`: ç”¨äºå‘é€ HTTP è¯·æ±‚
- `diskcache`: ç”¨äºæœ¬åœ°ç¼“å­˜è®¿é—®ä»¤ç‰Œ
- `redis`: ç”¨äºåˆ†å¸ƒå¼ç¼“å­˜è®¿é—®ä»¤ç‰Œ
- `jsonschema`: ç”¨äºéªŒè¯ API å“åº”æ ¼å¼

## å¼€å‘å’Œæµ‹è¯•

### è¿è¡Œæµ‹è¯•

```bash
python -m pytest test_open.py -v
```

### é¡¹ç›®ç»“æ„

```
easy_start_qunjielong/
â”œâ”€â”€ easy_start_qunjielong/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ open.py
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ README.md
```

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ä½œè€…ä¿¡æ¯

- **ä½œè€…**: guolei
- **é‚®ç®±**: 174000902@qq.com
- **é¡¹ç›®åœ°å€**: [https://gitee.com/guolei19850528/easy_start_qunjielong](https://gitee.com/guolei19850528/easy_start_qunjielong)
