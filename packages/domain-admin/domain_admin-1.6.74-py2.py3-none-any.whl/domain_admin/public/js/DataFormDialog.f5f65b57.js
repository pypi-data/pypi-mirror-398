import{_ as D}from"./index.9c016c05.js";import{ak as u,o as n,c as _,D as l,E as a,a as g,P as b,a3 as V,B as p,M as v,O as k,L as C}from"./vendor-vue.4795a80b.js";const O={host:[{message:"\u4E3B\u673A\u5730\u5740\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],user:[{message:"\u7528\u6237\u540D\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],password:[{message:"\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],private_key:[{message:"\u79D8\u94A5\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}]},f={PASSWORD:1,PRIVATE_KEY:2},S=[{label:"\u5BC6\u7801",value:f.PASSWORD},{label:"\u79C1\u94A5\u8BC1\u4E66",value:f.PRIVATE_KEY}];function P(s){var e;return(e=S.find(r=>r.value===s))==null?void 0:e.label}const H={name:"RemoteHostForm",props:{row:{type:Object,default:null}},components:{},data(){return{rules:O,HostAuthTypeEnum:f,HostAuthTypeOptions:S,form:{host:"",port:"22",user:"",auth_type:f.PASSWORD,password:"",private_key:"",dns_id:0},dnsList:[]}},computed:{},methods:{async getData(){if(console.log(this.row),this.row&&this.row.id){const s=await this.getHostById(this.row.id);for(let e in this.form)this.form[e]=s[e]}else this.row&&this.row.host&&(this.form.host=this.row.host);this.getDnsList()},async getDnsList(){const s=await this.$http.getDnsList();s.code==0&&(this.dnsList=s.data.list)},async getHostById(s){let e={host_id:s};return(await this.$http.getHostById(e)).data},handleCancel(){this.$emit("on-cancel")},handleSubmit(){this.$refs.form.validate(s=>{if(s)this.confirmSubmit();else return!1})},async confirmSubmit(){let s=this.$loading({fullscreen:!0}),e={host:this.form.host,port:this.form.port,user:this.form.user,password:this.form.password,private_key:this.form.private_key,auth_type:this.form.auth_type,dns_id:this.form.dns_id},r=null,h=null;if(this.row&&this.row.id?(h=this.row.id,e.host_id=this.row.id,r=await this.$http.updateHostById(e),{...this.row,...e}):(r=await this.$http.addHost(e),r.data,h=r.data.id),r.code==0){this.$msg.success("\u64CD\u4F5C\u6210\u529F");let t=await this.getHostById(h);this.$emit("on-success",t)}else this.$msg.error(r.msg);this.$nextTick(()=>{s.close()})}},created(){this.getData()}},T={class:"remote-host"},A={class:"flex"},B={class:"text-center"};function E(s,e,r,h,t,i){const m=u("el-input"),d=u("el-form-item"),c=u("el-option"),y=u("el-select"),x=u("el-form"),w=u("el-button");return n(),_("div",T,[l(x,{ref:"form",model:t.form,rules:t.rules,"label-width":"100px"},{default:a(()=>[l(d,{label:"\u4E3B\u673A\u5730\u5740",prop:"host"},{default:a(()=>[g("div",A,[l(m,{type:"text",modelValue:t.form.host,"onUpdate:modelValue":e[0]||(e[0]=o=>t.form.host=o),placeholder:"\u4E3B\u673A\u5730\u5740"},null,8,["modelValue"]),l(m,{class:"remote-host__port-input",type:"text",modelValue:t.form.port,"onUpdate:modelValue":e[1]||(e[1]=o=>t.form.port=o),placeholder:"\u7AEF\u53E3\u53F7"},null,8,["modelValue"])])]),_:1}),l(d,{label:"\u7528\u6237\u540D",prop:"user"},{default:a(()=>[l(m,{type:"text",modelValue:t.form.user,"onUpdate:modelValue":e[2]||(e[2]=o=>t.form.user=o),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D"},null,8,["modelValue"])]),_:1}),l(d,{label:"\u9A8C\u8BC1\u65B9\u5F0F",prop:"auth_type"},{default:a(()=>[l(y,{modelValue:t.form.auth_type,"onUpdate:modelValue":e[3]||(e[3]=o=>t.form.auth_type=o)},{default:a(()=>[(n(!0),_(b,null,V(t.HostAuthTypeOptions,o=>(n(),p(c,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t.HostAuthTypeEnum.PRIVATE_KEY==t.form.auth_type?(n(),p(d,{key:0,label:"\u79C1\u94A5\u8BC1\u4E66",prop:"private_key"},{default:a(()=>[l(m,{type:"textarea",rows:5,modelValue:t.form.private_key,"onUpdate:modelValue":e[4]||(e[4]=o=>t.form.private_key=o),"show-password":"",spellcheck:!1,placeholder:"\u8BF7\u8F93\u5165\u79C1\u94A5\u8BC1\u4E66"},null,8,["modelValue"])]),_:1})):(n(),p(d,{key:1,label:"\u5BC6\u7801",prop:"password"},{default:a(()=>[l(m,{type:"password",modelValue:t.form.password,"onUpdate:modelValue":e[5]||(e[5]=o=>t.form.password=o),"show-password":"",autocomplete:"new-password",placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801"},null,8,["modelValue"])]),_:1})),l(d,{label:"\u5173\u8054DNS\u8D26\u53F7",prop:"dns_id"},{default:a(()=>[l(y,{modelValue:t.form.dns_id,"onUpdate:modelValue":e[6]||(e[6]=o=>t.form.dns_id=o),placeholder:"\u8BF7\u9009\u62E9DNS\u8D26\u53F7",clearable:""},{default:a(()=>[(n(!0),_(b,null,V(t.dnsList,o=>(n(),p(c,{key:o.id,label:o.name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),g("div",B,[l(w,{onClick:i.handleCancel},{default:a(()=>[v(k(s.$t("\u53D6\u6D88")),1)]),_:1},8,["onClick"]),l(w,{type:"primary",onClick:i.handleSubmit},{default:a(()=>[v(k(s.$t("\u786E\u5B9A")),1)]),_:1},8,["onClick"])])])}const L=D(H,[["render",E]]),I={name:"",props:{row:{type:Object,default:null},visible:{type:Boolean,default:!1}},emits:["update:visible"],components:{DataForm:L},data(){return{}},computed:{dialogTitle(){return this.row&&this.row.id?"\u7F16\u8F91\u4E3B\u673A":"\u6DFB\u52A0\u4E3B\u673A"},dialogVisible:{get(){return this.visible},set(s){this.$emit("update:visible",s)}}},methods:{handleClose(){this.$emit("update:visible",!1)},handleOpen(){this.$emit("update:visible",!0)},handleSuccess(s){this.handleClose(),this.$emit("on-success",s)}},created(){}};function R(s,e,r,h,t,i){const m=u("DataForm"),d=u("el-dialog");return n(),p(d,{title:i.dialogTitle,modelValue:i.dialogVisible,"onUpdate:modelValue":e[0]||(e[0]=c=>i.dialogVisible=c),width:"400px",center:"","append-to-body":""},{default:a(()=>[i.dialogVisible?(n(),p(m,{key:0,row:r.row,onOnCancel:i.handleClose,onOnSuccess:i.handleSuccess},null,8,["row","onOnCancel","onOnSuccess"])):C("",!0)]),_:1},8,["title","modelValue"])}const N=D(I,[["render",R]]);export{N as D,P as g};
