# TC PyTools é¡¹ç›®è®¾ç½®å®Œæˆ

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. UV åŒ…ç®¡ç†å™¨é…ç½®
- âœ… åˆ›å»º `pyproject.toml` é…ç½®æ–‡ä»¶
- âœ… é…ç½®é¡¹ç›®å…ƒæ•°æ®å’Œä¾èµ–
- âœ… è®¾ç½®å¼€å‘ä¾èµ–ï¼ˆpytest, pytest-cov, ruff, mypy, pre-commitï¼‰
- âœ… é…ç½® CLI å…¥å£ç‚¹ `rename-ngdc-genome-id`
- âœ… åˆ›å»º `.python-version` æ–‡ä»¶æŒ‡å®š Python ç‰ˆæœ¬
- âœ… ç”Ÿæˆ `uv.lock` é”æ–‡ä»¶
- âœ… åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ `.venv/`

### 2. æœ¬åœ° CI é…ç½®
å·²åˆ›å»ºä¸‰ç§æœ¬åœ° CI æ–¹å¼ï¼š

#### æ–¹å¼ 1: CI Shell è„šæœ¬ (`ci.sh`)
- å®Œæ•´çš„ CI æµç¨‹è„šæœ¬
- åŒ…å«ä¾èµ–æ£€æŸ¥ã€æ ¼å¼åŒ–ã€ä»£ç æ£€æŸ¥ã€ç±»å‹æ£€æŸ¥ã€æµ‹è¯•
- å½©è‰²è¾“å‡ºå’Œè¯¦ç»†æŠ¥å‘Š
- ä½¿ç”¨: `./ci.sh`

#### æ–¹å¼ 2: Pre-commit é’©å­ (`.pre-commit-config.yaml`)
- Git æäº¤å‰è‡ªåŠ¨æ£€æŸ¥
- åŒ…å«ä»£ç æ ¼å¼åŒ–ã€ä»£ç æ£€æŸ¥ã€ç±»å‹æ£€æŸ¥ã€æµ‹è¯•
- ä½¿ç”¨:
  ```bash
  uv run pre-commit install  # å®‰è£…é’©å­
  uv run pre-commit run --all-files  # æ‰‹åŠ¨è¿è¡Œ
  ```

#### æ–¹å¼ 3: Makefile
- ä¾¿æ·çš„å‘½ä»¤å¿«æ·æ–¹å¼
- æä¾› `make ci` è¿è¡Œå®Œæ•´æ£€æŸ¥
- å…¶ä»–å‘½ä»¤: `make test`, `make lint`, `make format` ç­‰
- ä½¿ç”¨: `make help` æŸ¥çœ‹æ‰€æœ‰å‘½ä»¤

### 3. GitHub Actions CI/CD (`.github/workflows/ci.yml`)
- å¤š Python ç‰ˆæœ¬æµ‹è¯• (3.8-3.12)
- è‡ªåŠ¨åŒ–æ ¼å¼æ£€æŸ¥ã€ä»£ç æ£€æŸ¥ã€ç±»å‹æ£€æŸ¥ã€æµ‹è¯•
- è¦†ç›–ç‡ä¸Šä¼ åˆ° Codecov
- æ„å»ºäº§ç‰©ä¸Šä¼ 

### 4. ä»£ç è´¨é‡å·¥å…·é…ç½®

#### Ruff (`ruff.toml`)
- ä»£ç æ ¼å¼åŒ–å™¨å’Œæ£€æŸ¥å™¨
- æ›¿ä»£ black, isort, flake8
- é…ç½®äº† pyupgrade, bugbear ç­‰æ£€æŸ¥

#### MyPy
- é™æ€ç±»å‹æ£€æŸ¥
- é…ç½®åœ¨ `pyproject.toml` ä¸­

#### Pytest (`pyproject.toml`)
- å•å…ƒæµ‹è¯•æ¡†æ¶
- é…ç½®äº†è¦†ç›–ç‡æŠ¥å‘Š
- HTML å’Œç»ˆç«¯æŠ¥å‘Š

### 5. é¡¹ç›®æ–‡æ¡£
- âœ… `README.md` - é¡¹ç›®è¯´æ˜å’Œä½¿ç”¨æ–‡æ¡£
- âœ… `QUICKREF.md` - ä¸­æ–‡å¿«é€Ÿå‚è€ƒæŒ‡å—
- âœ… `.gitignore` - Git å¿½ç•¥æ–‡ä»¶é…ç½®

### 6. åŒ…ç»“æ„ä¼˜åŒ–
- âœ… æ·»åŠ  `gtf/__init__.py`
- âœ… æ·»åŠ  `gtf/tests/__init__.py`
- âœ… é…ç½® hatchling æ„å»ºç³»ç»Ÿ

## ğŸ“¦ é¡¹ç›®ç»“æ„

```
tc-pytools-v1.1/
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â””â”€â”€ ci.yml                 # GitHub Actions CI é…ç½®
â”œâ”€â”€ .venv/                         # è™šæ‹Ÿç¯å¢ƒï¼ˆç”± uv ç®¡ç†ï¼‰
â”œâ”€â”€ gtf/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ rename_ngdc_genome_id.py   # ä¸»ç¨‹åº
â”‚   â””â”€â”€ tests/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ test_rename_ngdc_genome_id.py  # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ htmlcov/                       # è¦†ç›–ç‡ HTML æŠ¥å‘Š
â”œâ”€â”€ .coverage                      # è¦†ç›–ç‡æ•°æ®
â”œâ”€â”€ .gitignore                     # Git å¿½ç•¥é…ç½®
â”œâ”€â”€ .pre-commit-config.yaml        # Pre-commit é…ç½®
â”œâ”€â”€ .python-version                # Python ç‰ˆæœ¬
â”œâ”€â”€ ci.sh                          # æœ¬åœ° CI è„šæœ¬
â”œâ”€â”€ Makefile                       # Make å‘½ä»¤
â”œâ”€â”€ pyproject.toml                 # é¡¹ç›®é…ç½®
â”œâ”€â”€ QUICKREF.md                    # å¿«é€Ÿå‚è€ƒï¼ˆä¸­æ–‡ï¼‰
â”œâ”€â”€ README.md                      # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ ruff.toml                      # Ruff é…ç½®
â””â”€â”€ uv.lock                        # UV é”æ–‡ä»¶
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¬¬ä¸€æ¬¡ä½¿ç”¨
```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd /home/kent/scripts/tc-pytools-v1.1

# 2. å®‰è£…ä¾èµ–ï¼ˆå·²å®Œæˆï¼‰
uv sync

# 3. è¿è¡Œæµ‹è¯•éªŒè¯
make test

# 4. è¿è¡Œå®Œæ•´ CI
make ci
```

### æ—¥å¸¸å¼€å‘
```bash
# è¿è¡Œæµ‹è¯•
make test

# æ ¼å¼åŒ–ä»£ç 
make format

# ä»£ç æ£€æŸ¥
make lint

# è¿è¡Œ CI
make ci

# æˆ–ç›´æ¥è¿è¡Œ CI è„šæœ¬
./ci.sh
```

### ä½¿ç”¨å·¥å…·
```bash
# è¿è¡Œä¸»ç¨‹åº
uv run rename-ngdc-genome-id -f input.fasta -o output.fasta

# å¤„ç† FASTA å’Œ GFF
uv run rename-ngdc-genome-id -f genome.fasta -o out.fasta -g input.gff -og out.gff
```

## ğŸ“Š æµ‹è¯•ç»“æœ

å½“å‰æµ‹è¯•çŠ¶æ€:
- âœ… 10/10 æµ‹è¯•é€šè¿‡
- âœ… ä»£ç è¦†ç›–ç‡: 67%
- âœ… æ— æ ¼å¼é—®é¢˜
- âœ… æ— ä»£ç æ£€æŸ¥é—®é¢˜
- âœ… æ— ç±»å‹æ£€æŸ¥é—®é¢˜

## ğŸ¯ ä¸‹ä¸€æ­¥å»ºè®®

1. **å¢åŠ æµ‹è¯•è¦†ç›–ç‡**: å½“å‰ 67%ï¼Œå¯ä»¥æ·»åŠ æ›´å¤šæµ‹è¯•è¦†ç›– main å‡½æ•°
2. **æ·»åŠ æ›´å¤šæ–‡æ¡£**: å¦‚éœ€è¦å¯ä»¥æ·»åŠ  API æ–‡æ¡£
3. **è®¾ç½® Git ä»“åº“**: åˆå§‹åŒ– Git å¹¶æ¨é€åˆ°è¿œç¨‹
4. **é…ç½® Codecov**: å¦‚æœæœ‰ GitHub ä»“åº“ï¼Œå¯ä»¥å¯ç”¨è¦†ç›–ç‡è¿½è¸ª
5. **å‘å¸ƒåŒ…**: å¯ä»¥å‘å¸ƒåˆ° PyPI

## ğŸ“ é‡è¦å‘½ä»¤æ€»ç»“

```bash
# å¼€å‘
make install          # å®‰è£…ä¾èµ–
make test            # è¿è¡Œæµ‹è¯•
make lint            # ä»£ç æ£€æŸ¥
make format          # æ ¼å¼åŒ–ä»£ç 
make ci              # å®Œæ•´ CI

# UV å‘½ä»¤
uv sync              # åŒæ­¥ä¾èµ–
uv add <package>     # æ·»åŠ ä¾èµ–
uv run <command>     # è¿è¡Œå‘½ä»¤

# è¿è¡Œç¨‹åº
uv run rename-ngdc-genome-id -f <fasta> -o <output>

# CI
./ci.sh              # æœ¬åœ° CI è„šæœ¬
make pre-commit-run  # è¿è¡Œ pre-commit
```

## âœ¨ ç‰¹æ€§äº®ç‚¹

1. **ç°ä»£åŒ–å·¥å…·é“¾**: ä½¿ç”¨ uv ä½œä¸ºå¿«é€Ÿçš„åŒ…ç®¡ç†å™¨
2. **å®Œæ•´çš„ CI/CD**: æœ¬åœ°å’Œ GitHub Actions åŒé‡ä¿éšœ
3. **ä»£ç è´¨é‡**: Ruff + MyPy + Pytest ä¸‰é‡æ£€æŸ¥
4. **å¤šç§è¿è¡Œæ–¹å¼**: Shell è„šæœ¬ã€Makeã€Pre-commit
5. **è¯¦ç»†æ–‡æ¡£**: ä¸­è‹±æ–‡æ–‡æ¡£é½å…¨
6. **è‡ªåŠ¨åŒ–**: Pre-commit é’©å­è‡ªåŠ¨æ£€æŸ¥

---

**é¡¹ç›®å·²å‡†å¤‡å°±ç»ªï¼Œå¯ä»¥å¼€å§‹å¼€å‘ï¼** ğŸ‰
