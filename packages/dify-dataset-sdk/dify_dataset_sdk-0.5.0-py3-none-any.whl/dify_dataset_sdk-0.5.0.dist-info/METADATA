Metadata-Version: 2.4
Name: dify-dataset-sdk
Version: 0.5.0
Summary: Python SDK for Dify Dataset API
Project-URL: Homepage, https://github.com/LeekJay/dify-dataset-sdk
Project-URL: Documentation, https://docs.dify.ai/
Project-URL: Repository, https://github.com/LeekJay/dify-dataset-sdk
Project-URL: Issues, https://github.com/LeekJay/dify-dataset-sdk/issues
Author: LeekJay
Keywords: api,dataset,dify,knowledge-base,sdk
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Topic :: Internet :: WWW/HTTP :: Dynamic Content
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Requires-Python: >=3.8.1
Requires-Dist: httpx>=0.28.1
Requires-Dist: pydantic>=2.10.6
Provides-Extra: dev
Requires-Dist: mypy>=1.0.0; extra == 'dev'
Requires-Dist: pytest-asyncio>=0.21.0; extra == 'dev'
Requires-Dist: pytest>=7.0.0; extra == 'dev'
Requires-Dist: ruff>=0.12.7; extra == 'dev'
Provides-Extra: publish
Requires-Dist: build>=1.0.0; extra == 'publish'
Requires-Dist: twine>=6.1.0; extra == 'publish'
Description-Content-Type: text/markdown

# Dify Dataset SDK

ç”¨äºç®¡ç† Dify çŸ¥è¯†åº“çš„ Python SDKã€‚

## ç‰¹æ€§

- ğŸ“š **æ¨¡å—åŒ–è®¾è®¡**: æŒ‰åŠŸèƒ½åˆ†ç¦»çš„å®¢æˆ·ç«¯æ¨¡å—ï¼ˆdatasetsã€documentsã€segmentsã€tagsã€metadataã€modelsï¼‰
- ğŸ” **å®‰å…¨è®¤è¯**: åŸºäº API Key çš„å®‰å…¨è®¤è¯
- ğŸ“„ **æ–‡æ¡£ç®¡ç†**: æ”¯æŒæ–‡æœ¬å’Œæ–‡ä»¶ä¸Šä¼ åˆ›å»ºæ–‡æ¡£
- ğŸ—‚ï¸ **æ•°æ®é›†æ“ä½œ**: å®Œæ•´çš„çŸ¥è¯†åº“ CRUD æ“ä½œ
- âœ‚ï¸ **æ–‡æ¡£å—ç®¡ç†**: ç²¾ç»†åŒ–çš„æ–‡æ¡£å—ï¼ˆchunksï¼‰å’Œå­å—ç®¡ç†
- ğŸ·ï¸ **æ ‡ç­¾ç³»ç»Ÿ**: çŸ¥è¯†åº“æ ‡ç­¾ç®¡ç†
- ğŸ§¾ **å…ƒæ•°æ®ç®¡ç†**: è‡ªå®šä¹‰å…ƒæ•°æ®å­—æ®µä¸æ–‡æ¡£å…ƒæ•°æ®ç®¡ç†
- ğŸ” **é«˜çº§æ£€ç´¢**: æ”¯æŒè¯­ä¹‰æœç´¢ã€å…¨æ–‡æœç´¢ã€æ··åˆæœç´¢
- ğŸ”’ **ç±»å‹å®‰å…¨**: å®Œæ•´çš„ç±»å‹æç¤ºå’Œ Pydantic æ¨¡å‹
- âš ï¸ **å¼‚å¸¸å¤„ç†**: å®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶

## å®‰è£…

```bash
pip install dify-dataset-sdk
```

## å¿«é€Ÿå¼€å§‹

```python
from dify_dataset_sdk import DifyDatasetClient

# åˆå§‹åŒ–å®¢æˆ·ç«¯
client = DifyDatasetClient(api_key="your-api-key")

# åˆ›å»ºçŸ¥è¯†åº“
dataset = client.datasets.create(name="æˆ‘çš„çŸ¥è¯†åº“")

# æ·»åŠ æ–‡æ¡£
doc = client.documents.create_by_text(
    dataset_id=dataset.id,
    name="ç¤ºä¾‹æ–‡æ¡£",
    text="è¿™æ˜¯æ–‡æ¡£å†…å®¹..."
)

# æ£€ç´¢çŸ¥è¯†åº“
results = client.datasets.retrieve(dataset_id=dataset.id, query="æœç´¢å…³é”®è¯")
```

## å®¢æˆ·ç«¯ç»“æ„

SDK é‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œé€šè¿‡ç»Ÿä¸€çš„ `DifyDatasetClient` å…¥å£è®¿é—®å„åŠŸèƒ½æ¨¡å—ï¼š

```python
client = DifyDatasetClient(api_key="your-api-key")

client.datasets    # æ•°æ®é›†ç®¡ç†
client.documents   # æ–‡æ¡£ç®¡ç†
client.segments    # æ–‡æ¡£å—ç®¡ç†
client.tags        # æ ‡ç­¾ç®¡ç†
client.metadata    # å…ƒæ•°æ®ç®¡ç†
client.models      # åµŒå…¥æ¨¡å‹æŸ¥è¯¢
```

## API å‚è€ƒ

### åˆå§‹åŒ–å®¢æˆ·ç«¯

```python
from dify_dataset_sdk import DifyDatasetClient

client = DifyDatasetClient(
    api_key="your-api-key",           # APIå¯†é’¥ï¼ˆå¿…éœ€ï¼‰
    base_url="https://api.dify.ai",   # APIåœ°å€ï¼ˆå¯é€‰ï¼‰
    timeout=30.0                       # è¶…æ—¶æ—¶é—´ï¼ˆå¯é€‰ï¼‰
)

# æ”¯æŒä¸Šä¸‹æ–‡ç®¡ç†å™¨
with DifyDatasetClient(api_key="your-api-key") as client:
    dataset = client.datasets.create(name="test")
```

---

### æ•°æ®é›†ç®¡ç† (client.datasets)

#### åˆ›å»ºæ•°æ®é›†

```python
dataset = client.datasets.create(
    name="çŸ¥è¯†åº“åç§°",                    # å¿…éœ€
    description="çŸ¥è¯†åº“æè¿°",             # å¯é€‰
    indexing_technique="high_quality",   # å¯é€‰: "high_quality" | "economy"
    permission="only_me",                # å¯é€‰: "only_me" | "all_team_members" | "partial_members"
    embedding_model="text-embedding-3-small",      # å¯é€‰
    embedding_model_provider="openai",             # å¯é€‰
)
```

#### è·å–æ•°æ®é›†åˆ—è¡¨

```python
result = client.datasets.list(
    keyword="æœç´¢å…³é”®è¯",    # å¯é€‰
    tag_ids=["tag-id"],     # å¯é€‰
    page=1,                  # å¯é€‰ï¼Œé»˜è®¤1
    limit=20,                # å¯é€‰ï¼Œé»˜è®¤20
)

for dataset in result.data:
    print(f"{dataset['id']}: {dataset['name']}")
```

#### è·å–æ•°æ®é›†è¯¦æƒ…

```python
dataset = client.datasets.get(dataset_id="dataset-id")
print(dataset.name)
```

#### æ›´æ–°æ•°æ®é›†

```python
dataset = client.datasets.update(
    dataset_id="dataset-id",
    name="æ–°åç§°",
    description="æ–°æè¿°",
)
```

#### åˆ é™¤æ•°æ®é›†

```python
client.datasets.delete(dataset_id="dataset-id")
```

#### çŸ¥è¯†åº“æ£€ç´¢

```python
from dify_dataset_sdk import RetrievalModel

# åŸºæœ¬æ£€ç´¢
results = client.datasets.retrieve(
    dataset_id="dataset-id",
    query="æœç´¢å†…å®¹"
)

# é«˜çº§æ£€ç´¢é…ç½®
retrieval_model = RetrievalModel(
    search_method="hybrid_search",  # "hybrid_search" | "semantic_search" | "full_text_search" | "keyword_search"
    reranking_enable=True,
    top_k=10,
    score_threshold_enabled=True,
    score_threshold=0.5,
)

results = client.datasets.retrieve(
    dataset_id="dataset-id",
    query="æœç´¢å†…å®¹",
    retrieval_model=retrieval_model
)

for record in results.records:
    print(f"å†…å®¹: {record['content']}")
    print(f"åˆ†æ•°: {record['score']}")
```

---

### æ–‡æ¡£ç®¡ç† (client.documents)

#### é€šè¿‡æ–‡æœ¬åˆ›å»ºæ–‡æ¡£

```python
from dify_dataset_sdk import ProcessRule

response = client.documents.create_by_text(
    dataset_id="dataset-id",
    name="æ–‡æ¡£åç§°",
    text="æ–‡æ¡£å†…å®¹...",
    indexing_technique="high_quality",   # å¯é€‰
    doc_form="text_model",               # å¯é€‰: "text_model" | "hierarchical_model" | "qa_model"
    doc_language="zh",                   # å¯é€‰ï¼ŒQ&Aæ¨¡å¼ä½¿ç”¨
)

print(f"æ–‡æ¡£ID: {response.document.id}")
print(f"æ‰¹æ¬¡ID: {response.batch}")
```

#### é€šè¿‡æ–‡ä»¶åˆ›å»ºæ–‡æ¡£

```python
response = client.documents.create_by_file(
    dataset_id="dataset-id",
    file_path="/path/to/file.pdf",
    indexing_technique="high_quality",
)
```

#### è·å–æ–‡æ¡£åˆ—è¡¨

```python
result = client.documents.list(
    dataset_id="dataset-id",
    keyword="æœç´¢å…³é”®è¯",    # å¯é€‰
    page=1,
    limit=20,
)
```

#### è·å–æ–‡æ¡£è¯¦æƒ…

```python
document = client.documents.get(
    dataset_id="dataset-id",
    document_id="document-id",
    metadata="all",  # "all" | "only" | "without"
)
```

#### æ›´æ–°æ–‡æ¡£ï¼ˆæ–‡æœ¬ï¼‰

```python
response = client.documents.update_by_text(
    dataset_id="dataset-id",
    document_id="document-id",
    name="æ–°åç§°",
    text="æ–°å†…å®¹",
)
```

#### æ›´æ–°æ–‡æ¡£ï¼ˆæ–‡ä»¶ï¼‰

```python
response = client.documents.update_by_file(
    dataset_id="dataset-id",
    document_id="document-id",
    file_path="/path/to/new_file.pdf",
)
```

#### åˆ é™¤æ–‡æ¡£

```python
client.documents.delete(
    dataset_id="dataset-id",
    document_id="document-id"
)
```

#### è·å–ç´¢å¼•çŠ¶æ€

```python
status = client.documents.get_indexing_status(
    dataset_id="dataset-id",
    batch="batch-id"  # åˆ›å»ºæ–‡æ¡£æ—¶è¿”å›çš„batch
)

for item in status.data:
    print(f"çŠ¶æ€: {item.indexing_status}")
    print(f"è¿›åº¦: {item.completed_segments}/{item.total_segments}")
```

#### æ‰¹é‡æ›´æ–°æ–‡æ¡£çŠ¶æ€

```python
client.documents.batch_update_status(
    dataset_id="dataset-id",
    action="enable",  # "enable" | "disable" | "archive" | "un_archive"
    document_ids=["doc-id-1", "doc-id-2"]
)
```

---

### æ–‡æ¡£å—ç®¡ç† (client.segments)

#### åˆ›å»ºæ–‡æ¡£å—

```python
response = client.segments.create(
    dataset_id="dataset-id",
    document_id="document-id",
    segments=[
        {
            "content": "å—å†…å®¹",
            "keywords": ["å…³é”®è¯1", "å…³é”®è¯2"],
            "answer": "ç­”æ¡ˆå†…å®¹ï¼ˆQ&Aæ¨¡å¼ï¼‰"  # å¯é€‰
        }
    ]
)
```

#### è·å–æ–‡æ¡£å—åˆ—è¡¨

```python
response = client.segments.list(
    dataset_id="dataset-id",
    document_id="document-id",
    keyword="æœç´¢å…³é”®è¯",    # å¯é€‰
    status="completed",      # å¯é€‰
    page=1,
    limit=20,
)

for segment in response.data:
    print(f"{segment.id}: {segment.content[:50]}...")
```

#### è·å–æ–‡æ¡£å—è¯¦æƒ…

```python
segment = client.segments.get(
    dataset_id="dataset-id",
    document_id="document-id",
    segment_id="segment-id"
)
```

#### æ›´æ–°æ–‡æ¡£å—

```python
client.segments.update(
    dataset_id="dataset-id",
    document_id="document-id",
    segment_id="segment-id",
    segment_data={
        "content": "æ›´æ–°åçš„å†…å®¹",
        "keywords": ["æ–°å…³é”®è¯"],
        "enabled": True,
    }
)
```

#### åˆ é™¤æ–‡æ¡£å—

```python
client.segments.delete(
    dataset_id="dataset-id",
    document_id="document-id",
    segment_id="segment-id"
)
```

#### å­å—æ“ä½œï¼ˆåˆ†å±‚æ¨¡å¼ï¼‰

```python
# åˆ›å»ºå­å—
client.segments.create_child_chunk(
    dataset_id="dataset-id",
    document_id="document-id",
    segment_id="segment-id",
    content="å­å—å†…å®¹"
)

# è·å–å­å—åˆ—è¡¨
response = client.segments.list_child_chunks(
    dataset_id="dataset-id",
    document_id="document-id",
    segment_id="segment-id",
)

# æ›´æ–°å­å—
client.segments.update_child_chunk(
    dataset_id="dataset-id",
    document_id="document-id",
    segment_id="segment-id",
    child_chunk_id="child-chunk-id",
    content="æ›´æ–°åçš„å­å—å†…å®¹"
)

# åˆ é™¤å­å—
client.segments.delete_child_chunk(
    dataset_id="dataset-id",
    document_id="document-id",
    segment_id="segment-id",
    child_chunk_id="child-chunk-id"
)
```

---

### æ ‡ç­¾ç®¡ç† (client.tags)

#### çŸ¥è¯†åº“æ ‡ç­¾

```python
# åˆ›å»ºæ ‡ç­¾
tag = client.tags.create(name="é‡è¦")

# è·å–æ‰€æœ‰æ ‡ç­¾
tags = client.tags.list()

# æ›´æ–°æ ‡ç­¾
tag = client.tags.update(tag_id="tag-id", name="éå¸¸é‡è¦")

# åˆ é™¤æ ‡ç­¾
client.tags.delete(tag_id="tag-id")

# ç»‘å®šæ ‡ç­¾åˆ°æ•°æ®é›†
client.tags.bind_to_dataset(
    dataset_id="dataset-id",
    tag_ids=["tag-id-1", "tag-id-2"]
)

# è§£ç»‘æ ‡ç­¾
client.tags.unbind_from_dataset(
    dataset_id="dataset-id",
    tag_id="tag-id"
)

# è·å–æ•°æ®é›†çš„æ ‡ç­¾
tags = client.tags.get_dataset_tags(dataset_id="dataset-id")
```

### å…ƒæ•°æ®ç®¡ç† (client.metadata)

```python
# åˆ›å»ºå…ƒæ•°æ®å­—æ®µ
metadata = client.metadata.create(
    dataset_id="dataset-id",
    field_type="string",  # "string" | "number" | "time"
    name="ä½œè€…"
)

# è·å–å…ƒæ•°æ®å­—æ®µåˆ—è¡¨
response = client.metadata.list(dataset_id="dataset-id")

# æ›´æ–°å…ƒæ•°æ®å­—æ®µ
metadata = client.metadata.update(
    dataset_id="dataset-id",
    metadata_id="metadata-id",
    name="æ–°å­—æ®µå"
)

# åˆ é™¤å…ƒæ•°æ®å­—æ®µ
client.metadata.delete(
    dataset_id="dataset-id",
    metadata_id="metadata-id"
)

# å¯ç”¨/ç¦ç”¨å†…ç½®å…ƒæ•°æ®
client.metadata.toggle_built_in(
    dataset_id="dataset-id",
    action="enable"  # "enable" | "disable"
)

# æ›´æ–°æ–‡æ¡£å…ƒæ•°æ®å€¼
client.metadata.update_document_metadata(
    dataset_id="dataset-id",
    operation_data=[
        {
            "document_id": "doc-id",
            "metadata_list": [
                {"id": "metadata-id", "value": "å€¼", "name": "å­—æ®µå"}
            ]
        }
    ]
)
```

---

### åµŒå…¥æ¨¡å‹ (client.models)

```python
# è·å–å¯ç”¨çš„åµŒå…¥æ¨¡å‹åˆ—è¡¨
response = client.models.list_embedding_models()

for provider in response.data:
    print(f"æä¾›å•†: {provider['provider']}")
    for model in provider.get('models', []):
        print(f"  - {model['model']}")
```

---

## å¼‚å¸¸å¤„ç†

```python
from dify_dataset_sdk import (
    DifyError,
    DifyAPIError,
    DifyAuthenticationError,
    DifyValidationError,
    DifyNotFoundError,
    DifyConflictError,
    DifyServerError,
    DifyConnectionError,
    DifyTimeoutError,
)

try:
    dataset = client.datasets.get(dataset_id="invalid-id")
except DifyNotFoundError as e:
    print(f"èµ„æºæœªæ‰¾åˆ°: {e.message}")
except DifyAuthenticationError as e:
    print(f"è®¤è¯å¤±è´¥: {e.message}")
except DifyValidationError as e:
    print(f"å‚æ•°é”™è¯¯: {e.message}, é”™è¯¯ç : {e.error_code}")
except DifyAPIError as e:
    print(f"APIé”™è¯¯: {e.message}, HTTPçŠ¶æ€ç : {e.status_code}")
except DifyConnectionError as e:
    print(f"è¿æ¥é”™è¯¯: {e.message}")
except DifyTimeoutError as e:
    print(f"è¯·æ±‚è¶…æ—¶: {e.message}")
```

## å®Œæ•´ç¤ºä¾‹

```python
from dify_dataset_sdk import DifyDatasetClient, RetrievalModel

def main():
    # åˆå§‹åŒ–å®¢æˆ·ç«¯
    with DifyDatasetClient(api_key="your-api-key") as client:
        # 1. åˆ›å»ºçŸ¥è¯†åº“
        dataset = client.datasets.create(
            name="äº§å“æ–‡æ¡£åº“",
            description="å­˜å‚¨äº§å“ç›¸å…³æ–‡æ¡£"
        )
        print(f"åˆ›å»ºçŸ¥è¯†åº“: {dataset.id}")

        # 2. æ·»åŠ æ–‡æ¡£
        doc_response = client.documents.create_by_text(
            dataset_id=dataset.id,
            name="äº§å“ä»‹ç»",
            text="""
            è¿™æ˜¯ä¸€æ¬¾æ™ºèƒ½åŠ©æ‰‹äº§å“ã€‚
            ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š
            1. è‡ªç„¶è¯­è¨€ç†è§£
            2. çŸ¥è¯†åº“æ£€ç´¢
            3. å¤šè½®å¯¹è¯
            """
        )
        print(f"åˆ›å»ºæ–‡æ¡£: {doc_response.document.id}")

        # 3. ç­‰å¾…ç´¢å¼•å®Œæˆï¼ˆå®é™…ä½¿ç”¨ä¸­åº”è½®è¯¢æ£€æŸ¥ï¼‰
        import time
        time.sleep(5)

        # 4. æ£€ç´¢çŸ¥è¯†åº“
        results = client.datasets.retrieve(
            dataset_id=dataset.id,
            query="äº§å“æœ‰å“ªäº›åŠŸèƒ½",
            retrieval_model=RetrievalModel(
                search_method="hybrid_search",
                top_k=3
            )
        )

        print("\næ£€ç´¢ç»“æœ:")
        for record in results.records:
            print(f"- {record['content'][:100]}...")
            print(f"  åˆ†æ•°: {record['score']}")

        # 5. æ·»åŠ æ ‡ç­¾
        tag = client.tags.create(name="äº§å“")
        client.tags.bind_to_dataset(dataset.id, tag_ids=[tag.id])
        print(f"\nå·²æ·»åŠ æ ‡ç­¾: {tag.name}")

if __name__ == "__main__":
    main()
```

## SDK ç»“æ„

```text
dify_dataset_sdk/
â”œâ”€â”€ __init__.py           # ç»Ÿä¸€å¯¼å‡ºå…¥å£
â”œâ”€â”€ _base.py              # HTTP å®¢æˆ·ç«¯åŸºç±»
â”œâ”€â”€ _exceptions.py        # å¼‚å¸¸ç±»å®šä¹‰
â”œâ”€â”€ client.py             # DifyClient ä¸»å…¥å£
â”œâ”€â”€ datasets/             # æ•°æ®é›†æ¨¡å—
â”‚   â”œâ”€â”€ client.py         # DatasetsClient
â”‚   â””â”€â”€ models.py         # Dataset ç›¸å…³æ¨¡å‹
â”œâ”€â”€ documents/            # æ–‡æ¡£æ¨¡å—
â”‚   â”œâ”€â”€ client.py         # DocumentsClient
â”‚   â””â”€â”€ models.py         # Document ç›¸å…³æ¨¡å‹
â”œâ”€â”€ segments/             # æ–‡æ¡£å—æ¨¡å—
â”‚   â”œâ”€â”€ client.py         # SegmentsClient
â”‚   â””â”€â”€ models.py         # Segment/ChildChunk ç›¸å…³æ¨¡å‹
â”œâ”€â”€ tags/                 # æ ‡ç­¾æ¨¡å—
â”‚   â”œâ”€â”€ client.py         # TagsClient
â”‚   â””â”€â”€ models.py         # Tag ç›¸å…³æ¨¡å‹
â”œâ”€â”€ metadata/             # å…ƒæ•°æ®æ¨¡å—
â”‚   â”œâ”€â”€ client.py         # MetadataClient
â”‚   â””â”€â”€ models.py         # Metadata ç›¸å…³æ¨¡å‹
â””â”€â”€ models_api/           # åµŒå…¥æ¨¡å‹æ¨¡å—
    â”œâ”€â”€ client.py         # ModelsClient
    â””â”€â”€ models.py         # EmbeddingModel ç›¸å…³æ¨¡å‹
```

## ä» v0.3.0 è¿ç§»åˆ° v0.4.0

### ä¸»è¦å˜æ›´

v0.4.0 å¯¹ SDK è¿›è¡Œäº†æ¨¡å—åŒ–é‡æ„ï¼ŒAPI è°ƒç”¨æ–¹å¼æœ‰è¾ƒå¤§å˜åŒ–ï¼š

1. **å®¢æˆ·ç«¯ç±»åä¸å˜**ï¼šä»ç„¶ä½¿ç”¨ `DifyDatasetClient`
2. **æ–¹æ³•è°ƒç”¨æ–¹å¼å˜æ›´**ï¼šä»æ‰å¹³æ–¹æ³•è°ƒç”¨æ”¹ä¸ºæ¨¡å—åŒ–è°ƒç”¨
3. **å¯¼å…¥è·¯å¾„å˜æ›´**ï¼šç»Ÿä¸€ä» `dify_dataset_sdk` å¯¼å…¥

### å®¢æˆ·ç«¯åˆå§‹åŒ–

```python
# v0.3.0 å’Œ v0.4.0 åˆå§‹åŒ–æ–¹å¼ç›¸åŒ
from dify_dataset_sdk import DifyDatasetClient

client = DifyDatasetClient(api_key="your-api-key")
```

### API æ˜ å°„è¡¨

#### æ•°æ®é›†æ“ä½œ

| v0.3.0 æ–¹æ³• | v0.4.0 æ–¹æ³• |
|------------|------------|
| `client.create_dataset(name=...)` | `client.datasets.create(name=...)` |
| `client.list_datasets(...)` | `client.datasets.list(...)` |
| `client.get_dataset(dataset_id)` | `client.datasets.get(dataset_id)` |
| `client.update_dataset(dataset_id, ...)` | `client.datasets.update(dataset_id, ...)` |
| `client.delete_dataset(dataset_id)` | `client.datasets.delete(dataset_id)` |
| `client.retrieve(dataset_id, query)` | `client.datasets.retrieve(dataset_id, query)` |

#### æ–‡æ¡£æ“ä½œ

| v0.3.0 æ–¹æ³• | v0.4.0 æ–¹æ³• |
|------------|------------|
| `client.create_document_by_text(...)` | `client.documents.create_by_text(...)` |
| `client.create_document_by_file(...)` | `client.documents.create_by_file(...)` |
| `client.list_documents(dataset_id, ...)` | `client.documents.list(dataset_id, ...)` |
| `client.get_document(dataset_id, document_id)` | `client.documents.get(dataset_id, document_id)` |
| `client.update_document_by_text(...)` | `client.documents.update_by_text(...)` |
| `client.update_document_by_file(...)` | `client.documents.update_by_file(...)` |
| `client.delete_document(dataset_id, document_id)` | `client.documents.delete(dataset_id, document_id)` |
| `client.get_document_indexing_status(...)` | `client.documents.get_indexing_status(...)` |
| `client.batch_update_document_status(...)` | `client.documents.batch_update_status(...)` |

#### æ–‡æ¡£å—æ“ä½œ

| v0.3.0 æ–¹æ³• | v0.4.0 æ–¹æ³• |
|------------|------------|
| `client.create_segments(...)` | `client.segments.create(...)` |
| `client.list_segments(...)` | `client.segments.list(...)` |
| `client.get_segment(...)` | `client.segments.get(...)` |
| `client.update_segment(...)` | `client.segments.update(...)` |
| `client.delete_segment(...)` | `client.segments.delete(...)` |
| `client.create_child_chunk(...)` | `client.segments.create_child_chunk(...)` |
| `client.list_child_chunks(...)` | `client.segments.list_child_chunks(...)` |
| `client.update_child_chunk(...)` | `client.segments.update_child_chunk(...)` |
| `client.delete_child_chunk(...)` | `client.segments.delete_child_chunk(...)` |

#### æ ‡ç­¾æ“ä½œ

| v0.3.0 æ–¹æ³• | v0.4.0 æ–¹æ³• |
|------------|------------|
| `client.create_knowledge_tag(...)` | `client.tags.create(...)` |
| `client.list_knowledge_tags()` | `client.tags.list()` |
| `client.update_knowledge_tag(...)` | `client.tags.update(...)` |
| `client.delete_knowledge_tag(...)` | `client.tags.delete(...)` |
| `client.bind_dataset_to_tag(...)` | `client.tags.bind_to_dataset(...)` |
| `client.unbind_dataset_from_tag(...)` | `client.tags.unbind_from_dataset(...)` |
| `client.get_dataset_tags(...)` | `client.tags.get_dataset_tags(...)` |

#### å…ƒæ•°æ®æ“ä½œ

| v0.3.0 æ–¹æ³• | v0.4.0 æ–¹æ³• |
|------------|------------|
| `client.create_metadata_field(...)` | `client.metadata.create(...)` |
| `client.list_metadata_fields(...)` | `client.metadata.list(...)` |
| `client.update_metadata_field(...)` | `client.metadata.update(...)` |
| `client.delete_metadata_field(...)` | `client.metadata.delete(...)` |
| `client.toggle_built_in_metadata_field(...)` | `client.metadata.toggle_built_in(...)` |
| `client.update_document_metadata(...)` | `client.metadata.update_document_metadata(...)` |

#### æ¨¡å‹æ“ä½œ

| v0.3.0 æ–¹æ³• | v0.4.0 æ–¹æ³• |
|------------|------------|
| `client.list_embedding_models()` | `client.models.list_embedding_models()` |

### å®Œæ•´è¿ç§»ç¤ºä¾‹

```python
# ============ v0.3.0 ä»£ç  ============
from dify_dataset_sdk import DifyDatasetClient

client = DifyDatasetClient(api_key="your-api-key")

# åˆ›å»ºçŸ¥è¯†åº“
dataset = client.create_dataset(name="æˆ‘çš„çŸ¥è¯†åº“")

# æ·»åŠ æ–‡æ¡£
doc = client.create_document_by_text(
    dataset_id=dataset.id,
    name="ç¤ºä¾‹æ–‡æ¡£",
    text="æ–‡æ¡£å†…å®¹"
)

# åˆ›å»ºæ ‡ç­¾
tag = client.create_knowledge_tag(name="é‡è¦")
client.bind_dataset_to_tag(dataset_id=dataset.id, tag_ids=[tag.id])

# æ£€ç´¢
results = client.retrieve(dataset_id=dataset.id, query="æœç´¢å…³é”®è¯")


# ============ v0.4.0 ä»£ç  ============
from dify_dataset_sdk import DifyDatasetClient

client = DifyDatasetClient(api_key="your-api-key")

# åˆ›å»ºçŸ¥è¯†åº“
dataset = client.datasets.create(name="æˆ‘çš„çŸ¥è¯†åº“")

# æ·»åŠ æ–‡æ¡£
doc = client.documents.create_by_text(
    dataset_id=dataset.id,
    name="ç¤ºä¾‹æ–‡æ¡£",
    text="æ–‡æ¡£å†…å®¹"
)

# åˆ›å»ºæ ‡ç­¾
tag = client.tags.create(name="é‡è¦")
client.tags.bind_to_dataset(dataset_id=dataset.id, tag_ids=[tag.id])

# æ£€ç´¢
results = client.datasets.retrieve(dataset_id=dataset.id, query="æœç´¢å…³é”®è¯")
```

### æ¨¡å‹å’Œå¼‚å¸¸ç±»

æ¨¡å‹å’Œå¼‚å¸¸ç±»çš„å¯¼å…¥ä¿æŒä¸å˜ï¼š

```python
from dify_dataset_sdk import (
    # æ¨¡å‹ç±»
    Dataset,
    Document,
    Segment,
    RetrievalModel,
    ProcessRule,
    KnowledgeTag,
    Metadata,
    # å¼‚å¸¸ç±»
    DifyError,
    DifyAPIError,
    DifyAuthenticationError,
    DifyNotFoundError,
    DifyValidationError,
    DifyServerError,
    DifyConnectionError,
    DifyTimeoutError,
)
```

---

## ç‰ˆæœ¬ä¿¡æ¯

- å½“å‰ç‰ˆæœ¬: 0.5.0
- Python æ”¯æŒ: >= 3.8.1
- ä¾èµ–: httpx, pydantic

## æ›´æ–°æ—¥å¿—

### v0.5.0

- **ç ´åæ€§å˜æ›´**: `tags` ä¸ `metadata` æ‹†åˆ†ä¸ºç‹¬ç«‹æ¨¡å—
- **æ–°å¢æ¨¡å—**: `client.metadata` ä¸“ç”¨äºå…ƒæ•°æ®ç›¸å…³æ“ä½œ

### v0.4.0

- **é‡æ„**: é‡‡ç”¨æ¨¡å—åŒ–æ¶æ„ï¼ŒæŒ‰åŠŸèƒ½æ‹†åˆ†å®¢æˆ·ç«¯
- **æ–° API**: ä½¿ç”¨ `DifyDatasetClient` å…¥å£è®¿é—®å„å­æ¨¡å—ï¼ˆdatasets, documents, segments, tags, metadata, modelsï¼‰
- **æ”¹è¿›**: ç®€åŒ–æ–¹æ³•å‘½åï¼ˆå¦‚ `create_dataset` â†’ `datasets.create`ï¼‰

### v0.3.0

- åˆå§‹ç‰ˆæœ¬ï¼Œæ”¯æŒå®Œæ•´çš„ Dify Knowledge Base API

## License

MIT License
