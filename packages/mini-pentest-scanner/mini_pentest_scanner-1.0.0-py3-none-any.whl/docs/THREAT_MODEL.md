# üõ°Ô∏è Threat Model - Mini Pentest Lab

## üìã ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°

Threat Model ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Mini Pentest Lab ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÅ‡∏•‡∏∞‡∏à‡∏∏‡∏î‡πÇ‡∏à‡∏°‡∏ï‡∏µ

## üéØ Assets (‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô)

### 1. User Data
- Username, Password
- Email
- Role (admin/user)
- Session tokens

### 2. Application Data
- Posts
- User profiles
- Database

### 3. System Information
- Error messages
- Debug information
- File system access

## üë§ Threat Actors (‡∏ú‡∏π‡πâ‡∏Ñ‡∏∏‡∏Å‡∏Ñ‡∏≤‡∏°)

### 1. Unauthenticated User
- **‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ**: ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á public endpoints
- **‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢**: ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• public, ‡πÉ‡∏ä‡πâ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà XSS, SQL Injection

### 2. Authenticated User
- **‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ**: ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á user endpoints
- **‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢**: ‡πÉ‡∏ä‡πâ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà IDOR, XSS, CSRF

### 3. Privileged User (Admin)
- **‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ**: ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á admin endpoints
- **‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢**: ‡πÉ‡∏ä‡πâ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà authorization bypass

## üîì Attack Vectors (‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡πÇ‡∏à‡∏°‡∏ï‡∏µ)

### 1. SQL Injection
- **‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á**: Login, Register, Search
- **‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö**: Bypass authentication, ‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•, ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
- **‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á**: üî¥ ‡∏™‡∏π‡∏á

### 2. Cross-Site Scripting (XSS)
- **‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á**: Search, Post creation, Post display
- **‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö**: ‡∏Ç‡πÇ‡∏°‡∏¢ session, redirect, defacement
- **‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á**: üü° ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á-‡∏™‡∏π‡∏á

### 3. Insecure Direct Object Reference (IDOR)
- **‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á**: Profile view, API endpoints
- **‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö**: ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏≠‡∏∑‡πà‡∏ô
- **‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á**: üü° ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á

### 4. Weak Authentication
- **‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á**: Authentication system
- **‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö**: Brute force, password cracking
- **‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á**: üî¥ ‡∏™‡∏π‡∏á

### 5. Session Management Issues
- **‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á**: Session handling
- **‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö**: Session fixation, session hijacking
- **‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á**: üü° ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á

### 6. Information Disclosure
- **‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á**: Error messages, Debug endpoint
- **‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö**: ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏∞‡∏ö‡∏ö
- **‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á**: üü¢ ‡∏ï‡πà‡∏≥-‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á

### 7. Cross-Site Request Forgery (CSRF)
- **‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á**: Form submissions
- **‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö**: ‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡πÅ‡∏ó‡∏ô‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
- **‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á**: üü° ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á

### 8. Path Traversal
- **‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á**: File viewer
- **‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö**: ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏∞‡∏ö‡∏ö
- **‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á**: üî¥ ‡∏™‡∏π‡∏á

## üõ°Ô∏è Security Controls (‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢)

### ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô (‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà)
- ‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ input validation
- ‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ output encoding
- ‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ CSRF protection
- ‚ùå Weak password hashing
- ‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ rate limiting
- ‚ùå Session management ‡πÑ‡∏°‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢

### ‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ (Best Practices)
- ‚úÖ Input validation ‡πÅ‡∏•‡∏∞ sanitization
- ‚úÖ Output encoding
- ‚úÖ CSRF tokens
- ‚úÖ Strong password hashing (bcrypt/argon2)
- ‚úÖ Rate limiting
- ‚úÖ Secure session management
- ‚úÖ Security headers
- ‚úÖ Parameterized queries

## üìä Risk Assessment (‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á)

| ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà | ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á | ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô | ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö | Risk Level |
|---------|-----------|--------------|---------|-----------|
| SQL Injection | ‡∏™‡∏π‡∏á | ‡∏™‡∏π‡∏á | ‡∏™‡∏π‡∏á | üî¥ Critical |
| XSS | ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á-‡∏™‡∏π‡∏á | ‡∏™‡∏π‡∏á | ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á | üü° High |
| IDOR | ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á | ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á | ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á | üü° Medium |
| Weak Auth | ‡∏™‡∏π‡∏á | ‡∏™‡∏π‡∏á | ‡∏™‡∏π‡∏á | üî¥ Critical |
| Session Issues | ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á | ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á | ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á | üü° Medium |
| Info Disclosure | ‡∏ï‡πà‡∏≥-‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á | ‡∏™‡∏π‡∏á | ‡∏ï‡πà‡∏≥ | üü¢ Low-Medium |
| CSRF | ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á | ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á | ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á | üü° Medium |
| Path Traversal | ‡∏™‡∏π‡∏á | ‡∏ï‡πà‡∏≥ | ‡∏™‡∏π‡∏á | üü° High |

## üéØ Mitigation Strategies (‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå‡∏Å‡∏≤‡∏£‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á)

### 1. SQL Injection
- ‡πÉ‡∏ä‡πâ parameterized queries
- Input validation
- Least privilege database access

### 2. XSS
- Output encoding
- Content Security Policy (CSP)
- Input sanitization

### 3. IDOR
- Authorization checks
- Access control lists
- Resource ownership verification

### 4. Weak Authentication
- Strong password hashing (bcrypt/argon2)
- Rate limiting
- Multi-factor authentication

### 5. Session Management
- Secure session cookies
- Session regeneration
- Session timeout

### 6. Information Disclosure
- Generic error messages
- Disable debug mode in production
- Remove debug endpoints

### 7. CSRF
- CSRF tokens
- SameSite cookies
- Referer validation

### 8. Path Traversal
- Path validation
- Whitelist allowed files
- Sandbox file access

## üìö ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á

- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [OWASP Threat Modeling](https://owasp.org/www-community/Threat_Modeling)
- [OWASP Application Security Verification Standard](https://owasp.org/www-project-application-security-verification-standard/)

---

**‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏**: Threat Model ‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô

