{
  "summary": {
    "total_issues": 10,
    "total_estimated_monthly_saving_usd": 91.6,
    "severity_breakdown": {
      "low": 0,
      "medium": 5,
      "high": 4,
      "critical": 1
    }
  },
  "timestamp": "2025-12-20T15:04:44.640303",
  "issues": [
    {
      "rule": "unattached_ebs_volume",
      "resource": "cost-scanner/sample-repos/sample_ec2_ebs.tf:aws_ebs_volume.unused_volume",
      "severity": "medium",
      "estimated_monthly_saving_usd": 16.0,
      "details": "EBS volume size ~200 GB (heuristic demo)",
      "recommendation": "Delete or snapshot and move to colder storage after verification"
    },
    {
      "rule": "s3_versioning_disabled",
      "resource": "cost-scanner/sample-repos/sample_s3.tf:aws_s3_bucket.public_bucket",
      "severity": "medium",
      "estimated_monthly_saving_usd": 0,
      "details": "S3 bucket does not have versioning enabled",
      "recommendation": "Enable versioning to protect against accidental deletes and overwrites"
    },
    {
      "rule": "unused_elastic_ip",
      "resource": "cost-scanner/sample-repos/sample_network.tf:aws_eip.unused_ip",
      "severity": "medium",
      "estimated_monthly_saving_usd": 3.6,
      "details": "Elastic IP allocated but not attached to any instance",
      "recommendation": "Release unused Elastic IPs to avoid charges"
    },
    {
      "rule": "overprovisioned_ec2",
      "resource": "cost-scanner/sample-repos/sample_ec2_ebs.tf:aws_instance.big_instance",
      "severity": "medium",
      "estimated_monthly_saving_usd": 62.0,
      "details": "Instance type m5.large could be downsized to t2.micro",
      "recommendation": "Consider downsizing m5.large to t2.micro if workload allows"
    },
    {
      "rule": "unused_rds_snapshot",
      "resource": "cost-scanner/sample-repos/unused_rds_snapshot.tf:aws_db_snapshot.old_snapshot",
      "severity": "medium",
      "estimated_monthly_saving_usd": 10.0,
      "details": "RDS snapshot appears unused",
      "recommendation": "Delete or archive unused snapshots to reduce storage cost"
    },
    {
      "rule": "public_s3_bucket",
      "resource": "cost-scanner/sample-repos/sample_s3.tf:aws_s3_bucket.public_bucket",
      "severity": "high",
      "estimated_monthly_saving_usd": 0,
      "details": "S3 bucket ACL is public-read",
      "recommendation": "Remove public ACL; use least-privilege bucket policy"
    },
    {
      "rule": "unencrypted_rds_instance",
      "resource": "cost-scanner/sample-repos/sample_rds.tf:aws_db_instance.unencrypted_db",
      "severity": "high",
      "estimated_monthly_saving_usd": 0,
      "details": "RDS instance storage is not encrypted",
      "recommendation": "Enable storage encryption for compliance and security"
    },
    {
      "rule": "unencrypted_s3_bucket",
      "resource": "cost-scanner/sample-repos/sample_s3.tf:aws_s3_bucket.public_bucket",
      "severity": "high",
      "estimated_monthly_saving_usd": 0,
      "details": "S3 bucket lacks encryption configuration",
      "recommendation": "Enable server-side encryption (SSE) for compliance and data protection"
    },
    {
      "rule": "iam_inline_policy",
      "resource": "cost-scanner/sample-repos/iam_inline_policy.tf:aws_iam_user_policy.inline_policy_example",
      "severity": "high",
      "estimated_monthly_saving_usd": 0,
      "details": "IAM user has an inline policy attached",
      "recommendation": "Use managed policies or group-based access instead of inline user policies"
    },
    {
      "rule": "open_security_group",
      "resource": "cost-scanner/sample-repos/sample_sg.tf:aws_security_group.open_sg",
      "severity": "critical",
      "estimated_monthly_saving_usd": 0,
      "details": "Security group allows access from anywhere",
      "recommendation": "Restrict CIDR blocks to trusted IP ranges"
    }
  ]
}