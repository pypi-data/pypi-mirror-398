import{b as xt}from"./chunk-55BKVSJZ.js";import{a as br}from"./chunk-XP7HK5C5.js";import{a as Ct}from"./chunk-74KQCU7Q.js";import{a as pr,b as gr,c as jr}from"./chunk-GNFIJ6N6.js";import{a as kt}from"./chunk-4GAYC3RP.js";import{a as vr}from"./chunk-4QYV6YJG.js";import{a as hr,b as $}from"./chunk-UBE66OYC.js";import{a as yr}from"./chunk-IVA6BOTV.js";import{a as K,c as Tt,d as Xe}from"./chunk-S7O4ILSJ.js";import{a as wt,b as q,c as E}from"./chunk-Y7GZ3BOM.js";var Ft=wt((Fi,Ce)=>{(function(n){typeof define=="function"&&define.amd?define([],n):typeof Ce=="object"&&Ce.exports?Ce.exports=n():window.idleCallbackShim=n()})(function(){"use strict";var n,e,t,r,i=typeof window<"u"?window:typeof global!=null?global:this||{},o=i.cancelRequestAnimationFrame&&i.requestAnimationFrame||setTimeout,s=i.cancelRequestAnimationFrame||clearTimeout,l=[],f=0,u=!1,p=7,m=35,z=125,ge=0,te=0,ae=0,le={get didTimeout(){return!1},timeRemaining:function(){var F=p-(Date.now()-te);return F<0?0:F}},de=P(function(){p=22,z=66,m=0});function P(F){var A,O,D=99,V=function(){var U=Date.now()-O;U<D?A=setTimeout(V,D-U):(A=null,F())};return function(){O=Date.now(),A||(A=setTimeout(V,D))}}function I(){u&&(r&&s(r),t&&clearTimeout(t),u=!1)}function L(){z!=125&&(p=7,z=125,m=35,u&&(I(),re())),de()}function be(){r=null,t=setTimeout(Ve,0)}function W(){t=null,o(be)}function re(){u||(e=z-(Date.now()-te),n=Date.now(),u=!0,m&&e<m&&(e=m),e>9?t=setTimeout(W,e):(e=0,W()))}function Ve(){var F,A,O,D=p>9?9:1;if(te=Date.now(),u=!1,t=null,f>2||te-e-50<n)for(A=0,O=l.length;A<O&&le.timeRemaining()>D;A++)F=l.shift(),ae++,F&&F(le);l.length?re():f=0}function ce(F){return ge++,l.push(F),re(),ge}function ve(F){var A=F-1-ae;l[A]&&(l[A]=null)}if(!i.requestIdleCallback||!i.cancelIdleCallback)i.requestIdleCallback=ce,i.cancelIdleCallback=ve,i.document&&document.addEventListener&&(i.addEventListener("scroll",L,!0),i.addEventListener("resize",L),document.addEventListener("focus",L,!0),document.addEventListener("mouseover",L,!0),["click","keypress","touchstart","mousedown"].forEach(function(F){document.addEventListener(F,L,{capture:!0,passive:!0})}),i.MutationObserver&&new MutationObserver(L).observe(document.documentElement,{childList:!0,subtree:!0,attributes:!0}));else try{i.requestIdleCallback(function(){},{timeout:0})}catch{(function(A){var O,D;if(i.requestIdleCallback=function(V,U){return U&&typeof U.timeout=="number"?A(V,U.timeout):A(V)},i.IdleCallbackDeadline&&(O=IdleCallbackDeadline.prototype)){if(D=Object.getOwnPropertyDescriptor(O,"timeRemaining"),!D||!D.configurable||!D.get)return;Object.defineProperty(O,"timeRemaining",{value:function(){return D.get.call(this)},enumerable:!0,configurable:!0})}})(i.requestIdleCallback)}return{request:ce,cancel:ve}})});var $t=wt((Ai,_t)=>{var Er="Expected a function",It="__lodash_hash_undefined__",Rt=1/0,wr=9007199254740991,kr="[object Function]",xr="[object GeneratorFunction]",Tr="[object Symbol]",Cr=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Fr=/^\w*$/,Ar=/^\./,Sr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Lr=/[\\^$.*+?()[\]{}|]/g,Pr=/\\(\\)?/g,Ir=/^\[object .+?Constructor\]$/,Rr=/^(?:0|[1-9]\d*)$/,Mr=typeof global=="object"&&global&&global.Object===Object&&global,Dr=typeof self=="object"&&self&&self.Object===Object&&self,Ke=Mr||Dr||Function("return this")();function Hr(n,e){return n==null?void 0:n[e]}function Or(n){var e=!1;if(n!=null&&typeof n.toString!="function")try{e=!!(n+"")}catch{}return e}var qr=Array.prototype,Vr=Function.prototype,Mt=Object.prototype,We=Ke["__core-js_shared__"],At=(function(){var n=/[^.]+$/.exec(We&&We.keys&&We.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""})(),Dt=Vr.toString,Ae=Mt.hasOwnProperty,Ht=Mt.toString,_r=RegExp("^"+Dt.call(Ae).replace(Lr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),St=Ke.Symbol,$r=qr.splice,Nr=Ot(Ke,"Map"),pe=Ot(Object,"create"),Lt=St?St.prototype:void 0,Pt=Lt?Lt.toString:void 0;function Q(n){var e=-1,t=n?n.length:0;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}function Br(){this.__data__=pe?pe(null):{}}function Gr(n){return this.has(n)&&delete this.__data__[n]}function zr(n){var e=this.__data__;if(pe){var t=e[n];return t===It?void 0:t}return Ae.call(e,n)?e[n]:void 0}function Ur(n){var e=this.__data__;return pe?e[n]!==void 0:Ae.call(e,n)}function Jr(n,e){var t=this.__data__;return t[n]=pe&&e===void 0?It:e,this}Q.prototype.clear=Br;Q.prototype.delete=Gr;Q.prototype.get=zr;Q.prototype.has=Ur;Q.prototype.set=Jr;function oe(n){var e=-1,t=n?n.length:0;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}function Xr(){this.__data__=[]}function Wr(n){var e=this.__data__,t=Se(e,n);if(t<0)return!1;var r=e.length-1;return t==r?e.pop():$r.call(e,t,1),!0}function Kr(n){var e=this.__data__,t=Se(e,n);return t<0?void 0:e[t][1]}function Qr(n){return Se(this.__data__,n)>-1}function Yr(n,e){var t=this.__data__,r=Se(t,n);return r<0?t.push([n,e]):t[r][1]=e,this}oe.prototype.clear=Xr;oe.prototype.delete=Wr;oe.prototype.get=Kr;oe.prototype.has=Qr;oe.prototype.set=Yr;function Y(n){var e=-1,t=n?n.length:0;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}function Zr(){this.__data__={hash:new Q,map:new(Nr||oe),string:new Q}}function ei(n){return Le(this,n).delete(n)}function ti(n){return Le(this,n).get(n)}function ri(n){return Le(this,n).has(n)}function ii(n,e){return Le(this,n).set(n,e),this}Y.prototype.clear=Zr;Y.prototype.delete=ei;Y.prototype.get=ti;Y.prototype.has=ri;Y.prototype.set=ii;function oi(n,e,t){var r=n[e];(!(Ae.call(n,e)&&qt(r,t))||t===void 0&&!(e in n))&&(n[e]=t)}function Se(n,e){for(var t=n.length;t--;)if(qt(n[t][0],e))return t;return-1}function ni(n){if(!Fe(n)||fi(n))return!1;var e=gi(n)||Or(n)?_r:Ir;return e.test(hi(n))}function si(n,e,t,r){if(!Fe(n))return n;e=ci(e,n)?[e]:li(e);for(var i=-1,o=e.length,s=o-1,l=n;l!=null&&++i<o;){var f=pi(e[i]),u=t;if(i!=s){var p=l[f];u=r?r(p,f,l):void 0,u===void 0&&(u=Fe(p)?p:di(e[i+1])?[]:{})}oi(l,f,u),l=l[f]}return n}function ai(n){if(typeof n=="string")return n;if(Ye(n))return Pt?Pt.call(n):"";var e=n+"";return e=="0"&&1/n==-Rt?"-0":e}function li(n){return Vt(n)?n:mi(n)}function Le(n,e){var t=n.__data__;return ui(e)?t[typeof e=="string"?"string":"hash"]:t.map}function Ot(n,e){var t=Hr(n,e);return ni(t)?t:void 0}function di(n,e){return e=e??wr,!!e&&(typeof n=="number"||Rr.test(n))&&n>-1&&n%1==0&&n<e}function ci(n,e){if(Vt(n))return!1;var t=typeof n;return t=="number"||t=="symbol"||t=="boolean"||n==null||Ye(n)?!0:Fr.test(n)||!Cr.test(n)||e!=null&&n in Object(e)}function ui(n){var e=typeof n;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?n!=="__proto__":n===null}function fi(n){return!!At&&At in n}var mi=Qe(function(n){n=vi(n);var e=[];return Ar.test(n)&&e.push(""),n.replace(Sr,function(t,r,i,o){e.push(i?o.replace(Pr,"$1"):r||t)}),e});function pi(n){if(typeof n=="string"||Ye(n))return n;var e=n+"";return e=="0"&&1/n==-Rt?"-0":e}function hi(n){if(n!=null){try{return Dt.call(n)}catch{}try{return n+""}catch{}}return""}function Qe(n,e){if(typeof n!="function"||e&&typeof e!="function")throw new TypeError(Er);var t=function(){var r=arguments,i=e?e.apply(this,r):r[0],o=t.cache;if(o.has(i))return o.get(i);var s=n.apply(this,r);return t.cache=o.set(i,s),s};return t.cache=new(Qe.Cache||Y),t}Qe.Cache=Y;function qt(n,e){return n===e||n!==n&&e!==e}var Vt=Array.isArray;function gi(n){var e=Fe(n)?Ht.call(n):"";return e==kr||e==xr}function Fe(n){var e=typeof n;return!!n&&(e=="object"||e=="function")}function bi(n){return!!n&&typeof n=="object"}function Ye(n){return typeof n=="symbol"||bi(n)&&Ht.call(n)==Tr}function vi(n){return n==null?"":ai(n)}function ji(n,e,t){return n==null?n:si(n,e,t)}_t.exports=ji});(function(){"use strict";var n=(function(d,a){var c=function(w){for(var b=0,y=w.length;b<y;b++)h(w[b])},h=function(w){var b=w.target,y=w.attributeName,T=w.oldValue;b.attributeChangedCallback(y,T,b.getAttribute(y))};return function(g,w){var b=g.constructor.observedAttributes;return b&&d(w).then(function(){new a(c).observe(g,{attributes:!0,attributeOldValue:!0,attributeFilter:b});for(var y=0,T=b.length;y<T;y++)g.hasAttribute(b[y])&&h({target:g,attributeName:b[y],oldValue:null})}),g}});function e(d,a){if(d){if(typeof d=="string")return t(d,a);var c=Object.prototype.toString.call(d).slice(8,-1);if(c==="Object"&&d.constructor&&(c=d.constructor.name),c==="Map"||c==="Set")return Array.from(d);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return t(d,a)}}function t(d,a){(a==null||a>d.length)&&(a=d.length);for(var c=0,h=new Array(a);c<a;c++)h[c]=d[c];return h}function r(d,a){var c=typeof Symbol<"u"&&d[Symbol.iterator]||d["@@iterator"];if(!c){if(Array.isArray(d)||(c=e(d))||a&&d&&typeof d.length=="number"){c&&(d=c);var h=0,g=function(){};return{s:g,n:function(){return h>=d.length?{done:!0}:{done:!1,value:d[h++]}},e:function(T){throw T},f:g}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var w=!0,b=!1,y;return{s:function(){c=c.call(d)},n:function(){var T=c.next();return w=T.done,T},e:function(T){b=!0,y=T},f:function(){try{!w&&c.return!=null&&c.return()}finally{if(b)throw y}}}}var i=!0,o=!1,s="querySelectorAll",l=function(a){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:MutationObserver,g=arguments.length>3&&arguments[3]!==void 0?arguments[3]:["*"],w=function T(J,X,R,v,x,C){var H=r(J),ie;try{for(H.s();!(ie=H.n()).done;){var S=ie.value;(C||s in S)&&(x?R.has(S)||(R.add(S),v.delete(S),a(S,x)):v.has(S)||(v.add(S),R.delete(S),a(S,x)),C||T(S[s](X),X,R,v,x,i))}}catch(Je){H.e(Je)}finally{H.f()}},b=new h(function(T){if(g.length){var J=g.join(","),X=new Set,R=new Set,v=r(T),x;try{for(v.s();!(x=v.n()).done;){var C=x.value,H=C.addedNodes,ie=C.removedNodes;w(ie,J,X,R,o,o),w(H,J,X,R,i,o)}}catch(S){v.e(S)}finally{v.f()}}}),y=b.observe;return(b.observe=function(T){return y.call(b,T,{subtree:i,childList:i})})(c),b},f="querySelectorAll",u=self,p=u.document,m=u.Element,z=u.MutationObserver,ge=u.Set,te=u.WeakMap,ae=function(a){return f in a},le=[].filter,de=(function(d){var a=new te,c=function(v){for(var x=0,C=v.length;x<C;x++)a.delete(v[x])},h=function(){for(var v=J.takeRecords(),x=0,C=v.length;x<C;x++)b(le.call(v[x].removedNodes,ae),!1),b(le.call(v[x].addedNodes,ae),!0)},g=function(v){return v.matches||v.webkitMatchesSelector||v.msMatchesSelector},w=function(v,x){var C;if(x)for(var H,ie=g(v),S=0,Je=y.length;S<Je;S++)ie.call(v,H=y[S])&&(a.has(v)||a.set(v,new ge),C=a.get(v),C.has(H)||(C.add(H),d.handle(v,x,H)));else a.has(v)&&(C=a.get(v),a.delete(v),C.forEach(function(mr){d.handle(v,x,mr)}))},b=function(v){for(var x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,C=0,H=v.length;C<H;C++)w(v[C],x)},y=d.query,T=d.root||p,J=l(w,T,z,y),X=m.prototype.attachShadow;return X&&(m.prototype.attachShadow=function(R){var v=X.call(this,R);return J.observe(v),v}),y.length&&b(T[f](y)),{drop:c,flush:h,observer:J,parse:b}}),P=self,I=P.document,L=P.Map,be=P.MutationObserver,W=P.Object,re=P.Set,Ve=P.WeakMap,ce=P.Element,ve=P.HTMLElement,F=P.Node,A=P.Error,O=P.TypeError,D=P.Reflect,V=W.defineProperty,U=W.keys,Yt=W.getOwnPropertyNames,ue=W.setPrototypeOf,fe=!self.customElements,at=function(a){for(var c=U(a),h=[],g=new re,w=c.length,b=0;b<w;b++){h[b]=a[c[b]];try{delete a[c[b]]}catch{g.add(b)}}return function(){for(var y=0;y<w;y++)g.has(y)||(a[c[y]]=h[y])}};if(fe){var _e=function(){var a=this.constructor;if(!$e.has(a))throw new O("Illegal constructor");var c=$e.get(a);if(ye)return ut(ye,c);var h=lt.call(I,c);return ut(ue(h,a.prototype),c)},lt=I.createElement,$e=new L,je=new L,dt=new L,me=new L,ct=[],Zt=function(a,c,h){var g=dt.get(h);if(c&&!g.isPrototypeOf(a)){var w=at(a);ye=ue(a,g);try{new g.constructor}finally{ye=null,w()}}var b="".concat(c?"":"dis","connectedCallback");b in g&&a[b]()},er=de({query:ct,handle:Zt}),tr=er.parse,ye=null,Ne=function(a){if(!je.has(a)){var c,h=new Promise(function(g){c=g});je.set(a,{$:h,_:c})}return je.get(a).$},ut=n(Ne,be);self.customElements={define:function(a,c){if(me.has(a))throw new A('the name "'.concat(a,'" has already been used with this registry'));$e.set(c,a),dt.set(a,c.prototype),me.set(a,c),ct.push(a),Ne(a).then(function(){tr(I.querySelectorAll(a))}),je.get(a)._(c)},get:function(a){return me.get(a)},whenDefined:Ne},V(_e.prototype=ve.prototype,"constructor",{value:_e}),self.HTMLElement=_e,I.createElement=function(d,a){var c=a&&a.is,h=c?me.get(c):me.get(d);return h?new h:lt.call(I,d)},"isConnected"in F.prototype||V(F.prototype,"isConnected",{configurable:!0,get:function(){return!(this.ownerDocument.compareDocumentPosition(this)&this.DOCUMENT_POSITION_DISCONNECTED)}})}else if(fe=!self.customElements.get("extends-br"),fe)try{var ft=function d(){return self.Reflect.construct(HTMLBRElement,[],d)};ft.prototype=HTMLLIElement.prototype;var mt="extends-br";self.customElements.define("extends-br",ft,{extends:"br"}),fe=I.createElement("br",{is:mt}).outerHTML.indexOf(mt)<0;var pt=self.customElements,rr=pt.get,ir=pt.whenDefined;self.customElements.whenDefined=function(d){var a=this;return ir.call(this,d).then(function(c){return c||rr.call(a,d)})}}catch{}if(fe){var ht=function(a){var c=Be.get(a);yt(c.querySelectorAll(this),a.isConnected)},_=self.customElements,gt=I.createElement,or=_.define,nr=_.get,sr=_.upgrade,ar=D||{construct:function(a){return a.call(this)}},lr=ar.construct,Be=new Ve,Ge=new re,Ee=new L,we=new L,bt=new L,ke=new L,vt=[],xe=[],jt=function(a){return ke.get(a)||nr.call(_,a)},dr=function(a,c,h){var g=bt.get(h);if(c&&!g.isPrototypeOf(a)){var w=at(a);Te=ue(a,g);try{new g.constructor}finally{Te=null,w()}}var b="".concat(c?"":"dis","connectedCallback");b in g&&a[b]()},cr=de({query:xe,handle:dr}),yt=cr.parse,ur=de({query:vt,handle:function(a,c){Be.has(a)&&(c?Ge.add(a):Ge.delete(a),xe.length&&ht.call(xe,a))}}),fr=ur.parse,Et=ce.prototype.attachShadow;Et&&(ce.prototype.attachShadow=function(d){var a=Et.call(this,d);return Be.set(this,a),a});var ze=function(a){if(!we.has(a)){var c,h=new Promise(function(g){c=g});we.set(a,{$:h,_:c})}return we.get(a).$},Ue=n(ze,be),Te=null;Yt(self).filter(function(d){return/^HTML.*Element$/.test(d)}).forEach(function(d){var a=self[d];function c(){var h=this.constructor;if(!Ee.has(h))throw new O("Illegal constructor");var g=Ee.get(h),w=g.is,b=g.tag;if(w){if(Te)return Ue(Te,w);var y=gt.call(I,b);return y.setAttribute("is",w),Ue(ue(y,h.prototype),w)}else return lr.call(this,a,[],h)}V(c.prototype=a.prototype,"constructor",{value:c}),V(self,d,{value:c})}),I.createElement=function(d,a){var c=a&&a.is;if(c){var h=ke.get(c);if(h&&Ee.get(h).tag===d)return new h}var g=gt.call(I,d);return c&&g.setAttribute("is",c),g},_.get=jt,_.whenDefined=ze,_.upgrade=function(d){var a=d.getAttribute("is");if(a){var c=ke.get(a);if(c){Ue(ue(d,c.prototype),a);return}}sr.call(_,d)},_.define=function(d,a,c){if(jt(d))throw new A("'".concat(d,"' has already been defined as a custom element"));var h,g=c&&c.extends;Ee.set(a,g?{is:d,tag:g}:{is:"",tag:d}),g?(h="".concat(g,'[is="').concat(d,'"]'),bt.set(h,a.prototype),ke.set(d,a),xe.push(h)):(or.apply(_,arguments),vt.push(h=d)),ze(d).then(function(){g?(yt(I.querySelectorAll(h)),Ge.forEach(ht,[h])):fr(I.querySelectorAll(h))}),we.get(d)._(a)}}})();var Ki=q(Ft());var B=q(pr()),G=q(hr()),st=q(gr()),ee=q(br()),Oe=q(vr()),qe=q(jr()),M=q(yr()),Ie=q($t()),Wt=q(kt());var Bt=q(kt());var Nt="django-formset .dj-control-panel:has(input[type=file]){display:flex}django-formset .dj-control-panel:has(input[type=file]) input[type=file]{width:0 !important;height:0 !important;margin:0 !important;padding:0 !important}django-formset .dj-control-panel:has(input[type=file])>div{height:fit-content;margin-left:1rem}django-formset .dj-control-panel:has(input[type=file])>div progress{width:100%;margin-top:.25rem}django-formset .dj-control-panel:has(input[type=file]) figure.dj-dropbox{all:unset;display:inline-flex;align-items:center;justify-content:flex-start;background-color:color-mix(in srgb, var(--django-formset-background-color), currentcolor 5%);padding:1px;height:8rem;max-width:100%;outline:var(--outline-color) thin dotted}django-formset .dj-control-panel:has(input[type=file]) figure.dj-dropbox:has(>.dj-empty-item){outline:var(--outline-color) 2px dashed;border-radius:.25rem}django-formset .dj-control-panel:has(input[type=file]) figure.dj-dropbox.drag-over{opacity:.4}django-formset .dj-control-panel:has(input[type=file]) figure.dj-dropbox>div.dj-empty-item{flex-grow:1;text-align:center;min-width:8rem;height:auto}django-formset .dj-control-panel:has(input[type=file]) figure.dj-dropbox>div.dj-empty-item p{padding:2rem;margin:0}django-formset .dj-control-panel:has(input[type=file]) figure.dj-dropbox>img{all:unset;display:block;height:100%}django-formset .dj-control-panel:has(input[type=file]) figure.dj-dropbox>figcaption{all:unset;display:flex;flex-direction:column;justify-content:space-around;overflow-x:hidden;margin:0 .5rem;height:100%}django-formset .dj-control-panel:has(input[type=file]) figure.dj-dropbox>figcaption dl{font-size:small;margin:0 0 .25rem 0}django-formset .dj-control-panel:has(input[type=file]) figure.dj-dropbox>figcaption dl dd{margin:0}django-formset .dj-control-panel:has(input[type=file]) figure.dj-dropbox>figcaption>div{display:flex;justify-content:space-between;align-items:center;margin-top:.25rem;margin-bottom:.25rem}django-formset .dj-control-panel:has(input[type=file]) figure.dj-dropbox>figcaption>div .dj-delete-file,django-formset .dj-control-panel:has(input[type=file]) figure.dj-dropbox>figcaption>div .dj-download-file{font-weight:bold;display:inline-block;cursor:pointer;text-decoration:none}django-formset .dj-control-panel:has(input[type=file]) figure.dj-dropbox>figcaption>div .dj-delete-file:hover,django-formset .dj-control-panel:has(input[type=file]) figure.dj-dropbox>figcaption>div .dj-download-file:hover{text-decoration:underline}django-formset .dj-control-panel:has(input[type=file]) figure.dj-dropbox>figcaption .dj-download-file{margin-left:2rem}";var Pe=class{constructor(e,t){this.progressBar=null;this.baseSelector='django-formset .dj-control-panel:has(input[type="file"])';this.handleFileDrop=e=>{if(this.dropbox.classList.remove("drag-over"),this.swallowEvent(e),e.dataTransfer){for(let t of e.dataTransfer.files)if(!this.matchesMimeType(t.type)){e.dataTransfer.clearData(),this.fieldGroup.reportFailedUpload();return}this.fieldGroup.touch(),this.inputElement.files=e.dataTransfer.files,this.uploadFiles(this.inputElement.files).then(()=>{this.fieldGroup.inputted(),this.fieldGroup.validate()})}};this.fileRemove=()=>{for(this.inputElement.value="",this.inputElement.required=this.initialRequired,this.uploadedFiles=this.initialData.length>0?[{}]:[];this.dropbox.firstChild;)this.dropbox.removeChild(this.dropbox.firstChild);this.dropbox.appendChild(this.emptyDropboxItem),this.fieldGroup.touch(),this.fieldGroup.inputted(),this.fieldGroup.validate()};this.handleDragOver=e=>{this.dropbox.classList.add("drag-over"),this.swallowEvent(e)};this.handleDragLeave=e=>{this.dropbox.classList.remove("drag-over"),this.swallowEvent(e)};this.swallowEvent=e=>{e.stopPropagation(),e.preventDefault()};if(this.fieldGroup=e,this.inputElement=t,this.maxUploadSize=parseInt(this.inputElement.getAttribute("max-size")??"0"),this.dropbox=this.fieldGroup.element.querySelector("figure.dj-dropbox"),!this.dropbox)throw new Error('Element <input type="file"> requires sibling element <figure class="dj-dropbox"></figure>');if(this.chooseFileButton=this.fieldGroup.element.querySelector(`button[aria-controls="${t.id}"]`),!this.chooseFileButton)throw new Error(`Element ${t} requires sibling element <button aria-controls="${t.id}"></button>`);if(this.progressBar=this.fieldGroup.element.querySelector("progress"),this.progressBar&&(this.progressBar.style.visibility="hidden"),this.emptyDropboxItem=this.dropbox.querySelector("div.dj-empty-item"),!this.emptyDropboxItem)throw new Error('Element <input type="file"> requires sibling element <figure><div class="dj-empty-item"></div></figure>');let r=this.fieldGroup.element.querySelector(".dj-dropbox-items");if(!r)throw new Error('Element <input type="file"> requires sibling element <template class="dj-dropbox-items"></template>');this.dropboxItemTemplate=(0,Bt.default)(r.innerHTML),this.observer=new MutationObserver(o=>this.attributesChanged(o)),this.observer.observe(this.inputElement,{attributes:!0}),this.chooseFileButton.disabled=t.disabled,this.styleSheet=K.stylesAreInstalled(this.baseSelector)??this.transferStyles();let i=document.getElementById(`initial_${t.id}`);i!=null&&i.textContent?(this.uploadedFiles=this.initialData=[JSON.parse(i.textContent)],this.renderDropbox()):this.uploadedFiles=this.initialData=[],this.initialRequired=this.inputElement.required,this.dropbox.addEventListener("dragover",this.handleDragOver),this.dropbox.addEventListener("dragleave",this.handleDragLeave),this.dropbox.addEventListener("drop",this.handleFileDrop),this.chooseFileButton.addEventListener("click",()=>{t.click()}),t.addEventListener("change",()=>this.uploadFiles(this.inputElement.files).then(()=>{this.fieldGroup.inputted(),this.fieldGroup.validate()}).catch(()=>{this.fieldGroup.errorPlaceholder.reportCustomError(gettext("File upload failed."))}).finally(()=>{this.chooseFileButton.blur(),this.fieldGroup.touch()}))}matchesMimeType(e){if(!this.inputElement.accept)return!0;let t=this.inputElement.accept.split(",").map(o=>o.trim()),[r,i]=e.split("/");for(let o of t)if(!o||o===e||i==="*"&&o.split("/")[0]===r)return!0;return!1}async uploadFiles(e){return!e||e.length===0?Promise.reject():new Promise((t,r)=>{let i=e.item(0);i&&(!this.maxUploadSize||i.size<=this.maxUploadSize)?this.uploadFile(i,this.dropbox.clientHeight).then(o=>{this.uploadedFiles=[o],this.renderDropbox(),this.fieldGroup.inputted(),this.inputElement.dataset.fileupload=JSON.stringify(o),t()}).catch(()=>{r()}):r()})}async uploadFile(e,t){let r=this;function i(s){let l=s.lengthComputable?s.loaded/s.total:0;r.progressBar&&(r.progressBar.style.visibility="visible",r.progressBar.value=.97*l)}let o=new FormData;return o.append("temp_file",e),o.append("image_height",t.toString()),new Promise((s,l)=>{function f(){r.progressBar&&(r.progressBar.value=1,window.setTimeout(()=>r.progressBar.style.visibility="hidden",333)),u.status===200?s(u.response):l(u.response)}let u=new XMLHttpRequest;r.progressBar&&(u.addEventListener("loadstart",i),u.upload.addEventListener("progress",i,!1)),u.addEventListener("loadend",f),u.open("POST",this.fieldGroup.form.formset.endpoint,!0);let p=this.fieldGroup.form.formset.CSRFToken;p&&u.setRequestHeader("X-CSRFToken",p),u.responseType="json",u.send(o)})}renderDropbox(){try{let e=this.uploadedFiles.map(this.dropboxItemTemplate);e.length>0?(this.dropbox.innerHTML=e.join(""),this.inputElement.dataset.fileupload=JSON.stringify(this.uploadedFiles[0])):this.dropbox.replaceChildren(this.emptyDropboxItem)}catch(e){console.warn(`Error while rendering dropbox template: ${e}`)}}attributesChanged(e){for(let t of e)if(t.type==="attributes"){if(t.attributeName==="disabled"&&this.chooseFileButton.disabled!=this.inputElement.disabled&&(this.chooseFileButton.disabled=this.inputElement.disabled),t.attributeName==="data-fileupload"){let r=this.inputElement.dataset.fileupload;if(r){this.dropbox.innerHTML=this.dropboxItemTemplate(JSON.parse(r));let i=this.dropbox.querySelector(".dj-delete-file");i&&i.addEventListener("click",this.fileRemove,{once:!0}),this.inputElement.required=!1}else this.inputElement.required=this.initialRequired}t.attributeName==="required"&&this.inputElement.dataset.fileupload&&(this.inputElement.required=!1)}}transferStyles(){let e=document.createElement("style");if(e.innerText=Nt,document.head.appendChild(e),!e.sheet)throw new Error("Could not create <style> element");this.inputElement.style.transition="none";let t=!1;for(let r=0;e.sheet&&r<e.sheet.cssRules.length;r++){let o=e.sheet.cssRules.item(r).selectorText.trim(),s="";switch(o){case this.baseSelector:t=!0;break;default:break}s&&e.sheet.insertRule(`${o}{${s}}`,++r)}if(this.inputElement.style.transition="",K.pushMediaQueryStyles(e.sheet,this.baseSelector,{"--outline-color":"outline-color"},this.inputElement),!t)throw new Error(`Could not load styles for ${this.baseSelector}`);return e.sheet}inProgress(){return!!this.inputElement.files&&this.inputElement.files.length>0&&!this.uploadedFiles.length}resetToInitial(){this.uploadedFiles=this.initialData,this.renderDropbox()}};var Gt=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
	<g class="spinner">
		<path style="stroke-width:0.729" d="m 12.73285,23.212276 -10e-7,-4.393157 A 0.27932072,0.27932072 0 0 0 12.27476,18.604602 l -2.6367848,2.196577 a 0.27932072,0.27932072 0 0 0 -10e-8,0.429037 l 2.6367859,2.196577 a 0.27932072,0.27932072 0 0 0 0.458089,-0.214517 z" />
		<path style="stroke-width:0.729" d="m 11.298326,5.191792 -10e-7,-4.39315704 a 0.27932072,0.27932072 0 0 1 0.458086,-0.214519 L 14.393193,2.780699 a 0.27932072,0.27932072 0 0 1 2e-6,0.429033 l -2.636785,2.19658 a 0.27932072,0.27932072 0 0 1 -0.458084,-0.21452 z" />
		<path style="fill:none;stroke:currentColor;stroke-width:2;stroke-linecap:round;stroke-miterlimit:10;stroke-dashoffset:89.339;stroke-dasharray:none" d="M 12.5,2.9179688 C 12.333705,2.9010187 12.166975,2.8886442 12,2.8808594 6.9635919,2.8807514 2.8807499,6.9635934 2.8808594,12 c 0.00661,2.530252 1.064217,4.944009 2.9199218,6.664062" />
		<path style="fill:none;stroke:currentColor;stroke-width:2;stroke-linecap:round;stroke-miterlimit:10;stroke-dashoffset:89.339;stroke-dasharray:none" d="m 11.458261,21.082031 c 0.166295,0.01695 0.333025,0.02933 0.5,0.03711 C 16.994669,21.119249 21.077511,17.036407 21.077402,12 21.070802,9.469748 20.013185,7.055991 18.15748,5.335938" />
	</g>
</svg>
`;var zt=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
	<circle class="path circle" fill="none" stroke="currentColor" stroke-width="1.93833" stroke-miterlimit="10" cx="12.000002" cy="12.000002" r="10.030837" />
	<polyline class="path check" fill="none" stroke="currentColor" stroke-width="12" stroke-linecap="round" stroke-miterlimit="10" points="100.2,40.2 51.5,88.8 29.8,67.5 " transform="matrix(0.18,0,0,0.18,-0.284,0.544)" />
</svg>
`;var Ut=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
	<circle class="path circle" fill="none" stroke="currentColor" stroke-width="1.93833" stroke-miterlimit="10" cx="12.000002" cy="12.000002" r="10.030837" />
	<line class="path line" fill="none" stroke="currentColor" stroke-width="2.12533" stroke-linecap="round" stroke-miterlimit="10" x1="6.562665" y1="7.1626649" x2="17.437328" y2="16.79755" />
	<line class="path line" fill="none" stroke="currentColor" stroke-width="2.12534" stroke-linecap="round" stroke-miterlimit="10" x1="17.437338" y1="7.1626701" x2="6.5626698" y2="16.762127" />
</svg>
`;var Jt=`input::placeholder,select::placeholder{color:gray}select.ts-hidden-accessible{display:none}django-formset{--django-formset-fg-color: light-dark(black, white);--django-formset-color-invalid: rgb(255, 3, 0);--django-formset-box-shadow-invalid: 0 0 0 .2rem rgb(255, 3, 0, 0.25);--django-formset-color-valid: rgb(0, 122, 0);--django-formset-icon-invalid: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 16" fill="rgb(255, 3, 0)"><path fill-rule="evenodd" d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/><path d="M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995z"/></svg>');--django-formset-icon-warning: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 16" fill="rgb(255, 165, 0)"><path fill-rule="evenodd" d="M7.938 2.016a.146.146 0 0 0-.054.057L1.027 13.74a.176.176 0 0 0-.002.183c.016.03.037.05.054.06.015.01.034.017.066.017h13.713a.12.12 0 0 0 .066-.017.163.163 0 0 0 .055-.06.176.176 0 0 0-.003-.183L8.12 2.073a.146.146 0 0 0-.054-.057A.13.13 0 0 0 8.002 2a.13.13 0 0 0-.064.016zm1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566z"/><path d="M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995z"/></svg>');--django-formset-icon-valid: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 16" fill="rgb(0, 122, 0)"><path fill-rule="evenodd" d="M10.97 4.97a.75.75 0 0 1 1.071 1.05l-3.992 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.236.236 0 0 1 .02-.022z"/></svg>');--django-formset-dropdown-caret: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="rgb(128, 128, 128)"><path d="M11.9999 13.1714L16.9497 8.22168L18.3639 9.63589L11.9999 15.9999L5.63599 9.63589L7.0502 8.22168L11.9999 13.1714Z"></path></svg>')}django-formset ul.dj-errorlist{list-style:none;margin-top:0;margin-bottom:0;margin-left:0;padding-left:0;color:var(--django-formset-color-invalid)}django-formset.dj-feedback-errors [role=group].dj-touched:not(.dj-submitted)>input[type=email]:not(.dj-exempt-feedback):invalid:not([is]):not(:focus),django-formset.dj-feedback-errors [role=group].dj-touched:not(.dj-submitted) :not([role=group])>input[type=email]:not(.dj-exempt-feedback):invalid:not([is]):not(:focus){border-color:var(--django-formset-color-invalid);background-image:var(--django-formset-icon-invalid) !important}django-formset.dj-feedback-errors [role=group].dj-touched:not(.dj-submitted) input[type=email]:not(.dj-exempt-feedback):invalid:focus~[role=alert]{display:none}django-formset.dj-feedback-errors [role=group].dj-touched:not(.dj-submitted)>input[type=text]:not(.dj-exempt-feedback):invalid:not([is]):not(:focus),django-formset.dj-feedback-errors [role=group].dj-touched:not(.dj-submitted) :not([role=group])>input[type=text]:not(.dj-exempt-feedback):invalid:not([is]):not(:focus){border-color:var(--django-formset-color-invalid);background-image:var(--django-formset-icon-invalid) !important}django-formset.dj-feedback-errors [role=group].dj-touched:not(.dj-submitted) input[type=text]:not(.dj-exempt-feedback):invalid:focus~[role=alert]{display:none}django-formset.dj-feedback-errors [role=group].dj-touched:not(.dj-submitted)>input[type=number]:not(.dj-exempt-feedback):invalid:not([is]):not(:focus),django-formset.dj-feedback-errors [role=group].dj-touched:not(.dj-submitted) :not([role=group])>input[type=number]:not(.dj-exempt-feedback):invalid:not([is]):not(:focus){border-color:var(--django-formset-color-invalid);background-image:var(--django-formset-icon-invalid) !important}django-formset.dj-feedback-errors [role=group].dj-touched:not(.dj-submitted) input[type=number]:not(.dj-exempt-feedback):invalid:focus~[role=alert]{display:none}django-formset.dj-feedback-errors [role=group].dj-touched:not(.dj-submitted)>input[type=regex]:not(.dj-exempt-feedback):invalid:not([is]):not(:focus),django-formset.dj-feedback-errors [role=group].dj-touched:not(.dj-submitted) :not([role=group])>input[type=regex]:not(.dj-exempt-feedback):invalid:not([is]):not(:focus){border-color:var(--django-formset-color-invalid);background-image:var(--django-formset-icon-invalid) !important}django-formset.dj-feedback-errors [role=group].dj-touched:not(.dj-submitted) input[type=regex]:not(.dj-exempt-feedback):invalid:focus~[role=alert]{display:none}django-formset.dj-feedback-errors [role=group].dj-touched:not(.dj-submitted)>input[type=date]:not(.dj-exempt-feedback):invalid:not([is]):not(:focus),django-formset.dj-feedback-errors [role=group].dj-touched:not(.dj-submitted) :not([role=group])>input[type=date]:not(.dj-exempt-feedback):invalid:not([is]):not(:focus){border-color:var(--django-formset-color-invalid);background-image:var(--django-formset-icon-invalid) !important}django-formset.dj-feedback-errors [role=group].dj-touched:not(.dj-submitted) input[type=date]:not(.dj-exempt-feedback):invalid:focus~[role=alert]{display:none}django-formset.dj-feedback-errors [role=group].dj-touched:not(.dj-submitted)>input[type=datetime-local]:not(.dj-exempt-feedback):invalid:not([is]):not(:focus),django-formset.dj-feedback-errors [role=group].dj-touched:not(.dj-submitted) :not([role=group])>input[type=datetime-local]:not(.dj-exempt-feedback):invalid:not([is]):not(:focus){border-color:var(--django-formset-color-invalid);background-image:var(--django-formset-icon-invalid) !important}django-formset.dj-feedback-errors [role=group].dj-touched:not(.dj-submitted) input[type=datetime-local]:not(.dj-exempt-feedback):invalid:focus~[role=alert]{display:none}django-formset.dj-feedback-errors [role=group].dj-touched:not(.dj-submitted)>input[type=url]:not(.dj-exempt-feedback):invalid:not([is]):not(:focus),django-formset.dj-feedback-errors [role=group].dj-touched:not(.dj-submitted) :not([role=group])>input[type=url]:not(.dj-exempt-feedback):invalid:not([is]):not(:focus){border-color:var(--django-formset-color-invalid);background-image:var(--django-formset-icon-invalid) !important}django-formset.dj-feedback-errors [role=group].dj-touched:not(.dj-submitted) input[type=url]:not(.dj-exempt-feedback):invalid:focus~[role=alert]{display:none}django-formset.dj-feedback-errors [role=group].dj-touched:not(.dj-submitted)>input[type=password]:not(.dj-exempt-feedback):invalid:not([is]):not(:focus),django-formset.dj-feedback-errors [role=group].dj-touched:not(.dj-submitted) :not([role=group])>input[type=password]:not(.dj-exempt-feedback):invalid:not([is]):not(:focus){border-color:var(--django-formset-color-invalid);background-image:var(--django-formset-icon-invalid) !important}django-formset.dj-feedback-errors [role=group].dj-touched:not(.dj-submitted) input[type=password]:not(.dj-exempt-feedback):invalid:focus~[role=alert]{display:none}django-formset.dj-feedback-errors [role=group].dj-touched:not(.dj-submitted)>select:not(.dj-exempt-feedback):invalid:not([is]):not(:focus),django-formset.dj-feedback-errors [role=group].dj-touched:not(.dj-submitted) :not([role=group])>select:not(.dj-exempt-feedback):invalid:not([is]):not(:focus){border-color:var(--django-formset-color-invalid)}django-formset.dj-feedback-errors [role=group].dj-touched:not(.dj-submitted) select:not(.dj-exempt-feedback):invalid:focus~[role=alert]{display:none}django-formset.dj-feedback-errors [role=group].dj-touched:not(.dj-submitted)>textarea:not(.dj-exempt-feedback):invalid:not([is]):not(:focus),django-formset.dj-feedback-errors [role=group].dj-touched:not(.dj-submitted) :not([role=group])>textarea:not(.dj-exempt-feedback):invalid:not([is]):not(:focus){border-color:var(--django-formset-color-invalid)}django-formset.dj-feedback-errors [role=group].dj-touched:not(.dj-submitted) textarea:not(.dj-exempt-feedback):invalid:focus~[role=alert]{display:none}django-formset.dj-feedback-errors [role=group].dj-touched:not(.dj-submitted)>input[is^=django]:invalid+[role=textbox]:not(.focus),django-formset.dj-feedback-errors [role=group].dj-touched:not(.dj-submitted) :not([role=group])>input[is^=django]:invalid+[role=textbox]:not(.focus){border-color:var(--django-formset-color-invalid);background-image:var(--django-formset-icon-invalid) !important}django-formset.dj-feedback-warnings [role=group].dj-dirty:not(.dj-submitted)>input[type=email]:not(.dj-exempt-feedback):invalid:not([is]):focus,django-formset.dj-feedback-warnings [role=group].dj-dirty:not(.dj-submitted) :not([role=group])>input[type=email]:not(.dj-exempt-feedback):invalid:not([is]):focus{background-image:var(--django-formset-icon-warning)}django-formset.dj-feedback-warnings [role=group].dj-dirty:not(.dj-submitted)>input[type=text]:not(.dj-exempt-feedback):invalid:not([is]):focus,django-formset.dj-feedback-warnings [role=group].dj-dirty:not(.dj-submitted) :not([role=group])>input[type=text]:not(.dj-exempt-feedback):invalid:not([is]):focus{background-image:var(--django-formset-icon-warning)}django-formset.dj-feedback-warnings [role=group].dj-dirty:not(.dj-submitted)>input[type=number]:not(.dj-exempt-feedback):invalid:not([is]):focus,django-formset.dj-feedback-warnings [role=group].dj-dirty:not(.dj-submitted) :not([role=group])>input[type=number]:not(.dj-exempt-feedback):invalid:not([is]):focus{background-image:var(--django-formset-icon-warning)}django-formset.dj-feedback-warnings [role=group].dj-dirty:not(.dj-submitted)>input[type=regex]:not(.dj-exempt-feedback):invalid:not([is]):focus,django-formset.dj-feedback-warnings [role=group].dj-dirty:not(.dj-submitted) :not([role=group])>input[type=regex]:not(.dj-exempt-feedback):invalid:not([is]):focus{background-image:var(--django-formset-icon-warning)}django-formset.dj-feedback-warnings [role=group].dj-dirty:not(.dj-submitted)>input[type=date]:not(.dj-exempt-feedback):invalid:not([is]):focus,django-formset.dj-feedback-warnings [role=group].dj-dirty:not(.dj-submitted) :not([role=group])>input[type=date]:not(.dj-exempt-feedback):invalid:not([is]):focus{background-image:var(--django-formset-icon-warning)}django-formset.dj-feedback-warnings [role=group].dj-dirty:not(.dj-submitted)>input[type=datetime-local]:not(.dj-exempt-feedback):invalid:not([is]):focus,django-formset.dj-feedback-warnings [role=group].dj-dirty:not(.dj-submitted) :not([role=group])>input[type=datetime-local]:not(.dj-exempt-feedback):invalid:not([is]):focus{background-image:var(--django-formset-icon-warning)}django-formset.dj-feedback-warnings [role=group].dj-dirty:not(.dj-submitted)>input[type=url]:not(.dj-exempt-feedback):invalid:not([is]):focus,django-formset.dj-feedback-warnings [role=group].dj-dirty:not(.dj-submitted) :not([role=group])>input[type=url]:not(.dj-exempt-feedback):invalid:not([is]):focus{background-image:var(--django-formset-icon-warning)}django-formset.dj-feedback-warnings [role=group].dj-dirty:not(.dj-submitted)>input[type=password]:not(.dj-exempt-feedback):invalid:not([is]):focus,django-formset.dj-feedback-warnings [role=group].dj-dirty:not(.dj-submitted) :not([role=group])>input[type=password]:not(.dj-exempt-feedback):invalid:not([is]):focus{background-image:var(--django-formset-icon-warning)}django-formset.dj-feedback-warnings:not(.dj-feedback-errors) [role=group].dj-dirty:not(.dj-submitted)>input[type=email]:not(.dj-exempt-feedback):invalid:not([is]),django-formset.dj-feedback-warnings:not(.dj-feedback-errors) [role=group].dj-dirty:not(.dj-submitted) :not([role=group])>input[type=email]:not(.dj-exempt-feedback):invalid:not([is]){background-image:var(--django-formset-icon-warning)}django-formset.dj-feedback-warnings:not(.dj-feedback-errors) [role=group].dj-dirty:not(.dj-submitted)>input[type=text]:not(.dj-exempt-feedback):invalid:not([is]),django-formset.dj-feedback-warnings:not(.dj-feedback-errors) [role=group].dj-dirty:not(.dj-submitted) :not([role=group])>input[type=text]:not(.dj-exempt-feedback):invalid:not([is]){background-image:var(--django-formset-icon-warning)}django-formset.dj-feedback-warnings:not(.dj-feedback-errors) [role=group].dj-dirty:not(.dj-submitted)>input[type=number]:not(.dj-exempt-feedback):invalid:not([is]),django-formset.dj-feedback-warnings:not(.dj-feedback-errors) [role=group].dj-dirty:not(.dj-submitted) :not([role=group])>input[type=number]:not(.dj-exempt-feedback):invalid:not([is]){background-image:var(--django-formset-icon-warning)}django-formset.dj-feedback-warnings:not(.dj-feedback-errors) [role=group].dj-dirty:not(.dj-submitted)>input[type=regex]:not(.dj-exempt-feedback):invalid:not([is]),django-formset.dj-feedback-warnings:not(.dj-feedback-errors) [role=group].dj-dirty:not(.dj-submitted) :not([role=group])>input[type=regex]:not(.dj-exempt-feedback):invalid:not([is]){background-image:var(--django-formset-icon-warning)}django-formset.dj-feedback-warnings:not(.dj-feedback-errors) [role=group].dj-dirty:not(.dj-submitted)>input[type=date]:not(.dj-exempt-feedback):invalid:not([is]),django-formset.dj-feedback-warnings:not(.dj-feedback-errors) [role=group].dj-dirty:not(.dj-submitted) :not([role=group])>input[type=date]:not(.dj-exempt-feedback):invalid:not([is]){background-image:var(--django-formset-icon-warning)}django-formset.dj-feedback-warnings:not(.dj-feedback-errors) [role=group].dj-dirty:not(.dj-submitted)>input[type=datetime-local]:not(.dj-exempt-feedback):invalid:not([is]),django-formset.dj-feedback-warnings:not(.dj-feedback-errors) [role=group].dj-dirty:not(.dj-submitted) :not([role=group])>input[type=datetime-local]:not(.dj-exempt-feedback):invalid:not([is]){background-image:var(--django-formset-icon-warning)}django-formset.dj-feedback-warnings:not(.dj-feedback-errors) [role=group].dj-dirty:not(.dj-submitted)>input[type=url]:not(.dj-exempt-feedback):invalid:not([is]),django-formset.dj-feedback-warnings:not(.dj-feedback-errors) [role=group].dj-dirty:not(.dj-submitted) :not([role=group])>input[type=url]:not(.dj-exempt-feedback):invalid:not([is]){background-image:var(--django-formset-icon-warning)}django-formset.dj-feedback-warnings:not(.dj-feedback-errors) [role=group].dj-dirty:not(.dj-submitted)>input[type=password]:not(.dj-exempt-feedback):invalid:not([is]),django-formset.dj-feedback-warnings:not(.dj-feedback-errors) [role=group].dj-dirty:not(.dj-submitted) :not([role=group])>input[type=password]:not(.dj-exempt-feedback):invalid:not([is]){background-image:var(--django-formset-icon-warning)}django-formset.dj-feedback-success [role=group].dj-dirty>input[type=email]:not(.dj-exempt-feedback):valid:not([is]):not(:focus),django-formset.dj-feedback-success [role=group].dj-dirty :not([role=group])>input[type=email]:not(.dj-exempt-feedback):valid:not([is]):not(:focus){border-color:var(--django-formset-color-valid);background-image:var(--django-formset-icon-valid) !important}django-formset.dj-feedback-success [role=group].dj-dirty>input[type=text]:not(.dj-exempt-feedback):valid:not([is]):not(:focus),django-formset.dj-feedback-success [role=group].dj-dirty :not([role=group])>input[type=text]:not(.dj-exempt-feedback):valid:not([is]):not(:focus){border-color:var(--django-formset-color-valid);background-image:var(--django-formset-icon-valid) !important}django-formset.dj-feedback-success [role=group].dj-dirty>input[type=number]:not(.dj-exempt-feedback):valid:not([is]):not(:focus),django-formset.dj-feedback-success [role=group].dj-dirty :not([role=group])>input[type=number]:not(.dj-exempt-feedback):valid:not([is]):not(:focus){border-color:var(--django-formset-color-valid);background-image:var(--django-formset-icon-valid) !important}django-formset.dj-feedback-success [role=group].dj-dirty>input[type=regex]:not(.dj-exempt-feedback):valid:not([is]):not(:focus),django-formset.dj-feedback-success [role=group].dj-dirty :not([role=group])>input[type=regex]:not(.dj-exempt-feedback):valid:not([is]):not(:focus){border-color:var(--django-formset-color-valid);background-image:var(--django-formset-icon-valid) !important}django-formset.dj-feedback-success [role=group].dj-dirty>input[type=date]:not(.dj-exempt-feedback):valid:not([is]):not(:focus),django-formset.dj-feedback-success [role=group].dj-dirty :not([role=group])>input[type=date]:not(.dj-exempt-feedback):valid:not([is]):not(:focus){border-color:var(--django-formset-color-valid);background-image:var(--django-formset-icon-valid) !important}django-formset.dj-feedback-success [role=group].dj-dirty>input[type=datetime-local]:not(.dj-exempt-feedback):valid:not([is]):not(:focus),django-formset.dj-feedback-success [role=group].dj-dirty :not([role=group])>input[type=datetime-local]:not(.dj-exempt-feedback):valid:not([is]):not(:focus){border-color:var(--django-formset-color-valid);background-image:var(--django-formset-icon-valid) !important}django-formset.dj-feedback-success [role=group].dj-dirty>input[type=url]:not(.dj-exempt-feedback):valid:not([is]):not(:focus),django-formset.dj-feedback-success [role=group].dj-dirty :not([role=group])>input[type=url]:not(.dj-exempt-feedback):valid:not([is]):not(:focus){border-color:var(--django-formset-color-valid);background-image:var(--django-formset-icon-valid) !important}django-formset.dj-feedback-success [role=group].dj-dirty>input[type=password]:not(.dj-exempt-feedback):valid:not([is]):not(:focus),django-formset.dj-feedback-success [role=group].dj-dirty :not([role=group])>input[type=password]:not(.dj-exempt-feedback):valid:not([is]):not(:focus){border-color:var(--django-formset-color-valid);background-image:var(--django-formset-icon-valid) !important}django-formset.dj-feedback-success [role=group].dj-dirty>select:not(.dj-exempt-feedback):valid:not([is]):not(:focus),django-formset.dj-feedback-success [role=group].dj-dirty :not([role=group])>select:not(.dj-exempt-feedback):valid:not([is]):not(:focus){border-color:var(--django-formset-color-valid)}django-formset.dj-feedback-success [role=group].dj-dirty>textarea:not(.dj-exempt-feedback):valid:not([is]):not(:focus),django-formset.dj-feedback-success [role=group].dj-dirty :not([role=group])>textarea:not(.dj-exempt-feedback):valid:not([is]):not(:focus){border-color:var(--django-formset-color-valid)}django-formset.dj-feedback-success [role=group].dj-dirty>input[is^=django]:valid+[role=textbox]:not(.focus),django-formset.dj-feedback-success [role=group].dj-dirty :not([role=group])>input[is^=django]:valid+[role=textbox]:not(.focus){border-color:var(--django-formset-color-valid);background-image:var(--django-formset-icon-valid) !important}django-formset [role=group][hidden]{display:none}django-formset [role=group].dj-required>label,django-formset [role=group].dj-required-any>label{font-weight:bolder}django-formset [role=group].dj-submitted>input[type=email]:not(.dj-exempt-feedback):not([is]):invalid{border-color:var(--django-formset-color-invalid);background-image:var(--django-formset-icon-invalid)}django-formset [role=group].dj-submitted>input[type=email]:not(.dj-exempt-feedback):not([is]):invalid:focus{box-shadow:var(--django-formset-box-shadow-invalid)}django-formset [role=group].dj-submitted>input[type=text]:not(.dj-exempt-feedback):not([is]):invalid{border-color:var(--django-formset-color-invalid);background-image:var(--django-formset-icon-invalid)}django-formset [role=group].dj-submitted>input[type=text]:not(.dj-exempt-feedback):not([is]):invalid:focus{box-shadow:var(--django-formset-box-shadow-invalid)}django-formset [role=group].dj-submitted>input[type=number]:not(.dj-exempt-feedback):not([is]):invalid{border-color:var(--django-formset-color-invalid);background-image:var(--django-formset-icon-invalid)}django-formset [role=group].dj-submitted>input[type=number]:not(.dj-exempt-feedback):not([is]):invalid:focus{box-shadow:var(--django-formset-box-shadow-invalid)}django-formset [role=group].dj-submitted>input[type=regex]:not(.dj-exempt-feedback):not([is]):invalid{border-color:var(--django-formset-color-invalid);background-image:var(--django-formset-icon-invalid)}django-formset [role=group].dj-submitted>input[type=regex]:not(.dj-exempt-feedback):not([is]):invalid:focus{box-shadow:var(--django-formset-box-shadow-invalid)}django-formset [role=group].dj-submitted>input[type=date]:not(.dj-exempt-feedback):not([is]):invalid{border-color:var(--django-formset-color-invalid);background-image:var(--django-formset-icon-invalid)}django-formset [role=group].dj-submitted>input[type=date]:not(.dj-exempt-feedback):not([is]):invalid:focus{box-shadow:var(--django-formset-box-shadow-invalid)}django-formset [role=group].dj-submitted>input[type=datetime-local]:not(.dj-exempt-feedback):not([is]):invalid{border-color:var(--django-formset-color-invalid);background-image:var(--django-formset-icon-invalid)}django-formset [role=group].dj-submitted>input[type=datetime-local]:not(.dj-exempt-feedback):not([is]):invalid:focus{box-shadow:var(--django-formset-box-shadow-invalid)}django-formset [role=group].dj-submitted>input[type=url]:not(.dj-exempt-feedback):not([is]):invalid{border-color:var(--django-formset-color-invalid);background-image:var(--django-formset-icon-invalid)}django-formset [role=group].dj-submitted>input[type=url]:not(.dj-exempt-feedback):not([is]):invalid:focus{box-shadow:var(--django-formset-box-shadow-invalid)}django-formset [role=group].dj-submitted>input[type=password]:not(.dj-exempt-feedback):not([is]):invalid{border-color:var(--django-formset-color-invalid);background-image:var(--django-formset-icon-invalid)}django-formset [role=group].dj-submitted>input[type=password]:not(.dj-exempt-feedback):not([is]):invalid:focus{box-shadow:var(--django-formset-box-shadow-invalid)}django-formset [role=group].dj-submitted>select:not(.dj-exempt-feedback):not([is]):invalid{border-color:var(--django-formset-color-invalid);background-image:var(--django-formset-icon-invalid)}django-formset [role=group].dj-submitted>select:not(.dj-exempt-feedback):not([is]):invalid:focus{box-shadow:var(--django-formset-box-shadow-invalid)}django-formset [role=group].dj-submitted>textarea:not(.dj-exempt-feedback):not([is]):invalid{border-color:var(--django-formset-color-invalid);background-image:var(--django-formset-icon-invalid)}django-formset [role=group].dj-submitted>textarea:not(.dj-exempt-feedback):not([is]):invalid:focus{box-shadow:var(--django-formset-box-shadow-invalid)}django-formset [role=group].dj-submitted input[is^=django]:invalid+[role=textbox]{border-color:var(--django-formset-color-invalid);background-image:var(--django-formset-icon-invalid)}django-formset [role=group].dj-submitted input[is^=django]:focus:invalid+[role=textbox],django-formset [role=group].dj-submitted input[is^=django]:invalid+[role=textbox].focus{box-shadow:var(--django-formset-box-shadow-invalid)}django-formset [role=group] input,django-formset [role=group] [role=textbox]{background-repeat:no-repeat !important;background-position:center right !important;background-origin:content-box !important}django-formset [role=group] input[type^=date]{position:relative}django-formset [role=group] input[type^=date]::-webkit-datetime-edit-fields-wrapper{margin-left:1.75em}django-formset [role=group] input[type^=date]::-webkit-calendar-picker-indicator{cursor:pointer;position:absolute;left:.75em}django-formset [role=group] input[type^=date]:hover::-webkit-calendar-picker-indicator{cursor:pointer}django-formset [role=group] select,django-formset [role=group] textarea{background-image:none !important}django-formset [role=group] select.dj-concealed,django-formset [role=group] textarea.dj-concealed{display:block !important;height:1px !important;min-height:initial !important;max-height:initial !important;padding:0 !important;margin:-1px 0 0 0 !important;border-width:unset !important;opacity:0 !important;resize:none}django-formset [role=group] .dj-help-text{font-style:oblique}django-formset [role=group] .dj-form-optgroup{margin-bottom:.5rem}django-formset [role=group] .dj-form-optgroup>em{margin-left:.75rem}django-formset [role=group] .dj-form-inlined{display:inline-block}django-formset [is^=django-][hidden]{display:block !important;width:0 !important;min-width:0 !important;height:0 !important;min-height:0 !important;padding:0 !important;margin:0 !important;border:none !important;outline:none !important;box-shadow:none !important}django-formset [is^=django-][hidden]::-webkit-calendar-picker-indicator{display:none}django-formset dialog{position:fixed;top:0;z-index:2}django-formset dialog:not([df-modal]) .dialog-header{cursor:pointer}django-formset dialog .dialog-header{display:flex;flex-shrink:0;flex-wrap:wrap;align-items:center;justify-content:space-between}django-formset dialog .dialog-footer{display:flex;flex-shrink:0;flex-wrap:wrap;align-items:center;justify-content:flex-end}.dj-button-decorator{line-height:initial}.dj-button-decorator svg{vertical-align:baseline;width:1rem;height:1rem}.dj-button-decorator svg .path{stroke-dasharray:1000;stroke-dashoffset:0}.dj-button-decorator svg .path.circle{animation:dash .9s ease-in-out}.dj-button-decorator svg .path.line{stroke-dashoffset:1000;animation:dash .9s .35s ease-in-out forwards}.dj-button-decorator svg .path.check{stroke-dashoffset:-100;animation:dash-check .9s .35s ease-in-out forwards}.dj-button-decorator svg .spinner{transform-origin:center;animation:rotate 1.5s infinite linear}@keyframes dash{0%{stroke-dashoffset:1000}100%{stroke-dashoffset:0}}@keyframes dash-check{0%{stroke-dashoffset:-100}100%{stroke-dashoffset:900}}@keyframes rotate{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}.dj-button-decorator .dj-icon{display:inline-block;width:1em;height:1em}`;var Ze="__all__",Ti="_collection_errors_",Ci="_marked_for_removal_",Me=document.createElement("style");Me.innerText=Jt;document.head.appendChild(Me);Me.sheet instanceof CSSStyleSheet&&K.pushMediaQueryStyles(Me.sheet,"django-formset",{"--django-formset-background-color":"background-color","--django-formset-foreground-color":"color"},document.body);function Re(n){return Array.isArray(n)?n.length!==0&&n.every(e=>Re(e)):(0,qe.default)(n)?!(0,st.default)(n):!!n}var et=class{constructor(e){this.value=e}},tt=class{constructor(e,t){this.form=e,this.element=t;let r;this.isInitialized=new Promise(m=>r=m);let i=t.classList.contains("dj-required-any"),o=m=>m instanceof HTMLInputElement&&m.name&&m.form===e.element&&m.type!=="hidden",s=Array.from(t.getElementsByTagName("INPUT")).filter(o);for(let m of s)switch(m.type){case"checkbox":case"radio":m.addEventListener("input",()=>{this.touch(),this.inputted()}),m.addEventListener("change",()=>{i?this.validateCheckboxSelectMultiple():this.validate()});break;case"file":this.fileUploader=new Pe(this,m),m.addEventListener("invalid",()=>this.errorPlaceholder.reportValidationError());break;default:m.addEventListener("focus",()=>this.touch()),m.addEventListener("input",()=>this.inputted()),m.addEventListener("blur",()=>this.validate()),m.addEventListener("invalid",()=>this.errorPlaceholder.reportValidationError());break}this.fieldElements=[...s];let l=m=>m instanceof HTMLSelectElement&&m.name&&m.form===e.element,f=Array.from(t.getElementsByTagName("SELECT")).filter(l).at(0);f instanceof HTMLSelectElement&&(f.addEventListener("focusin",()=>this.touch()),f.addEventListener("focusout",()=>this.validate()),f.addEventListener("change",()=>{this.clearCustomError(),this.form.formset.aggregateValues(),this.form.formset.updateOperability(),this.setDirty()}),f.addEventListener("invalid",()=>this.errorPlaceholder.reportValidationError()),this.fieldElements=[f]);let u=m=>m instanceof HTMLTextAreaElement&&m.name&&m.form===e.element,p=Array.from(t.getElementsByTagName("TEXTAREA")).filter(u).at(0);p instanceof HTMLTextAreaElement&&(p.addEventListener("focus",()=>{this.touch(),this.clearCustomError()}),p.addEventListener("input",()=>this.inputted()),p.addEventListener("blur",()=>this.validate()),p.addEventListener("invalid",()=>this.errorPlaceholder.reportValidationError()),this.fieldElements=[p]),p&&"isInitialized"in p?p.isInitialized?r(!0):p.addEventListener("initialized",()=>{r(p.isInitialized)},{once:!0}):r(!0),this.errorPlaceholder=new Ct(this.fieldElements[0]),this.name=this.assertUniqueName(),this.initialDisabled=this.fieldElements.map(m=>m.disabled),this.initialRequired=this.fieldElements.map(m=>m.required),i?this.validateCheckboxSelectMultiple():this.validateBoundField(),this.pristineValue=new et(this.aggregateValue()),this.updateVisibility=this.evalVisibility("df-show",!0)??this.evalVisibility("df-hide",!1)??function(){},this.updateDisabled=this.evalDisable(),this.updateRequired=this.evalRequire(),this.untouch(),this.setPristine()}aggregateValue(){if(this.fieldElements.length===1){let e=this.fieldElements[0];if(e.type==="checkbox")return e.checked?e.value:"";if(e.type==="select-multiple")return Array.from(e.selectedOptions).map(r=>r.value);if(e.type==="file")return this.fileUploader.uploadedFiles;if(e instanceof HTMLInputElement){if(window.customElements.get("django-datefield")&&e.getAttribute("is")==="django-datefield"||window.customElements.get("django-datecalendar")&&e.getAttribute("is")==="django-datecalendar"||window.customElements.get("django-datepicker")&&e.getAttribute("is")==="django-datepicker"){let t=e.valueAsDate;return t?new Date(t.getTime()-t.getTimezoneOffset()*6e4).toISOString().slice(0,10):""}if(window.customElements.get("django-datetimefield")&&e.getAttribute("is")==="django-datetimefield"||window.customElements.get("django-datetimecalendar")&&e.getAttribute("is")==="django-datetimecalendar"||window.customElements.get("django-datetimepicker")&&e.getAttribute("is")==="django-datetimepicker"){let t=e.valueAsDate;return t?new Date(t.getTime()-t.getTimezoneOffset()*6e4).toISOString().replace("T"," ").slice(0,16):""}if(window.customElements.get("django-daterangefield")&&e.getAttribute("is")==="django-daterangefield"||window.customElements.get("django-daterangecalendar")&&e.getAttribute("is")==="django-daterangecalendar"||window.customElements.get("django-daterangepicker")&&e.getAttribute("is")==="django-daterangepicker")return e.value?e.value.split(";").map(t=>t.slice(0,10)):["",""];if(window.customElements.get("django-datetimerangefield")&&e.getAttribute("is")==="django-datetimerangefield"||window.customElements.get("django-datetimerangecalendar")&&e.getAttribute("is")==="django-datetimerangecalendar"||window.customElements.get("django-datetimerangepicker")&&e.getAttribute("is")==="django-datetimerangepicker")return e.value?e.value.split(";").map(t=>t.slice(0,16)):["",""]}return e.value}else{let e=[];for(let t of this.fieldElements)if(t.type==="checkbox")t.checked&&e.push(t.value);else if(t.type==="radio"&&t.checked)return t.value;return e}}setFieldValue(e){if(this.fieldElements.length===1){let t=this.fieldElements[0];if(t.type==="checkbox")t.checked=e===t.value;else if(t.type==="select-multiple"){let r=Array.from(t.selectedOptions).map(i=>i.value);r.push(e),t.value=r}else t.type!=="file"&&(t.value=e)}else{let t=e;for(let r of this.fieldElements)r.type==="checkbox"&&(r.checked=t.includes(r.value))}this.validate()}updateOperability(...e){this.updateVisibility(),this.updateDisabled(),this.updateRequired(),this.fieldElements.filter(t=>(0,Oe.default)(t.updateOperability)).forEach(t=>t.updateOperability(...e))}disableRequiredConstraint(){this.fieldElements.forEach(e=>e.required=!1)}restoreRequiredConstraint(){this.fieldElements.forEach((e,t)=>e.required=this.initialRequired[t])}get isValid(){return this.fieldElements[0].validity.valid}assertUniqueName(){let e="__undefined__";for(let t of this.fieldElements)if(e==="__undefined__")e=t.name;else if(e!==t.name)throw new Error(`Duplicate name '${e}' on multiple input fields on '${t.name}'`);return e}evalVisibility(e,t){var i;let r=(i=this.fieldElements[0])==null?void 0:i.getAttribute(e);if(!(0,M.default)(r))return null;try{let o=new Function(`return ${$(r,{startRule:"OperabilityExpression"})};`);return()=>{let s=t!=Re(o.call(this));this.element.hasAttribute("hidden")!==s&&(this.fieldElements.forEach((l,f)=>l.disabled=s||this.initialDisabled[f]),this.element.toggleAttribute("hidden",s))}}catch(o){throw new Error(`Error while parsing <... df-show/hide="${r}">: ${o}.`)}}evalDisable(){var t;let e=(t=this.fieldElements[0])==null?void 0:t.getAttribute("df-disable");if(!(0,M.default)(e))return()=>{};try{let r=new Function(`return ${$(e,{startRule:"OperabilityExpression"})}`);return()=>{let i=Re(r.call(this));this.fieldElements.forEach((o,s)=>o.disabled=i||this.initialDisabled[s])}}catch(r){throw new Error(`Error while parsing <... df-disable="${e}">: ${r}.`)}}evalRequire(){var t;let e=(t=this.fieldElements[0])==null?void 0:t.getAttribute("df-require");if(!(0,M.default)(e))return()=>{};try{let r=new Function(`return ${$(e,{startRule:"OperabilityExpression"})}`);return()=>{let i=Re(r.call(this));this.fieldElements.forEach(o=>o.required=i),this.form.checkValidity()}}catch(r){throw new Error(`Error while parsing <... df-require="${e}">: ${r}.`)}}getDataValue(e){return this.form.getDataValue(e,this.name)}inputted(){(0,G.default)(this.pristineValue,this.aggregateValue())?this.setPristine():this.setDirty(),this.clearCustomError(),this.form.restoreRequiredConstraints()}clearCustomError(){this.form.clearCustomErrors(),this.errorPlaceholder.clearError()}resetToInitial(){var e;(e=this.fileUploader)==null||e.resetToInitial(),this.untouch(),this.setPristine(),this.errorPlaceholder.clearError()}disableAllFields(){this.fieldElements.forEach(e=>e.disabled=!0)}reenableAllFields(){this.fieldElements.forEach((e,t)=>e.disabled=this.initialDisabled[t])}touch(){this.element.classList.remove("dj-untouched","dj-validated"),this.element.classList.add("dj-touched")}untouch(){this.element.classList.remove("dj-submitted","dj-touched"),this.element.classList.add("dj-untouched")}setDirty(){this.element.classList.remove("dj-submitted","dj-pristine"),this.element.classList.add("dj-dirty")}setPristine(){this.element.classList.remove("dj-dirty"),this.element.classList.add("dj-pristine")}get isPristine(){return this.element.classList.contains("dj-pristine")}get isTouched(){return this.element.classList.contains("dj-touched")}setSubmitted(){this.element.classList.add("dj-submitted")}validate(){let e=null;for(e of this.fieldElements)if(e instanceof HTMLInputElement&&e.hasAttribute("is")&&e.checkValidity(),!e.validity.valid)break;if(!e)throw new Error("No input element to validate.");e.validity.valid||e instanceof HTMLInputElement&&e.type==="file"&&this.validateFileInput(),this.form.validate()&&!e.validity.valid&&e.dispatchEvent(new Event("invalid"))}validateCheckboxSelectMultiple(){let e=this.errorPlaceholder.getMessage("customError");return e&&this.fieldElements.every(t=>{if(!(t instanceof HTMLInputElement&&t.type==="checkbox"))throw new Error("Expected input element of type 'checkbox'.");return!t.checked})?(this.errorPlaceholder.reportCustomError(e),!1):!0}validateFileInput(){return this.fileUploader.inProgress()?(this.errorPlaceholder.reportCustomError(gettext("File upload in progress.")),!1):this.fileUploader.inputElement.validity.valid}validateBoundField(){if(this.fieldElements.length!==1)return;let e=this.fieldElements[0];e.value&&(e.type==="text"||e instanceof HTMLTextAreaElement)&&(e.minLength>0&&e.value.length<e.minLength&&e.setCustomValidity(gettext("Entered text is too short.")),e.maxLength>0&&e.value.length>e.maxLength&&e.setCustomValidity(gettext("Entered text is too long.")))}setValidationError(){if(this.fieldElements[0]instanceof HTMLInputElement&&this.fieldElements[0].type==="file")return this.validateFileInput();for(let e of this.fieldElements)if(!e.validity.valid)return this.errorPlaceholder.reportValidationError();return!0}},he=class{constructor(e,t){this.func=e,this.args=t}},se=class{constructor(e,t){this.successChain=e,this.rejectChain=t}},rt=class{constructor(e,t,r){this.condition=e,this.fulfilled=t,this.otherwise=r}};function k(n,e,t){let r=t.value;return t.value=function(...i){let o=r.apply(this,i);return(0,Oe.default)(o)?(...s)=>o.apply(n,s):o},t.value.isAllowedAction=!0,t}var j=class{constructor(e,t,r){this.clickHandler=()=>{};this.path=[];this.clicked=e=>{e.currentTarget===this.element&&this.clickHandler()};var i;this.formset=e,this.element=t,this.initialClass=t.getAttribute("class")??"",this.isAutoDisabled=t.hasAttribute("auto-disable"),this.omitRestore=t.hasAttribute("omit-restore"),this.decoratorElement=t.querySelector(".dj-button-decorator"),this.originalDecorator=(i=this.decoratorElement)==null?void 0:i.cloneNode(!0),this.spinnerElement=document.createElement("i"),this.spinnerElement.classList.add("dj-icon","dj-spinner"),this.spinnerElement.innerHTML=Gt,this.okayElement=document.createElement("i"),this.okayElement.classList.add("dj-icon","dj-okay"),this.okayElement.innerHTML=zt,this.bummerElement=document.createElement("i"),this.bummerElement.classList.add("dj-icon","dj-bummer"),this.bummerElement.innerHTML=Ut,this.path=r,this.parseActionsQueue(t.getAttribute("df-click")),this.updateVisibility=this.evalVisibility("df-show",!0)??this.evalVisibility("df-hide",!1)??function(){},this.updateDisabled=this.evalDisable(),t.addEventListener("click",this.clicked)}evalVisibility(e,t){let r=this.element.getAttribute(e);if(r===null)return null;try{let i=new Function(`return ${$(r,{startRule:"OperabilityExpression"})}`);return()=>{let o=t!=!!i.call(this);this.element.hasAttribute("hidden")!==o&&this.element.toggleAttribute("hidden",o)}}catch(i){throw new Error(`Error while parsing <button df-show/hide="${r}">: ${i}.`)}}evalDisable(){let e=this.element.getAttribute("df-disable");if(!(0,M.default)(e))return()=>{};try{let t=new Function(`return ${$(e,{startRule:"OperabilityExpression"})}`);return()=>this.element.disabled=t.call(this)}catch(t){throw new Error(`Error while parsing <button df-disable="${e}">: ${t}.`)}}autoDisable(e){this.isAutoDisabled&&(this.element.disabled=!e)}disable(){return e=>(this.element.disabled=!0,Promise.resolve(e))}enable(){return e=>(this.element.disabled=!1,Promise.resolve(e))}submit(e){return()=>new Promise((t,r)=>{this.formset.submit(e).then(i=>i instanceof Response&&i.status===200?t(i):r(i))})}submitPartial(e){return()=>new Promise((t,r)=>{let i=this.path.slice(0,-1);this.formset.submitPartial(i,e).then(o=>o instanceof Response&&o.status===200?t(o):r(o))})}reset(){return e=>(this.formset.resetToInitial(),Promise.resolve(e))}reload(e){return t=>(e?location.reload():location.replace(window.location.pathname),new Promise(r=>window.setTimeout(()=>r(t),3e3)))}proceed(e){return async t=>{if((0,M.default)(e)&&e.length>0)location.assign(e);else if(t instanceof Response&&t.status===200){let r=await t.clone().json();r.success_url?location.assign(r.success_url):console.warn("Neither a success-, nor a proceed-URL are given.")}return new Promise(r=>window.setTimeout(()=>r(t),3e3))}}delay(e){return t=>new Promise(r=>this.timeoutHandler=window.setTimeout(()=>{this.timeoutHandler=void 0,r(t)},e))}spinner(){return e=>{var t;return(t=this.decoratorElement)==null||t.replaceChildren(this.spinnerElement),Promise.resolve(e)}}okay(e){return this.decorate(this.okayElement,e)}bummer(e){return this.decorate(this.bummerElement,e)}addClass(e){return t=>(this.element.classList.add(e),Promise.resolve(t))}removeClass(e){return t=>(this.element.classList.remove(e),Promise.resolve(t))}toggleClass(e){return t=>(this.element.classList.toggle(e),Promise.resolve(t))}emit(e,t){return r=>{let i={bubbles:!0,cancelable:!0};return t!==void 0?(Object.assign(i,{detail:t}),this.element.dispatchEvent(new CustomEvent(e,i))):this.element.dispatchEvent(new Event(e,i)),Promise.resolve(r)}}intercept(e){return t=>{let r={request:this.formset.buildBody(),response:null},i=e?document.querySelector(e):null;return i?t.clone().json().then(o=>{r.response=o,i.innerHTML=JSON.stringify(r,null,"  ")}):console.info(r),Promise.resolve(t)}}clearErrors(){return e=>(this.formset.clearErrors(),Promise.resolve(e))}scrollToError(){return e=>{let t=this.formset.findFirstErrorReport();return t&&t.scrollIntoView({behavior:"smooth"}),Promise.resolve(e)}}confirm(e){if(!(0,M.default)(e))throw new Error("The confirm() action requires a message.");return t=>window.confirm(e)?Promise.resolve(t):Promise.reject({})}alertOnError(){return e=>(e.status!==422&&window.alert(e.statusText),Promise.resolve(e))}activate(...e){return t=>(this.formset.updateOperability(this,...e),Promise.resolve(t))}setFieldValue(e,t){return r=>(this.formset.setFieldValue(e,t),Promise.resolve(r))}setExtraData(e,t){return r=>(this.formset.setExtraData(e,t),Promise.resolve(r))}deletePartial(e,t){return r=>((0,M.default)(t)&&parseInt(t)&&this.formset.deletePartial(e,t),Promise.resolve(r))}prefillPartial(e){return t=>{let r=this.formset.prefillPartial(e,t);return Promise.resolve(r)}}noop(){return e=>Promise.resolve(e)}restore(){window.requestIdleCallback(()=>this.restoreToInitial(),{timeout:250})}decorate(e,t){return r=>{var i;return(i=this.decoratorElement)==null||i.replaceChildren(e),(0,ee.default)(t)?new Promise(o=>this.timeoutHandler=window.setTimeout(()=>{this.timeoutHandler=void 0,o(r)},t)):Promise.resolve(r)}}setClickHandler(e){let t=l=>f=>f instanceof he?f.func.call(this,...f.args.map(t(l)),l):f,r=l=>{let f;for(let u of l.values())f=f?f.then(async p=>{let m=p?await p.clone().json():{};return u.func.apply(this,u.args.map(t(m)))(p)}):u.func.apply(this,u.args.map(t()))();return f},i=(l,f)=>{let u;for(let p of l.values())u=u?u.then(async m=>{let z=m?await m.clone().json():{};return p.func.apply(this,p.args.map(t(z)))(m)}):p.func.apply(this,p.args.map(t()))(f);return u},o=l=>{var f,u;(u=(f=r(l.successChain))==null?void 0:f.then(()=>{this.restore.apply(this)}))==null||u.catch(p=>{var m;(m=i(l.rejectChain,p))==null||m.finally(()=>{this.restore.apply(this)})})},s=l=>{l.condition.call(this)?l.fulfilled instanceof se?o(l.fulfilled):s(l.fulfilled):l.otherwise instanceof se?o(l.otherwise):s(l.otherwise)};this.clickHandler=()=>{e instanceof se?o(e):s(e)}}parseActionsQueue(e){if(!e)return;let t=o=>{if((0,qe.default)(o)&&(0,M.default)(o._funcName)&&Array.isArray(o._funcArgs)){let s=this[o._funcName];if(!(0,Oe.default)(s)||!s.hasOwnProperty("isAllowedAction"))throw new Error(`Unknown function '${o._funcName}'.`);return new he(s,o._funcArgs.map(t))}return o},r=o=>{let s=o.map(t);return s.length===0&&s.push(new he(this.noop,[])),s},i=o=>o.condition===!0?new se(r(o.fulfilled.successChain),r(o.fulfilled.rejectChain)):new rt(Function(o.condition),i(o.fulfilled),i(o.otherwise));try{let o=$(e,{startRule:"Ternary"}),s=i(o);this.setClickHandler(s)}catch(o){throw new Error(`Error while parsing <button df-click="${e}">: ${o}.`)}}restoreToInitial(){var e;this.omitRestore||(this.isAutoDisabled||(this.element.disabled=!1),this.element.setAttribute("class",this.initialClass),this.originalDecorator&&((e=this.decoratorElement)==null||e.replaceChildren(...this.originalDecorator.cloneNode(!0).childNodes)))}maxNumSiblingsReached(){return this.formset.maxNumSiblingsReached(this)}getDataValue(e){return this.formset.getDataValue(e)}getResponseValue(e,t){return(0,B.default)(t,e)}updateOperability(...e){this.updateVisibility(),this.updateDisabled()}abortAction(){this.timeoutHandler&&(clearTimeout(this.timeoutHandler),this.timeoutHandler=void 0)}};E([k],j.prototype,"disable",1),E([k],j.prototype,"enable",1),E([k],j.prototype,"submit",1),E([k],j.prototype,"submitPartial",1),E([k],j.prototype,"reset",1),E([k],j.prototype,"reload",1),E([k],j.prototype,"proceed",1),E([k],j.prototype,"delay",1),E([k],j.prototype,"spinner",1),E([k],j.prototype,"okay",1),E([k],j.prototype,"bummer",1),E([k],j.prototype,"addClass",1),E([k],j.prototype,"removeClass",1),E([k],j.prototype,"toggleClass",1),E([k],j.prototype,"emit",1),E([k],j.prototype,"intercept",1),E([k],j.prototype,"clearErrors",1),E([k],j.prototype,"scrollToError",1),E([k],j.prototype,"confirm",1),E([k],j.prototype,"alertOnError",1),E([k],j.prototype,"activate",1),E([k],j.prototype,"setFieldValue",1),E([k],j.prototype,"setExtraData",1),E([k],j.prototype,"deletePartial",1),E([k],j.prototype,"prefillPartial",1),E([k],j.prototype,"noop",1),E([k],j.prototype,"maxNumSiblingsReached",1),E([k],j.prototype,"getDataValue",1),E([k],j.prototype,"getResponseValue",1);var it=class{constructor(e,t){this.form=e,this.element=t,this.updateVisibility=this.evalVisibility("df-show",!0)??this.evalVisibility("df-hide",!1)??function(){},this.updateDisabled=this.evalDisable()}evalVisibility(e,t){let r=this.element.getAttribute(e);if(r===null)return null;try{let i=new Function(`return ${$(r,{startRule:"OperabilityExpression"})}`);return()=>{let o=t!=!!i.call(this);this.element.hasAttribute("hidden")!==o&&this.element.toggleAttribute("hidden",o)}}catch(i){throw new Error(`Error while parsing <fieldset df-show/hide="${r}">: ${i}.`)}}evalDisable(){let e=this.element.getAttribute("df-disable");if(!(0,M.default)(e))return()=>{};try{let t=new Function(`return ${$(e,{startRule:"OperabilityExpression"})}`);return()=>this.element.disabled=t.call(this)}catch(t){throw new Error(`Error while parsing <fieldset df-disable="${e}">: ${t}.`)}}getDataValue(e){return this.form.getDataValue(e,`${this.element.name}.`)}updateOperability(...e){this.updateVisibility(),this.updateDisabled()}},ot=class{constructor(e,t){this.fieldsets=Array(0);this.errorList=null;this.errorPlaceholder=null;this.fieldGroups=Array(0);this.hiddenInputFields=Array(0);this.markedForRemoval=!1;this.isValid=()=>{if(this.element.noValidate||this.isTransient)return!0;let e=!0;for(let t of this.fieldGroups)e=t.setValidationError()&&e;return e};this.handleSubmit=e=>{if(e.target instanceof HTMLFormElement&&e.target.method==="dialog"){this.setSubmitted();return}e.preventDefault()};this.handleReset=()=>{for(let e of this.fieldGroups)e.resetToInitial()};var i,o;this.formset=e,this.element=t,this.path=((i=this.name)==null?void 0:i.split("."))??[],this.findFieldsets();let r=(o=t.nextElementSibling)==null?void 0:o.querySelector(":scope > .dj-form-errors > ul.dj-errorlist > li.dj-placeholder");r&&(this.errorList=r.parentElement,this.errorPlaceholder=this.errorList.removeChild(r)),this.isTransient=this.element.hasAttribute("df-transient"),this.element.addEventListener("submit",this.handleSubmit),this.element.addEventListener("reset",this.handleReset)}findFieldsets(){let e=this.element.nextElementSibling;e==null||e.querySelectorAll("FIELDSET").forEach(t=>{this.fieldsets.push(new it(this,t))})}aggregateValues(){let e=new Map;for(let t of this.fieldGroups)e.set(t.name,t.aggregateValue());for(let t of this.hiddenInputFields.filter(r=>r.type==="hidden"))e.set(t.name,t.value);return e}get name(){return this.element.getAttribute("name")}get formId(){return this.element.getAttribute("id")}getAbsPath(){return["formset_data",...this.path]}getDataValue(e,t){if(e[0]!=="")return this.formset.getDataValue(e);let r=t.includes(".")?t.split("."):[...this.path],i=e.filter(o=>o!=="");if(t.includes(".")){let o=e.length-i.length+Number(t.endsWith("."));r.splice(r.length-o)}return r.push(...i),this.formset.getDataValue(r)}setFieldValue(e,t){let r=this.fieldGroups.find(i=>i.name===e);r?r.setFieldValue(t):this.element.elements.namedItem(e)?(this.element.elements.namedItem(e).value=t,this.formset.validate()):console.warn(`Field group '${e}' not found.`)}updateOperability(...e){this.fieldsets.forEach(t=>t.updateOperability(...e)),this.fieldGroups.forEach(t=>t.updateOperability(...e))}setSubmitted(){this.fieldGroups.forEach(e=>e.setSubmitted()),this.element.dispatchEvent(new Event("submitted"))}validate(){return this.formset.validate()}checkValidity(){return this.element.noValidate||this.isTransient?!0:this.element.checkValidity()}reportValidity(){if(this.element.noValidate||this.isTransient)return;let e=this.element.getBoundingClientRect();e.width===0&&e.height===0&&!this.isValid()&&(this.formset.forceVisibility(this),e=this.element.getBoundingClientRect()),(e.width!==0||e.height!==0)&&this.element.reportValidity()}clearCustomErrors(){for(;this.errorList&&this.errorList.lastChild;)this.errorList.removeChild(this.errorList.lastChild)}resetToInitial(){this.element.reset()}toggleForRemoval(e){this.markedForRemoval=e;for(let t of this.fieldGroups)e?(t.resetToInitial(),t.disableAllFields()):t.reenableAllFields()}reportCustomErrors(e){this.clearCustomErrors();let t=e[Ze];if(this.errorList&&Array.isArray(t)&&this.errorPlaceholder)for(let r of t){let i=this.errorPlaceholder.cloneNode();i.innerHTML=r,this.errorList.appendChild(i)}for(let r of this.fieldGroups){let i=e[r.name];Array.isArray(i)&&i.length>0&&r.errorPlaceholder.reportCustomError(i[0])}}findFirstErrorReport(){var e,t;return(e=this.errorList)!=null&&e.textContent?this.element:((t=this.fieldGroups.find(r=>!r.isValid))==null?void 0:t.element)??null}untouch(){this.fieldGroups.forEach(e=>e.untouch())}setPristine(){this.fieldGroups.forEach(e=>e.setPristine())}get isPristine(){return this.fieldGroups.every(e=>e.isPristine)}disableRequiredConstraints(){this.fieldGroups.forEach(e=>e.disableRequiredConstraint())}restoreRequiredConstraints(){this.fieldGroups.forEach(e=>e.restoreRequiredConstraint())}get isConnected(){return new Promise(e=>{Promise.all(this.fieldGroups.map(t=>t.isInitialized)).then(t=>{this.element.dispatchEvent(new CustomEvent("django-formset-connected",{detail:{form:this}})),e(t)})})}},Z=class n{constructor(e,t,r){this.forms=Array(0);this.children=Array(0);this.markedForRemoval=!1;this.formset=e,this.element=t,this.parent=r,this.findFormCollections()}findFormCollections(){for(let e of n.getChildCollections(this.element))this.children.push(new n(this.formset,e,this));for(let[e,t]of n.getChildSiblingsCollections(this.element).entries())this.children.push(new N(this.formset,t,e,this));for(let e of this.children)e.updateRemoveButtonAttrs();this.formCollectionTemplate=De.findFormCollectionTemplate(this.formset,this.element,this)}assignForms(e){this.forms=e.filter(t=>this.element.contains(t.element));for(let t of this.children)this.forms=this.forms.filter(r=>!t.element.contains(r.element)),t.assignForms(e)}updateRemoveButtonAttrs(){}disconnect(){var e;this.forms.forEach(t=>this.formset.removeForm(t)),this.children.forEach(t=>t.disconnect()),(e=this.formCollectionTemplate)==null||e.disconnect(),this.element.remove()}toggleForRemoval(e){this.markedForRemoval=e;for(let t of this.forms)t.toggleForRemoval(e);for(let t of this.children)t.toggleForRemoval(e);this.formCollectionTemplate&&(this.formCollectionTemplate.markedForRemoval=e),this.element.classList.toggle("dj-marked-for-removal",this.markedForRemoval)}resetToInitial(){if(this.toggleForRemoval(!1),n.resetCollectionsToInitial(this.children),this.formCollectionTemplate){let e=this.formCollectionTemplate.prefix,t=e==="0"?0:e.split(".").length;this.children.forEach((r,i)=>r.repositionForms(t,i))}return!1}repositionSiblings(){}repositionForms(e,t){this.forms.forEach(r=>{r.path[e]=String(t),r.element.setAttribute("name",r.path.join("."))}),this.children.forEach(r=>r.repositionForms(e,t))}markAsFreshAndEmpty(e){this.children.forEach(t=>t.markAsFreshAndEmpty(e)),e&&this.forms.forEach(t=>{t.disableRequiredConstraints();let r=t.path.slice(0,-1);this.formset.forms.forEach(i=>{(0,G.default)(i.path.slice(0,-1),r)&&i.element.dispatchEvent(new CustomEvent("django-formset-connected",{detail:{form:i}}))})})}restoreRequiredConstraint(){this.forms.forEach(e=>e.restoreRequiredConstraints()),this.children.forEach(e=>e.restoreRequiredConstraint())}get isFreshAndEmpty(){return this.forms.every(e=>e.isPristine)&&this.children.every(e=>e.isFreshAndEmpty)}removeFreshAndEmpty(){Array.from(this.children).reverse().forEach(t=>t.removeFreshAndEmpty())}maxNumSiblingsReached(e){var r;let t=((r=this.formCollectionTemplate)==null?void 0:r.maxNumSiblingsReached(e))??null;return t===null?this.children.some(i=>i.maxNumSiblingsReached(e)):t}static getChildCollections(e){var r;let t=(r=e.querySelector("django-form-collection"))==null?void 0:r.parentElement;return(t==null?void 0:t.querySelectorAll(":scope > django-form-collection:not([sibling-position])"))??[]}static getChildSiblingsCollections(e){var r;let t=(r=e.querySelector("django-form-collection"))==null?void 0:r.parentElement;return(t==null?void 0:t.querySelectorAll(":scope > django-form-collection[sibling-position]"))??[]}static resetCollectionsToInitial(e){var i;let t=Array(0);for(let o of e)o.resetToInitial()&&t.push(o);t.forEach(o=>e.splice(e.indexOf(o),1)),e.sort((o,s)=>o instanceof N&&s instanceof N?o.initialPosition-s.initialPosition:0);let r=null;for(let o of e)o instanceof N&&(o.initialPosition===0?(i=o.element.parentElement)==null||i.insertAdjacentElement("afterbegin",o.element):r==null||r.insertAdjacentElement("afterend",o.element),r=o.element);e.forEach(o=>o.repositionSiblings())}},N=class n extends Z{constructor(t,r,i,o){super(t,r,o);this.siblingId=0;this.minSiblings=0;this.maxSiblings=null;this.justAdded=!1;this.removeCollection=()=>{var i,o;let t=((i=this.parent)==null?void 0:i.children)??this.formset.formCollections;this.justAdded?(this.disconnect(),t.splice(t.indexOf(this),1),this.repositionSiblings()):(this.toggleForRemoval(!this.markedForRemoval),this.removeButton.disabled=!this.markedForRemoval),t.forEach(s=>s.updateRemoveButtonAttrs()),(((o=this.parent)==null?void 0:o.formCollectionTemplate)??this.formset.formCollectionTemplate).updateOperability()};let s=r.getAttribute("sibling-position");if(!s)throw new Error("Missing argument 'sibling-position' in <django-form-collection>");this.position=this.initialPosition=parseInt(s),this.siblingId=i;let l=r.getAttribute("min-siblings");if(!l)throw new Error("Missing argument 'min-siblings' in <django-form-collection>");this.minSiblings=parseInt(l);let f=r.getAttribute("max-siblings");f&&(this.maxSiblings=parseInt(f));let u=r.querySelector(":scope > button.remove-collection");if(!u)throw new Error('<django-form-collection> with siblings requires child element <button class="remove-collection">');this.removeButton=u,this.removeButton.addEventListener("click",this.removeCollection)}disconnect(){this.removeButton.removeEventListener("click",this.removeCollection),super.disconnect()}repositionSiblings(){var r;(((r=this.parent)==null?void 0:r.children)??this.formset.formCollections).forEach((i,o)=>{i instanceof n&&(i.position=o,i.element.setAttribute("sibling-position",String(o)))})}updateRemoveButtonAttrs(){var i;if(!this.removeButton)return;let r=(((i=this.parent)==null?void 0:i.children)??this.formset.formCollections).filter(o=>!o.markedForRemoval).length;this.markedForRemoval?this.maxSiblings?this.removeButton.disabled=r>=this.maxSiblings:this.removeButton.disabled=!1:this.removeButton.disabled=r<=this.minSiblings,this.formset.updateOperability()}markAsFreshAndEmpty(t){this.justAdded=t||this.element.hasAttribute("fresh-and-empty"),super.markAsFreshAndEmpty(this.justAdded)}get isFreshAndEmpty(){return this.justAdded&&super.isFreshAndEmpty}removeFreshAndEmpty(){!this.removeButton.disabled&&this.isFreshAndEmpty?this.removeCollection():super.removeFreshAndEmpty()}resetToInitial(){return this.justAdded&&!this.element.hasAttribute("fresh-and-empty")?(this.disconnect(),!0):(super.resetToInitial(),!1)}},De=class n{constructor(e,t,r){this.maxSiblings=null;this.baseContext=new Map;this.markedForRemoval=!1;this.resortSiblings=e=>{var o;let t=e.oldDraggableIndex??NaN,r=e.newDraggableIndex??NaN;if(!(0,ee.default)(t)||!(0,ee.default)(r)||t===r)return;let i=((o=this.parent)==null?void 0:o.children)??this.formset.formCollections;if(i.at(t)instanceof N){let s=i.splice(t,1);i.splice(r,0,...s),s.at(0).repositionSiblings();let l=this.prefix==="0"?0:this.prefix.split(".").length;i.forEach((f,u)=>f.repositionForms(l,u)),this.formset.validate()}};var u;this.formset=e,this.element=t,this.parent=r;let i=t.innerHTML.matchAll(/\$\{([^} ]+)}/g);for(let p of i)this.baseContext.set(p[1],p[0]);let o=t.getAttribute("prefix");if(!o)throw new Error('<template class="empty-collection" ...> requires attribute "prefix"');this.prefix=o,e.pushTemplatePrefix(this.prefix),this.renderEmptyCollection=(0,Wt.default)(t.innerHTML);let s=((u=this.element.getAttribute("df-induce-add-sibling"))==null?void 0:u.split(":")[0].split("."))??[];this.addSiblingButtonPath=Xe(o.split("."),s),this.induceAddSibling=this.evalInducer(t,(...p)=>this.appendCollectionSibling()),e.registerInducer(this);let l=this.element.content.querySelector("django-form-collection"),f=l==null?void 0:l.getAttribute("max-siblings");f&&(this.maxSiblings=parseInt(f)),t.hasAttribute("sortable")&&new xt(t.parentElement,{animation:150,handle:"django-form-collection[sibling-position]:not(.dj-marked-for-removal) > .collection-drag-handle",draggable:"django-form-collection[sibling-position]",selectedClass:"selected",ghostClass:"dj-ghost-collection",onEnd:this.resortSiblings})}evalInducer(e,t){let r=e.getAttribute("df-induce-add-sibling");if(!(0,M.default)(r))return()=>{};try{let i=new Function("...args",`return ${$(r,{startRule:"InduceExpression"})}`);return(...o)=>{let s=i.call(this,...o);return s&&t(...o),s}}catch(i){throw new Error(`Error while parsing <django-form-collection df-induce-activate="${r}">: ${i}.`)}}isButtonActive(e,t,r,...i){let o=this.prefix==="-"?[]:this.prefix.split(".");return r instanceof j&&(0,G.default)(Xe(o,e),r.path)&&t(...i)}appendCollectionSibling(){var f;let e=Object.fromEntries(this.baseContext),[t,r]=this.getNextPositionAndSiblingId();e.position=t.toString(),e.siblingId=r.toString(),e.position_1="${position}",e.siblingId_1="${siblingId}";for(let u=1;u<10;++u)e[`position_${u+1}`]=`\${position_${u}}`,e[`siblingId_${u+1}`]=`\${siblingId_${u}}`;let i=this.renderEmptyCollection(e);this.element.insertAdjacentHTML("beforebegin",i);let o=this.element.previousElementSibling;if(!(o instanceof HTMLElement))throw new Error("Unable to insert empty <django-form-collection> element.");let s=((f=this.parent)==null?void 0:f.children)??this.formset.formCollections,l=new N(this.formset,o,r,this.parent);s.push(l),this.formset.findForms(o),this.formset.assignFieldsToForms(o),this.formset.assignFormsToCollections(),this.formset.findDetachedButtons(o),this.formset.findCollectionErrorsList(),l.markAsFreshAndEmpty(!0),this.formset.validate(),s.forEach(u=>u.updateRemoveButtonAttrs())}getNextPositionAndSiblingId(){let e=-1,t=-1,r=this.parent?this.parent.children:this.formset.formCollections;for(let i of r.filter(o=>o instanceof N))e=Math.max(e,i.position),t=Math.max(t,i.siblingId);return[e+1,t+1]}disconnect(){this.formset.popTemplatePrefix(this.prefix)}maxNumSiblingsReached(e){var i;return(0,G.default)(this.addSiblingButtonPath,e.path)?this.markedForRemoval||this.maxSiblings===null?!1:(((i=this.parent)==null?void 0:i.children)??this.formset.formCollections).filter(o=>!o.markedForRemoval).length>=this.maxSiblings:null}updateOperability(e,...t){e instanceof j&&this.induceAddSibling(e,...t)}forceVisibility(e){}static findFormCollectionTemplate(e,t,r){let i=t.querySelector(":scope > .collection-siblings > template.empty-collection");if(i)return new n(e,i,r)}},nt=class{constructor(e){this.buttons=Array(0);this.forms=Array(0);this.inducers=Array(0);this.formCollections=Array(0);this.errorList=null;this.errorPlaceholder=null;this.collectionErrorsList=new Map;this.abortController=new AbortController;this.emptyCollectionPrefixes=Array(0);this.extraData={};this.element=e,this.parseWithholdFeedback(),this.CSRFToken=this.element.getAttribute("csrf-token")}connectedCallback(){this.findErrorsPlaceholder(),this.findForms(),this.findFormCollections(),this.findCollectionErrorsList(),this.assignFieldsToForms(),this.assignFormsToCollections(),this.findDetachedButtons(),this.formCollections.forEach(e=>e.markAsFreshAndEmpty()),this.extraData=JSON.parse(this.element.dataset.extra?this.element.dataset.extra:"{}"),Promise.all(this.forms.map(e=>e.isConnected)).then(()=>{this.validate(),this.element.dispatchEvent(new CustomEvent("django-formset-connected",{detail:{formset:this}}))})}get endpoint(){return this.element.getAttribute("endpoint")??""}get forceSubmission(){return this.element.hasAttribute("force-submission")}parseWithholdFeedback(){var r;let e=((r=this.element.getAttribute("withhold-feedback"))==null?void 0:r.split(" "))??[],t=new Set(["dj-feedback-errors","dj-feedback-warnings","dj-feedback-success"]);for(let i of e)switch(i.toLowerCase()){case"messages":break;case"errors":t.delete("dj-feedback-errors");break;case"warnings":t.delete("dj-feedback-warnings");break;case"success":t.delete("dj-feedback-success");break;default:throw new Error(`Unknown value in <django-formset withhold-feedback="${i}">.`)}t.forEach(i=>this.element.classList.add(i))}pushTemplatePrefix(e){this.emptyCollectionPrefixes.push(e)}popTemplatePrefix(e){let t=this.emptyCollectionPrefixes.indexOf(e);t>=0&&this.emptyCollectionPrefixes.splice(t,1)}assignFieldsToForms(e){e=e??this.element;for(let t of e.querySelectorAll("INPUT, SELECT, TEXTAREA, BUTTON")){let r=t.getAttribute("form");if(!r)continue;let i=this.forms.filter(s=>s.formId&&s.formId===r);if(i.length<1)continue;if(i.length>1)throw new Error(`More than one form has id="${r}"`);let o=i[0];if(t instanceof HTMLInputElement&&t.type==="hidden")o.hiddenInputFields.includes(t)||o.hiddenInputFields.push(t);else if(t instanceof HTMLButtonElement){if(t.hasAttribute("df-click")&&t.form===o.element){let s=new j(o.formset,t,[...o.path,t.name]);this.buttons.push(s)}}else{let s=t.closest('[role="group"]');if(s&&!o.fieldGroups.find(l=>l.element===s)){let l=new tt(o,s);o.fieldGroups.push(l)}}}}findErrorsPlaceholder(){let e=this.element.querySelector(":scope > .dj-form-errors > ul.dj-errorlist > li.dj-placeholder");e&&(this.errorList=e.parentElement,this.errorPlaceholder=this.errorList.removeChild(e))}findForms(e){e=e??this.element;for(let t of e.getElementsByTagName("FORM")){let r=new ot(this,t);this.forms.push(r)}this.checkForUniqueness()}checkForUniqueness(){let e=this.forms.filter(r=>!r.isTransient);if(e.length===1)return;let t=Array();e.forEach((r,i)=>{if(i===0)r.name&&t.push(r.name);else{if(!r.name)throw new Error("Multiple <form>-elements in a <django-formset> require a unique name each.");if(r.name in t)throw new Error(`Duplicate name "${r.name}" used in multiple forms of same <django-formset>.`);t.push(r.name)}})}findFormCollections(){for(let e of Z.getChildCollections(this.element))this.formCollections.push(new Z(this,e));for(let[e,t]of Z.getChildSiblingsCollections(this.element).entries())this.formCollections.push(new N(this,t,e));this.formCollections.forEach(e=>e.updateRemoveButtonAttrs()),this.formCollectionTemplate=De.findFormCollectionTemplate(this,this.element)}findCollectionErrorsList(){this.collectionErrorsList.clear();for(let e of this.element.getElementsByClassName("dj-collection-errors")){let t=e.getAttribute("prefix")??"",r=e.querySelector("ul.dj-errorlist");this.collectionErrorsList.set(t,r)}}findDetachedButtons(e){e=e??this.element;for(let t of e.getElementsByTagName("BUTTON"))if(t.hasAttribute("df-click")){let r=t;if(!this.buttons.find(i=>i.element===r)){let i=r.name?r.name.split("."):[];this.buttons.push(new j(this,r,i))}}}assignFormsToCollections(){this.formCollections.forEach(e=>e.assignForms(this.forms))}removeForm(e){this.forms.splice(this.forms.indexOf(e),1)}removeFreshCollections(){Array.from(this.formCollections).reverse().forEach(t=>t.removeFreshAndEmpty())}aggregateValues(){this.data={};for(let e of this.forms)(0,Ie.default)(this.data,e.getAbsPath(),Object.fromEntries(e.aggregateValues()))}updateOperability(...e){for(let t of this.forms)t.markedForRemoval||t.updateOperability(...e);this.buttons.forEach(t=>t.updateOperability(...e)),this.inducers.forEach(t=>t.updateOperability(...e))}forceVisibility(e){this.inducers.forEach(t=>t.forceVisibility(e.element))}registerInducer(e){this.inducers.push(e)}validate(){let e=!0;for(let t of this.forms)e=(t.markedForRemoval||t.checkValidity())&&e;for(let t of this.buttons)t.autoDisable(e);return this.aggregateValues(),this.updateOperability(),e}buildBody(){let e;function t(i,o){if(o.length===1){Array.isArray(i)?e&&!i.includes(e)&&i.push(e):i[o[0]]=e??[];return}if(isNaN(parseInt(o[1]))){let s=i[o[0]]??{};t(s,o.slice(1));let l=parseInt(o[0]);isNaN(l)?i[o[0]]=s:i[l]={...i[l],...s}}else{if(Array.isArray(i))throw new Error("Invalid form structure: Contains nested arrays.");let s=i[o[0]]??[];if(!Array.isArray(s))throw new Error("Invalid form structure: Inner array is missing.");t(s,o.slice(1)),i[o[0]]=s}}this.data===void 0&&this.aggregateValues();let r={formset_data:Array.isArray(this.data.formset_data)?[]:{}};for(let i of this.emptyCollectionPrefixes){let o=["formset_data",...i.split(".")];e=(0,B.default)(r,o),t(r,o)}for(let[i,o]of this.forms.entries())if(!o.isTransient)if(i===0&&!o.name){let s=Object.fromEntries(o.aggregateValues());Object.assign(r.formset_data,s)}else{let s=o.getAbsPath();e=(0,B.default)(this.data,s),o.markedForRemoval&&(e[Ci]=!0),t(r,s)}return r}async submit(e){let t=!0;if(this.setSubmitted(),!this.forceSubmission)for(let r of this.forms)r.markedForRemoval||r.isTransient||(t=r.isValid()&&t);if(t){if(!this.endpoint)throw new Error(`<django-formset> requires attribute 'endpoint="server endpoint"' for submission`);this.removeFreshCollections();let r=Object.assign({extra_data:Object.assign({},this.extraData,e)},this.buildBody());try{let i=new Headers;i.append("Accept","application/json"),i.append("Content-Type","application/json"),this.CSRFToken&&i.append("X-CSRFToken",this.CSRFToken);let o=await fetch(this.endpoint,{method:"POST",headers:i,body:JSON.stringify(r),signal:this.abortController.signal});switch(o.status){case 200:return this.clearErrors(),this.forms.forEach(l=>l.element.dispatchEvent(new Event("submitted"))),o;case 422:this.clearErrors();let s=await o.clone().json();return this.reportErrors(s),o;default:return console.warn(`Unknown response status: ${o.status}`),this.clearErrors(),this.buttons.forEach(l=>l.restoreToInitial()),o}}catch(i){this.clearErrors(),this.buttons.forEach(o=>o.restoreToInitial()),alert(i)}}else this.clearErrors(),this.forms.forEach(r=>r.reportValidity())}async prefillPartial(e,t){if(!this.endpoint)throw new Error(`<django-formset> requires attribute 'endpoint="server endpoint"' for submission`);try{let r=new URLSearchParams({pk:e,path:t.join(".")}),i=new Headers;i.append("Accept","application/json");let o=await fetch(`${this.endpoint}?${r.toString()}`,{headers:i});switch(o.status){case 200:this.clearErrors();let s=await o.json(),l=this.forms.find(f=>(0,G.default)(f.path,t));if(l!=null&&l.element)for(let[f,u]of Object.entries((0,B.default)(s,t,{}))){let p=l.element.elements.namedItem(f);((0,M.default)(u)||(0,ee.default)(u))&&(p instanceof HTMLInputElement||p instanceof HTMLSelectElement||p instanceof HTMLTextAreaElement)&&(p.value=u)}return o;default:return console.warn(`Unknown response status: ${o.status}`),this.clearErrors(),this.buttons.forEach(f=>f.restoreToInitial()),o}}catch(r){this.clearErrors(),this.buttons.forEach(i=>i.restoreToInitial()),alert(r)}}async submitPartial(e,t){if(!this.endpoint)throw new Error(`<django-formset> requires attribute 'endpoint="server endpoint"' for submission`);let r=this.forms.filter(s=>{if(Tt(e,s.path))return s.setSubmitted(),!s.isValid()});if(!this.forceSubmission&&r.length>0){this.clearErrors(),r.forEach(s=>s.reportValidity());return}let i=["formset_data",...e],o=(0,Ie.default)({extra_data:Object.assign({},this.extraData,t)},i,(0,B.default)(this.buildBody(),i));try{let s=new Headers;s.append("Accept","application/json"),s.append("Content-Type","application/json"),this.CSRFToken&&s.append("X-CSRFToken",this.CSRFToken);let l=await fetch(this.endpoint,{method:"PATCH",headers:s,body:JSON.stringify(o)});switch(l.status){case 200:return this.clearErrors(),this.forms.filter(u=>(0,G.default)(u.path,e)).forEach(u=>{u.element.dispatchEvent(new Event("submitted"))}),l;case 422:this.clearErrors();let f=await l.clone().json();return this.reportErrors(f),l;default:return console.warn(`Unknown response status: ${l.status}`),this.clearErrors(),this.buttons.forEach(u=>u.restoreToInitial()),l}}catch(s){this.clearErrors(),this.buttons.forEach(l=>l.restoreToInitial()),alert(s)}}async deletePartial(e,t){if(!this.endpoint)throw new Error(`<django-formset> requires attribute 'endpoint="server endpoint"' for submission`);try{let r=new URLSearchParams({pk:t,path:e.join(".")}),i=new Headers;this.CSRFToken&&i.append("X-CSRFToken",this.CSRFToken);let o=await fetch(`${this.endpoint}?${r.toString()}`,{method:"DELETE",headers:i});switch(o.status){case 204:return this.clearErrors(),o;default:return console.warn(`Unknown response status: ${o.status}`),this.clearErrors(),this.buttons.forEach(s=>s.restoreToInitial()),o}}catch(r){this.clearErrors(),this.buttons.forEach(i=>i.restoreToInitial()),alert(r)}}reportErrors(e){console.info("Response from server:",e);for(let t of this.forms){let r=t.name?(0,B.default)(e,t.name.split("."),null):e;(0,st.default)(r)?t.clearCustomErrors():(t.reportCustomErrors(r),t.reportValidity())}for(let[t,r]of this.collectionErrorsList){let i=t?t.split("."):[];i=[...i,"0",Ti];for(let o of(0,B.default)(e,i,[])){let s=document.createElement("li");s.classList.add("dj-placeholder"),s.innerText=o,r.appendChild(s)}}if(this.errorList&&this.errorPlaceholder&&Array.isArray(e[Ze]))for(let t of e[Ze]){let r=this.errorPlaceholder.cloneNode();r.innerHTML=t,this.errorList.appendChild(r)}}resetToInitial(){Z.resetCollectionsToInitial(this.formCollections),this.forms.forEach(e=>e.resetToInitial()),this.validate()}abort(){for(let e of this.buttons)e.abortAction();this.abortController.abort()}setSubmitted(){for(let e of this.forms)e.setSubmitted()}getDataValue(e){let t=1,r=1,i=["formset_data",e[0]];for(;r<=e.length;){let o=(0,B.default)(this.data,i);if(o===void 0){i[t]+=`.${e[r]}`,++r;continue}if(r===e.length)return o;i.push(e[r]),++t,++r}}*unroll(e){for(let[t,r]of Object.entries(e))if((0,qe.default)(r))for(let[i,o,s]of this.unroll(r))yield[[t,...i],o,s];else(0,M.default)(r)||(0,ee.default)(r)?yield[[],t,r]:yield[[],void 0,void 0]}setFieldValue(e,t){if((0,M.default)(t)||(0,ee.default)(t)){let r=e.slice(0,-1),i=e.at(-1),o=this.forms.find(s=>(0,G.default)(s.path,r));i&&o&&o.setFieldValue(i,t)}else for(let[r,i,o]of this.unroll(t)){let s=this.forms.find(l=>(0,G.default)(l.path,[...e,...r]));i&&s&&s.setFieldValue(i,o)}}setExtraData(e,t){(0,Ie.default)(this.extraData,e,t)}findFirstErrorReport(){for(let e of this.forms){let t=e.findFirstErrorReport();if(t)return t}return null}maxNumSiblingsReached(e){var r;let t=((r=this.formCollectionTemplate)==null?void 0:r.maxNumSiblingsReached(e))??null;return t===null?this.formCollections.some(i=>i.maxNumSiblingsReached(e)):t}clearErrors(){for(let e of this.forms)e.clearCustomErrors();for(let e of this.collectionErrorsList.values())for(;e.firstElementChild;)e.removeChild(e.firstElementChild);this.errorList&&this.errorList.replaceChildren()}},ne=Symbol("DjangoFormset"),Xt,He=class extends(Xt=HTMLElement,ne,Xt){constructor(){super(),this[ne]=new nt(this)}static get observedAttributes(){return["endpoint","withhold-feedback","force-submission"]}connectedCallback(){this[ne].connectedCallback()}async submit(e){return this[ne].submit(e)}async abort(){return this[ne].abort()}async reset(){return this[ne].resetToInitial()}};function Kt(n,e=!1){function t(i,o,s,l=void 0){window.customElements.whenDefined(o).then(()=>i()),window.customElements.get(o)instanceof Function||window.customElements.define(o,s,l)}let r=Array();return n.querySelector('select[is="django-selectize"]')&&r.push(new Promise((i,o)=>{import("./DjangoSelectize-DMJXIPUU.js").then(({DjangoSelectizeElement:s})=>{t(i,"django-selectize",s,{extends:"select"})}).catch(s=>o(s))})),n.querySelector('select[is="django-selectize-country"]')&&r.push(new Promise((i,o)=>{import("./DjangoSelectizeCountry-3ZXOCITM.js").then(({CountrySelectizeElement:s})=>{t(i,"django-selectize-country",s,{extends:"select"})}).catch(s=>o(s))})),n.querySelector('select[is="django-dual-selector"], django-sortable-select')&&r.push(new Promise((i,o)=>{import("./DualSelector-F7PYL4ZK.js").then(({DualSelectorElement:s,SortableSelectElement:l})=>{Promise.all([window.customElements.whenDefined("django-sortable-select"),window.customElements.whenDefined("django-dual-selector")]).then(()=>i()),window.customElements.get("django-sortable-select")instanceof Function||window.customElements.define("django-sortable-select",l),window.customElements.get("django-dual-selector")instanceof Function||window.customElements.define("django-dual-selector",s,{extends:"select"})}).catch(s=>o(s))})),n.querySelector('input[is="django-decimal-unit"]')&&r.push(new Promise((i,o)=>{import("./DecimalUnit-KH346YR7.js").then(({DecimalUnitElement:s})=>{t(i,"django-decimal-unit",s,{extends:"input"})}).catch(s=>o(s))})),n.querySelector('input[is="django-phone-number"]')&&r.push(new Promise((i,o)=>{import("./PhoneNumber-W4K77RRB.js").then(({PhoneNumberElement:s})=>{t(i,"django-phone-number",s,{extends:"input"})}).catch(s=>o(s))})),n.querySelector('textarea[is="django-richtext"]')&&r.push(new Promise((i,o)=>{import("./RichtextArea-V6NBAU7D.js").then(({RichTextAreaElement:s})=>{let l=n.querySelectorAll('textarea[is="django-richtext"]');window.customElements.whenDefined("django-richtext").then(()=>{Promise.all(Array.from(l).map(f=>new Promise(u=>{e||f.isInitialized?u():f.addEventListener("connected",()=>u(),{once:!0})}))).then(()=>i())}).then(()=>i()),window.customElements.get("django-richtext")instanceof Function||window.customElements.define("django-richtext",s,{extends:"textarea"})}).catch(s=>o(s))})),n.querySelector('input[is="django-slug"]')&&r.push(new Promise((i,o)=>{import("./DjangoSlug-ITM2BTBO.js").then(({DjangoSlugElement:s})=>{t(i,"django-slug",s,{extends:"input"})}).catch(s=>o(s))})),n.querySelector('input[is="django-datefield"]')&&r.push(new Promise((i,o)=>{import("./DateTime-QMT7WAJ4.js").then(({DateFieldElement:s})=>{t(i,"django-datefield",s,{extends:"input"})}).catch(s=>o(s))})),n.querySelector('input[is="django-datecalendar"]')&&r.push(new Promise((i,o)=>{import("./Calendar-7VTHJBPR.js").then(({DateCalendarElement:s})=>{t(i,"django-datecalendar",s,{extends:"input"})}).catch(s=>o(s))})),n.querySelector('input[is="django-datepicker"]')&&r.push(new Promise((i,o)=>{import("./DateTime-QMT7WAJ4.js").then(({DatePickerElement:s})=>{t(i,"django-datepicker",s,{extends:"input"})}).catch(s=>o(s))})),n.querySelector('input[is="django-datetimefield"]')&&r.push(new Promise((i,o)=>{import("./DateTime-QMT7WAJ4.js").then(({DateTimeFieldElement:s})=>{t(i,"django-datetimefield",s,{extends:"input"})}).catch(s=>o(s))})),n.querySelector('input[is="django-datetimecalendar"]')&&r.push(new Promise((i,o)=>{import("./Calendar-7VTHJBPR.js").then(({DateTimeCalendarElement:s})=>{t(i,"django-datetimecalendar",s,{extends:"input"})}).catch(s=>o(s))})),n.querySelector('input[is="django-datetimepicker"]')&&r.push(new Promise((i,o)=>{import("./DateTime-QMT7WAJ4.js").then(({DateTimePickerElement:s})=>{t(i,"django-datetimepicker",s,{extends:"input"})}).catch(s=>o(s))})),n.querySelector('input[is="django-daterangefield"]')&&r.push(new Promise((i,o)=>{import("./DateTime-QMT7WAJ4.js").then(({DateRangeFieldElement:s})=>{t(i,"django-daterangefield",s,{extends:"input"})}).catch(s=>o(s))})),n.querySelector('input[is="django-daterangecalendar"]')&&r.push(new Promise((i,o)=>{import("./Calendar-7VTHJBPR.js").then(({DateRangeCalendarElement:s})=>{t(i,"django-daterangecalendar",s,{extends:"input"})}).catch(s=>o(s))})),n.querySelector('input[is="django-daterangepicker"]')&&r.push(new Promise((i,o)=>{import("./DateTime-QMT7WAJ4.js").then(({DateRangePickerElement:s})=>{t(i,"django-daterangepicker",s,{extends:"input"})}).catch(s=>o(s))})),n.querySelector('input[is="django-datetimerangefield"]')&&r.push(new Promise((i,o)=>{import("./DateTime-QMT7WAJ4.js").then(({DateTimeRangeFieldElement:s})=>{t(i,"django-datetimerangefield",s,{extends:"input"})}).catch(s=>o(s))})),n.querySelector('input[is="django-datetimerangecalendar"]')&&r.push(new Promise((i,o)=>{import("./Calendar-7VTHJBPR.js").then(({DateTimeRangeCalendarElement:s})=>{t(i,"django-datetimerangecalendar",s,{extends:"input"})}).catch(s=>o(s))})),n.querySelector('input[is="django-datetimerangepicker"]')&&r.push(new Promise((i,o)=>{import("./DateTime-QMT7WAJ4.js").then(({DateTimeRangePickerElement:s})=>{t(i,"django-datetimerangepicker",s,{extends:"input"})}).catch(s=>o(s))})),n.querySelector('dialog[is="django-form-dialog"]')&&r.push(new Promise((i,o)=>{import("./FormDialog-ULXWFM5I.js").then(({FormDialogElement:s})=>{t(i,"django-form-dialog",s,{extends:"dialog"})}).catch(s=>o(s))})),n.querySelector("django-stepper-collection")&&r.push(new Promise((i,o)=>{import("./StepperCollection-OPGIN24Z.js").then(({StepperCollectionElement:s})=>{t(i,"django-stepper-collection",s)}).catch(s=>o(s))})),Promise.all(r)}function Qt(){let n=Array();K.attachPseudoStyles(),document.querySelectorAll("template.empty-collection").forEach(t=>{t instanceof HTMLTemplateElement&&t.content instanceof DocumentFragment&&n.push(Kt(t.content,!0))}),n.push(Kt(document));let e=new Set;document.querySelectorAll("django-formset [id]").forEach(t=>{let r=t.getAttribute("id");if(e.has(r))throw new Error(`There are at least two elements with attribute id="${r}"`);e.add(r)}),Promise.all(n).then(()=>{window.customElements.define("django-formset",He)}).catch(t=>console.error(`Failed to initialize django-formset: ${t}`))}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",Qt):Qt();
/*! Bundled license information:

@ungap/custom-elements/index.js:
  (*! (c) Andrea Giammarchi @webreflection ISC *)
  (*! (c) Andrea Giammarchi - ISC *)
*/
