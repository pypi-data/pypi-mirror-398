Metadata-Version: 2.4
Name: sakuragent
Version: 0.3.2
Summary: Sakura Agent Framework - A streamlined LLM agent framework
Author-email: Vist233 <zhangyvjing@outlook.com>
License: MIT
Project-URL: Homepage, https://github.com/Vist233/sakura
Project-URL: Bug Tracker, https://github.com/Vist233/sakura/issues
Project-URL: Source Code, https://github.com/Vist233/sakura
Keywords: llm,agent,framework,performance,sakura,sakuragent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Requires-Python: >=3.10
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: pydantic>=2.0
Requires-Dist: openai>=1.0
Requires-Dist: rich
Requires-Dist: docstring-parser
Requires-Dist: packaging
Requires-Dist: pyyaml
Requires-Dist: python-dotenv
Provides-Extra: qwen
Requires-Dist: dashscope; extra == "qwen"
Provides-Extra: claude
Requires-Dist: anthropic; extra == "claude"
Provides-Extra: search
Requires-Dist: ddgs; extra == "search"
Provides-Extra: dev
Requires-Dist: pytest; extra == "dev"
Requires-Dist: pytest-asyncio; extra == "dev"
Provides-Extra: all
Requires-Dist: sakura[claude,dev,qwen,search]; extra == "all"
Dynamic: license-file

# Sakura Agent Framework

> **æ ¸å¿ƒå“²å­¦**ï¼šä¸é‡æ–°å‘æ˜è½®å­ï¼Œè®©å¥½çš„ä¸œè¥¿æ›´å¥½ã€‚
> 
> **æ¡†æ¶å®šä½**ï¼šåªåšå¥½ä¸€ä»¶äº‹æƒ… â€”â€” è®© LLM Agent å¼€å‘æ›´ç®€å•ã€æ›´é«˜æ•ˆã€‚

## ğŸ¯ è®¾è®¡ç†å¿µ

Sakura æ˜¯ä¸€ä¸ª**è½»é‡çº§ã€é«˜æ€§èƒ½**çš„ Agent æ¡†æ¶ï¼Œä¸“æ³¨äºï¼š

1. **æç®€ API** - 5 åˆ†é’Ÿä¸Šæ‰‹ï¼Œæ— å­¦ä¹ æ›²çº¿
2. **å¤šæ¨¡å‹æ”¯æŒ** - ç»Ÿä¸€æ¥å£ï¼Œä¸€é”®åˆ‡æ¢ Qwen/OpenAI/Claude/Kimi
3. **å·¥ç¨‹åŒ–å·¥å…·** - å¯è§‚æµ‹ã€å¯è¿½è¸ªã€å¯è°ƒè¯•
4. **ç”Ÿäº§å°±ç»ª** - ç»è¿‡ä¼˜åŒ–çš„æ€§èƒ½ï¼Œé€‚åˆéƒ¨ç½²

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…

```bash
pip install sakuragent

# å¯é€‰ä¾èµ–
pip install sakuragent[qwen]    # é˜¿é‡Œäº‘é€šä¹‰åƒé—®
pip install sakuragent[claude]  # Anthropic Claude
pip install sakuragent[search]  # æœç´¢å·¥å…·
pip install sakuragent[all]     # å…¨éƒ¨å®‰è£…
```

### æœ€ç®€ç¤ºä¾‹

```python
from sakura import Agent, tool
from sakura.models import Qwen

@tool
def search(query: str) -> str:
    """æœç´¢ç½‘ç»œ"""
    return f"æœç´¢ç»“æœ: {query}"

agent = Agent(
    model=Qwen(id="qwen-plus"),
    tools=[search],
    system_prompt="ä½ æ˜¯ä¸€ä¸ªæœ‰å¸®åŠ©çš„åŠ©æ‰‹"
)

result = agent.run("æœç´¢ Python æœ€ä½³å®è·µ")
print(result.content)
```

### å¼‚æ­¥æ‰§è¡Œï¼ˆçœŸæ­£çš„å¹¶è¡Œå·¥å…·è°ƒç”¨ï¼‰

```python
import asyncio

# å¼‚æ­¥æ‰§è¡Œï¼Œå·¥å…·è°ƒç”¨å¹¶è¡Œ
result = await agent.arun("åŒæ—¶æœç´¢ä¸‰ä¸ªä¸»é¢˜")
```

## ğŸ—ï¸ æ ¸å¿ƒæ¨¡å—

### 1. Agent - ç»Ÿä¸€çš„ä»£ç†ç±»

```python
from sakura import Agent

agent = Agent(
    model=Qwen(id="qwen-plus"),     # æ¨¡å‹
    tools=[tool1, tool2],            # å·¥å…·åˆ—è¡¨
    system_prompt="...",             # ç³»ç»Ÿæç¤ºè¯
    max_tool_calls=10,               # æœ€å¤§å·¥å…·è°ƒç”¨æ¬¡æ•°
    debug=True,                      # è°ƒè¯•æ¨¡å¼
)

# åŒæ­¥æ‰§è¡Œ
result = agent.run("ä½ çš„é—®é¢˜")

# å¼‚æ­¥æ‰§è¡Œï¼ˆå¹¶è¡Œå·¥å…·è°ƒç”¨ï¼‰
result = await agent.arun("ä½ çš„é—®é¢˜")
```

### 2. Models - å¤šæ¨¡å‹æ”¯æŒ

```python
from sakura.models import Qwen, OpenAI, Claude, Kimi, OpenRouter

# é˜¿é‡Œäº‘é€šä¹‰åƒé—®
model = Qwen(id="qwen-plus")  # æˆ– qwen-turbo, qwen-max

# OpenAI
model = OpenAI(id="gpt-4o")

# Anthropic Claude
model = Claude(id="claude-sonnet-4-20250514")

# æœˆä¹‹æš—é¢ Kimi
model = Kimi(id="moonshot-v1-8k")

# OpenRouter (è®¿é—®å¤šç§æ¨¡å‹)
model = OpenRouter(id="anthropic/claude-3.5-sonnet")
```

æ‰€æœ‰æ¨¡å‹ä½¿ç”¨ç»Ÿä¸€ APIï¼Œåˆ‡æ¢åªéœ€æ”¹ä¸€è¡Œä»£ç ã€‚

### 3. Tools - å·¥å…·ç³»ç»Ÿ

#### è‡ªå®šä¹‰å·¥å…·

```python
from sakura import tool

@tool
def calculate(expression: str) -> str:
    """è®¡ç®—æ•°å­¦è¡¨è¾¾å¼
    
    Args:
        expression: æ•°å­¦è¡¨è¾¾å¼ï¼Œå¦‚ "1+2*3"
    
    Returns:
        è®¡ç®—ç»“æœ
    """
    return str(eval(expression))
```

#### å†…ç½®å·¥å…·

```python
from sakura.tools.builtin import DuckDuckGoTools, BaiduSearchTools, FileTools

# æœç´¢å·¥å…·
ddg = DuckDuckGoTools()
baidu = BaiduSearchTools()

agent = Agent(
    model=...,
    tools=[ddg.duckduckgo_search, baidu.baidu_search]
)
```

### 4. SubAgent - å­ä»£ç†ç³»ç»Ÿ

åˆ›å»ºä¸“é—¨çš„å­ Agent å¤„ç†ç‰¹å®šä»»åŠ¡ï¼š

```python
from sakura.tools.subagent import subagent, parallel_subagents

# å•ä¸ª SubAgent
result = subagent(
    prompt="ç ”ç©¶ Python å¼‚æ­¥ç¼–ç¨‹",
    model="qwen-plus",
    tools=[search_tool],
    system_prompt="ä½ æ˜¯æŠ€æœ¯ç ”ç©¶å‘˜"
)

# å¹¶è¡Œå¤šä¸ª SubAgent
results = await parallel_subagents(
    prompts=["ç ”ç©¶ä¸»é¢˜A", "ç ”ç©¶ä¸»é¢˜B", "ç ”ç©¶ä¸»é¢˜C"],
    model="qwen-plus",
    tools=[search_tool]
)
```

### 5. Monitor - å¯è§‚æµ‹æ€§

#### è®¡æ—¶è£…é¥°å™¨

```python
from sakura.monitor import timer

@timer
def my_function():
    # è‡ªåŠ¨æ‰“å°æ‰§è¡Œæ—¶é—´
    ...
```

#### æ•°æ®åº“ç›‘æ§

```python
from sakura.monitor import Monitor, monitor

# åˆ›å»ºç›‘æ§å™¨ï¼ˆæ”¯æŒ SQLite/PostgreSQL/MySQLï¼‰
mon = Monitor("./agent_logs.db")

@monitor(storage=mon.storage)
def agent_task(prompt):
    return agent.run(prompt)

# æŸ¥çœ‹ç»Ÿè®¡
print(mon.get_stats())
```

#### ğŸ†• æ‰§è¡Œæµç¨‹è¿½è¸ªï¼ˆMermaid æµç¨‹å›¾ï¼‰

```python
from sakura.monitor import trace_flow, trace_span, FlowTracer

@trace_flow(output_file="trace.html")
async def research(topic: str):
    with trace_span("ä¸» Agent", span_type="agent", model="qwen-plus"):
        result = await agent.arun(topic)
    return result

# ç»ˆç«¯è¾“å‡º Mermaid ä»£ç 
# HTML æ–‡ä»¶åŒ…å«å¯ç‚¹å‡»çš„æµç¨‹å›¾ï¼Œæ˜¾ç¤º:
# - æ¨¡å‹ã€å·¥å…·ã€ç³»ç»Ÿæç¤ºè¯
# - æ‰§è¡Œæ—¶é—´ã€Token ç»Ÿè®¡
# - è°ƒç”¨å±‚çº§å…³ç³»
```

ç”Ÿæˆçš„ HTML æ•ˆæœï¼š
- ğŸ“Š å¯è§†åŒ–æµç¨‹å›¾
- ğŸ–±ï¸ ç‚¹å‡»èŠ‚ç‚¹æŸ¥çœ‹è¯¦æƒ…ï¼ˆæ¨¡å‹/å·¥å…·/æç¤ºè¯ï¼‰
- â±ï¸ æ¯ä¸ªæ­¥éª¤çš„è€—æ—¶ç»Ÿè®¡

### 6. Memory - æ™ºèƒ½è®°å¿†

```python
from sakura import SmartCompressor

agent = Agent(
    model=...,
    memory=SmartCompressor(
        threshold=0.92,     # 92% ä¸Šä¸‹æ–‡æ—¶è§¦å‘å‹ç¼©
        strategy="structured"
    )
)
```

## ğŸ“Š å®ç”¨ç¤ºä¾‹

### æ·±åº¦ç ”ç©¶ Agent

```python
from sakura import Agent, tool
from sakura.models import Qwen
from sakura.tools.builtin import BaiduSearchTools
from sakura.monitor import trace_flow, trace_span

baidu = BaiduSearchTools()

@tool
def web_search(query: str) -> str:
    """æœç´¢ç½‘ç»œè·å–ä¿¡æ¯"""
    return baidu.baidu_search(query, max_results=5)

@trace_flow(output_file="research_trace.html")
async def deep_research(topic: str):
    agent = Agent(
        model=Qwen(id="qwen-plus"),
        tools=[web_search],
        system_prompt="""ä½ æ˜¯ä¸€ä¸ªç ”ç©¶å‘˜ï¼Œè¯·ï¼š
1. æœç´¢ç›¸å…³ä¿¡æ¯
2. ç»¼åˆåˆ†æ
3. è¾“å‡ºç»“æ„åŒ–æŠ¥å‘Š""",
        debug=True
    )
    
    with trace_span("ç ”ç©¶ä»»åŠ¡", span_type="agent", 
                    model="qwen-plus", 
                    user_prompt=topic):
        result = await agent.arun(topic)
    
    return result

# è¿è¡Œ
import asyncio
result = asyncio.run(deep_research("Python 3.12 æ–°ç‰¹æ€§"))
```

### å¤š Agent åä½œ

```python
from sakura.tools.subagent import parallel_subagents

async def multi_agent_research(topic: str):
    # å¹¶è¡Œå¯åŠ¨å¤šä¸ªä¸“å®¶ Agent
    focuses = ["åŸºç¡€æ¦‚å¿µ", "æœ€æ–°è¿›å±•", "å®é™…åº”ç”¨"]
    
    results = await parallel_subagents(
        prompts=[f"ç ”ç©¶ {topic} çš„{focus}" for focus in focuses],
        model="qwen-plus",
        tools=[web_search],
        system_prompt="ä½ æ˜¯ä¸“ä¸šç ”ç©¶å‘˜"
    )
    
    # æ±‡æ€»ç»“æœ
    final_agent = Agent(model=Qwen(id="qwen-plus"))
    summary = final_agent.run(f"ç»¼åˆä»¥ä¸‹ç ”ç©¶æŠ¥å‘Šï¼š{results}")
    
    return summary
```

## ğŸ”§ ç¯å¢ƒå˜é‡

```bash
# é˜¿é‡Œäº‘é€šä¹‰åƒé—®
export DASHSCOPE_API_KEY="your-key"

# OpenAI
export OPENAI_API_KEY="your-key"

# Anthropic Claude  
export ANTHROPIC_API_KEY="your-key"

# æœˆä¹‹æš—é¢ Kimi
export MOONSHOT_API_KEY="your-key"

# OpenRouter
export OPENROUTER_API_KEY="your-key"
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
sakura/
â”œâ”€â”€ __init__.py          # ä¸»å…¥å£
â”œâ”€â”€ agent.py             # Agent æ ¸å¿ƒç±»
â”œâ”€â”€ models/              # æ¨¡å‹é€‚é…å™¨
â”‚   â”œâ”€â”€ qwen.py
â”‚   â”œâ”€â”€ openai.py
â”‚   â”œâ”€â”€ claude.py
â”‚   â””â”€â”€ ...
â”œâ”€â”€ tools/               # å·¥å…·ç³»ç»Ÿ
â”‚   â”œâ”€â”€ decorator.py     # @tool è£…é¥°å™¨
â”‚   â”œâ”€â”€ builtin/         # å†…ç½®å·¥å…·
â”‚   â””â”€â”€ subagent/        # å­ Agent
â”œâ”€â”€ monitor/             # å¯è§‚æµ‹æ€§
â”‚   â”œâ”€â”€ decorators.py    # @timer, @monitor
â”‚   â”œâ”€â”€ storage.py       # æ•°æ®åº“å­˜å‚¨
â”‚   â””â”€â”€ tracer.py        # æµç¨‹è¿½è¸ª (NEW)
â”œâ”€â”€ memory/              # è®°å¿†ç³»ç»Ÿ
â”‚   â””â”€â”€ compressor.py    # æ™ºèƒ½å‹ç¼©
â””â”€â”€ messages/            # æ¶ˆæ¯å¤„ç†
```

## ğŸ†• v0.2.0 æ›´æ–°

- âœ… **æ‰§è¡Œæµç¨‹è¿½è¸ª** - `@trace_flow` è£…é¥°å™¨ï¼Œç”Ÿæˆ Mermaid æµç¨‹å›¾
- âœ… **HTML å¯è§†åŒ–** - ç‚¹å‡»èŠ‚ç‚¹æŸ¥çœ‹ Agent è¯¦æƒ…
- âœ… **ç™¾åº¦æœç´¢å·¥å…·** - `BaiduSearchTools` å†…ç½®æ”¯æŒ
- âœ… **å¹¶è¡Œ SubAgent** - `parallel_subagents` çœŸæ­£å¹¶è¡Œæ‰§è¡Œ
- âœ… **è°ƒè¯•æ¨¡å¼å¢å¼º** - `set_log_level_to_debug()` è¯¦ç»†æ—¥å¿—

## ğŸ’¡ è®¾è®¡å“²å­¦

### ä¸é‡æ–°å‘æ˜è½®å­

- åŸºäºæˆç†Ÿçš„ OpenAI SDK æ¥å£è§„èŒƒ
- ä½¿ç”¨æ ‡å‡†çš„ Python typing å’Œ dataclass
- å…¼å®¹ä¸»æµ LLM æœåŠ¡å•† API

### è®©å¥½çš„ä¸œè¥¿æ›´å¥½

- ç»Ÿä¸€å¤šæ¨¡å‹æ¥å£ï¼Œé™ä½åˆ‡æ¢æˆæœ¬
- å†…ç½®å¯è§‚æµ‹æ€§ï¼Œæ— éœ€é¢å¤–é…ç½®
- æµç¨‹è¿½è¸ªå¯è§†åŒ–ï¼Œè°ƒè¯•æ›´ç›´è§‚

### åªåšå¥½ä¸€ä»¶äº‹æƒ…

- ä¸“æ³¨äº Agent æ ¸å¿ƒèƒ½åŠ›
- ä¸åš RAGã€ä¸åšå‘é‡åº“ã€ä¸åš UI
- è½»é‡çº§ä¾èµ–ï¼Œå¿«é€Ÿå¯åŠ¨

---

**GitHub**: [Vist233/sakura](https://github.com/Vist233/sakura)
**PyPI**: `pip install sakuragent`
**ç‰ˆæœ¬**: 0.2.0

**Based on Agno**

