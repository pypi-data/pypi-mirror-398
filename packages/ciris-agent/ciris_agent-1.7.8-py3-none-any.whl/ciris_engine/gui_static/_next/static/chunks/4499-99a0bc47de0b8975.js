"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4499],{1338:(e,r,s)=>{s.d(r,{L:()=>a});var t=s(4568),n=s(7620);class a extends n.Component{static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,r){console.error("❌❌❌ CONSENT PAGE CRITICAL ERROR ❌❌❌"),console.error("Error:",e),console.error("Error Info:",r),console.error("Stack:",e.stack),this.setState({error:e,errorInfo:r}),alert("Critical error in Consent page: ".concat(e.message,"\n\nPlease refresh the page or contact support."))}render(){if(this.state.hasError){var e;return(0,t.jsx)("div",{className:"min-h-screen bg-red-50 flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"max-w-2xl w-full bg-white rounded-lg shadow-xl p-6",children:[(0,t.jsxs)("div",{className:"flex items-center mb-4",children:[(0,t.jsx)("svg",{className:"h-12 w-12 text-red-600 mr-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,t.jsx)("h1",{className:"text-2xl font-bold text-red-600",children:"Consent Page Error"})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:[(0,t.jsx)("p",{className:"font-bold",children:"Error Message:"}),(0,t.jsx)("p",{className:"font-mono text-sm mt-1",children:null==(e=this.state.error)?void 0:e.message})]}),!1,(0,t.jsxs)("div",{className:"flex space-x-4 mt-6",children:[(0,t.jsx)("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Reload Page"}),(0,t.jsx)("button",{onClick:()=>window.location.href="/",className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700",children:"Go to Home"})]})]})]})})}return this.props.children}constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}}},3120:(e,r,s)=>{s.d(r,{_:()=>o});var t=s(704);function n(){let e=window.location.hostname,r=window.location.pathname,s=r.startsWith("/agent/");if("agents.ciris.ai"!==e&&!s)return{mode:"standalone",agentId:"default",apiBase:"/v1"};{let e="default";e=s?r.split("/")[2]||"default":localStorage.getItem("selectedAgentId")||"default";let t="/api/".concat(e,"/v1");return{mode:"managed",agentId:e,apiBase:t}}}var a=s(5950);class i{configure(e,r){let s,{mode:t}=n();if("managed"===t)s="".concat(window.location.origin,"/api/").concat(e);else{let r=localStorage.getItem("agent_".concat(e,"_api_url"));s=r||window.location.origin}r||(r=a.a.getAccessToken()||void 0);let i={baseURL:s,authToken:r,agentId:e,mode:t};return this.hasConfigChanged(i)&&this.applyConfiguration(i),i}configureForOAuthCallback(e,r){let s,{mode:t}=n(),a={baseURL:"managed"===t?"".concat(window.location.origin,"/api/").concat(e):window.location.origin,authToken:r,agentId:e,mode:t};return this.applyConfiguration(a),this.storeConfiguration(a),a}getCurrentConfig(){return this.currentConfig}isConfiguredFor(e){return!!this.currentConfig&&this.currentConfig.agentId===e&&!!this.currentConfig.authToken}clear(){this.currentConfig=null,localStorage.removeItem("sdk_config"),this.log("SDK configuration cleared")}applyConfiguration(e){this.log("Applying SDK configuration:",e),t.AQ.setConfig({baseURL:e.baseURL,authToken:e.authToken}),this.currentConfig=e,this.log("SDK configured successfully")}hasConfigChanged(e){return!this.currentConfig||this.currentConfig.baseURL!==e.baseURL||this.currentConfig.authToken!==e.authToken||this.currentConfig.agentId!==e.agentId||this.currentConfig.mode!==e.mode}storeConfiguration(e){let r={baseURL:e.baseURL,agentId:e.agentId,mode:e.mode};localStorage.setItem("sdk_config",JSON.stringify(r)),"standalone"===e.mode&&e.baseURL!==window.location.origin&&localStorage.setItem("agent_".concat(e.agentId,"_api_url"),e.baseURL)}restoreConfiguration(){let e=localStorage.getItem("sdk_config");if(!e)return null;try{let r=JSON.parse(e),s=a.a.getAccessToken()||void 0;return{...r,authToken:s}}catch(e){return null}}log(){for(var e=arguments.length,r=Array(e),s=0;s<e;s++)r[s]=arguments[s];this.debugMode&&console.log("[SDKConfigManager]",...r)}constructor(){this.currentConfig=null,this.debugMode=!1}}let o=new i},3457:(e,r,s)=>{s.d(r,{k:()=>n,u:()=>a});var t=s(4568);function n(){return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)("svg",{className:"h-5 w-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),(0,t.jsxs)("div",{className:"ml-3",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-blue-800",children:"Consent Record Creation"}),(0,t.jsx)("div",{className:"mt-2 text-sm text-blue-700",children:(0,t.jsxs)("p",{children:["Consent records are automatically created ",(0,t.jsx)("strong",{children:"6-12 hours after your first Discord interaction"})," with CIRIS. This delay ensures meaningful engagement before establishing a consent relationship."]})})]})]})}),(0,t.jsx)("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)("svg",{className:"h-5 w-5 text-amber-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),(0,t.jsxs)("div",{className:"ml-3",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-amber-800",children:"Important Consent Rules"}),(0,t.jsxs)("div",{className:"mt-2 text-sm text-amber-700 space-y-2",children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Downgrades:"})," Switching to TEMPORARY or ANONYMOUS creates a proactive opt-out and takes effect immediately."]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Partnership Upgrades:"})," Always require mutual consent from both you and the agent. The agent must approve your partnership request."]})]})]})]})}),(0,t.jsx)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})})}),(0,t.jsxs)("div",{className:"ml-3",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-gray-800",children:"Privacy & Access Control"}),(0,t.jsx)("div",{className:"mt-2 text-sm text-gray-700",children:(0,t.jsx)("p",{children:"You can only view and manage your own consent settings. Administrators can view consent records for all users for compliance purposes, but cannot modify them."})})]})]})})]})}function a(e){let{partnershipRequests:r}=e;if(!r||0===r.length)return null;let s=r.filter(e=>"agent"===e.from);return 0===s.length?null:(0,t.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:(0,t.jsxs)("div",{className:"flex items-start",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("svg",{className:"h-6 w-6 text-green-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{d:"M8 9a3 3 0 100-6 3 3 0 000 6zM8 11a6 6 0 016 6H2a6 6 0 016-6zM16 7a1 1 0 10-2 0v1h-1a1 1 0 100 2h1v1a1 1 0 102 0v-1h1a1 1 0 100-2h-1V7z"})}),(0,t.jsx)("span",{className:"absolute -top-1 -right-1 h-3 w-3 bg-green-400 rounded-full animate-pulse"})]})}),(0,t.jsxs)("div",{className:"ml-3 flex-1",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-green-800",children:"Partnership Request from Agent"}),(0,t.jsxs)("div",{className:"mt-2 text-sm text-green-700",children:[(0,t.jsx)("p",{children:"The agent has requested to establish a partnership with you! This would enable:"}),(0,t.jsxs)("ul",{className:"mt-2 list-disc list-inside space-y-1",children:[(0,t.jsx)("li",{children:"Enhanced personalization based on your preferences"}),(0,t.jsx)("li",{children:"Long-term memory of your interactions"}),(0,t.jsx)("li",{children:"Mutual growth and learning"})]}),s[0].message&&(0,t.jsxs)("p",{className:"mt-3 italic",children:['"',s[0].message,'"']}),(0,t.jsxs)("div",{className:"mt-4 flex space-x-3",children:[(0,t.jsx)("button",{className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:"Accept Partnership"}),(0,t.jsx)("button",{className:"inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Decline"})]})]})]})]})})}s(7620)},5003:(e,r,s)=>{s.d(r,{A:()=>l});var t=s(4568),n=s(7620),a=s(704),i=s(7192);let o=[{id:a.Lb.INTERACTION,name:"Interaction",description:"Learn from our conversations",icon:"\uD83D\uDCAC"},{id:a.Lb.PREFERENCE,name:"Preference",description:"Learn your preferences and patterns",icon:"⚙️"},{id:a.Lb.IMPROVEMENT,name:"Improvement",description:"Use for self-improvement",icon:"\uD83D\uDCC8"},{id:a.Lb.RESEARCH,name:"Research",description:"Use for research purposes",icon:"\uD83D\uDD2C"},{id:a.Lb.SHARING,name:"Sharing",description:"Share learnings with others",icon:"\uD83E\uDD32"}];function l(e){let{isOpen:r,onClose:s,onSuccess:l}=e,[c,d]=(0,n.useState)([]),[u,h]=(0,n.useState)(""),[m,g]=(0,n.useState)(!1),[x,f]=(0,n.useState)(null);if(!r)return null;let p=e=>{d(r=>r.includes(e)?r.filter(r=>r!==e):[...r,e])},b=async()=>{if(0===c.length)return void f("Please select at least one category");g(!0),f(null);try{console.log("Selected categories (raw):",c),console.log("Selected categories (values):",c.map(e=>String(e))),await a.AQ.consent.requestPartnership(c,u||"User requested partnership upgrade"),l(),s()}catch(e){f((0,i.PE)(e)),console.error("Partnership request failed:",e),console.error("Error details:",{status:null==e?void 0:e.status,detail:null==e?void 0:e.detail,message:null==e?void 0:e.message,type:null==e?void 0:e.type})}finally{g(!1)}};return(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"border-b px-6 py-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Request Partnership"}),(0,t.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-500",children:(0,t.jsx)("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,t.jsx)("p",{className:"mt-1 text-sm text-gray-600",children:"Partnership requires mutual consent. The agent will review your request."})]}),(0,t.jsxs)("div",{className:"px-6 py-4",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:"Select what you'd like to share:"}),(0,t.jsx)("div",{className:"space-y-3",children:o.map(e=>(0,t.jsxs)("label",{className:"flex items-start cursor-pointer hover:bg-gray-50 p-3 rounded-lg transition-colors",children:[(0,t.jsx)("input",{type:"checkbox",checked:c.includes(e.id),onChange:()=>p(e.id),className:"mt-1 h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),(0,t.jsxs)("div",{className:"ml-3 flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("span",{className:"text-lg mr-2",children:e.icon}),(0,t.jsx)("span",{className:"font-medium text-gray-900",children:e.name})]}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description})]})]},e.id))})]}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("label",{htmlFor:"reason",className:"block text-sm font-medium text-gray-900 mb-2",children:"Tell the agent why you want to partner (optional):"}),(0,t.jsx)("textarea",{id:"reason",rows:4,value:u,onChange:e=>h(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Share your goals and how partnership would help both of us grow..."})]}),x&&(0,t.jsx)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md",children:(0,t.jsx)("p",{className:"text-sm text-red-600",children:x})}),(0,t.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)("svg",{className:"h-5 w-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),(0,t.jsxs)("div",{className:"ml-3",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-blue-800",children:"About Partnership"}),(0,t.jsx)("div",{className:"mt-2 text-sm text-blue-700",children:(0,t.jsxs)("ul",{className:"list-disc pl-5 space-y-1",children:[(0,t.jsx)("li",{children:"The agent will review your request within 48 hours"}),(0,t.jsx)("li",{children:"You'll be notified when a decision is made"}),(0,t.jsx)("li",{children:"You can withdraw your request at any time"}),(0,t.jsx)("li",{children:"Partnership can be ended by either party"})]})})]})]})})]}),(0,t.jsx)("div",{className:"border-t px-6 py-4 bg-gray-50",children:(0,t.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,t.jsx)("button",{onClick:s,disabled:m,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Cancel"}),(0,t.jsx)("button",{onClick:b,disabled:m||0===c.length,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 border border-transparent rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:m?"Submitting...":"Submit Request"})]})})]})})}},6264:(e,r,s)=>{s.d(r,{O:()=>o});var t=s(4568),n=s(7620),a=s(2942),i=s(9484);function o(e){let{children:r,requiredRole:s,requiredPermission:o}=e,{user:l,loading:c,hasRole:d,hasPermission:u}=(0,i.A)(),h=(0,a.useRouter)();return((0,n.useEffect)(()=>{if(!c){if(!l)return void h.push("/login");if(s&&!d(s)||o&&!u(o))return void h.push("/unauthorized")}},[l,c,s,o,d,u,h]),c)?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsx)("div",{className:"text-lg",children:"Loading..."})}):l&&(!s||d(s))&&(!o||u(o))?(0,t.jsx)(t.Fragment,{children:r}):null}},7192:(e,r,s)=>{function t(e){if(!e)return"Unknown error";if("string"==typeof e)return e;if(Array.isArray(e))return e.map(e=>"string"==typeof e?e:e.msg?e.msg:e.message?e.message:JSON.stringify(e)).join("; ");if(e.detail){if(Array.isArray(e.detail))return e.detail.map(e=>{let r=Array.isArray(e.loc)?e.loc.join("."):e.loc||"",s=e.msg||e.message||"Validation error";return r?"".concat(r,": ").concat(s):s}).join("; ");if("string"==typeof e.detail)return e.detail;if("object"==typeof e.detail)return JSON.stringify(e.detail)}if(e.message&&"string"==typeof e.message)return e.message;if(e.error&&"string"==typeof e.error)return e.error;if(e.statusText&&"string"==typeof e.statusText)return e.statusText;try{let r=JSON.stringify(e);if(r.length>200)return"Complex error object (see console for details)";return r}catch(e){return"Unknown error (see console for details)"}}s.d(r,{PE:()=>t})},9484:(e,r,s)=>{s.d(r,{A:()=>u,O:()=>d});var t=s(4568),n=s(7620),a=s(2942),i=s(3237),o=s(704),l=s(3120);let c=(0,n.createContext)(void 0);function d(e){let{children:r}=e,[s,d]=(0,n.useState)(null),[u,h]=(0,n.useState)(!0),[m,g]=(0,n.useState)(null),x=(0,a.useRouter)();(0,n.useEffect)(()=>{let e=window.location.pathname;"/login"===e||e.startsWith("/manager")?h(!1):f();let r=localStorage.getItem("manager_token");r&&g(r)},[]);let f=async()=>{try{if(o.AQ.isAuthenticated()){let e=await o.AQ.auth.getMe();d(e)}}catch(e){console.error("Auth check failed:",e)}finally{h(!1)}},p=(0,n.useCallback)(async(e,r)=>{try{let s=localStorage.getItem("selectedAgentId");if(!s)throw Error("No agent selected");l._.configure(s);let t=await o.AQ.login(e,r),n=o.AQ.auth.getAccessToken();n&&l._.configure(s,n),d(t),i.Ay.success("Welcome, ".concat(t.username||t.user_id,"!")),x.push("/")}catch(e){throw i.Ay.error(e.message||"Login failed"),e}},[x]),b=(0,n.useCallback)(async()=>{try{await o.AQ.logout(),d(null),i.Ay.success("Logged out successfully"),x.push("/login")}catch(e){console.error("Logout failed:",e),i.Ay.error("Logout failed")}},[x]),v=(0,n.useCallback)(e=>!!s&&(s.permissions.includes(e)||"SYSTEM_ADMIN"===s.role),[s]),j=(0,n.useCallback)(e=>{if(!s)return!1;let r=["OBSERVER","ADMIN","AUTHORITY","SYSTEM_ADMIN"];return r.indexOf(s.role)>=r.indexOf(e)},[s]),y=(0,n.useCallback)(e=>{o.AQ.setConfig({authToken:e})},[]),N=(0,n.useCallback)(()=>!!m,[m]);return(0,t.jsx)(c.Provider,{value:{user:s,loading:u,login:p,logout:b,hasPermission:v,hasRole:j,setUser:d,setToken:y,managerToken:m,setManagerToken:g,isManagerAuthenticated:N},children:r})}function u(){let e=(0,n.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}}]);