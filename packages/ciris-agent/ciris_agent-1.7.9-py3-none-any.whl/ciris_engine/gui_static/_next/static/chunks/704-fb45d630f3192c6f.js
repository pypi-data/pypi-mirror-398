"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[704],{704:(t,e,s)=>{s.d(e,{AQ:()=>r.AQ,CIRISClient:()=>r.wG,Lb:()=>i.Lb,aS:()=>a.a,fz:()=>n.fz});var r=s(2987);s(3469),s(6690);var a=s(5950);s(3304);var n=s(9388),i=s(9684)},2987:(t,e,s)=>{s.d(e,{wG:()=>A,AQ:()=>L});var r=s(5950);class a{async checkLimit(t){let e=Date.now()/1e3;if(this.globalRemaining<=0&&e<this.globalReset)return!1;let s=this.getBucket(t);if(s.tokens<=0){let t=Math.floor((e-s.lastRefill)*(this.windowMs/1e3));t>0&&(s.tokens=Math.min(s.tokens+t,this.globalLimit),s.lastRefill=e)}return s.tokens>0}consumeToken(t){let e=this.getBucket(t);e.tokens=Math.max(0,e.tokens-1),this.globalRemaining=Math.max(0,this.globalRemaining-1)}updateFromHeaders(t){let e=e=>t instanceof Headers?t.get(e):t[e]||null,s=e("X-RateLimit-Limit"),r=e("X-RateLimit-Remaining"),a=e("X-RateLimit-Reset"),n=e("X-RateLimit-Window");s&&(this.globalLimit=parseInt(s,10)),r&&(this.globalRemaining=parseInt(r,10)),a&&(this.globalReset=parseInt(a,10)),n&&(this.windowMs=this.parseWindow(n))}getInfo(){return{limit:this.globalLimit,remaining:this.globalRemaining,reset:this.globalReset,window:"".concat(this.windowMs/1e3,"s")}}getRetryDelay(t){let e=Date.now()/1e3,s=Math.max(0,this.globalReset-e),r=this.baseDelayMs*Math.pow(2,t),a=.1*Math.random()*r;return Math.max(1e3*s,r+a)}getBucket(t){return this.buckets.has(t)||this.buckets.set(t,{tokens:this.globalLimit,lastRefill:Date.now()/1e3}),this.buckets.get(t)}parseWindow(t){let e=t.match(/^(\d+)([smh])$/);if(!e)return 6e4;let s=parseInt(e[1],10);switch(e[2]){case"s":return 1e3*s;case"m":return 60*s*1e3;case"h":return 60*s*6e4;default:return 6e4}}constructor(t=3,e=1e3){this.maxRetries=t,this.baseDelayMs=e,this.buckets=new Map,this.globalLimit=100,this.globalRemaining=100,this.globalReset=Date.now()/1e3,this.windowMs=6e4}}var n=s(6690);class i{async request(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this.buildURL(e,s.params),a=null;for(let i=0;i<this.maxRetries;i++)try{if(this.rateLimiter&&!await this.rateLimiter.checkLimit(e)){let t=this.rateLimiter.getRetryDelay(i);await this.delay(t);continue}let a=this.buildHeaders(s.headers,s.skipAuth),n={method:t,headers:a,signal:AbortSignal.timeout(this.timeout)};s.body&&"GET"!==t&&(n.body=JSON.stringify(s.body),e.includes("/consent/grant")&&console.log("[CIRIS SDK] Consent request payload:",{url:r,method:t,body:s.body,stringified:JSON.stringify(s.body)}));let o=await fetch(r,n);return this.rateLimiter&&this.rateLimiter.updateFromHeaders(o.headers),this.rateLimiter&&this.rateLimiter.consumeToken(e),await this.handleResponse(o,s.responseType)}catch(t){if(a=t,t instanceof n.VB)throw t;if(t instanceof Error&&"AbortError"===t.name&&(a=new n.Wr("Request to ".concat(e," timed out after ").concat(this.timeout,"ms"))),t instanceof TypeError&&t.message.includes("fetch")&&(a=new n.BK("Failed to connect to ".concat(this.baseURL))),i<this.maxRetries-1){let t=Math.min(1e3*Math.pow(2,i),1e4);await this.delay(t);continue}}throw a||new n.BK("Request failed after retries")}async handleResponse(t){let e,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"json";if(204===t.status)return null;if(401===t.status){console.error("401 Error Details:",{url:t.url,headers:Object.fromEntries(t.headers.entries()),status:t.status,statusText:t.statusText});try{let e=await t.json();console.error("401 Error Response:",e)}catch(t){console.error("Could not parse 401 error response")}throw r.a.clearToken(),this.onAuthError&&this.onAuthError(),new n.VB("Authentication failed")}if(429===t.status){let e=parseInt(t.headers.get("Retry-After")||"60",10),s=parseInt(t.headers.get("X-RateLimit-Limit")||"100",10),r=t.headers.get("X-RateLimit-Window")||"1m";throw new n.QX(e,s,r)}if(t.ok&&"json"!==s){if("blob"===s)return await t.blob();else if("text"===s)return await t.text()}let a="";try{e=(a=await t.text())?JSON.parse(a):{}}catch(s){if(console.error("[CIRIS SDK] Failed to parse JSON response:",{status:t.status,statusText:t.statusText,url:t.url,responseText:a.substring(0,500),error:s}),t.ok){if(a.includes("<!DOCTYPE")||a.includes("<html"))throw new n.N3(t.status,"Received HTML instead of JSON. The API endpoint may be incorrect or the server may be returning an error page.",a.substring(0,200));if(!a||""===a.trim())return{};throw new n.N3(t.status,"Failed to parse response as JSON",a.substring(0,200))}let e="HTTP ".concat(t.status," error");if(a.includes("<!DOCTYPE")||a.includes("<html")){let t=a.match(/<title>(.*?)<\/title>/i);t&&(e=t[1])}else a&&(e=a.substring(0,200));throw new n.N3(t.status,e,"Response was not valid JSON. This might indicate the API is down, the endpoint is incorrect, or there is a server error.")}if(!t.ok){let s=e;if(422===t.status&&console.error("[CIRIS SDK] 422 Validation Error:",{url:t.url,status:t.status,errorData:e,detail:s.detail,rawData:JSON.stringify(e)}),422===t.status&&Array.isArray(s.detail)){let e=s.detail.map(t=>{let e=Array.isArray(t.loc)?t.loc.join("."):t.loc;return"".concat(e,": ").concat(t.msg)}).join("; ");throw new n.N3(t.status,e||"Validation error",e,"validation_error")}if(403===t.status&&"error"in e&&"insufficient_permissions"===e.error){console.log("[CIRIS SDK] Creating PermissionDeniedError with Discord invite:",{message:e.message||s.detail||"Permission denied",discordInvite:e.discord_invite,canRequestPermissions:e.can_request_permissions,permissionRequested:e.permission_requested,requestedAt:e.requested_at});let t=new n.H7(e.message||s.detail||"Permission denied",e.discord_invite,e.can_request_permissions,e.permission_requested,e.requested_at);throw console.log("[CIRIS SDK] Throwing PermissionDeniedError:",t),t}throw new n.N3(t.status,s.detail||"HTTP ".concat(t.status," error"),s.detail,s.type)}return this.isSuccessResponse(e)?e.data:e}isSuccessResponse(t){return"object"==typeof t&&null!==t&&"data"in t&&"metadata"in t}buildURL(t,e){let s;if(t.startsWith("http://")||t.startsWith("https://"))s=new URL(t);else if(this.baseURL&&""!==this.baseURL)s=new URL(t.startsWith("/")?t.slice(1):t,this.baseURL.endsWith("/")?this.baseURL:this.baseURL+"/");else{let e=window.location.origin;s=new URL(t.startsWith("/")?t:"/"+t,e)}return e&&Object.entries(e).forEach(t=>{let[e,r]=t;null!=r&&s.searchParams.append(e,String(r))}),s.toString()}buildHeaders(t,e){let s={"Content-Type":"application/json",Accept:"application/json",...t};if(!e){let t=r.a.getAccessToken();if(t&&t===localStorage.getItem("manager_token"))return console.warn("[CIRIS SDK] Detected manager token, skipping auth for CIRIS SDK request"),s;t&&(s.Authorization="Bearer ".concat(t))}return s}delay(t){return new Promise(e=>setTimeout(e,t))}async get(t,e){return this.request("GET",t,e)}async post(t,e,s){return this.request("POST",t,{...s,body:e})}async put(t,e,s){return this.request("PUT",t,{...s,body:e})}async patch(t,e,s){return this.request("PATCH",t,{...s,body:e})}async delete(t,e){return this.request("DELETE",t,e)}setBaseURL(t){this.baseURL=t.replace(/\/$/,"")}getBaseURL(){return this.baseURL}setAuthToken(t){if(t){let e=r.a.getToken();e&&e.access_token===t||r.a.saveToken({access_token:t,token_type:"Bearer",expires_in:86400,user_id:"",role:"",created_at:Date.now()})}else r.a.clearToken()}constructor(t){this.baseURL=t.baseURL.replace(/\/$/,""),this.timeout=t.timeout||6e4,this.maxRetries=t.maxRetries||3,this.onAuthError=t.onAuthError,t.enableRateLimiting&&(this.rateLimiter=new a(this.maxRetries))}}var o=s(3304),c=s(5663);class u extends c.Q{async submitMessage(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.transport.post("/v1/agent/message",{message:t,channel_id:e.channel_id||"web_ui",context:e.context})}async interact(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.transport.post("/v1/agent/interact",{message:t,channel_id:e.channel_id||"web_ui",context:e.context})}async getStatus(){return this.transport.get("/v1/agent/status")}async getIdentity(){return this.transport.get("/v1/agent/identity")}async getHistory(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.transport.get("/v1/agent/history",{params:{channel_id:t.channel_id,limit:t.limit||50,offset:t.offset||0}})}async getChannels(){return(await this.transport.get("/v1/agent/channels")).channels||[]}async clearHistory(t){return this.transport.delete("/v1/agent/history/".concat(t))}async getMessage(t){return this.transport.get("/v1/agent/message/".concat(t))}}class l extends c.Q{async getHealth(){return this.transport.get("/v1/system/health")}async getServices(){return this.transport.get("/v1/system/services")}async getResources(){return this.transport.get("/v1/system/resources")}async pauseRuntime(){var t;let e=await this.transport.post("/v1/system/runtime/pause",{}),s=e.data||e;return{status:s.success?"success":"error",message:s.message||"Runtime paused",timestamp:(null==(t=e.metadata)?void 0:t.timestamp)||new Date().toISOString(),processor_state:s.processor_state,cognitive_state:s.cognitive_state}}async resumeRuntime(){var t;let e=await this.transport.post("/v1/system/runtime/resume",{}),s=e.data||e;return{status:s.success?"success":"error",message:s.message||"Runtime resumed",timestamp:(null==(t=e.metadata)?void 0:t.timestamp)||new Date().toISOString(),processor_state:s.processor_state,cognitive_state:s.cognitive_state}}async getRuntimeStatus(){let t=await this.transport.post("/v1/system/runtime/state",{});return{is_paused:"paused"===t.processor_state,processor_status:t.processor_state,health_status:"healthy",uptime_seconds:0,active_adapters:[],loaded_adapters:[]}}async getRuntimeState(){try{let[t,e]=await Promise.all([this.transport.get("/v1/system/health").catch(()=>null),this.transport.get("/v1/system/runtime/queue").catch(()=>null)]),s=(null==t?void 0:t.data)||t,r=(null==e?void 0:e.data)||e;return{success:!0,message:"Runtime state retrieved",processor_state:"running",cognitive_state:(null==s?void 0:s.cognitive_state)||"work",queue_depth:(null==r?void 0:r.queue_size)||0}}catch(t){return{success:!1,message:"Failed to retrieve runtime state",processor_state:"unknown",cognitive_state:"work",queue_depth:0}}}async pauseProcessor(t,e){return this.transport.post("/v1/system/processors/".concat(t,"/pause"),{duration:e})}async resumeProcessor(t){return this.transport.post("/v1/system/processors/".concat(t,"/resume"))}async getAdapters(){return this.transport.get("/v1/system/adapters")}async getAdapter(t){return this.transport.get("/v1/system/adapters/".concat(t))}async registerAdapter(t,e){return this.transport.post("/v1/system/adapters/".concat(t),{config:e})}async unregisterAdapter(t){return this.transport.delete("/v1/system/adapters/".concat(t))}async reloadAdapter(t){return this.transport.put("/v1/system/adapters/".concat(t,"/reload"))}async restartService(t){return this.transport.post("/v1/system/services/".concat(t,"/restart"))}async pauseAdapter(t,e){return this.transport.post("/v1/system/adapters/".concat(t,"/pause"),{duration:e})}async resumeAdapter(t){return this.transport.post("/v1/system/adapters/".concat(t,"/resume"))}async getProcessingQueueStatus(){return this.transport.get("/v1/system/runtime/queue")}async singleStepProcessor(){return this.transport.post("/v1/system/runtime/step")}async singleStepProcessorEnhanced(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0],e=await this.transport.post(t?"/v1/system/runtime/step?include_details=true":"/v1/system/runtime/step",{}),s=e.data||e;return{success:s.success||!1,message:s.message||"Single step completed",step_point:s.step_point||null,step_result:s.step_result||null,processing_time_ms:s.processing_time_ms||0,tokens_used:s.tokens_used||0,processor_state:s.processor_state||"unknown",cognitive_state:s.cognitive_state||"work",queue_depth:s.queue_depth||0,pipeline_state:s.pipeline_state||null,demo_data:s.demo_data||null}}async getServiceHealthDetails(){return this.transport.get("/v1/system/services/health")}async updateServicePriority(t,e){return this.transport.put("/v1/system/services/".concat(t,"/priority"),e)}async resetCircuitBreakers(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.transport.post("/v1/system/services/circuit-breakers/reset",t)}async getServiceSelectionExplanation(){return this.transport.get("/v1/system/services/selection-logic")}async getProcessorStates(){return this.transport.get("/v1/system/processors")}async transitionState(t){let e=await this.transport.post("/v1/system/state/transition",t);return e.data||e}async getTime(){return this.transport.get("/v1/system/time")}async shutdown(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.transport.post("/v1/system/shutdown",{reason:t,confirm:e,force:s})}async getTools(){return this.transport.get("/v1/system/tools")}}class h extends c.Q{async query(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=t&&(t.toLowerCase().startsWith("metric_")||t.toLowerCase().startsWith("audit_")||t.toLowerCase().startsWith("log_")||t.toLowerCase().startsWith("dream_schedule_")||t.toLowerCase().startsWith("thought_")||t.toLowerCase().startsWith("thought/")||t.toLowerCase().startsWith("task_")||t.toLowerCase().startsWith("observation_")||t.toLowerCase().startsWith("concept_")||t.toLowerCase().startsWith("identity_")||t.toLowerCase().startsWith("config_")||t.toLowerCase().startsWith("config:")||t.toLowerCase().startsWith("tsdb_data_")||t.toLowerCase().startsWith("conversation_summary_")||t.toLowerCase().startsWith("trace_summary_")||t.toLowerCase().startsWith("audit_summary_")||t.toLowerCase().startsWith("tsdb_summary_")||t.toLowerCase().startsWith("user_")||t.toLowerCase().startsWith("user/")||t.toLowerCase().startsWith("shutdown_")||t.toLowerCase().startsWith("edge_")||t.toLowerCase().startsWith("datum-")||/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/.test(t)||t.includes("_")&&!t.startsWith("_")&&/\d{10}/.test(t)),r={...s?{node_id:t}:{query:t},...e};console.log("Memory query:",{query:t,isNodeId:s,body:r});let a=await this.transport.post("/v1/memory/query",r);return console.log("Memory query response:",a),Array.isArray(a)?a:a.data||a}async getNode(t){return this.transport.get("/v1/memory/".concat(encodeURIComponent(t)))}async recall(t){return this.transport.get("/v1/memory/recall/".concat(encodeURIComponent(t)))}async createNode(t){return this.transport.post("/v1/memory/store",t)}async updateNode(t,e){return this.transport.patch("/v1/memory/".concat(encodeURIComponent(t)),e)}async deleteNode(t){return this.transport.delete("/v1/memory/".concat(encodeURIComponent(t)))}async getStats(){return this.transport.get("/v1/memory/stats")}async search(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(await this.transport.post("/v1/memory/query",{query:t,...e})).results||[]}async getTimeline(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.transport.get("/v1/memory/timeline",{params:t})}async getRelated(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.transport.get("/v1/memory/".concat(encodeURIComponent(t),"/related"),{params:e})}async getVisualization(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await this.transport.get("/v1/memory/visualize/graph",{params:t,responseType:"text"})}async createEdge(t){return this.transport.post("/v1/memory/edges",{edge:t})}async getNodeEdges(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"local";return this.transport.get("/v1/memory/".concat(encodeURIComponent(t),"/edges"),{params:{scope:e}})}async queryWithEdges(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.query(t,{...e,include_edges:!0})}}class p extends c.Q{async getEntries(t){var e;let s=await this.transport.get("/v1/audit/entries",t);return{items:s.entries||[],total:(null==(e=s.entries)?void 0:e.length)||0,page:(null==t?void 0:t.page)||1,page_size:(null==t?void 0:t.page_size)||100,has_next:!1,has_prev:!1}}async getEntry(t){return this.transport.get("/v1/audit/entries/".concat(t))}async exportEntries(t){return await this.transport.get("/v1/audit/export",{...t,responseType:"blob"})}async searchEntries(t){return this.transport.post("/v1/audit/search",t||{})}async verifyEntry(t){return this.transport.get("/v1/audit/verify/".concat(t))}}var g=s(9388);class d extends c.Q{async getLogs(t,e,s){return"string"==typeof t||void 0===t?(await this.transport.get("/v1/telemetry/logs",{params:{level:t,service:e,limit:s||100}})).logs||[]:this.transport.get("/v1/telemetry/logs",t)}async getMetrics(t){return this.transport.get("/v1/telemetry/metrics",t)}async getMetricDetail(t){return this.transport.get("/v1/telemetry/metrics/".concat(t))}async getOverview(t){return this.transport.get("/v1/telemetry/overview",t)}async query(t){return this.transport.post("/v1/telemetry/query",t)}async getResources(){return this.transport.get("/v1/telemetry/resources")}async getResourceHistory(t){return this.transport.get("/v1/telemetry/resources/history",t)}async getTraces(t){return this.transport.get("/v1/telemetry/traces",t)}async getIncidents(t){return(await this.transport.get("/v1/telemetry/logs",{params:{level:"ERROR",limit:(null==t?void 0:t.limit)||50,service:null==t?void 0:t.service}})).logs||[]}}class m extends c.Q{async getDeferrals(t){return(await this.transport.get("/v1/wa/deferrals",t)).deferrals||[]}async resolveDeferral(t,e,s,r){return this.transport.post("/v1/wa/deferrals/".concat(t,"/resolve"),{resolution:"deny"===e?"reject":e,guidance:s})}async requestGuidance(t){return this.transport.post("/v1/wa/guidance",t)}async getPermissions(t){return this.transport.get("/v1/wa/permissions",t)}async getStatus(){return this.transport.get("/v1/wa/status")}}class y extends c.Q{async shutdown(t){return this.transport.post("/emergency/shutdown",t,{skipAuth:!0,headers:{"X-Emergency-Signature":t.signature}})}async test(){return this.transport.get("/emergency/test")}}class v extends c.Q{async list(t){return this.transport.get("/v1/users",{params:t})}async get(t){return this.transport.get("/v1/users/".concat(t))}async create(t){return this.transport.post("/v1/users",t)}async update(t,e){return this.transport.put("/v1/users/".concat(t),e)}async changePassword(t,e){return this.transport.put("/v1/users/".concat(t,"/password"),e)}async mintWiseAuthority(t,e){return this.transport.post("/v1/users/".concat(t,"/mint-wa"),e)}async deactivate(t){return this.transport.delete("/v1/users/".concat(t))}async listAPIKeys(t){return this.transport.get("/v1/users/".concat(t,"/api-keys"))}async checkWAKeyExists(t){return this.transport.get("/v1/users/wa/key-check",{params:{path:t}})}async requestPermissions(){return this.transport.post("/v1/users/request-permissions")}async getPermissionRequests(){return this.transport.get("/v1/users/permission-requests")}async grantPermissions(t,e){return this.transport.put("/v1/users/".concat(t,"/permissions"),e)}async linkOAuthAccount(t,e){return this.transport.post("/v1/users/".concat(t,"/oauth-links"),e)}async unlinkOAuthAccount(t,e,s){return this.transport.delete("/v1/users/".concat(t,"/oauth-links/").concat(e,"/").concat(s))}async getMySettings(){return this.transport.get("/v1/users/me/settings")}async updateMySettings(t){return this.transport.put("/v1/users/me/settings",t)}}class w extends c.Q{async listAgents(){let t="".concat(window.location.origin,"/manager/v1/agents");return(await this.transport.request("GET",t,{skipAuth:!0})).agents||[]}async getAgent(t){let e="".concat(window.location.origin,"/manager/v1/agents/").concat(t);return this.transport.request("GET",e,{skipAuth:!0})}async health(){let t="".concat(window.location.origin,"/manager/v1/health");return this.transport.request("GET",t,{skipAuth:!0})}}var _=s(9684);class R extends c.Q{async submitRequest(t){return this.transport.post("/v1/dsr/submit",t,{skipAuth:!0})}async checkStatus(t){return this.transport.get("/v1/dsr/status/".concat(t),{skipAuth:!0})}async listRequests(){return this.transport.get("/v1/dsr/admin/requests")}async updateRequest(t,e,s){return this.transport.put("/v1/dsr/admin/requests/".concat(t),{status:e,response:s})}}class f extends c.Q{async getCredits(){return this.transport.get("/v1/api/billing/credits")}async initiatePurchase(t){return this.transport.post("/v1/api/billing/purchase/initiate",t||{})}async getPurchaseStatus(t){return this.transport.get("/v1/api/billing/purchase/status/".concat(t))}async getTransactions(t){let e=new URLSearchParams;(null==t?void 0:t.limit)&&e.append("limit",t.limit.toString()),(null==t?void 0:t.offset)&&e.append("offset",t.offset.toString());let s=e.toString();return this.transport.get("/v1/api/billing/transactions".concat(s?"?".concat(s):""))}}class k extends c.Q{async getStatus(){return this.transport.get("/v1/setup/status")}async getProviders(){return this.transport.get("/v1/setup/providers")}async validateLLM(t){return this.transport.post("/v1/setup/validate-llm",t)}async getTemplates(){return this.transport.get("/v1/setup/templates")}async getAdapters(){return this.transport.get("/v1/setup/adapters")}async complete(t){return this.transport.post("/v1/setup/complete",t)}async getConfig(){return this.transport.get("/v1/setup/config")}async updateConfig(t){return this.transport.put("/v1/setup/config",t)}}var S=s(9664);s(3469);var b=s(4338);class A{async login(t,e){return this.auth.login(t,e)}async logout(){return this.auth.logout()}isAuthenticated(){return this.auth.isAuthenticated()}getCurrentUser(){return this.auth.getCurrentUser()}setConfig(t){t.baseURL&&this.transport.setBaseURL(t.baseURL),void 0!==t.authToken&&this.transport.setAuthToken(t.authToken)}getVersion(){return S.MF}getVersionString(){return S.MF.version}setBaseURL(t){this.transport.setBaseURL(t)}getBaseURL(){return this.transport.getBaseURL()}withConfig(t){let e=new A({baseURL:t.baseURL||this.transport.getBaseURL(),timeout:t.timeout,maxRetries:t.maxRetries,enableRateLimiting:t.enableRateLimiting,onAuthError:t.onAuthError});return t.authToken&&e.transport.setAuthToken(t.authToken),e}async interact(t,e){return this.agent.interact(t,e)}async getStatus(){return this.agent.getStatus()}async getHealth(){return this.system.getHealth()}constructor(t={}){let e;e="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?b.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:8080":"";let s={baseURL:t.baseURL||e,timeout:t.timeout,maxRetries:t.maxRetries,enableRateLimiting:!1!==t.enableRateLimiting,onAuthError:t.onAuthError||(()=>{"/login"!==window.location.pathname&&(window.location.href="/login")})};this.transport=new i(s),this.auth=new o.p(this.transport),this.agent=new u(this.transport),this.system=new l(this.transport),this.memory=new h(this.transport),this.audit=new p(this.transport),this.config=new g.xt(this.transport),this.telemetry=new d(this.transport),this.wiseAuthority=new m(this.transport),this.emergency=new y(this.transport),this.users=new v(this.transport),this.manager=new w(this.transport),this.consent=new _.jv(this.transport),this.dsar=new R(this.transport),this.billing=new f(this.transport),this.setup=new k(this.transport)}}let L=(()=>{let t;return console.log("[CIRIS SDK] Creating default client with baseURL:",t="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?b.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:8080":""),new A({baseURL:t})})()},3304:(t,e,s)=>{s.d(e,{p:()=>i});var r=s(5663),a=s(5950),n=s(6690);class i extends r.Q{async login(t,e){try{let s=await this.transport.post("/v1/auth/login",{username:t,password:e},{skipAuth:!0}),r={access_token:s.access_token,token_type:s.token_type,expires_in:s.expires_in,user_id:s.user_id,role:s.role,created_at:Date.now()};a.a.saveToken(r);let n=await this.getMe();return a.a.saveUser(n),n}catch(t){throw new n.VB(this.buildErrorMessage("login",t.message))}}async logout(){try{await this.transport.post("/v1/auth/logout")}catch(t){}finally{a.a.clearToken()}}async getMe(){return this.transport.get("/v1/auth/me")}isAuthenticated(){return a.a.isAuthenticated()}getCurrentUser(){return a.a.getUser()}getAccessToken(){return a.a.getAccessToken()}async refresh(){try{let t=await this.transport.post("/v1/auth/refresh"),e={access_token:t.access_token,token_type:t.token_type,expires_in:t.expires_in,user_id:t.user_id,role:t.role,created_at:Date.now()};return a.a.saveToken(e),t}catch(t){throw new n.VB(this.buildErrorMessage("refresh",t.message))}}async listOAuthProviders(){return this.transport.get("/v1/auth/oauth/providers")}async configureOAuthProvider(t,e,s,r){return this.transport.post("/v1/auth/oauth/providers",{provider:t,client_id:e,client_secret:s,metadata:r||void 0})}async initiateOAuthLogin(t,e){return this.transport.get("/v1/auth/oauth/".concat(t,"/login"),{params:e?{redirect_uri:e}:void 0,skipAuth:!0})}async handleOAuthCallback(t,e,s){try{let r=await this.transport.get("/v1/auth/oauth/".concat(t,"/callback"),{params:{code:e,state:s},skipAuth:!0}),n={access_token:r.access_token,token_type:r.token_type,expires_in:r.expires_in,user_id:r.user_id,role:r.role,created_at:Date.now()};a.a.saveToken(n);let i=await this.getMe();return a.a.saveUser(i),i}catch(t){throw new n.VB(this.buildErrorMessage("OAuth callback",t.message))}}async createAPIKey(t,e){return this.transport.post("/v1/auth/api-keys",{description:t,expires_in_minutes:e})}async listAPIKeys(){return this.transport.get("/v1/auth/api-keys")}async deleteAPIKey(t){return this.transport.delete("/v1/auth/api-keys/".concat(t))}}},3469:(t,e,s)=>{},5663:(t,e,s)=>{s.d(e,{Q:()=>r});class r{buildErrorMessage(t,e){let s="Failed to ".concat(t);return e?"".concat(s,": ").concat(e):s}constructor(t){this.transport=t}}},5950:(t,e,s)=>{s.d(e,{a:()=>a});var r=s(7932);class a{static saveToken(t){{let e={...t,created_at:Date.now()};window.localStorage&&localStorage.setItem(this.STORAGE_KEY,JSON.stringify(e)),r.A.set("auth_token",t.access_token,{expires:t.expires_in/86400})}}static getToken(){if(!window.localStorage)return null;let t=localStorage.getItem(this.STORAGE_KEY);if(!t)return null;try{let e=JSON.parse(t),s=e.created_at+1e3*e.expires_in;if(Date.now()>s)return this.clearToken(),null;return e}catch(t){return this.clearToken(),null}}static clearToken(){window.localStorage&&(localStorage.removeItem(this.STORAGE_KEY),localStorage.removeItem(this.USER_KEY)),r.A.remove("auth_token")}static saveUser(t){window.localStorage&&localStorage.setItem(this.USER_KEY,JSON.stringify(t))}static getUser(){if(!window.localStorage)return null;let t=localStorage.getItem(this.USER_KEY);if(!t)return null;try{return JSON.parse(t)}catch(t){return null}}static isAuthenticated(){return null!==this.getToken()}static getAccessToken(){let t=this.getToken();return t?t.access_token:r.A.get("auth_token")||null}}a.STORAGE_KEY="ciris_auth_token",a.USER_KEY="ciris_auth_user"},6690:(t,e,s)=>{s.d(e,{BK:()=>i,H7:()=>u,N3:()=>a,QX:()=>c,VB:()=>n,Wr:()=>o});class r extends Error{constructor(t){super(t),this.name="CIRISError"}}class a extends r{constructor(t,e,s,r){super(e),this.status=t,this.detail=s,this.type=r,this.name="CIRISAPIError"}}class n extends r{constructor(t){super(t),this.name="CIRISAuthError"}}class i extends r{constructor(t){super(t),this.name="CIRISConnectionError"}}class o extends r{constructor(t){super(t),this.name="CIRISTimeoutError"}}class c extends a{constructor(t,e,s){super(429,"Rate limit exceeded. Retry after ".concat(t," seconds")),this.retryAfter=t,this.limit=e,this.window=s,this.name="CIRISRateLimitError"}}class u extends a{constructor(t,e,s,r,a){super(403,t),this.name="CIRISPermissionDeniedError",this.discordInvite=e,this.canRequestPermissions=s,this.permissionRequested=r,this.requestedAt=a}}},9388:(t,e,s)=>{s.d(e,{fz:()=>a,xt:()=>n});var r=s(5663);function a(t){return t?null!==t.string_value&&void 0!==t.string_value?t.string_value:null!==t.int_value&&void 0!==t.int_value?t.int_value:null!==t.float_value&&void 0!==t.float_value?t.float_value:null!==t.bool_value&&void 0!==t.bool_value?t.bool_value:null!==t.list_value&&void 0!==t.list_value?t.list_value:null!==t.dict_value&&void 0!==t.dict_value?t.dict_value:null:null}class n extends r.Q{async getAll(){return this.transport.get("/v1/config")}async updateMultiple(t){let e=await Promise.allSettled(Object.entries(t).map(t=>{let[e,s]=t;return this.set(e,s)})),s=[],r=[];return e.forEach((e,a)=>{let n=Object.keys(t)[a];"fulfilled"===e.status?s.push(n):r.push(n)}),{success:0===r.length,updated:s,failed:r,message:0===r.length?"All configurations updated":"".concat(r.length," updates failed")}}async get(t){return this.transport.get("/v1/config/".concat(t))}async set(t,e,s){return this.transport.put("/v1/config/".concat(t),{value:e,reason:s})}async delete(t){return this.transport.delete("/v1/config/".concat(t))}async getConfig(){let t=await this.getAll(),e={};return t.configs.forEach(t=>{e[t.key]=a(t.value)}),e}async updateConfig(t){return this.updateMultiple(t)}async getConfigByKey(t){let e=await this.get(t);return{key:e.key,value:a(e.value),updated_at:e.updated_at,updated_by:e.updated_by}}async updateConfigByKey(t,e,s){let r=await this.set(t,e,s);return{success:!0,key:r.key,new_value:a(r.value),message:"Configuration updated successfully"}}async getByPrefix(t){return this.transport.get("/v1/config?prefix=".concat(encodeURIComponent(t)))}}},9664:(t,e,s)=>{s.d(e,{MF:()=>a});var r=s(4338);let a={version:r.env.NEXT_PUBLIC_APP_VERSION,buildDate:new Date().toISOString(),gitHash:r.env.NEXT_PUBLIC_GIT_HASH||"development",gitBranch:r.env.NEXT_PUBLIC_GIT_BRANCH||"main"}},9684:(t,e,s)=>{s.d(e,{Lb:()=>a,jv:()=>n});var r=s(5663),a=function(t){return t.INTERACTION="interaction",t.PREFERENCE="preference",t.IMPROVEMENT="improvement",t.RESEARCH="research",t.SHARING="sharing",t}({});class n extends r.Q{async getStatus(){return this.transport.get("/v1/consent/status")}async grantConsent(t){let e=await this.transport.get("/v1/auth/me"),s={...t,user_id:e.user_id};return this.transport.post("/v1/consent/grant",s)}async revokeConsent(t){return this.transport.post("/v1/consent/revoke",{reason:t})}async getImpactReport(){return this.transport.get("/v1/consent/impact")}async getAuditTrail(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this.transport.get("/v1/consent/audit?limit=".concat(t))}async getStreams(){return this.transport.get("/v1/consent/streams")}async getCategories(){return this.transport.get("/v1/consent/categories")}async getPartnershipStatus(){return this.transport.get("/v1/consent/partnership/status")}async cleanupExpired(){return this.transport.post("/v1/consent/cleanup",{})}async requestPartnership(t,e){return this.grantConsent({stream:"partnered",categories:t,reason:e||"User requested partnership upgrade"})}async switchToTemporary(){return this.grantConsent({stream:"temporary",categories:[],reason:"User switched to temporary consent"})}async switchToAnonymous(){return this.grantConsent({stream:"anonymous",categories:[],reason:"User switched to anonymous consent"})}async hasPartnership(){return"partnered"===(await this.getStatus()).stream}async getTimeRemaining(){let t=await this.getStatus();return"temporary"===t.stream&&t.expires_at?Math.max(0,new Date(t.expires_at).getTime()-Date.now()):null}async pollPartnershipStatus(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60,s=0;for(;s<e;){let e=await this.getPartnershipStatus();if(t&&t(e),"pending"!==e.partnership_status)return e;await new Promise(t=>setTimeout(t,5e3)),s++}return this.getPartnershipStatus()}async initiateDSARExport(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"full";return this.transport.post("/v1/consent/dsar/initiate",{request_type:t})}async getDSARStatus(t){return this.transport.get("/v1/consent/dsar/status/".concat(t))}async downloadConsentData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"full",e=await this.initiateDSARExport(t),s=new Blob([JSON.stringify(e.export_data,null,2)],{type:"application/json"}),r=URL.createObjectURL(s),a=document.createElement("a");return a.href=r,a.download="ciris-consent-export-".concat(e.request_id,".json"),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(r),e.request_id}}}}]);