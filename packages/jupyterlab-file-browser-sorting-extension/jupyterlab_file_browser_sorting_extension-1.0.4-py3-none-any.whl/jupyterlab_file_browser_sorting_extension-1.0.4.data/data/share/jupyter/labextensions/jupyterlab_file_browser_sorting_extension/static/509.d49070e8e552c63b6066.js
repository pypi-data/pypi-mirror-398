"use strict";(self.webpackChunkjupyterlab_file_browser_sorting_extension=self.webpackChunkjupyterlab_file_browser_sorting_extension||[]).push([[509],{509(t,e,o){o.r(e),o.d(e,{default:()=>d});var n=o(780),r=o(223);const i="jupyterlab_file_browser_sorting_extension:plugin",s="filebrowser:toggle-unix-sorting";let a=!1,c=!0;function l(t,e){const o=[...t],n="descending"===e.direction?-1:1;function r(t){return"directory"===t.type?0:a&&"notebook"===t.type?1:2}return o.sort((t,o)=>{var i,s;const a=r(t),l=r(o);if(a!==l)return a-l;let d;return d="last_modified"===e.key?new Date(t.last_modified).getTime()-new Date(o.last_modified).getTime():"file_size"===e.key?(null!==(i=o.size)&&void 0!==i?i:0)-(null!==(s=t.size)&&void 0!==s?s:0):function(t,e){return c?function(t,e){const o=t.length,n=e.length,r=Math.min(o,n);for(let o=0;o<r;o++){const n=t.charCodeAt(o),r=e.charCodeAt(o);if(n!==r)return n-r}return o-n}(t.name,e.name):function(t,e){return t.localeCompare(e,void 0,{numeric:!0,sensitivity:"base"})}(t.name,e.name)}(t,o),d*n}),o}const d={id:i,description:"LC_COLLATE=C file browser sorting",autoStart:!0,requires:[n.IFileBrowserFactory],optional:[r.ISettingRegistry],activate:(t,e,o)=>{const{commands:n}=t,{tracker:r}=e,d=new WeakSet;function u(){r.forEach(t=>{var e;(e=t.listing)&&e.sortState&&e.sort(e.sortState)})}function f(t){const e=t.listing;e&&function(t){if(!t||d.has(t))return;d.add(t);let e=[];Object.defineProperty(t,"sortedItems",{get:function(){return e},configurable:!0});const o=t.sort.bind(t);t.sort=function(t){const n=this.model;if(!n)return void o(t);const r=Array.from(n.items());if(0===r.length)return this._sortState=t,e=[],this._sortedItems=[],void o(t);const i=l(r,t);e=i,this._sortedItems=i,this._sortState=t,this.update()};const n=t.model;n&&n.refreshed&&n.refreshed.connect(()=>{t.sortState&&t.sort(t.sortState)}),t.sortState&&t.sort(t.sortState)}(e)}o&&(o.load("@jupyterlab/filebrowser-extension:browser").then(t=>{var e;a=null!==(e=t.get("sortNotebooksFirst").composite)&&void 0!==e&&e,t.changed.connect(()=>{var e;a=null!==(e=t.get("sortNotebooksFirst").composite)&&void 0!==e&&e})}).catch(()=>{}),o.load(i).then(t=>{var e;c=null===(e=t.get("useCLocaleSorting").composite)||void 0===e||e,t.changed.connect(()=>{var e;const o=null===(e=t.get("useCLocaleSorting").composite)||void 0===e||e;c=o,u()})}).catch(()=>{})),n.addCommand(s,{label:"Unix Style Sorting",caption:"Sort: dot files first, uppercase before lowercase",isToggleable:!0,isToggled:()=>c,execute:async()=>{if(o){const t=await o.load(i);await t.set("useCLocaleSorting",!c)}else c=!c,u()}}),t.contextMenu.addItem({command:s,selector:".jp-DirListing-item",rank:100}),t.contextMenu.addItem({command:s,selector:".jp-DirListing",rank:100}),t.restored.then(()=>{r.forEach(f),r.widgetAdded.connect((t,e)=>{f(e)})})}}}}]);