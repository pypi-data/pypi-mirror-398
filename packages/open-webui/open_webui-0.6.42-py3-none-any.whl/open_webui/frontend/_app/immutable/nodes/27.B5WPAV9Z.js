import"../chunks/CWj6FrbW.js";import"../chunks/CN51-NxK.js";import{b as ve,g as ge,o as Ee,aX as N,j as e,c as o,r as s,k as C,aY as ne,i as d,t as _,u as ie,w as g,s as j,l as H,a as y,p as ue,f as z,m as $,q as qe,v as Fe,aW as Je,x as K,z as Se,e as Le}from"../chunks/lUdQH9Xf.js";import{i as Q}from"../chunks/a8_cTibZ.js";import{e as Me,i as je}from"../chunks/CyDjujdM.js";import{a as Y,d as Xe,s as Ze}from"../chunks/AGdekky4.js";import{b as de}from"../chunks/gZt8HVPH.js";import{b as ce}from"../chunks/D72e2DEW.js";import{i as fe}from"../chunks/VsCEtJ32.js";import{a as W,s as ze}from"../chunks/CcA7kcll.js";import{t as Ge}from"../chunks/1N3xujas.js";import{g as Ke}from"../chunks/CeIFb-7H.js";import{b as Qe}from"../chunks/BJunrENY.js";import{u as Ve,b as et,c as tt,a as st}from"../chunks/CQ5nDkjA.js";import{c as at}from"../chunks/DrHmROi9.js";import{n as rt}from"../chunks/BXNnaNI-.js";import{C as ot}from"../chunks/DF5UxXSC.js";import{p as V}from"../chunks/wFFmXPqF.js";import{C as lt}from"../chunks/BEWIE6Ek.js";import{P as it}from"../chunks/C2a4pS38.js";var nt=z('<div class="flex gap-2 group"><div class="flex items-start pt-1"><div class="px-2 py-1 text-sm font-semibold uppercase min-w-[6rem] text-left rounded-lg transition"> </div></div> <div class="flex-1"><textarea class="w-full bg-transparent outline-hidden rounded-lg p-2 text-sm resize-none overflow-hidden" rows="1"></textarea></div> <div class=" pt-1"><button class=" group-hover:text-gray-500 dark:text-gray-500 dark:hover:text-gray-300 transition"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M15 12H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"></path></svg></button></div></div>');function dt(U,S){ve(S,!1);const r=()=>W(R,"$i18n",E),[E,q]=ze(),R=ge("i18n");let u=V(S,"message",12),T=V(S,"idx",8),F=V(S,"onDelete",8),c=$();Ee(()=>{N(c,e(c).style.height=""),N(c,e(c).style.height=e(c).scrollHeight+"px")}),fe();var m=nt(),A=o(m),B=o(A),w=o(B,!0);s(B),s(A);var D=C(A,2),f=o(D);ne(f),ce(f,p=>d(c,p),()=>e(c)),s(D);var k=C(D,2),h=o(k);s(k),s(m),_((p,v)=>{j(w,p),Y(f,"id",`${ie(u()),g(()=>u().role)??""}-${T()??""}-textarea`),Y(f,"placeholder",v)},[()=>(r(),ie(u()),g(()=>r().t(u().role))),()=>(r(),ie(u()),g(()=>r().t("Enter {{role}} message here",{role:u().role==="user"?r().t("a user"):r().t("an assistant")})))]),H("input",f,p=>{N(c,e(c).style.height=""),N(c,e(c).style.height=e(c).scrollHeight+"px")}),H("focus",f,p=>{N(c,e(c).style.height=""),N(c,e(c).style.height=e(c).scrollHeight+"px")}),de(f,()=>u().content,p=>u(u().content=p,!0)),H("click",h,()=>{F()()}),y(U,m),ue(),q()}var ct=z('<div class="py-3 space-y-3"></div>');function vt(U,S){ve(S,!1),ge("i18n");let r=V(S,"messages",28,()=>[]);fe();var E=ct();Me(E,5,r,je,(q,R,u)=>{dt(q,{get message(){return e(R)},idx:u,onDelete:()=>{r(r().filter((T,F)=>F!==u))}})}),s(E),y(U,E),ue()}var gt=z('<div class=" flex-1 text-gray-500 line-clamp-1"> </div>'),ut=z('<div class="flex gap-2 justify-between items-center"><div class=" shrink-0 font-medium ml-1.5"> </div> <!> <div class="shrink-0"><button class="p-1.5 bg-transparent hover:bg-white/5 transition rounded-lg"><!></button></div></div>'),ft=z('<div slot="content"><div class="pt-1 px-1.5"><textarea class="w-full h-full bg-transparent resize-none outline-hidden text-sm" rows="4"></textarea></div></div>'),mt=z('<option class="bg-gray-50 dark:bg-gray-700"> </option>'),pt=z('<button class="px-3.5 py-1.5 text-sm font-medium disabled:bg-gray-50 dark:disabled:hover:bg-gray-850 disabled:cursor-not-allowed bg-gray-50 hover:bg-gray-100 text-gray-900 dark:bg-gray-850 dark:hover:bg-gray-800 dark:text-gray-200 transition rounded-lg"> </button> <button class="px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-lg"> </button>',1),ht=z('<button class="px-3 py-1.5 text-sm font-medium bg-gray-300 text-black transition rounded-lg"> </button>'),xt=z('<div class=" flex flex-col justify-between w-full overflow-y-auto h-full"><div class="mx-auto w-full md:px-0 h-full relative"><div class=" flex flex-col h-full px-3.5"><div class="flex w-full items-start gap-1.5"><!></div> <div class=" pb-2.5 flex flex-col justify-between w-full flex-auto overflow-auto h-0" id="messages-container"><div class=" h-full w-full flex flex-col"><div class="flex-1 p-1"><!></div></div></div> <div class="pb-3"><div class="border border-gray-100/30 dark:border-gray-850/30 w-full px-3 py-2.5 rounded-xl"><div class="py-0.5"><textarea class=" w-full h-full bg-transparent resize-none outline-hidden text-sm" rows="2"></textarea></div> <div class="flex justify-between flex-col sm:flex-row items-start sm:items-center gap-2 mt-2"><div class="shrink-0"><button type="button"><!></button></div> <div class="flex items-center justify-between gap-2 w-full sm:w-auto"><div class="flex-1"><select class=" bg-transparent border border-gray-100/30 dark:border-gray-850/30 rounded-lg py-1 px-2 -mx-0.5 text-sm outline-hidden w-full"></select></div> <div class="flex gap-2 shrink-0"><!></div></div></div></div></div></div></div></div>');function bt(U,S){ve(S,!1);const r=()=>W(c,"$i18n",T),E=()=>W(st,"$models",T),q=()=>W(Ve,"$user",T),R=()=>W(et,"$settings",T),u=()=>W(tt,"$config",T),[T,F]=ze(),c=ge("i18n");let m=$(""),A=$(!1),B=!1,w=$(),D=$(),f=$(!1),k=$(""),h=$("user"),p=$(""),v=$([]);const me=()=>{const t=e(D);t&&(t.scrollTop=t==null?void 0:t.scrollHeight)},Re=()=>{B=!0},pe=async()=>{await K(),e(w)&&(N(w,e(w).style.height=""),N(w,e(w).style.height=Math.min(e(w).scrollHeight,555)+"px"))},Te=async()=>{var x;if(e(m)===""){Ge.error(r().t("Please select a model."));return}const t=E().find(M=>M.id===e(m));if(!t){d(m,"");return}const[l,a]=await at(localStorage.token,{model:t.id,stream:!0,messages:[e(k)?{role:"system",content:e(k)}:void 0,...e(v)].filter(M=>M)},`${Qe}/api`);let n;((x=e(v).at(-1))==null?void 0:x.role)==="assistant"?n=e(v).at(-1):(n={role:"assistant",content:""},e(v).push(n),d(v,e(v))),await K();const i=document.getElementById(`assistant-${e(v).length-1}-textarea`);if(l&&l.ok){const M=l.body.pipeThrough(new TextDecoderStream).pipeThrough(rt(`
`)).getReader();for(;;){const{value:I,done:G}=await M.read();if(G||B){B&&a.abort("User: Stop Response");break}try{let L=I.split(`
`);for(const O of L)if(O!=="")if(O==="data: [DONE]")d(v,e(v));else{let X=JSON.parse(O.replace(/^data: /,""));if(n.content==""&&X.choices[0].delta.content==`
`)continue;i.style.height=i.scrollHeight+"px",n.content+=X.choices[0].delta.content??"",d(v,e(v)),i.style.height=i.scrollHeight+"px",await K()}}catch(L){}me()}}},he=async()=>{e(p)&&(e(v).push({role:e(h),content:e(p)}),d(v,e(v)),d(p,""),await K(),me())},Ne=async()=>{e(m)&&(await he(),d(A,!0),await Te(),d(A,!1),B=!1)};Ee(async()=>{var t,l,a,n,i;((t=q())==null?void 0:t.role)!=="admin"&&await Ke("/"),(l=R())!=null&&l.models?d(m,(a=R())==null?void 0:a.models[0]):(n=u())!=null&&n.default_models?d(m,(i=u())==null?void 0:i.default_models.split(",")[0]):d(m,"")}),qe(()=>e(f),()=>{e(f)&&pe()}),Fe(),fe();var ee=xt(),xe=o(ee),be=o(xe),te=o(be),Ue=o(te);ot(Ue,{className:"w-full flex-1",buttonClassName:"w-full rounded-lg text-sm border border-gray-100/30 dark:border-gray-850/30 w-full py-1 px-1.5",grow:!0,get open(){return e(f)},set open(t){d(f,t)},children:(t,l)=>{var a=ut(),n=o(a),i=o(n,!0);s(n);var x=C(n,2);{var M=b=>{var le=gt(),Ye=o(le,!0);s(le),_(()=>j(Ye,e(k))),y(b,le)};Q(x,b=>{e(f),e(k),g(()=>!e(f)&&e(k).trim())&&b(M)})}var I=C(x,2),G=o(I),L=o(G);{var O=b=>{lt(b,{className:"size-3.5"})},X=b=>{it(b,{className:"size-3.5"})};Q(L,b=>{e(f)?b(O):b(X,!1)})}s(G),s(I),s(a),_(b=>j(i,b),[()=>(r(),g(()=>r().t("System Instructions")))]),y(t,a)},$$slots:{default:!0,content:(t,l)=>{var a=ft(),n=o(a),i=o(n);ne(i),ce(i,x=>d(w,x),()=>e(w)),s(n),s(a),_(x=>Y(i,"placeholder",x),[()=>(r(),g(()=>r().t("You're a helpful assistant.")))]),de(i,()=>e(k),x=>d(k,x)),H("input",i,()=>{pe()}),y(t,a)}},$$legacy:!0}),s(te);var Z=C(te,2),_e=o(Z),ye=o(_e),Ae=o(ye);vt(Ae,{get messages(){return e(v)},set messages(t){d(v,t)},$$legacy:!0}),s(ye),s(_e),s(Z),ce(Z,t=>d(D,t),()=>e(D));var we=C(Z,2),ke=o(we),se=o(ke),J=o(se);ne(J),s(se);var $e=C(se,2),ae=o($e),P=o(ae),Be=o(P);{var De=t=>{var l=Se();_(a=>j(l,a),[()=>(r(),g(()=>r().t("User")))]),y(t,l)},Pe=t=>{var l=Se();_(a=>j(l,a),[()=>(r(),g(()=>r().t("Assistant")))]),y(t,l)};Q(Be,t=>{e(h)==="user"?t(De):t(Pe,!1)})}s(P),s(ae);var Ce=C(ae,2),re=o(Ce),oe=o(re);_(()=>{e(m),Je(()=>{E()})}),Me(oe,5,E,je,(t,l)=>{var a=mt(),n=o(a,!0);s(a);var i={};_(()=>{j(n,(e(l),g(()=>e(l).name))),i!==(i=(e(l),g(()=>e(l).id)))&&(a.value=(a.__value=(e(l),g(()=>e(l).id)))??"")}),y(t,a)}),s(oe),s(re);var He=C(re,2),Ie=o(He);{var Oe=t=>{var l=pt(),a=Le(l),n=o(a,!0);s(a);var i=C(a,2),x=o(i,!0);s(i),_((M,I)=>{a.disabled=e(p)==="",j(n,M),j(x,I)},[()=>(r(),g(()=>r().t("Add"))),()=>(r(),g(()=>r().t("Run")))]),H("click",a,()=>{he(),d(h,e(h)==="user"?"assistant":"user")}),H("click",i,()=>{Ne()}),y(t,l)},We=t=>{var l=ht(),a=o(l,!0);s(l),_(n=>j(a,n),[()=>(r(),g(()=>r().t("Cancel")))]),H("click",l,()=>{Re()}),y(t,l)};Q(Ie,t=>{e(A)?t(We,!1):t(Oe)})}s(He),s(Ce),s($e),s(ke),s(we),s(be),s(xe),s(ee),_((t,l)=>{Y(J,"placeholder",t),Ze(P,1,`px-3.5 py-1.5 text-sm font-medium bg-gray-50 hover:bg-gray-100 text-gray-900 dark:bg-gray-850 dark:hover:bg-gray-800 dark:text-gray-200 transition rounded-lg shrink-0 ${R(),g(()=>{var a;return((a=R())==null?void 0:a.highContrastMode)??!1?"":"outline-hidden"})??""}`),Y(P,"aria-pressed",e(h)==="assistant"),Y(P,"aria-label",l)},[()=>(r(),e(h),g(()=>r().t("Enter {{role}} message here",{role:e(h)==="user"?r().t("a user"):r().t("an assistant")}))),()=>(r(),e(h),g(()=>r().t(e(h)==="user"?"Switch to Assistant role":"Switch to User role")))]),de(J,()=>e(p),t=>d(p,t)),H("input",J,t=>{t.target.style.height="",t.target.style.height=Math.min(t.target.scrollHeight,150)+"px"}),H("focus",J,t=>{t.target.style.height="",t.target.style.height=Math.min(t.target.scrollHeight,150)+"px"}),H("click",P,()=>{d(h,e(h)==="user"?"assistant":"user")}),Xe(oe,()=>e(m),t=>d(m,t)),y(U,ee),ue(),F()}function It(U){bt(U,{})}export{It as component};
//# sourceMappingURL=27.B5WPAV9Z.js.map
