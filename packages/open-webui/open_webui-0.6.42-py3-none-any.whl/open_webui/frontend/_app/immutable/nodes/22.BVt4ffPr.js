import"../chunks/CWj6FrbW.js";import"../chunks/CN51-NxK.js";import{t as E,a as i,B as mt,b as qe,g as tt,o as dt,e as ye,j as e,i as m,k as y,p as Ke,f,m as le,n as se,w as s,c as a,u as o,r,l as Ae,s as fe,d as Ye,A as Ut,z as Je,x as ot,q as st,v as lt,aT as jt,aX as et,h as Qt,$ as yt}from"../chunks/lUdQH9Xf.js";import{i as Xe}from"../chunks/VsCEtJ32.js";import{s as Qe,a as Ee}from"../chunks/CcA7kcll.js";import{p as Jt}from"../chunks/DRW7FbpN.js";import{i as b}from"../chunks/a8_cTibZ.js";import{k as er}from"../chunks/DpkLTJmG.js";import{s as Oe,c as _t,a as We,r as tr}from"../chunks/AGdekky4.js";import{b as Et}from"../chunks/D72e2DEW.js";import{p as G}from"../chunks/wFFmXPqF.js";import{t as Fe}from"../chunks/1N3xujas.js";import{P as rr,c as bt,d as ar}from"../chunks/BIFARBIE.js";import{g as At}from"../chunks/CeIFb-7H.js";import{u as it,b as sr,m as lr,s as ft,g as ir,i as Rt,e as wt,j as $t,h as kt}from"../chunks/CQ5nDkjA.js";import{g as nr,d as or,u as dr,p as Dt,r as vr,a as cr,b as ur,c as fr,e as gr,f as mr,h as Mt,s as Bt,i as Pt,j as zt}from"../chunks/DBQvhM_r.js";import{e as rt,i as ut}from"../chunks/CyDjujdM.js";import{d as Ce,r as pt}from"../chunks/I1CDPYOB.js";import{F as Wt,G as Ht,l as Ot,H as Tt,y as _r}from"../chunks/BXNnaNI-.js";import{a as He}from"../chunks/BJunrENY.js";import{M as Ct,I as pr}from"../chunks/DF5UxXSC.js";import{N as hr,P as xr}from"../chunks/DmTfDUTz.js";import{C as yr}from"../chunks/7L2QCwoR.js";import{G as br}from"../chunks/DW4Ik_WH.js";import{P as wr}from"../chunks/C2a4pS38.js";import{T as Ve}from"../chunks/BtoSXKKz.js";import{T as $r}from"../chunks/DljGs0XM.js";import{C as kr,F as Mr}from"../chunks/CVLvuhCs.js";import{P as Ft}from"../chunks/C7r-faAX.js";import{E as St,F as It,U as Pr}from"../chunks/mPisGjQv.js";import{C as zr}from"../chunks/CNi-Z1CP.js";import{E as Tr}from"../chunks/BXXBqWH6.js";import{S as Nt}from"../chunks/CPW-btCN.js";import{P as Cr,M as Sr,U as Ir}from"../chunks/Da_gCGUc.js";import{L as Yt}from"../chunks/BrFI5UBi.js";import{S as at}from"../chunks/CkkUFZ96.js";import{M as Vt}from"../chunks/CRCzxQIJ.js";import{S as Nr}from"../chunks/Dguw-oCp.js";import{H as Gt,L as Zt}from"../chunks/B-RP1E8X.js";import{M as ht}from"../chunks/CbKu5dqy.js";import{X as vt}from"../chunks/9jNi-Hzr.js";import{b as Lr}from"../chunks/gZt8HVPH.js";import{P as Ur}from"../chunks/C2-_xXsa.js";import{B as jr}from"../chunks/9Bw9E4Yf.js";import{P as Er}from"../chunks/C4_WGY8S.js";import{D as Ar}from"../chunks/DCRoLTs7.js";import{i as Rr}from"../chunks/DB2dSxVg.js";var Dr=mt('<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M10.25 4.75L6.75 8.25L10.25 11.75" stroke-linecap="round" stroke-linejoin="round"></path><path d="M6.75 8.25L12.75 8.25C14.9591 8.25 16.75 10.0409 16.75 12.25V19.25" stroke-linecap="round" stroke-linejoin="round"></path></svg>');function Br(Se,x){let v=G(x,"className",8,"w-4 h-4"),Y=G(x,"strokeWidth",8,"1.5");var V=Dr();E(()=>{Oe(V,0,_t(v())),We(V,"stroke-width",Y())}),i(Se,V)}var Wr=mt('<svg viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" width="24" height="24"><path d="M9.5 14.5L3 21" stroke-linecap="round" stroke-linejoin="round"></path><path d="M5.00007 9.48528L14.1925 18.6777L15.8895 16.9806L15.4974 13.1944L21.0065 8.5211L15.1568 2.67141L10.4834 8.18034L6.69713 7.78823L5.00007 9.48528Z" stroke-linecap="round" stroke-linejoin="round"></path></svg>');function gt(Se,x){let v=G(x,"className",8,"size-4"),Y=G(x,"strokeWidth",8,"1.5");var V=Wr();E(()=>{We(V,"stroke-width",Y()),Oe(V,0,_t(v()))}),i(Se,V)}var Hr=f('<button class="hover:bg-gray-100 dark:hover:bg-gray-800 transition rounded-lg p-1 svelte-s6wdik"><!></button>'),Or=f('<button class="hover:bg-gray-100 dark:hover:bg-gray-800 transition rounded-lg p-0.5 svelte-s6wdik"><!></button>'),Fr=f('<button class="hover:bg-gray-100 dark:hover:bg-gray-800 transition rounded-lg p-1 svelte-s6wdik"><!></button>'),Yr=f('<button class="hover:bg-gray-100 dark:hover:bg-gray-800 transition rounded-lg p-1 svelte-s6wdik"><!></button>'),Vr=f('<button class="hover:bg-gray-100 dark:hover:bg-gray-800 transition rounded-lg p-1 svelte-s6wdik"><!></button>'),Gr=f('<button class="hover:bg-gray-100 dark:hover:bg-gray-800 transition rounded-lg p-1 svelte-s6wdik"><!></button>'),Zr=f("<!> <!>",1),qr=f('<div><div class="flex gap-1 rounded-lg bg-white dark:bg-gray-850 shadow-md p-0.5 border border-gray-100/30 dark:border-gray-850/30 svelte-s6wdik"><!> <!> <!> <!> <!></div></div>'),Kr=f('<div><div class="ml-8.5 flex items-center gap-1 px-1 rounded-full text-xs svelte-s6wdik"><!> <span class="text-gray-500 svelte-s6wdik"> </span></div></div>'),Xr=f('<img class="size-4 ml-0.5 rounded-full object-cover svelte-s6wdik"/>'),Qr=f('<img class="size-4 ml-0.5 rounded-full object-cover svelte-s6wdik"/>'),Jr=f('<div class="relative text-xs mb-1 svelte-s6wdik"><div class="absolute h-3 w-7 left-[18px] top-2 rounded-tl-lg border-t-[1.5px] border-l-[1.5px] border-gray-200 dark:border-gray-700 z-0 svelte-s6wdik"></div> <button class="ml-12 flex items-center space-x-2 relative z-0 svelte-s6wdik"><!> <div class="shrink-0 svelte-s6wdik"> </div> <div class="italic text-sm text-gray-500 dark:text-gray-400 line-clamp-1 w-full flex-1 svelte-s6wdik"><!></div></button></div>'),ea=f('<img class="size-8 translate-y-1 ml-0.5 object-cover rounded-full svelte-s6wdik"/>'),ta=f('<div class="mt-1.5 flex shrink-0 items-center text-xs self-center invisible group-hover:visible text-gray-500 font-medium first-letter:capitalize svelte-s6wdik"><!></div>'),ra=f('<span class="line-clamp-1 svelte-s6wdik"><!></span>'),aa=f('<div class=" self-center text-xs text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px] svelte-s6wdik"><!></div>'),sa=f('<div class=" self-end text-base shrink-0 font-medium truncate svelte-s6wdik"><!></div> <!>',1),la=f('<div class=" my-2 svelte-s6wdik"><!></div>'),ia=f('<video controls class=" max-h-96 rounded-lg svelte-s6wdik"></video>',2),na=f('<div class="svelte-s6wdik"><!></div>'),oa=f('<div class="my-2.5 w-full flex overflow-x-auto gap-2 flex-wrap svelte-s6wdik"></div>'),da=f('<div class="py-2 svelte-s6wdik"><!> <div class=" mt-2 mb-1 flex justify-end text-sm font-medium svelte-s6wdik"><div class="flex space-x-1.5 svelte-s6wdik"><button id="close-edit-message-button" class="px-3.5 py-1.5 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl svelte-s6wdik"> </button> <button id="confirm-edit-message-button" class="px-3.5 py-1.5 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl svelte-s6wdik"> </button></div></div></div>'),va=f('<span class="text-gray-500 text-[10px] pl-1 self-center svelte-s6wdik"> </span>'),ca=f("<!><!>",1),ua=f('<div class="text-xs font-medium text-gray-500 dark:text-gray-400 svelte-s6wdik"> </div>'),fa=f("<button><!> <!></button>"),ga=f('<div class="flex items-center gap-1.5 bg-gray-500/10 hover:outline hover:outline-gray-700/30 dark:hover:outline-gray-300/30 hover:outline-1 transition rounded-xl px-1 py-1 cursor-pointer text-gray-500 dark:text-gray-400 svelte-s6wdik"><!></div>'),ma=f('<div class="svelte-s6wdik"><div class="flex items-center flex-wrap gap-y-1.5 gap-1 mt-1 mb-2 svelte-s6wdik"><!> <!></div></div>'),_a=f('<div class="flex items-center gap-1.5 -mt-0.5 mb-1.5 svelte-s6wdik"><button class="flex items-center text-xs py-1 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition svelte-s6wdik"><span class="font-medium mr-1 svelte-s6wdik"> </span><span class="svelte-s6wdik"> </span> <span class="ml-1 svelte-s6wdik"><!></span></button></div>'),pa=f("<div><!></div> <!> <!>",1),ha=f('<div><!> <!> <!> <div><div><!></div> <div class="flex-auto w-0 pl-2 svelte-s6wdik"><!> <!> <!></div></div></div>'),xa=f("<!> <!>",1);function qt(Se,x){qe(x,!1);const v=()=>Ee(Z,"$i18n",we),Y=()=>Ee(it,"$user",we),V=()=>Ee(sr,"$settings",we),[we,ge]=Qe();Ce.extend(pt),Ce.extend(Wt),Ce.extend(Ht),Ce.extend(Ot);const Z=tt("i18n");let O=G(x,"className",8,""),t=G(x,"message",12),q=G(x,"channel",8),p=G(x,"showUserProfile",8,!0),pe=G(x,"thread",8,!1),ie=G(x,"replyToMessage",8,!1),$e=G(x,"disabled",8,!1),me=G(x,"pending",8,!1),N=G(x,"onDelete",8,()=>{}),R=G(x,"onEdit",8,()=>{}),ee=G(x,"onReply",8,()=>{}),ne=G(x,"onPin",8,()=>{}),xe=G(x,"onThread",8,()=>{}),oe=G(x,"onReaction",8,()=>{}),K=le(!1),te=le(!1),ke=le(null),Ie=le(!1);const S=async()=>{var z,n;if(t()&&((z=t())!=null&&z.data)){const T=await nr(localStorage.token,(n=q())==null?void 0:n.id,t().id);T&&t(t().data=T,!0)}};dt(async()=>{var z;t()&&((z=t())!=null&&z.data)&&await S()}),Xe();var Me=xa(),Q=ye(Me);{let z=se(()=>(v(),s(()=>v().t("Delete Message")))),n=se(()=>(v(),s(()=>v().t("Are you sure you want to delete this message?"))));yr(Q,{get title(){return e(z)},get message(){return e(n)},onConfirm:async()=>{await N()()},get show(){return e(Ie)},set show(T){m(Ie,T)},$$legacy:!0})}var C=y(Q,2);{var L=z=>{var n=ha(),T=a(n);{var U=$=>{var h=qr(),F=a(h),de=a(F);{var ue=P=>{St(P,{onClose:()=>m(K,!1),onSubmit:k=>{m(K,!1),oe()(k)},children:(k,ze)=>{{let Te=se(()=>(v(),s(()=>v().t("Add Reaction"))));Ve(k,{get content(){return e(Te)},children:(ve,ae)=>{var be=Hr(),he=a(be);It(he,{}),r(be),Ae("click",be,()=>{m(K,!0)}),i(ve,be)},$$slots:{default:!0}})}},$$slots:{default:!0}})};b(de,P=>{oe()&&P(ue)})}var B=y(de,2);{var H=P=>{{let k=se(()=>(v(),s(()=>v().t("Reply"))));Ve(P,{get content(){return e(k)},children:(ze,Te)=>{var ve=Or(),ae=a(ve);Br(ae,{className:"size-5"}),r(ve),Ae("click",ve,()=>{ee()(t())}),i(ze,ve)},$$slots:{default:!0}})}};b(B,P=>{ee()&&P(H)})}var I=y(B,2);{let P=se(()=>(o(t()),v(),s(()=>{var k;return(k=t())!=null&&k.is_pinned?v().t("Unpin"):v().t("Pin")})));Ve(I,{get content(){return e(P)},children:(k,ze)=>{var Te=Fr(),ve=a(Te);{var ae=he=>{Cr(he,{className:"size-4"})},be=he=>{gt(he,{className:"size-4"})};b(ve,he=>{o(t()),s(()=>{var je;return(je=t())==null?void 0:je.is_pinned})?he(ae):he(be,!1)})}r(Te),Ae("click",Te,()=>{ne()(t())}),i(k,Te)},$$slots:{default:!0}})}var Re=y(I,2);{var Ue=P=>{{let k=se(()=>(v(),s(()=>v().t("Reply in Thread"))));Ve(P,{get content(){return e(k)},children:(ze,Te)=>{var ve=Yr(),ae=a(ve);kr(ae,{}),r(ve),Ae("click",ve,()=>{xe()(t().id)}),i(ze,ve)},$$slots:{default:!0}})}};b(Re,P=>{!pe()&&xe()&&P(Ue)})}var j=y(Re,2);{var W=P=>{var k=Zr(),ze=ye(k);{var Te=be=>{{let he=se(()=>(v(),s(()=>v().t("Edit"))));Ve(be,{get content(){return e(he)},children:(je,Be)=>{var De=Vr(),Ge=a(De);wr(Ge,{}),r(De),Ae("click",De,()=>{m(te,!0),m(ke,t().content)}),i(je,De)},$$slots:{default:!0}})}};b(ze,be=>{R()&&be(Te)})}var ve=y(ze,2);{var ae=be=>{{let he=se(()=>(v(),s(()=>v().t("Delete"))));Ve(be,{get content(){return e(he)},children:(je,Be)=>{var De=Gr(),Ge=a(De);br(Ge,{}),r(De),Ae("click",De,()=>m(Ie,!0)),i(je,De)},$$slots:{default:!0}})}};b(ve,be=>{N()&&be(ae)})}i(P,k)};b(j,P=>{o(t()),Y(),s(()=>{var k,ze;return t().user_id===((k=Y())==null?void 0:k.id)||((ze=Y())==null?void 0:ze.role)==="admin"})&&P(W)})}r(F),r(h),E(()=>Oe(h,1,` absolute ${e(K)?"":"invisible group-hover:visible"} right-1 -top-2 z-10`,"svelte-s6wdik")),i($,h)};b(T,$=>{!e(te)&&!$e()&&$(U)})}var c=y(T,2);{var _=$=>{var h=Kr(),F=a(h),de=a(F);gt(de,{className:"size-3 text-yellow-500 dark:text-yellow-300"});var ue=y(de,2),B=a(ue,!0);r(ue),r(F),r(h),E(H=>{Oe(h,1,`flex ${p()?"mb-0.5":"mt-0.5"}`,"svelte-s6wdik"),fe(B,H)},[()=>(v(),s(()=>v().t("Pinned")))]),i($,h)};b(c,$=>{o(t()),s(()=>{var h;return(h=t())==null?void 0:h.is_pinned})&&$(_)})}var u=y(c,2);{var g=$=>{var h=Jr(),F=y(a(h),2),de=a(F);{var ue=j=>{var W=Xr();E(()=>{We(W,"src",(o(He),o(t()),s(()=>`${He}/models/model/profile/image?id=${t().reply_to_message.meta.model_id}`))),We(W,"alt",(o(t()),s(()=>t().reply_to_message.meta.model_name??t().reply_to_message.meta.model_id)))}),i(j,W)},B=j=>{var W=Qr();E(P=>{We(W,"src",(o(He),o(t()),s(()=>{var k;return`${He}/users/${(k=t().reply_to_message.user)==null?void 0:k.id}/profile/image`}))),We(W,"alt",P)},[()=>(o(t()),v(),s(()=>{var P;return((P=t().reply_to_message.user)==null?void 0:P.name)??v().t("Unknown User")}))]),i(j,W)};b(de,j=>{o(t()),s(()=>{var W,P,k;return(k=(P=(W=t())==null?void 0:W.reply_to_message)==null?void 0:P.meta)==null?void 0:k.model_id})?j(ue):j(B,!1)})}var H=y(de,2),I=a(H,!0);r(H);var Re=y(H,2),Ue=a(Re);{let j=se(()=>(o(t()),s(()=>`${t().id}-reply-to`))),W=se(()=>(o(t()),s(()=>{var P,k;return(k=(P=t())==null?void 0:P.reply_to_message)==null?void 0:k.content})));Ct(Ue,{get id(){return e(j)},get content(){return e(W)}})}r(Re),r(F),r(h),E(j=>fe(I,j),[()=>(o(t()),v(),s(()=>{var j,W,P,k;return((W=(j=t())==null?void 0:j.reply_to_message.meta)==null?void 0:W.model_name)??((k=(P=t())==null?void 0:P.reply_to_message.user)==null?void 0:k.name)??v().t("Unknown User")}))]),Ae("click",F,()=>{const j=document.getElementById(`message-${t().reply_to_message.id}`);if(j){j.scrollIntoView({behavior:"smooth",block:"center"}),j.classList.add("highlight"),setTimeout(()=>{j.classList.remove("highlight")},2e3);return}}),i($,h)};b(u,$=>{o(t()),s(()=>{var h,F;return(F=(h=t())==null?void 0:h.reply_to_message)==null?void 0:F.user})&&$(g)})}var l=y(u,2),d=a(l);Oe(d,1,"shrink-0 mr-1 w-9","svelte-s6wdik");var w=a(d);{var M=$=>{var h=Ye(),F=ye(h);{var de=B=>{var H=ea();E(()=>{We(H,"src",(o(He),o(t()),s(()=>`${He}/models/model/profile/image?id=${t().meta.model_id}`))),We(H,"alt",(o(t()),s(()=>t().meta.model_name??t().meta.model_id)))}),i(B,H)},ue=B=>{Ft(B,{get user(){return o(t()),s(()=>t().user)},children:(H,I)=>{{let Re=se(()=>(o(He),o(t()),s(()=>`${He}/users/${t().user.id}/profile/image`)));xr(H,{get src(){return e(Re)},className:"size-8 ml-0.5"})}},$$slots:{default:!0}})};b(F,B=>{o(t()),s(()=>{var H,I;return(I=(H=t())==null?void 0:H.meta)==null?void 0:I.model_id})?B(de):B(ue,!1)})}i($,h)},X=$=>{var h=Ye(),F=ye(h);{var de=ue=>{var B=ta(),H=a(B);{let I=se(()=>(o(Ce),o(t()),s(()=>Ce(t().created_at/1e6).format("LLLL"))));Ve(H,{get content(){return e(I)},children:(Re,Ue)=>{Ut();var j=Je();E(W=>fe(j,W),[()=>(o(Ce),o(t()),s(()=>Ce(t().created_at/1e6).format("HH:mm")))]),i(Re,j)},$$slots:{default:!0}})}r(B),i(ue,B)};b(F,ue=>{o(t()),s(()=>t().created_at)&&ue(de)})}i($,h)};b(w,$=>{p()?$(M):$(X,!1)})}r(d);var D=y(d,2),A=a(D);{var _e=$=>{hr($,{children:(h,F)=>{var de=sa(),ue=ye(de),B=a(ue);{var H=j=>{var W=Je();E(()=>fe(W,(o(t()),s(()=>{var P,k,ze,Te;return((k=(P=t())==null?void 0:P.meta)==null?void 0:k.model_name)??((Te=(ze=t())==null?void 0:ze.meta)==null?void 0:Te.model_id)})))),i(j,W)},I=j=>{var W=Je();E(()=>fe(W,(o(t()),s(()=>{var P,k;return(k=(P=t())==null?void 0:P.user)==null?void 0:k.name})))),i(j,W)};b(B,j=>{o(t()),s(()=>{var W,P;return(P=(W=t())==null?void 0:W.meta)==null?void 0:P.model_id})?j(H):j(I,!1)})}r(ue);var Re=y(ue,2);{var Ue=j=>{var W=aa(),P=a(W);{let k=se(()=>(o(Ce),o(t()),s(()=>Ce(t().created_at/1e6).format("LLLL"))));Ve(P,{get content(){return e(k)},children:(ze,Te)=>{var ve=ra(),ae=a(ve);{var be=je=>{var Be=Je();E(De=>fe(Be,De),[()=>(o(Ce),o(t()),s(()=>Ce(t().created_at/1e6).format("LT")))]),i(je,Be)},he=je=>{var Be=Je();E(De=>fe(Be,De),[()=>(v(),o(Tt),o(t()),o(Ce),s(()=>v().t(Tt(t().created_at/1e6),{LOCALIZED_TIME:Ce(t().created_at/1e6).format("LT"),LOCALIZED_DATE:Ce(t().created_at/1e6).format("L")})))]),i(je,Be)};b(ae,je=>{o(Ce),o(t()),s(()=>Ce(t().created_at/1e6).isToday())?je(be):je(he,!1)})}r(ve),i(ze,ve)},$$slots:{default:!0}})}r(W),i(j,W)};b(Re,j=>{o(t()),s(()=>t().created_at)&&j(Ue)})}i(h,de)},$$slots:{default:!0}})};b(A,$=>{p()&&$(_e)})}var ce=y(A,2);{var Ne=$=>{var h=la(),F=a(h);Nt(F,{}),r(h),i($,h)},J=$=>{var h=Ye(),F=ye(h);{var de=ue=>{var B=oa();rt(B,5,()=>(o(t()),s(()=>{var H,I;return(I=(H=t())==null?void 0:H.data)==null?void 0:I.files})),ut,(H,I)=>{const Re=se(()=>(e(I),o(He),s(()=>{var k;return e(I).url.startsWith("data")||e(I).url.startsWith("http")?e(I).url:`${He}/files/${e(I).url}${(k=e(I))!=null&&k.content_type?"/content":""}`})));var Ue=na(),j=a(Ue);{var W=k=>{pr(k,{get src(){return e(Re)},get alt(){return e(I),s(()=>e(I).name)},imageClassName:" max-h-96 rounded-lg"})},P=k=>{var ze=Ye(),Te=ye(ze);{var ve=be=>{var he=ia();E(()=>We(he,"src",e(Re))),i(be,he)},ae=be=>{{let he=se(()=>(e(I),s(()=>{var je;return(je=e(I))==null?void 0:je.size})));Mr(be,{get item(){return e(I)},get url(){return e(I),s(()=>e(I).url)},get name(){return e(I),s(()=>e(I).name)},get type(){return e(I),s(()=>e(I).type)},get size(){return e(he)},small:!0})}};b(Te,be=>{e(I),s(()=>{var he;return e(I).type==="video"||(((he=e(I))==null?void 0:he.content_type)??"").startsWith("video/")})?be(ve):be(ae,!1)},!0)}i(k,ze)};b(j,k=>{e(I),s(()=>{var ze;return e(I).type==="image"||(((ze=e(I))==null?void 0:ze.content_type)??"").startsWith("image/")})?k(W):k(P,!1)})}r(Ue),i(H,Ue)}),r(B),E(()=>{We(B,"dir",(V(),s(()=>{var H;return((H=V())==null?void 0:H.chatDirection)??"auto"}))),B.dir=B.dir}),i(ue,B)};b(F,ue=>{o(t()),s(()=>{var B,H;return(((H=(B=t())==null?void 0:B.data)==null?void 0:H.files)??[]).length>0})&&ue(de)},!0)}i($,h)};b(ce,$=>{o(t()),s(()=>{var h;return((h=t())==null?void 0:h.data)===!0})?$(Ne):$(J,!1)})}var re=y(ce,2);{var Pe=$=>{var h=da(),F=a(h);$r(F,{className:" bg-transparent outline-hidden w-full resize-none",onKeydown:Ue=>{var P,k;Ue.key==="Escape"&&((P=document.getElementById("close-edit-message-button"))==null||P.click());const j=Ue.metaKey||Ue.ctrlKey,W=Ue.key==="Enter";j&&W&&((k=document.getElementById("confirm-edit-message-button"))==null||k.click())},get value(){return e(ke)},set value(Ue){m(ke,Ue)},$$legacy:!0});var de=y(F,2),ue=a(de),B=a(ue),H=a(B,!0);r(B);var I=y(B,2),Re=a(I,!0);r(I),r(ue),r(de),r(h),E((Ue,j)=>{fe(H,Ue),fe(Re,j)},[()=>(v(),s(()=>v().t("Cancel"))),()=>(v(),s(()=>v().t("Save")))]),Ae("click",B,()=>{m(te,!1),m(ke,null)}),Ae("click",I,async()=>{R()(e(ke)),m(te,!1),m(ke,null)}),i($,h)},Le=$=>{var h=pa(),F=ye(h),de=a(F);{var ue=j=>{Nt(j,{})},B=j=>{var W=ca(),P=ye(W);Ct(P,{get id(){return o(t()),s(()=>t().id)},get content(){return o(t()),s(()=>t().content)},paragraphTag:"span"});var k=y(P);{var ze=Te=>{var ve=va(),ae=a(ve);r(ve),E(be=>fe(ae,`(${be??""})`),[()=>(v(),s(()=>v().t("edited")))]),i(Te,ve)};b(k,Te=>{o(t()),s(()=>{var ve,ae;return t().created_at!==t().updated_at&&(((ae=(ve=t())==null?void 0:ve.meta)==null?void 0:ae.model_id)??null)===null})&&Te(ze)})}i(j,W)};b(de,j=>{o(t()),s(()=>{var W,P,k;return(((W=t())==null?void 0:W.content)??"").trim()===""&&((k=(P=t())==null?void 0:P.meta)==null?void 0:k.model_id)})?j(ue):j(B,!1)})}r(F);var H=y(F,2);{var I=j=>{var W=ma(),P=a(W),k=a(P);rt(k,1,()=>(o(t()),s(()=>t().reactions)),ut,(ve,ae)=>{{let be=se(()=>(v(),e(ae),Y(),s(()=>v().t("{{NAMES}} reacted with {{REACTION}}",{NAMES:e(ae).users.reduce((he,je,Be)=>{var ct;const De=je.id===((ct=Y())==null?void 0:ct.id)?v().t("You"):je.name,Ge=e(ae).users.length;if(Be<3){const Ze=Be===0?"":Be===Math.min(2,Ge-1)?` ${v().t("and")} `:", ";return`${he}${Ze}${De}`}return Be===3&&Ge>4?he+` ${v().t("and {{COUNT}} others",{COUNT:Ge-3})}`:he},"").trim(),REACTION:`:${e(ae).name}:`}))));Ve(ve,{get content(){return e(be)},children:(he,je)=>{var Be=fa(),De=a(Be);Tr(De,{get shortCode(){return e(ae),s(()=>e(ae).name)}});var Ge=y(De,2);{var ct=Ze=>{var nt=ua(),Xt=a(nt,!0);r(nt),E(()=>fe(Xt,(e(ae),s(()=>{var xt;return(xt=e(ae).users)==null?void 0:xt.length})))),i(Ze,nt)};b(Ge,Ze=>{e(ae),s(()=>e(ae).users.length>0)&&Ze(ct)})}r(Be),E(Ze=>Oe(Be,1,`flex items-center gap-1.5 transition rounded-xl px-2 py-1 cursor-pointer ${Ze??""}`,"svelte-s6wdik"),[()=>(e(ae),Y(),s(()=>{var Ze;return e(ae).users.map(nt=>nt.id).includes((Ze=Y())==null?void 0:Ze.id)?" bg-blue-300/10 outline outline-blue-500/50 outline-1":"bg-gray-300/10 dark:bg-gray-500/10 hover:outline hover:outline-gray-700/30 dark:hover:outline-gray-300/30 hover:outline-1"}))]),Ae("click",Be,()=>{oe()&&oe()(e(ae).name)}),i(he,Be)},$$slots:{default:!0}})}});var ze=y(k,2);{var Te=ve=>{St(ve,{onSubmit:ae=>{oe()(ae)},children:(ae,be)=>{{let he=se(()=>(v(),s(()=>v().t("Add Reaction"))));Ve(ae,{get content(){return e(he)},children:(je,Be)=>{var De=ga(),Ge=a(De);It(Ge,{}),r(De),i(je,De)},$$slots:{default:!0}})}},$$slots:{default:!0}})};b(ze,ve=>{oe()&&ve(Te)})}r(P),r(W),i(j,W)};b(H,j=>{o(t()),s(()=>{var W;return(((W=t())==null?void 0:W.reactions)??[]).length>0})&&j(I)})}var Re=y(H,2);{var Ue=j=>{var W=_a(),P=a(W),k=a(P),ze=a(k,!0);r(k);var Te=y(k),ve=a(Te);r(Te);var ae=y(Te,2),be=a(ae);zr(be,{className:"size-2.5",strokeWidth:"3"}),r(ae),r(P),r(W),E((he,je,Be)=>{fe(ze,he),fe(ve,` - ${je??""}
									${Be??""}`)},[()=>(v(),o(t()),s(()=>v().t("{{COUNT}} Replies",{COUNT:t().reply_count}))),()=>(v(),s(()=>v().t("Last reply"))),()=>(o(Ce),o(t()),s(()=>Ce.unix(t().latest_reply_at/1e9).fromNow()))]),Ae("click",P,()=>{xe()(t().id)}),i(j,W)};b(Re,j=>{o(pe()),o(t()),s(()=>!pe()&&t().reply_count>0)&&j(Ue)})}E(()=>Oe(F,1,` min-w-full markdown-prose ${me()?"opacity-50":""}`,"svelte-s6wdik")),i($,h)};b(re,$=>{e(te)?$(Pe):$(Le,!1)})}r(D),r(l),r(n),E(()=>{We(n,"id",`message-${o(t()),s(()=>t().id)??""}`),Oe(n,1,`flex flex-col justify-between w-full max-w-full mx-auto group hover:bg-gray-300/5 dark:hover:bg-gray-700/5 transition relative ${o(O()),o(ie()),o(t()),Y(),s(()=>{var $,h,F,de,ue,B,H;return O()?O():`px-5 ${ie()?"border-l-4 border-blue-500 bg-blue-100/10 dark:bg-blue-100/5 pl-4":""} ${(((F=(h=($=t())==null?void 0:$.reply_to_message)==null?void 0:h.meta)==null?void 0:F.model_id)??((ue=(de=t())==null?void 0:de.reply_to_message)==null?void 0:ue.user_id))===((B=Y())==null?void 0:B.id)?"border-l-4 border-orange-500 bg-orange-100/10 dark:bg-orange-100/5 pl-4":""} ${(H=t())!=null&&H.is_pinned?"bg-yellow-100/20 dark:bg-yellow-100/5":""}`})??""} ${p()?"pt-1.5 pb-0.5":""}`,"svelte-s6wdik"),Oe(l,1,` flex w-full message-${o(t()),s(()=>t().id)??""} `,"svelte-s6wdik"),We(l,"id",`message-${o(t()),s(()=>t().id)??""}`),We(l,"dir",(V(),s(()=>V().chatDirection))),l.dir=l.dir}),i(z,n)};b(C,z=>{t()&&z(L)})}i(Se,Me),Ke(),ge()}var ya=f('<div class="w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2"><!> <div class=" "> </div></div>'),ba=f("<img/>"),wa=f('<div class="flex ml-[1px] mr-0.5"></div>'),$a=f('<div class="flex flex-col gap-1.5 pb-5 pt-10"><!> <div class="text-2xl font-medium capitalize"><!></div> <div class=" text-gray-500"> </div></div>'),ka=f('<div class="flex justify-center text-xs items-center gap-2 py-5"><div class=" "> </div></div>'),Ma=f('<hr class=" border-gray-50 dark:border-gray-700/20 py-2.5 w-full"/>'),Pa=f('<div class="px-5 max-w-full mx-auto"><!> <!></div>'),za=f('<div><!> <!> <div class="pb-6"></div></div>');function Kt(Se,x){qe(x,!1);const v=()=>Ee(ge,"$i18n",V),Y=()=>Ee(it,"$user",V),[V,we]=Qe();Ce.extend(pt),Ce.extend(Wt),Ce.extend(Ht);const ge=tt("i18n");let Z=G(x,"id",8,null),O=G(x,"channel",8,null),t=G(x,"messages",28,()=>[]),q=G(x,"replyToMessage",8,null),p=G(x,"top",8,!1),pe=G(x,"thread",8,!1),ie=G(x,"onLoad",8,()=>{}),$e=G(x,"onReply",8,()=>{}),me=G(x,"onThread",8,()=>{}),N=le(!1);const R=async()=>{const oe=document.getElementById("messages-container");oe.scrollTop=oe.scrollTop+100,m(N,!0),await ie()(),await ot(),m(N,!1)};Xe();var ee=Ye(),ne=ye(ee);{var xe=oe=>{const K=se(()=>(o(t()),s(()=>t().slice().reverse())));var te=za(),ke=a(te);{var Ie=Q=>{Yt(Q,{$$events:{visible:C=>{console.info("visible"),e(N)||R()}},children:(C,L)=>{var z=ya(),n=a(z);at(n,{className:" size-4"});var T=y(n,2),U=a(T,!0);r(T),r(z),E(c=>fe(U,c),[()=>(v(),s(()=>v().t("Loading...")))]),i(C,z)},$$slots:{default:!0}})},S=Q=>{var C=Ye(),L=ye(C);{var z=n=>{var T=Pa(),U=a(T);{var c=l=>{var d=$a(),w=a(d);{var M=J=>{var re=wa();rt(re,5,()=>(o(O()),Y(),s(()=>O().users.filter(Pe=>{var Le;return Pe.id!==((Le=Y())==null?void 0:Le.id)}).slice(0,2))),ut,(Pe,Le,$)=>{var h=ba();Oe(h,1,` size-7.5 rounded-full border-2 border-white dark:border-gray-900 ${$===1?"-ml-2.5":""}`),E(()=>{We(h,"src",(o(He),e(Le),s(()=>`${He}/users/${e(Le).id}/profile/image`))),We(h,"alt",(e(Le),s(()=>e(Le).name)))}),i(Pe,h)}),r(re),i(J,re)};b(w,J=>{o(O()),s(()=>{var re;return((re=O())==null?void 0:re.type)==="dm"})&&J(M)})}var X=y(w,2),D=a(X);{var A=J=>{var re=Je();E(()=>fe(re,(o(O()),s(()=>O().name)))),i(J,re)},_e=J=>{var re=Je();E(Pe=>fe(re,Pe),[()=>(o(O()),Y(),s(()=>{var Pe,Le;return(Le=(Pe=O())==null?void 0:Pe.users)==null?void 0:Le.filter($=>{var h;return $.id!==((h=Y())==null?void 0:h.id)}).map($=>$.name).join(", ")}))]),i(J,re)};b(D,J=>{o(O()),s(()=>{var re;return(re=O())==null?void 0:re.name})?J(A):J(_e,!1)})}r(X);var ce=y(X,2),Ne=a(ce,!0);r(ce),r(d),E(J=>fe(Ne,J),[()=>(v(),o(Ce),o(O()),s(()=>v().t("This channel was created on {{createdAt}}. This is the very beginning of the {{channelName}} channel.",{createdAt:Ce(O().created_at/1e6).format("MMMM D, YYYY"),channelName:O().name})))]),i(l,d)},_=l=>{var d=ka(),w=a(d),M=a(w,!0);r(w),r(d),E(X=>fe(M,X),[()=>(v(),s(()=>v().t("Start of the channel")))]),i(l,d)};b(U,l=>{O()?l(c):l(_,!1)})}var u=y(U,2);{var g=l=>{var d=Ma();i(l,d)};b(u,l=>{o(e(K)),s(()=>e(K).length>0)&&l(g)})}r(T),i(n,T)};b(L,n=>{pe()||n(z)},!0)}i(Q,C)};b(ke,Q=>{p()?Q(S,!1):Q(Ie)})}var Me=y(ke,2);rt(Me,3,()=>e(K),Q=>Z()?`${Z()}-${Q.id}`:Q.id,(Q,C,L)=>{{let z=se(()=>(o(q()),e(C),s(()=>{var c;return((c=q())==null?void 0:c.id)===e(C).id}))),n=se(()=>(o(O()),e(C),s(()=>{var c,_;return!((c=O())!=null&&c.write_access)||((_=e(C))==null?void 0:_.temp_id)}))),T=se(()=>(e(C),s(()=>{var c;return!!((c=e(C))!=null&&c.temp_id)}))),U=se(()=>(o(e(L)),o(e(K)),e(C),s(()=>{var c,_,u,g,l,d;return e(L)===0||((c=e(K).at(e(L)-1))==null?void 0:c.user_id)!==e(C).user_id||((u=(_=e(K).at(e(L)-1))==null?void 0:_.meta)==null?void 0:u.model_id)!==((l=(g=e(C))==null?void 0:g.meta)==null?void 0:l.model_id)||((d=e(C))==null?void 0:d.reply_to_message)!==null})));qt(Q,{get message(){return e(C)},get channel(){return O()},get thread(){return pe()},get replyToMessage(){return e(z)},get disabled(){return e(n)},get pending(){return e(T)},get showUserProfile(){return e(U)},onDelete:()=>{t(t().filter(c=>c.id!==e(C).id)),or(localStorage.token,e(C).channel_id,e(C).id).catch(c=>(Fe.error(`${c}`),null))},onEdit:c=>{t(t().map(_=>(_.id===e(C).id&&(_.content=c),_))),dr(localStorage.token,e(C).channel_id,e(C).id,{content:c}).catch(_=>(Fe.error(`${_}`),null))},onReply:c=>{$e()(c)},onPin:async c=>{t(t().map(_=>{var u;return _.id===c.id&&(_.is_pinned=!_.is_pinned,_.pinned_by=_.is_pinned?(u=Y())==null?void 0:u.id:null,_.pinned_at=_.is_pinned?Date.now()*1e6:null),_})),await Dt(localStorage.token,c.channel_id,c.id,c.is_pinned).catch(_=>(Fe.error(`${_}`),null))},onThread:c=>{me()(c)},onReaction:c=>{var _,u,g;((g=(u=(((_=e(C))==null?void 0:_.reactions)??[]).find(l=>l.name===c))==null?void 0:u.users)==null?void 0:g.some(l=>{var d;return l.id===((d=Y())==null?void 0:d.id)}))??!1?(t(t().map(l=>{if(l.id===e(C).id){const d=l.reactions.find(w=>w.name===c);d&&(d.users=d.users.filter(w=>{var M;return w.id!==((M=Y())==null?void 0:M.id)}),d.count=d.users.length,d.count===0&&(l.reactions=l.reactions.filter(w=>w.name!==c)))}return l})),vr(localStorage.token,e(C).channel_id,e(C).id,c).catch(l=>(Fe.error(`${l}`),null))):(t(t().map(l=>{var d,w,M,X;if(l.id===e(C).id&&l.reactions){const D=l.reactions.find(A=>A.name===c);D?(D.users.push({id:(d=Y())==null?void 0:d.id,name:(w=Y())==null?void 0:w.name}),D.count=D.users.length):l.reactions.push({name:c,users:[{id:(M=Y())==null?void 0:M.id,name:(X=Y())==null?void 0:X.name}],count:1})}return l})),cr(localStorage.token,e(C).channel_id,e(C).id,c).catch(l=>(Fe.error(`${l}`),null)))}})}}),Ut(2),r(te),i(oe,te)};b(ne,oe=>{t()&&oe(xe)})}i(Se,ee),Ke(),we()}var Ta=mt('<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor"><path d="M5 20V19C5 15.134 8.13401 12 12 12V12C15.866 12 19 15.134 19 19V20" stroke-linecap="round" stroke-linejoin="round"></path><path d="M12 12C14.2091 12 16 10.2091 16 8C16 5.79086 14.2091 4 12 4C9.79086 4 8 5.79086 8 8C8 10.2091 9.79086 12 12 12Z" stroke-linecap="round" stroke-linejoin="round"></path></svg>');function Ca(Se,x){let v=G(x,"className",8,"size-4"),Y=G(x,"strokeWidth",8,"1.5");var V=Ta();E(()=>{We(V,"stroke-width",Y()),Oe(V,0,_t(v()))}),i(Se,V)}var Sa=f('<div class="my-10"><!></div>'),Ia=f('<div><button type="button" class=" px-3 py-1.5 gap-1 rounded-xl bg-gray-100/50 dark:text-white dark:bg-gray-850/50 text-black transition font-medium text-xs flex items-center justify-center"><!> <span> </span></button></div>'),Na=f('<div class="flex gap-1 px-1 mb-1"><div class=" flex w-full space-x-2"><div class="flex flex-1 items-center"><div class=" self-center ml-1 mr-3"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4"><path fill-rule="evenodd" d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z" clip-rule="evenodd"></path></svg></div> <input class=" w-full text-sm pr-4 py-1 rounded-r-xl outline-hidden bg-transparent"/></div></div></div>'),La=f('<img class="rounded-2xl w-6 h-6 object-cover flex-shrink-0" alt="user"/>'),Ua=f('<div class="font-medium truncate"> </div>'),ja=f('<div><span class="relative flex size-1.5"><span class="absolute inline-flex h-full w-full animate-ping rounded-full bg-green-400 opacity-75"></span> <span class="relative inline-flex size-1.5 rounded-full bg-green-500"></span></span></div>'),Ea=f('<div><button class=" rounded-full p-1 hover:bg-gray-100 dark:hover:bg-gray-850 transition disabled:opacity-50 disabled:cursor-not-allowed" type="button"><!></button></div>'),Aa=f('<div class=" dark:border-gray-850 text-xs flex items-center justify-between"><div class="px-2 py-1.5 font-medium text-gray-900 dark:text-white flex-1"><div class="flex items-center gap-2"><!> <!> <!></div></div> <div class="px-2 py-1 flex items-center gap-1 translate-y-0.5"><div class=" "><!></div> <!></div></div>'),Ra=f('<div class="scrollbar-hidden relative whitespace-nowrap w-full max-w-full"><div class=" text-sm text-left text-gray-500 dark:text-gray-400 w-full max-w-full"><div class="w-full"></div></div></div> <!>',1),Da=f('<div class="text-gray-500 text-xs text-center py-5 px-10"> </div>'),Ba=f('<div class="flex items-center justify-between px-2 mb-1"><div class="flex gap-1 items-center"><span class="text-sm"> </span> <span class="text-sm text-gray-500"> </span></div> <!></div> <!> <!>',1),Wa=f('<div class="flex flex-col justify-center"><!></div>');function Ha(Se,x){qe(x,!1);const v=()=>Ee(ge,"$i18n",V),Y=()=>Ee(it,"$_user",V),[V,we]=Qe();Ce.extend(pt),Ce.extend(Ot);const ge=tt("i18n");let Z=G(x,"channel",8,null),O=G(x,"onAdd",8,null),t=G(x,"onRemove",8,null),q=G(x,"search",8,!0);G(x,"sort",8,!0);let p=le(1),pe=le(null),ie=le(null),$e=le(""),me=le("name"),N=le("asc");const R=async()=>{try{const K=await ur(localStorage.token,Z().id,e($e),e(me),e(N),e(p)).catch(te=>(Fe.error(`${te}`),null));K&&(m(pe,K.users),m(ie,K.total))}catch(K){}};st(()=>(o(Z()),e(p),e($e),e(me),e(N)),()=>{Z()!==null&&e(p)!==null&&e($e)!==null&&e(me)!==null&&e(N)!==null&&R()}),lt(),Xe();var ee=Wa(),ne=a(ee);{var xe=K=>{var te=Sa(),ke=a(te);at(ke,{className:"size-5"}),r(te),i(K,te)},oe=K=>{var te=Ba(),ke=ye(te),Ie=a(ke),S=a(Ie),Me=a(S,!0);r(S);var Q=y(S,2),C=a(Q,!0);r(Q),r(Ie);var L=y(Ie,2);{var z=u=>{var g=Ia(),l=a(g),d=a(l);Er(d,{className:"size-3.5 "});var w=y(d,2),M=a(w,!0);r(w),r(l),r(g),E(X=>fe(M,X),[()=>(v(),s(()=>v().t("Add Member")))]),Ae("click",l,function(...X){var D;(D=O())==null||D.apply(this,X)}),i(u,g)};b(L,u=>{O()&&u(z)})}r(ke);var n=y(ke,2);{var T=u=>{var g=Na(),l=a(g),d=a(l),w=y(a(d),2);tr(w),r(d),r(l),r(g),E(M=>We(w,"placeholder",M),[()=>(v(),s(()=>v().t("Search")))]),Lr(w,()=>e($e),M=>m($e,M)),i(u,g)};b(n,u=>{q()&&u(T)})}var U=y(n,2);{var c=u=>{var g=Ra(),l=ye(g),d=a(l),w=a(d);rt(w,7,()=>e(pe),D=>D.id,(D,A)=>{var _e=Aa(),ce=a(_e),Ne=a(ce),J=a(Ne);Ft(J,{get user(){return e(A)},side:"right",align:"center",sideOffset:6,children:(B,H)=>{var I=La();E(()=>We(I,"src",(o(He),e(A),s(()=>`${He}/users/${e(A).id}/profile/image`)))),i(B,I)},$$slots:{default:!0}});var re=y(J,2);Ve(re,{get content(){return e(A),s(()=>e(A).email)},placement:"top-start",children:(B,H)=>{var I=Ua(),Re=a(I,!0);r(I),E(()=>fe(Re,(e(A),s(()=>e(A).name)))),i(B,I)},$$slots:{default:!0}});var Pe=y(re,2);{var Le=B=>{var H=ja();i(B,H)};b(Pe,B=>{e(A),s(()=>{var H;return(H=e(A))==null?void 0:H.is_active})&&B(Le)})}r(Ne),r(ce);var $=y(ce,2),h=a($),F=a(h);{let B=se(()=>(e(A),s(()=>e(A).role==="admin"?"info":e(A).role==="user"?"success":"muted"))),H=se(()=>(v(),e(A),s(()=>v().t(e(A).role))));jr(F,{get type(){return e(B)},get content(){return e(H)}})}r(h);var de=y(h,2);{var ue=B=>{var H=Ea(),I=a(H),Re=a(I);vt(Re,{}),r(I),r(H),E(()=>I.disabled=(e(A),Y(),s(()=>{var Ue;return e(A).id===((Ue=Y())==null?void 0:Ue.id)}))),Ae("click",I,()=>{t()(e(A).id)}),i(B,H)};b(de,B=>{t()&&B(ue)})}r($),r(_e),i(D,_e)}),r(w),r(d),r(l);var M=y(l,2);{var X=D=>{Ur(D,{get count(){return e(ie)},perPage:30,get page(){return e(p)},set page(A){m(p,A)},$$legacy:!0})};b(M,D=>{e(ie)>30&&D(X)})}i(u,g)},_=u=>{var g=Da(),l=a(g,!0);r(g),E(d=>fe(l,d),[()=>(v(),s(()=>v().t("No users were found.")))]),i(u,g)};b(U,u=>{e(pe),s(()=>e(pe).length>0)?u(c):u(_,!1)})}E(u=>{fe(Me,u),fe(C,e(ie))},[()=>(v(),s(()=>v().t("Members")))]),i(K,te)};b(ne,K=>{e(pe)===null||e(ie)===null?K(xe):K(oe,!1)})}r(ee),i(Se,ee),Ke(),we()}var Oa=f('<div class="ml-2 self-center"><!></div>'),Fa=f('<div><div class=" flex justify-between dark:text-gray-100 px-5 pt-4 mb-1.5"><div class="self-center text-base"><div class="flex items-center gap-0.5 shrink-0"> </div></div> <button class="self-center"><!></button></div> <div class="flex flex-col md:flex-row w-full px-3 pb-4 md:space-x-4 dark:text-gray-200"><div class=" flex flex-col w-full sm:flex-row sm:justify-center sm:space-x-6"><form class="flex flex-col w-full"><div class="flex flex-col w-full h-full pb-2"><!></div> <div class="flex justify-end pt-3 text-sm font-medium gap-1.5"><button type="submit"> <!></button></div></form></div></div></div>');function Ya(Se,x){qe(x,!1);const v=()=>Ee(we,"$i18n",Y),[Y,V]=Qe(),we=tt("i18n");let ge=G(x,"show",12,!1),Z=G(x,"channel",8,null),O=G(x,"onUpdate",8,()=>{}),t=le([]),q=le([]),p=le(!1);const pe=async()=>{await fr(localStorage.token,Z().id,{user_ids:e(q),group_ids:e(t)}).catch(ee=>(Fe.error(`${ee}`),null))?(Fe.success(v().t("Members added successfully")),O()(),ge(!1)):Fe.error(v().t("Failed to add members"))},ie=()=>{m(q,[]),m(t,[]),m(p,!1)};st(()=>o(ge()),()=>{ge()||ie()}),lt(),Xe();var $e=Ye(),me=ye($e);{var N=R=>{ht(R,{size:"sm",get show(){return ge()},set show(ee){ge(ee)},children:(ee,ne)=>{var xe=Fa(),oe=a(xe),K=a(oe),te=a(K),ke=a(te,!0);r(te),r(K);var Ie=y(K,2),S=a(Ie);vt(S,{className:"size-5"}),r(Ie),r(oe);var Me=y(oe,2),Q=a(Me),C=a(Q),L=a(C),z=a(L);Sr(z,{includeGroups:!0,get userIds(){return e(q)},set userIds(u){m(q,u)},get groupIds(){return e(t)},set groupIds(u){m(t,u)},$$legacy:!0}),r(L);var n=y(L,2),T=a(n),U=a(T),c=y(U);{var _=u=>{var g=Oa(),l=a(g);at(l,{}),r(g),i(u,g)};b(c,u=>{e(p)&&u(_)})}r(T),r(n),r(C),r(Q),r(Me),r(xe),E((u,g)=>{fe(ke,u),Oe(T,1,`px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-950 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full flex flex-row space-x-1 items-center ${e(p)?" cursor-not-allowed":""}`),T.disabled=e(p),fe(U,`${g??""} `)},[()=>(v(),s(()=>v().t("Add Members"))),()=>(v(),s(()=>v().t("Add")))]),Ae("click",Ie,()=>{ge(!1)}),Ae("submit",C,u=>{u.preventDefault(),pe()}),i(ee,xe)},$$slots:{default:!0},$$legacy:!0})};b(me,R=>{Z()&&R(N)})}i(Se,$e),Ke(),V()}var Va=f('<div class=" text-left self-center overflow-hidden w-full line-clamp-1 flex-1"> </div>'),Ga=f('<div class=" size-4 justify-center flex items-center"><!></div> <div class=" text-left self-center overflow-hidden w-full line-clamp-1 flex-1"> </div>',1),Za=f('<div><div class=" flex justify-between dark:text-gray-100 px-5 pt-4 mb-1.5"><div class="self-center text-base"><div class="flex items-center gap-0.5 shrink-0"><!></div></div> <button class="self-center"><!></button></div> <div class="flex flex-col md:flex-row w-full px-3 pb-4 md:space-x-4 dark:text-gray-200"><div class=" flex flex-col w-full sm:flex-row sm:justify-center sm:space-x-6"><form class="flex flex-col w-full"><div class="flex flex-col w-full h-full pb-2"><!></div></form></div></div></div>'),qa=f("<!> <!>",1);function Ka(Se,x){qe(x,!1);const v=()=>Ee(we,"$i18n",Y),[Y,V]=Qe(),we=tt("i18n");let ge=G(x,"show",12,!1),Z=G(x,"channel",8,null),O=G(x,"onUpdate",8,()=>{}),t=le(!1);const q=async()=>{},p=async me=>{await gr(localStorage.token,Z().id,{user_ids:[me]}).catch(R=>(Fe.error(`${R}`),null))?(Fe.success(v().t("Member removed successfully")),O()()):Fe.error(v().t("Failed to remove member"))};dt(()=>{}),st(()=>o(ge()),()=>{ge()}),lt(),Xe();var pe=Ye(),ie=ye(pe);{var $e=me=>{var N=qa(),R=ye(N);Ya(R,{get channel(){return Z()},get onUpdate(){return O()},get show(){return e(t)},set show(ne){m(t,ne)},$$legacy:!0});var ee=y(R,2);ht(ee,{size:"sm",get show(){return ge()},set show(ne){ge(ne)},children:(ne,xe)=>{var oe=Za(),K=a(oe),te=a(K),ke=a(te),Ie=a(ke);{var S=c=>{var _=Va(),u=a(_,!0);r(_),E(g=>fe(u,g),[()=>(v(),s(()=>v().t("Direct Message")))]),i(c,_)},Me=c=>{var _=Ga(),u=ye(_),g=a(u);{var l=X=>{Gt(X,{className:"size-3.5",strokeWidth:"2.5"})},d=X=>{Zt(X,{className:"size-5.5",strokeWidth:"2"})};b(g,X=>{o(Z()),s(()=>{var D,A,_e;return((D=Z())==null?void 0:D.type)==="group"?!((A=Z())!=null&&A.is_private):((_e=Z())==null?void 0:_e.access_control)===null})?X(l):X(d,!1)})}r(u);var w=y(u,2),M=a(w,!0);r(w),E(()=>fe(M,(o(Z()),s(()=>Z().name)))),i(c,_)};b(Ie,c=>{o(Z()),s(()=>{var _;return((_=Z())==null?void 0:_.type)==="dm"})?c(S):c(Me,!1)})}r(ke),r(te);var Q=y(te,2),C=a(Q);vt(C,{className:"size-5"}),r(Q),r(K);var L=y(K,2),z=a(L),n=a(z),T=a(n),U=a(T);{let c=se(()=>(o(Z()),e(t),s(()=>{var l,d;return((l=Z())==null?void 0:l.type)==="group"&&((d=Z())!=null&&d.is_manager)?()=>{m(t,!0)}:null}))),_=se(()=>(o(Z()),s(()=>{var l,d;return((l=Z())==null?void 0:l.type)==="group"&&((d=Z())!=null&&d.is_manager)?w=>{p(w)}:null}))),u=se(()=>(o(Z()),s(()=>{var l;return((l=Z())==null?void 0:l.type)!=="dm"}))),g=se(()=>(o(Z()),s(()=>{var l;return((l=Z())==null?void 0:l.type)!=="dm"})));Ha(U,{get channel(){return Z()},get onAdd(){return e(c)},get onRemove(){return e(_)},get search(){return e(u)},get sort(){return e(g)}})}r(T),r(n),r(z),r(L),r(oe),Ae("click",Q,()=>{ge(!1)}),Ae("submit",n,c=>{c.preventDefault(),q()}),i(ne,oe)},$$slots:{default:!0},$$legacy:!0}),i(me,N)};b(ie,me=>{Z()&&me($e)})}i(Se,pe),Ke(),V()}var Xa=f('<div class="my-10"><!></div>'),Qa=f('<div class=" text-center text-xs text-gray-500 dark:text-gray-400 py-6"> </div>'),Ja=f('<div class="w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2"><!> <div class=" "> </div></div>'),es=f("<!> <!>",1),ts=f('<div class="flex flex-col gap-2 max-h-[60vh] overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 dark:scrollbar-thumb-gray-700 scrollbar-track-transparent py-2"><!></div>'),rs=f('<div><div class=" flex justify-between dark:text-gray-100 px-5 pt-4 mb-1.5"><div class="self-center text-base"><div class="flex items-center gap-0.5 shrink-0"> </div></div> <button class="self-center"><!></button></div> <div class="flex flex-col md:flex-row w-full px-4 pb-4 md:space-x-4 dark:text-gray-200"><div class=" flex flex-col w-full sm:flex-row sm:justify-center sm:space-x-6"><div class="flex flex-col w-full h-full pb-2 gap-1"><!></div></div></div></div>');function as(Se,x){qe(x,!1);const v=()=>Ee(we,"$i18n",Y),[Y,V]=Qe(),we=tt("i18n");let ge=G(x,"show",12,!1),Z=G(x,"channel",8,null),O=G(x,"onPin",8,(ee,ne)=>{}),t=le(1),q=le(null),p=le(!1),pe=le(!1);const ie=async()=>{if(Z()&&!e(p)){m(pe,!0);try{const ee=await mr(localStorage.token,Z().id,e(t)).catch(ne=>(Fe.error(`${ne}`),null));ee&&m(q,[...e(q)??[],...ee]),ee.length===0&&m(p,!0)}catch(ee){}finally{m(pe,!1)}}},$e=()=>{m(t,1),m(q,null),m(p,!1),ie()};dt(()=>{$e()}),st(()=>o(ge()),()=>{ge()&&$e()}),lt(),Xe();var me=Ye(),N=ye(me);{var R=ee=>{ht(ee,{size:"sm",get show(){return ge()},set show(ne){ge(ne)},children:(ne,xe)=>{var oe=rs(),K=a(oe),te=a(K),ke=a(te),Ie=a(ke,!0);r(ke),r(te);var S=y(te,2),Me=a(S);vt(Me,{className:"size-5"}),r(S),r(K);var Q=y(K,2),C=a(Q),L=a(C),z=a(L);{var n=U=>{var c=Xa(),_=a(c);at(_,{className:"size-5"}),r(c),i(U,c)},T=U=>{var c=ts(),_=a(c);{var u=l=>{var d=Qa(),w=a(d,!0);r(d),E(M=>fe(w,M),[()=>(v(),s(()=>v().t("No pinned messages")))]),i(l,d)},g=l=>{var d=Ye(),w=ye(d);rt(w,3,()=>e(q),M=>M.id,(M,X,D)=>{var A=es(),_e=ye(A);qt(_e,{className:"rounded-xl px-2",get message(){return e(X)},get channel(){return Z()},onPin:async J=>{m(q,e(q).filter(re=>re.id!==J.id)),O()(J.id,!J.is_pinned),await Dt(localStorage.token,J.channel_id,J.id,!J.is_pinned).catch(re=>(Fe.error(`${re}`),null)),$e()},onReaction:!1,onThread:!1,onReply:!1,onEdit:!1,onDelete:!1});var ce=y(_e,2);{var Ne=J=>{Yt(J,{$$events:{visible:re=>{e(pe)||(m(t,e(t)+1),ie())}},children:(re,Pe)=>{var Le=Ja(),$=a(Le);at($,{className:" size-4"});var h=y($,2),F=a(h,!0);r(h),r(Le),E(de=>fe(F,de),[()=>(v(),s(()=>v().t("Loading...")))]),i(re,Le)},$$slots:{default:!0}})};b(ce,J=>{o(e(D)),e(q),e(p),s(()=>e(D)===e(q).length-1&&!e(p))&&J(Ne)})}i(M,A)}),i(l,d)};b(_,l=>{e(q),s(()=>e(q).length===0)?l(u):l(g,!1)})}r(c),i(U,c)};b(z,U=>{e(q)===null?U(n):U(T,!1)})}r(L),r(C),r(Q),r(oe),E(U=>fe(Ie,U),[()=>(v(),s(()=>v().t("Pinned Messages")))]),Ae("click",S,()=>{ge(!1)}),i(ne,oe)},$$slots:{default:!0},$$legacy:!0})};b(N,ee=>{Z()&&ee(R)})}i(Se,me),Ke(),V()}var ss=f('<button id="sidebar-toggle-button" class=" cursor-pointer flex rounded-lg hover:bg-gray-100 dark:hover:bg-gray-850 transition cursor-"><div class=" self-center p-1.5"><!></div></button>'),ls=f("<div><!></div>"),is=f("<img/>"),ns=f('<span class="absolute inline-flex h-full w-full animate-ping rounded-full bg-green-400 opacity-75"></span>'),os=f('<div class="absolute bottom-0 right-0"><span class="relative flex size-2"><!> <span></span></span></div>'),ds=f('<div class="flex mr-1.5 relative"><!> <!></div>'),vs=f('<div class=" size-4.5 justify-center flex items-center"><!></div>'),cs=f('<div class="flex items-center gap-0.5 shrink-0"><!> <div class=" text-left self-center overflow-hidden w-full line-clamp-1 flex-1"><!></div></div>'),us=f('<button class=" flex cursor-pointer py-1.5 px-1.5 border dark:border-gray-850 border-gray-50 rounded-xl text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-850 transition" aria-label="Pinned Messages" type="button"><div class=" flex items-center gap-0.5 m-auto self-center"><!></div></button>'),fs=f('<button class=" flex cursor-pointer py-1 px-1.5 border dark:border-gray-850 border-gray-50 rounded-xl text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-850 transition" aria-label="User Count" type="button"><div class=" flex items-center gap-0.5 m-auto self-center"><!> <div class="text-sm"> </div></div></button>'),gs=f("<!> <!>",1),ms=f('<button class="select-none flex rounded-xl p-1.5 w-full hover:bg-gray-50 dark:hover:bg-gray-850 transition" aria-label="User Menu"><div class=" self-center"><img class="size-6 object-cover rounded-full" alt="User profile" draggable="false"/></div></button>'),_s=f('<!> <!> <nav class="sticky top-0 z-30 w-full px-1.5 py-1 -mb-8 flex items-center drag-region flex flex-col"><div id="navbar-bg-gradient-to-b" class=" bg-linear-to-b via-50% from-white via-white to-transparent dark:from-gray-900 dark:via-gray-900 dark:to-transparent pointer-events-none absolute inset-0 -bottom-7 z-[-1]"></div> <div class=" flex max-w-full w-full mx-auto px-1 pt-0.5 bg-transparent"><div class="flex items-center w-full max-w-full"><!> <div><!></div> <div class="self-start flex flex-none items-center text-gray-600 dark:text-gray-400 gap-1"><!> <!></div></div></div></nav>',1);function ps(Se,x){qe(x,!1);const v=()=>Ee(lr,"$mobile",ge),Y=()=>Ee(ft,"$showSidebar",ge),V=()=>Ee(O,"$i18n",ge),we=()=>Ee(it,"$user",ge),[ge,Z]=Qe(),O=tt("i18n");let t=le(!1),q=le(!1),p=G(x,"channel",8),pe=G(x,"onPin",8,(L,z)=>{}),ie=G(x,"onUpdate",8,()=>{});Xe();var $e=_s(),me=ye($e);as(me,{get channel(){return p()},get onPin(){return pe()},get show(){return e(t)},set show(L){m(t,L)},$$legacy:!0});var N=y(me,2);Ka(N,{get channel(){return p()},get onUpdate(){return ie()},get show(){return e(q)},set show(L){m(q,L)},$$legacy:!0});var R=y(N,2),ee=y(a(R),2),ne=a(ee),xe=a(ne);{var oe=L=>{var z=ls(),n=a(z);{let T=se(()=>(Y(),V(),s(()=>Y()?V().t("Close Sidebar"):V().t("Open Sidebar"))));Ve(n,{get content(){return e(T)},interactive:!0,children:(U,c)=>{var _=ss(),u=a(_),g=a(u);Nr(g,{}),r(u),r(_),Ae("click",_,()=>{ft.set(!Y())}),i(U,_)},$$slots:{default:!0}})}r(z),E(()=>Oe(z,1,`${Y()?"md:hidden":""} mr-1.5 mt-0.5 self-start flex flex-none items-center text-gray-600 dark:text-gray-400`)),i(L,z)};b(xe,L=>{v()&&L(oe)})}var K=y(xe,2),te=a(K);{var ke=L=>{var z=cs(),n=a(z);{var T=l=>{var d=Ye(),w=ye(d);{var M=D=>{const A=se(()=>(o(p()),we(),s(()=>p().users.filter(re=>{var Pe;return re.id!==((Pe=we())==null?void 0:Pe.id)}))));var _e=ds(),ce=a(_e);rt(ce,1,()=>(o(e(A)),s(()=>e(A).slice(0,2))),ut,(re,Pe,Le)=>{var $=is();Oe($,1,` size-6.5 rounded-full border-2 border-white dark:border-gray-900 ${Le===1?"-ml-3":""}`),E(()=>{We($,"src",(o(He),e(Pe),s(()=>`${He}/users/${e(Pe).id}/profile/image`))),We($,"alt",(e(Pe),s(()=>e(Pe).name)))}),i(re,$)});var Ne=y(ce,2);{var J=re=>{var Pe=os(),Le=a(Pe),$=a(Le);{var h=de=>{var ue=ns();i(de,ue)};b($,de=>{o(e(A)),s(()=>{var ue;return(ue=e(A)[0])==null?void 0:ue.is_active})&&de(h)})}var F=y($,2);r(Le),r(Pe),E(()=>Oe(F,1,`relative inline-flex size-2 rounded-full ${o(e(A)),s(()=>{var de;return(de=e(A)[0])!=null&&de.is_active?"bg-green-500":"bg-gray-300 dark:bg-gray-700"})??""} border-[1.5px] border-white dark:border-gray-900`)),i(re,Pe)};b(Ne,re=>{o(e(A)),s(()=>e(A).length===1)&&re(J)})}r(_e),i(D,_e)},X=D=>{Ir(D,{className:"size-4 ml-1 mr-0.5",strokeWidth:"2"})};b(w,D=>{o(p()),s(()=>{var A;return(A=p())==null?void 0:A.users})?D(M):D(X,!1)})}i(l,d)},U=l=>{var d=vs(),w=a(d);{var M=D=>{Gt(D,{className:"size-3.5",strokeWidth:"2.5"})},X=D=>{Zt(D,{className:"size-5",strokeWidth:"2"})};b(w,D=>{o(p()),s(()=>{var A,_e,ce;return((A=p())==null?void 0:A.type)==="group"?!((_e=p())!=null&&_e.is_private):((ce=p())==null?void 0:ce.access_control)===null})?D(M):D(X,!1)})}r(d),i(l,d)};b(n,l=>{o(p()),s(()=>{var d;return((d=p())==null?void 0:d.type)==="dm"})?l(T):l(U,!1)})}var c=y(n,2),_=a(c);{var u=l=>{var d=Je();E(()=>fe(d,(o(p()),s(()=>p().name)))),i(l,d)},g=l=>{var d=Je();E(w=>fe(d,w),[()=>(o(p()),we(),s(()=>{var w,M;return(M=(w=p())==null?void 0:w.users)==null?void 0:M.filter(X=>{var D;return X.id!==((D=we())==null?void 0:D.id)}).map(X=>X.name).join(", ")}))]),i(l,d)};b(_,l=>{o(p()),s(()=>{var d;return(d=p())==null?void 0:d.name})?l(u):l(g,!1)})}r(c),r(z),i(L,z)};b(te,L=>{p()&&L(ke)})}r(K);var Ie=y(K,2),S=a(Ie);{var Me=L=>{var z=gs(),n=ye(z);{let c=se(()=>(V(),s(()=>V().t("Pinned Messages"))));Ve(n,{get content(){return e(c)},children:(_,u)=>{var g=us(),l=a(g),d=a(l);gt(d,{className:" size-4",strokeWidth:"1.5"}),r(l),r(g),Ae("click",g,()=>{m(t,!0)}),i(_,g)},$$slots:{default:!0}})}var T=y(n,2);{var U=c=>{{let _=se(()=>(V(),s(()=>V().t("Users"))));Ve(c,{get content(){return e(_)},children:(u,g)=>{var l=fs(),d=a(l),w=a(d);Ca(w,{className:" size-4",strokeWidth:"1.5"});var M=y(w,2),X=a(M,!0);r(M),r(d),r(l),E(()=>fe(X,(o(p()),s(()=>p().user_count)))),Ae("click",l,()=>{m(q,!0)}),i(u,l)},$$slots:{default:!0}})}};b(T,c=>{o(p()),s(()=>{var _;return((_=p())==null?void 0:_.user_count)!==void 0})&&c(U)})}i(L,z)};b(S,L=>{p()&&L(Me)})}var Q=y(S,2);{var C=L=>{{let z=se(()=>(we(),s(()=>{var n;return(n=we())==null?void 0:n.role})));Pr(L,{className:"max-w-[240px]",get role(){return e(z)},help:!0,$$events:{show:n=>{n.detail==="archived-chat"&&ir.set(!0)}},children:(n,T)=>{var U=ms(),c=a(U),_=a(c);r(c),r(U),E(()=>We(_,"src",(o(He),we(),s(()=>{var u;return`${He}/users/${(u=we())==null?void 0:u.id}/profile/image`})))),i(n,U)},$$slots:{default:!0}})}};b(Q,L=>{we()!==void 0&&L(C)})}r(Ie),r(ne),r(ee),r(R),E(()=>Oe(K,1,`flex-1 overflow-hidden max-w-full py-0.5 flex items-center
			${Y()?"ml-1":""}
			`)),i(Se,$e),Ke(),Z()}var hs=f('<div class="w-full flex justify-center pt-5 pb-10"><!></div>'),xs=f('<div class="flex flex-col w-full h-full bg-gray-50 dark:bg-gray-850"><div class="sticky top-0 flex items-center justify-between px-3.5 py-3"><div class=" font-medium text-lg"> </div> <div><button class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 p-2"><!></button></div></div> <div class=" max-h-full w-full overflow-y-auto"><!> <div class=" pb-[1rem] px-2.5 w-full"><!></div></div></div>');function Lt(Se,x){qe(x,!1);const v=()=>Ee(it,"$user",we),Y=()=>Ee(Rt,"$socket",we),V=()=>Ee(Z,"$i18n",we),[we,ge]=Qe(),Z=tt("i18n");let O=G(x,"threadId",8,null),t=G(x,"channel",8,null),q=G(x,"onClose",8,()=>{}),p=le(null),pe=le(!1),ie=le(null),$e=le(null),me=le(null),N=le([]),R={};const ee=()=>{et(ie,e(ie).scrollTop=e(ie).scrollHeight)},ne=async()=>{m(p,null),m(pe,!1),m(N,[]),R={},t()?(m(p,await Mt(localStorage.token,t().id,O())),e(p).length<50&&m(pe,!0),await ot(),ee()):At("/")},xe=async S=>{var Me,Q,C;if(S.channel_id===t().id){const L=((Me=S==null?void 0:S.data)==null?void 0:Me.type)??null,z=((Q=S==null?void 0:S.data)==null?void 0:Q.data)??null;if(L==="message")((z==null?void 0:z.parent_id)??null)===O()&&e(p)&&(m(p,[z,...e(p)]),e(N).find(n=>n.id===S.user.id)&&m(N,e(N).filter(n=>n.id!==S.user.id)));else if(L==="message:update"){if(e(p)){const n=e(p).findIndex(T=>T.id===z.id);n!==-1&&et(p,e(p)[n]=z)}}else if(L==="message:delete")e(p)&&m(p,e(p).filter(n=>n.id!==z.id));else if(L.includes("message:reaction")){if(e(p)){const n=e(p).findIndex(T=>T.id===z.id);n!==-1&&et(p,e(p)[n]=z)}}else if(L==="typing"&&S.message_id===O()){if(S.user.id===((C=v())==null?void 0:C.id))return;m(N,z.typing?[...e(N),...e(N).find(n=>n.id===S.user.id)?[]:[{id:S.user.id,name:S.user.name}]]:e(N).filter(n=>n.id!==S.user.id)),R[S.user.id]&&clearTimeout(R[S.user.id]),R[S.user.id]=setTimeout(()=>{m(N,e(N).filter(n=>n.id!==S.user.id))},5e3)}}},oe=async({content:S,data:Me})=>{var Q;!S&&((Me==null?void 0:Me.files)??[]).length===0||(await Bt(localStorage.token,t().id,{parent_id:O(),reply_to_id:((Q=e(me))==null?void 0:Q.id)??null,content:S,data:Me}).catch(C=>(Fe.error(`${C}`),null)),m(me,null))},K=async()=>{var S;(S=Y())==null||S.emit("events:channel",{channel_id:t().id,message_id:O(),data:{type:"typing",data:{typing:!0}}})};dt(()=>{var S;(S=Y())==null||S.on("events:channel",xe)}),jt(()=>{var S;(S=Y())==null||S.off("events:channel",xe)}),st(()=>o(O()),()=>{O()&&ne()}),lt(),Xe();var te=Ye(),ke=ye(te);{var Ie=S=>{var Me=xs(),Q=a(Me),C=a(Q),L=a(C,!0);r(C);var z=y(C,2),n=a(z),T=a(n);vt(T,{}),r(n),r(z),r(Q);var U=y(Q,2),c=a(U);{var _=d=>{Kt(d,{get id(){return O()},get channel(){return t()},get top(){return e(pe)},get messages(){return e(p)},get replyToMessage(){return e(me)},thread:!0,onReply:async w=>{var M;m(me,w),await ot(),(M=e($e))==null||M.focus()},onLoad:async()=>{const w=await Mt(localStorage.token,t().id,O(),e(p).length);if(m(p,[...e(p),...w]),w.length<50){m(pe,!0);return}}})},u=d=>{var w=hs(),M=a(w);at(M,{}),r(w),i(d,w)};b(c,d=>{e(p)!==null?d(_):d(u,!1)})}var g=y(c,2),l=a(g);{let d=se(()=>(o(t()),s(()=>{var M;return!((M=t())!=null&&M.write_access)}))),w=se(()=>(o(t()),V(),s(()=>{var M;return(M=t())!=null&&M.write_access?V().t("Reply to thread..."):V().t("You do not have permission to send messages in this thread.")})));Vt(l,{get id(){return O()},get disabled(){return e(d)},get placeholder(){return e(w)},typingUsersClassName:"from-gray-50 dark:from-gray-850",get typingUsers(){return e(N)},userSuggestions:!0,channelSuggestions:!0,onChange:K,onSubmit:oe,get replyToMessage(){return e(me)},set replyToMessage(M){m(me,M)},get chatInputElement(){return e($e)},set chatInputElement(M){m($e,M)},$$legacy:!0})}r(g),r(U),Et(U,d=>m(ie,d),()=>e(ie)),r(Me),E(d=>fe(L,d),[()=>(V(),s(()=>V().t("Thread")))]),Ae("click",n,()=>{q()()}),i(S,Me)};b(ke,S=>{t()&&S(Ie)})}i(Se,te),Ke(),ge()}var ys=f('<div class="flex-1 overflow-y-auto"><div class=" pb-2.5 max-w-full z-10 scrollbar-hidden w-full h-full pt-6 flex-1 flex flex-col-reverse overflow-auto" id="messages-container"><!></div></div> <div class=" pb-[1rem] px-2.5"><!></div>',1),bs=f('<div class=" flex items-center justify-center h-full w-full"><div class="m-auto"><!></div></div>'),ws=f("<!> <!>",1),$s=f("<div><!></div>"),ks=f('<div class=" absolute -left-1.5 -right-1.5 -top-0 -bottom-0 z-20 cursor-col-resize bg-transparent"></div>'),Ms=f('<div class="h-full w-full shadow-xl"><!></div>'),Ps=f("<!> <!>",1),zs=f("<!> <!>",1),Ts=f('<div id="channel-container"><!></div>');function Cs(Se,x){qe(x,!1);const v=()=>Ee(Rt,"$socket",O),Y=()=>Ee(kt,"$channels",O),V=()=>Ee(it,"$user",O),we=()=>Ee(wt,"$chatId",O),ge=()=>Ee(ft,"$showSidebar",O),Z=()=>Ee(Rr,"$i18n",O),[O,t]=Qe();let q=G(x,"id",8,""),p=null,pe=le(!0),ie=le(null),$e=le(null),me=le(!1),N=le(null),R=le(null),ee=le(null),ne=le(null),xe=le([]),oe={};const K=()=>{e(ie)&&et(ie,e(ie).scrollTop=e(ie).scrollHeight)},te=async n=>{var T;(T=v())==null||T.emit("events:channel",{channel_id:n,message_id:null,data:{type:"last_read_at"}}),kt.set(Y().map(U=>U.id===n?{...U,unread_count:0}:U))},ke=async()=>{p&&te(p),p=q(),te(q()),$t.set(q()),m(me,!1),m(R,null),m(N,null),m(ne,null),m(xe,[]),oe={},m(N,await Pt(localStorage.token,q()).catch(n=>null)),e(N)?(m(R,await zt(localStorage.token,q(),0)),e(R)&&(K(),e(R).length<50&&m(me,!0))):At("/")},Ie=async n=>{var T,U,c;if(n.channel_id===q()){const _=((T=n==null?void 0:n.data)==null?void 0:T.type)??null,u=((U=n==null?void 0:n.data)==null?void 0:U.data)??null;if(_==="message"){if(((u==null?void 0:u.parent_id)??null)===null){const g=(u==null?void 0:u.temp_id)??null;m(R,[{...u,temp_id:null},...e(R).filter(l=>(l==null?void 0:l.temp_id)!==g)]),e(xe).find(l=>l.id===n.user.id)&&m(xe,e(xe).filter(l=>l.id!==n.user.id)),await ot(),e(pe)&&K()}}else if(_==="message:update"){const g=e(R).findIndex(l=>l.id===u.id);g!==-1&&et(R,e(R)[g]=u)}else if(_==="message:delete")m(R,e(R).filter(g=>g.id!==u.id));else if(_==="message:reply"){const g=e(R).findIndex(l=>l.id===u.id);g!==-1&&et(R,e(R)[g]=u)}else if(_.includes("message:reaction")){const g=e(R).findIndex(l=>l.id===u.id);g!==-1&&et(R,e(R)[g]=u)}else if(_==="typing"&&n.message_id===null){if(n.user.id===((c=V())==null?void 0:c.id))return;m(xe,u.typing?[...e(xe),...e(xe).find(g=>g.id===n.user.id)?[]:[{id:n.user.id,name:n.user.name}]]:e(xe).filter(g=>g.id!==n.user.id)),oe[n.user.id]&&clearTimeout(oe[n.user.id]),oe[n.user.id]=setTimeout(()=>{m(xe,e(xe).filter(g=>g.id!==n.user.id))},5e3)}}},S=async({content:n,data:T})=>{var g,l;if(!n&&((T==null?void 0:T.files)??[]).length===0)return;const U=_r(),c={temp_id:U,content:n,data:T,reply_to_id:((g=e(ee))==null?void 0:g.id)??null},_=Date.now()*1e6;m(R,[{...c,id:U,user_id:(l=V())==null?void 0:l.id,user:V(),reply_to_message:e(ee)??null,created_at:_,updated_at:_},...e(R)]),await Bt(localStorage.token,q(),c).catch(d=>(Fe.error(`${d}`),null))&&et(ie,e(ie).scrollTop=e(ie).scrollHeight),m(ee,null)},Me=async()=>{var n;(n=v())==null||n.emit("events:channel",{channel_id:q(),message_id:null,data:{type:"typing",data:{typing:!0}}}),te(q())};let Q,C=le(!1);dt(()=>{var T;we()&&wt.set(""),(T=v())==null||T.on("events:channel",Ie),Q=window.matchMedia("(min-width: 1024px)");const n=async U=>{U.matches?m(C,!0):m(C,!1)};Q.addEventListener("change",n),n(Q)}),jt(()=>{var n;te(q()),$t.set(null),(n=v())==null||n.off("events:channel",Ie)}),st(()=>o(q()),()=>{q()&&ke()}),lt(),Xe();var L=Ts();Qt(n=>{var T=Ye(),U=ye(T);{var c=u=>{E(g=>yt.title=`${g??""}  Open WebUI`,[()=>(e(N),V(),s(()=>{var g,l;return((g=e(N))==null?void 0:g.name.trim())||((l=e(N))==null?void 0:l.users.reduce((d,w,M,X)=>{var D;return w.id===((D=V())==null?void 0:D.id)?d:d?`${d}, ${w.name}`:w.name},""))}))])},_=u=>{E(()=>yt.title=`#${e(N),s(()=>{var g;return((g=e(N))==null?void 0:g.name)??"Channel"})??""}  Open WebUI`)};b(U,u=>{e(N),s(()=>{var g;return((g=e(N))==null?void 0:g.type)==="dm"})?u(c):u(_,!1)})}i(n,T)});var z=a(L);rr(z,{direction:"horizontal",class:"w-full h-full",children:(n,T)=>{var U=zs(),c=ye(U);bt(c,{defaultSize:50,minSize:50,class:"h-full flex flex-col w-full relative",children:(l,d)=>{var w=ws(),M=ye(w);ps(M,{get channel(){return e(N)},onPin:(_e,ce)=>{m(R,e(R).map(Ne=>Ne.id===_e?{...Ne,is_pinned:ce}:Ne))},onUpdate:async()=>{m(N,await Pt(localStorage.token,q()).catch(_e=>null))}});var X=y(M,2);{var D=_e=>{var ce=ys(),Ne=ye(ce),J=a(Ne),re=a(J);er(re,q,$=>{Kt($,{get channel(){return e(N)},get top(){return e(me)},get messages(){return e(R)},get replyToMessage(){return e(ee)},onReply:async h=>{var F;m(ee,h),await ot(),(F=e($e))==null||F.focus()},onThread:h=>{m(ne,h)},onLoad:async()=>{const h=await zt(localStorage.token,q(),e(R).length);if(m(R,[...e(R),...h]),h.length<50){m(me,!0);return}}})}),r(J),Et(J,$=>m(ie,$),()=>e(ie)),r(Ne);var Pe=y(Ne,2),Le=a(Pe);{let $=se(()=>(e(N),s(()=>{var F;return!((F=e(N))!=null&&F.write_access)}))),h=se(()=>(e(N),Z(),s(()=>{var F;return(F=e(N))!=null&&F.write_access?Z().t("Type here..."):Z().t("You do not have permission to send messages in this channel.")})));Vt(Le,{id:"root",get typingUsers(){return e(xe)},get channel(){return e(N)},userSuggestions:!0,channelSuggestions:!0,get disabled(){return e($)},get placeholder(){return e(h)},onChange:Me,onSubmit:S,scrollToBottom:K,get scrollEnd(){return e(pe)},get chatInputElement(){return e($e)},set chatInputElement(F){m($e,F)},get replyToMessage(){return e(ee)},set replyToMessage(F){m(ee,F)},$$legacy:!0})}r(Pe),Ae("scroll",J,$=>{m(pe,Math.abs(e(ie).scrollTop)<=50)}),i(_e,ce)},A=_e=>{var ce=bs(),Ne=a(ce),J=a(Ne);at(J,{className:"size-5"}),r(Ne),r(ce),i(_e,ce)};b(X,_e=>{e(N)&&e(R)!==null?_e(D):_e(A,!1)})}i(l,w)},$$slots:{default:!0}});var _=y(c,2);{var u=l=>{var d=Ye(),w=ye(d);{var M=X=>{{let D=se(()=>e(ne)!==null);Ar(X,{get show(){return e(D)},onClose:()=>{m(ne,null)},children:(A,_e)=>{var ce=$s(),Ne=a(ce);Lt(Ne,{get threadId(){return e(ne)},get channel(){return e(N)},onClose:()=>{m(ne,null)}}),r(ce),E(()=>Oe(ce,1,` ${e(ne)!==null?" h-screen  w-full":"px-6 py-4"} h-full`)),i(A,ce)},$$slots:{default:!0}})}};b(w,X=>{e(ne)!==null&&X(M)})}i(l,d)},g=l=>{var d=Ye(),w=ye(d);{var M=X=>{var D=Ps(),A=ye(D);ar(A,{class:"relative flex items-center justify-center group border-l border-gray-50 dark:border-gray-850/30 hover:border-gray-200 dark:hover:border-gray-800  transition z-20",id:"controls-resizer",children:(ce,Ne)=>{var J=ks();i(ce,J)},$$slots:{default:!0}});var _e=y(A,2);bt(_e,{defaultSize:50,minSize:30,class:"h-full w-full",children:(ce,Ne)=>{var J=Ms(),re=a(J);Lt(re,{get threadId(){return e(ne)},get channel(){return e(N)},onClose:()=>{m(ne,null)}}),r(J),i(ce,J)},$$slots:{default:!0}}),i(X,D)};b(w,X=>{e(ne)!==null&&X(M)},!0)}i(l,d)};b(_,l=>{e(C)?l(g,!1):l(u)})}i(n,U)},$$slots:{default:!0}}),r(L),E(()=>Oe(L,1,`h-screen max-h-[100dvh] transition-width duration-200 ease-in-out ${ge()?"md:max-w-[calc(100%-var(--sidebar-width))]":""} w-full max-w-full flex flex-col`)),i(Se,L),Ke(),t()}function $l(Se,x){qe(x,!1);const v=()=>Ee(Jt,"$page",Y),[Y,V]=Qe();Xe(),Cs(Se,{get id(){return v().params.id}}),Ke(),V()}export{$l as component};
//# sourceMappingURL=22.BVt4ffPr.js.map
