var $r=Object.defineProperty;var Er=(Te,o,l)=>o in Te?$r(Te,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):Te[o]=l;var $a=(Te,o,l)=>Er(Te,typeof o!="symbol"?o+"":o,l);import"./CWj6FrbW.js";import"./CN51-NxK.js";import{b as Mt,g as Dt,y as Ra,o as Pa,i as k,j as e,q as yt,u as i,v as ea,e as ee,w as t,k as I,c as n,r,t as b,s as q,l as Ce,a,aY as er,p as Ct,f,m as $e,n as _e,z as We,d as we,A as qa,aT as tr,x as lt,B as fa,aX as la}from"./lUdQH9Xf.js";import{i as g}from"./a8_cTibZ.js";import{k as Na}from"./DpkLTJmG.js";import{e as ht,i as Lt}from"./CyDjujdM.js";import{s as ze,a as Le,r as La,c as za,e as Va,h as Sr}from"./AGdekky4.js";import{i as It}from"./VsCEtJ32.js";import{p as c}from"./wFFmXPqF.js";import{a as De,s as Jt,e as Nr}from"./CcA7kcll.js";import{a as ja,y as Pr,E as Za,F as fr,G as Br,i as Tr,e as mr,H as or,I as Lr,J as Or,m as hr,b as ba,c as _r,u as Da,z as ar,K as ir,T as lr,W as Rr,w as dr,x as zr}from"./CQ5nDkjA.js";import{t as jt}from"./1N3xujas.js";import{a as jr,u as Ar,e as Hr}from"./CXz3UUqn.js";import{b as Ka,H as Ea,J as vr,k as pr,K as qr,B as Sa,l as xr,m as Ha,y as cr}from"./BXNnaNI-.js";import{d as Tt}from"./I1CDPYOB.js";import"./BFK-koEx.js";import{t as Ba}from"./DTfFgf4c.js";import{b as Aa}from"./gZt8HVPH.js";import{b as xa}from"./D72e2DEW.js";import{u as gr,c as Dr}from"./m9D00WjT.js";import{f as Wr}from"./C7-mw5nO.js";import{s as Fr}from"./CO2xySUO.js";import{i as Ur}from"./sDz7gawc.js";import{a as da,W as Jr}from"./BJunrENY.js";import{P as br,N as rr}from"./DmTfDUTz.js";import{S as sr}from"./CPW-btCN.js";import{C as Vr,d as Zr,b as Kr,e as Gr,M as Oa,F as Qr,I as Ga,B as Yr}from"./DF5UxXSC.js";import{T as mt}from"./BtoSXKKz.js";import{T as Xr}from"./ClbJC1qu.js";import{X as Wa}from"./9jNi-Hzr.js";import"./BkIq4suy.js";import"./BQWQRICs.js";import{f as Ta}from"./CiB29Aqe.js";import"./CHfhHIQf.js";import"./BFmuJLeH.js";import{C as es}from"./BAX94-W5.js";import"./CeIFb-7H.js";import{S as ts}from"./BsEh57bC.js";import{C as wr}from"./7L2QCwoR.js";import{b as yr}from"./uevuQHIQ.js";import{M as kr}from"./CbKu5dqy.js";import{T as as}from"./DljGs0XM.js";import{S as nr}from"./CkkUFZ96.js";import{B as Ua}from"./9Bw9E4Yf.js";import{C as rs}from"./Cn1zB_yn.js";import{E as ss}from"./CJyvYL24.js";import{c as ns}from"./B-5ZfLrN.js";import{c as os}from"./DrHmROi9.js";import{C as is,F as Qa}from"./CVLvuhCs.js";import{s as Mr}from"./9RuGBeWD.js";import{b as ls,c as Ja}from"./VjqWeGTs.js";import{f as ds}from"./BjO3HhBo.js";import{D as vs}from"./0lhZwTI1.js";import{C as cs}from"./BEWIE6Ek.js";import{S as Ya}from"./BoK-DDlo.js";import"./B1Cj3nBs.js";import{L as gs}from"./BrFI5UBi.js";import{h as us}from"./DVvqZTde.js";import{F as fs}from"./CU2r43ac.js";import{E as ms}from"./CYbUUK24.js";var hs=f('<div class="text-xs font-medium pt-1.5 -mb-0.5"> </div>'),_s=f("<button> </button>"),ps=f("<button><!></button>"),xs=f('<div class="text-sm mt-1.5 font-medium"> </div> <div class="flex flex-wrap gap-1.5 text-sm mt-1.5"></div>',1),bs=f('<!> <div class=" my-2.5 rounded-xl px-4 py-3 border border-gray-100/30 dark:border-gray-850/30"><div class="flex justify-between items-center"><div class="text-sm font-medium"> </div> <button><!></button></div> <div class="w-full flex justify-center"><div class=" relative w-fit overflow-x-auto scrollbar-none"><div class="mt-1.5 w-fit flex gap-1 pb-2"></div> <div class="sticky top-0 bottom-0 left-0 right-0 flex justify-between text-xs"><div> </div> <div> </div></div></div></div> <div><!></div> <div class="mt-2"><textarea class="w-full text-sm px-1 py-2 bg-transparent outline-hidden resize-none rounded-xl" rows="3"></textarea></div> <div class="mt-2 gap-1.5 flex justify-between"><div class="flex items-end group"><!></div> <button class="px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"> </button></div></div>',1);function ws(Te,o){Mt(o,!1);const l=()=>De(ja,"$models",$),u=()=>De(R,"$i18n",$),L=()=>De(Pr,"$_tags",$),[$,w]=Jt(),R=Dt("i18n"),G=Ra();let te=c(o,"message",8),m=c(o,"show",12,!1),A=["accurate_information","followed_instructions_perfectly","showcased_creativity","positive_attitude","attention_to_detail","thorough_explanation","other"],Y=["dont_like_the_style","too_verbose","not_helpful","not_factually_correct","didnt_fully_follow_instructions","refused_when_it_shouldnt_have","being_lazy","other"],v=$e([]),se=$e([]),O=$e(null),X=$e(""),ce=$e(null),s=$e(null);const le=()=>{var ne,oe,N,j,S,J,W,ie,ve;e(O)||k(O,((oe=(ne=te())==null?void 0:ne.annotation)==null?void 0:oe.reason)??""),e(X)||k(X,((j=(N=te())==null?void 0:N.annotation)==null?void 0:j.comment)??""),k(v,(((J=(S=te())==null?void 0:S.annotation)==null?void 0:J.tags)??[]).map(Ne=>({name:Ne}))),e(ce)||k(ce,((ve=(ie=(W=te())==null?void 0:W.annotation)==null?void 0:ie.details)==null?void 0:ve.rating)??null)};Pa(()=>{var ne,oe;(ne=te())!=null&&ne.arena&&(k(s,l().find(N=>N.id===te().selectedModelId)),jt.success(u().t('This response was generated by "{{model}}"',{model:e(s)?((oe=e(s))==null?void 0:oe.name)??e(s).id:te().selectedModelId})))});const pe=()=>{G("save",{reason:e(O),comment:e(X),tags:e(v).map(ne=>ne.name),details:{rating:e(ce)}}),jt.success(u().t("Thanks for your feedback!")),m(!1)};yt(()=>i(te()),()=>{var ne,oe,N,j;((oe=(ne=te())==null?void 0:ne.annotation)==null?void 0:oe.rating)===1?k(se,A):((j=(N=te())==null?void 0:N.annotation)==null?void 0:j.rating)===-1&&k(se,Y)}),yt(()=>i(te()),()=>{te()&&le()}),ea(),It();var me=bs(),de=ee(me);{var xe=ne=>{var oe=hs(),N=n(oe,!0);r(oe),b(j=>q(N,j),[()=>(u(),e(s),i(te()),t(()=>{var j;return u().t('This response was generated by "{{model}}"',{model:e(s)?((j=e(s))==null?void 0:j.name)??e(s).id:te().selectedModelId})}))]),a(ne,oe)};g(de,ne=>{i(te()),t(()=>{var oe;return(oe=te())==null?void 0:oe.arena})&&ne(xe)})}var ge=I(de,2),ue=n(ge),T=n(ue),E=n(T,!0);r(T);var d=I(T,2),F=n(d);Wa(F,{className:"size-4"}),r(d),r(ue);var Q=I(ue,2),D=n(Q),y=n(D);ht(y,4,()=>t(()=>Array.from({length:10}).map((ne,oe)=>oe+1)),Lt,(ne,oe)=>{var N=_s(),j=n(N,!0);r(N),b(()=>{ze(N,1,`size-7 text-sm border border-gray-100/30 dark:border-gray-850/30 hover:bg-gray-50 dark:hover:bg-gray-850 ${e(ce)===oe?"bg-gray-100 dark:bg-gray-800":""} transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white dark:disabled:bg-gray-900`),N.disabled=(i(te()),t(()=>{var S,J;return((J=(S=te())==null?void 0:S.annotation)==null?void 0:J.rating)===-1?oe>5:oe<6})),q(j,oe)}),Ce("click",N,()=>{k(ce,oe)}),a(ne,N)}),r(y);var h=I(y,2),p=n(h),H=n(p);r(p);var x=I(p,2),M=n(x);r(x),r(h),r(D),r(Q);var _=I(Q,2),B=n(_);{var U=ne=>{var oe=xs(),N=ee(oe),j=n(N,!0);r(N);var S=I(N,2);ht(S,5,()=>e(se),Lt,(J,W)=>{var ie=ps(),ve=n(ie);{var Ne=Re=>{var Ve=We();b(Ze=>q(Ve,Ze),[()=>(u(),t(()=>u().t("Accurate information")))]),a(Re,Ve)},be=Re=>{var Ve=we(),Ze=ee(Ve);{var He=Z=>{var Ee=We();b(ye=>q(Ee,ye),[()=>(u(),t(()=>u().t("Followed instructions perfectly")))]),a(Z,Ee)},he=Z=>{var Ee=we(),ye=ee(Ee);{var Ie=re=>{var ke=We();b(Se=>q(ke,Se),[()=>(u(),t(()=>u().t("Showcased creativity")))]),a(re,ke)},Pe=re=>{var ke=we(),Se=ee(ke);{var Ke=Ue=>{var Fe=We();b(qe=>q(Fe,qe),[()=>(u(),t(()=>u().t("Positive attitude")))]),a(Ue,Fe)},ct=Ue=>{var Fe=we(),qe=ee(Fe);{var Ge=$t=>{var Et=We();b(Gt=>q(Et,Gt),[()=>(u(),t(()=>u().t("Attention to detail")))]),a($t,Et)},Ye=$t=>{var Et=we(),Gt=ee(Et);{var ft=Ot=>{var Qt=We();b(Yt=>q(Qt,Yt),[()=>(u(),t(()=>u().t("Thorough explanation")))]),a(Ot,Qt)},Wt=Ot=>{var Qt=we(),Yt=ee(Qt);{var ma=ta=>{var aa=We();b(ca=>q(aa,ca),[()=>(u(),t(()=>u().t("Don't like the style")))]),a(ta,aa)},wa=ta=>{var aa=we(),ca=ee(aa);{var ha=ra=>{var ia=We();b(ga=>q(ia,ga),[()=>(u(),t(()=>u().t("Too verbose")))]),a(ra,ia)},ya=ra=>{var ia=we(),ga=ee(ia);{var ka=Me=>{var Oe=We();b(Be=>q(Oe,Be),[()=>(u(),t(()=>u().t("Not helpful")))]),a(Me,Oe)},Ae=Me=>{var Oe=we(),Be=ee(Oe);{var Je=rt=>{var nt=We();b(dt=>q(nt,dt),[()=>(u(),t(()=>u().t("Not factually correct")))]),a(rt,nt)},Xe=rt=>{var nt=we(),dt=ee(nt);{var et=tt=>{var at=We();b(kt=>q(at,kt),[()=>(u(),t(()=>u().t("Didn't fully follow instructions")))]),a(tt,at)},je=tt=>{var at=we(),kt=ee(at);{var Vt=Rt=>{var Xt=We();b(ua=>q(Xt,ua),[()=>(u(),t(()=>u().t("Refused when it shouldn't have")))]),a(Rt,Xt)},Zt=Rt=>{var Xt=we(),ua=ee(Xt);{var Ma=sa=>{var At=We();b(Ft=>q(At,Ft),[()=>(u(),t(()=>u().t("Being lazy")))]),a(sa,At)},Ca=sa=>{var At=we(),Ft=ee(At);{var Kt=Ht=>{var _a=We();b(_t=>q(_a,_t),[()=>(u(),t(()=>u().t("Other")))]),a(Ht,_a)},na=Ht=>{var _a=We();b(()=>q(_a,e(W))),a(Ht,_a)};g(Ft,Ht=>{e(W)==="other"?Ht(Kt):Ht(na,!1)},!0)}a(sa,At)};g(ua,sa=>{e(W)==="being_lazy"?sa(Ma):sa(Ca,!1)},!0)}a(Rt,Xt)};g(kt,Rt=>{e(W)==="refused_when_it_shouldnt_have"?Rt(Vt):Rt(Zt,!1)},!0)}a(tt,at)};g(dt,tt=>{e(W)==="didnt_fully_follow_instructions"?tt(et):tt(je,!1)},!0)}a(rt,nt)};g(Be,rt=>{e(W)==="not_factually_correct"?rt(Je):rt(Xe,!1)},!0)}a(Me,Oe)};g(ga,Me=>{e(W)==="not_helpful"?Me(ka):Me(Ae,!1)},!0)}a(ra,ia)};g(ca,ra=>{e(W)==="too_verbose"?ra(ha):ra(ya,!1)},!0)}a(ta,aa)};g(Yt,ta=>{e(W)==="dont_like_the_style"?ta(ma):ta(wa,!1)},!0)}a(Ot,Qt)};g(Gt,Ot=>{e(W)==="thorough_explanation"?Ot(ft):Ot(Wt,!1)},!0)}a($t,Et)};g(qe,$t=>{e(W)==="attention_to_detail"?$t(Ge):$t(Ye,!1)},!0)}a(Ue,Fe)};g(Se,Ue=>{e(W)==="positive_attitude"?Ue(Ke):Ue(ct,!1)},!0)}a(re,ke)};g(ye,re=>{e(W)==="showcased_creativity"?re(Ie):re(Pe,!1)},!0)}a(Z,Ee)};g(Ze,Z=>{e(W)==="followed_instructions_perfectly"?Z(He):Z(he,!1)},!0)}a(Re,Ve)};g(ve,Re=>{e(W)==="accurate_information"?Re(Ne):Re(be,!1)})}r(ie),b(()=>ze(ie,1,`px-3 py-0.5 border border-gray-100/30 dark:border-gray-850/30 hover:bg-gray-50 dark:hover:bg-gray-850 ${e(O)===e(W)?"bg-gray-100 dark:bg-gray-800":""} transition rounded-xl`)),Ce("click",ie,()=>{k(O,e(W))}),a(J,ie)}),r(S),b(J=>q(j,J),[()=>(u(),t(()=>u().t("Why?")))]),a(ne,oe)};g(B,ne=>{e(se),t(()=>e(se).length>0)&&ne(U)})}r(_);var z=I(_,2),C=n(z);er(C),r(z);var V=I(z,2),P=n(V),ae=n(P);{let ne=_e(()=>L()??[]);Xr(ae,{get tags(){return e(v)},get suggestionTags(){return e(ne)},$$events:{delete:oe=>{k(v,e(v).filter(N=>N.name.replaceAll(" ","_").toLowerCase()!==oe.detail.replaceAll(" ","_").toLowerCase()))},add:oe=>{k(v,[...e(v),{name:oe.detail}])}}})}r(P);var K=I(P,2),fe=n(K,!0);r(K),r(V),r(ge),b((ne,oe,N,j,S)=>{Le(ge,"id",`message-feedback-${i(te()),t(()=>te().id)??""}`),q(E,ne),q(H,`1 - ${oe??""}`),q(M,`10 - ${N??""}`),Le(C,"placeholder",j),q(fe,S)},[()=>(u(),t(()=>u().t("How would you rate this response?"))),()=>(u(),t(()=>u().t("Awful"))),()=>(u(),t(()=>u().t("Amazing"))),()=>(u(),t(()=>u().t("Feel free to add specific details"))),()=>(u(),t(()=>u().t("Save")))]),Ce("click",d,()=>{m(!1)}),Aa(C,()=>e(X),ne=>k(X,ne)),Ce("click",K,()=>{pe()}),a(Te,me),Ct(),w()}var ys=f('<div class="flex items-center gap-2 text-gray-500 transition"><!> <!></div>'),ks=f('<a target="_blank" class="flex w-full items-center p-1 px-3 group/item justify-between text-gray-800 dark:text-gray-300 font-normal! no-underline!"><div class="flex gap-2 items-center"><!> <div class=" line-clamp-1"> </div></div> <div class=" ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg></div></a>'),Ms=f('<a target="_blank" class="flex w-full items-center p-1 px-3 group/item justify-between text-gray-800 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-850 rounded-lg font-normal! no-underline! mb-1"><div class=" flex justify-center items-center gap-3"><div class="w-fit"><img alt="favicon" class="size-3.5"/></div> <div class="w-full text-sm line-clamp-1"> </div></div> <div class=" ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg></div></a>'),Cs=f('<a target="_blank" class="flex w-full items-center p-1 px-3 group/item justify-between text-gray-800 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-850 rounded-lg no-underline mb-1"><div class=" flex justify-center items-center gap-3"><div class="w-fit"><img alt="favicon" class="size-3.5"/></div> <div class="w-full text-sm line-clamp-1"> </div></div> <div class=" ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg></div></a>'),Is=f('<div class="text-sm border border-gray-50 dark:border-gray-850/30 rounded-xl my-1.5 p-2 w-full" slot="content"><!> <!></div>');function $s(Te,o){Mt(o,!1);let l=c(o,"status",24,()=>({urls:[],query:""})),u=$e(!1);It(),Vr(Te,{grow:!0,className:"w-full",buttonClassName:"w-full",get open(){return e(u)},set open(L){k(u,L)},children:(L,$)=>{var w=ys(),R=n(w);Mr(R,o,"default",{},null);var G=I(R,2);{var te=A=>{cs(A,{strokeWidth:"2.5",className:"size-3.5 "})},m=A=>{es(A,{strokeWidth:"2.5",className:"size-3.5 "})};g(G,A=>{e(u)?A(te):A(m,!1)})}r(w),a(L,w)},$$slots:{default:!0,content:(L,$)=>{var w=Is(),R=n(w);{var G=Y=>{var v=ks(),se=n(v),O=n(se);Ya(O,{});var X=I(O,2),ce=n(X,!0);r(X),r(se),qa(2),r(v),b(()=>{Le(v,"href",`https://www.google.com/search?q=${i(l()),t(()=>l().query)??""}`),q(ce,(i(l()),t(()=>l().query)))}),a(Y,v)};g(R,Y=>{i(l()),t(()=>{var v;return(v=l())==null?void 0:v.query})&&Y(G)})}var te=I(R,2);{var m=Y=>{var v=we(),se=ee(v);ht(se,1,()=>(i(l()),t(()=>l().items)),Lt,(O,X)=>{var ce=Ms(),s=n(ce),le=n(s),pe=n(le);r(le);var me=I(le,2),de=n(me,!0);r(me),r(s),qa(2),r(ce),b(()=>{Le(ce,"href",(e(X),t(()=>e(X).link))),Le(pe,"src",`https://www.google.com/s2/favicons?sz=32&domain=${e(X),t(()=>e(X).link)??""}`),q(de,(e(X),t(()=>{var xe;return((xe=e(X))==null?void 0:xe.title)??e(X).link})))}),a(O,ce)}),a(Y,v)},A=Y=>{var v=we(),se=ee(v);{var O=X=>{var ce=we(),s=ee(ce);ht(s,1,()=>(i(l()),t(()=>l().urls)),Lt,(le,pe)=>{var me=Cs(),de=n(me),xe=n(de),ge=n(xe);r(xe);var ue=I(xe,2),T=n(ue,!0);r(ue),r(de),qa(2),r(me),b(()=>{Le(me,"href",e(pe)),Le(ge,"src",`https://www.google.com/s2/favicons?sz=32&domain=${e(pe)??""}`),q(T,e(pe))}),a(le,me)}),a(X,ce)};g(se,X=>{i(l()),t(()=>{var ce;return(ce=l())==null?void 0:ce.urls})&&X(O)},!0)}a(Y,v)};g(te,Y=>{i(l()),t(()=>{var v;return(v=l())==null?void 0:v.items})?Y(m):Y(A,!1)})}r(w),a(L,w)}},$$legacy:!0}),Ct()}var Es=f('<div class="flex my-2 gap-2.5 border px-4 py-3 border-red-600/10 bg-red-600/10 rounded-lg"><div class=" self-start mt-0.5"><!></div> <div class=" self-center text-sm"><!></div></div>');function Ss(Te,o){Mt(o,!1);let l=c(o,"content",8,"");It();var u=Es(),L=n(u),$=n(L);Zr($,{className:"size-5 text-red-700 dark:text-red-400"}),r(L);var w=I(L,2),R=n(w);{var G=m=>{var A=We();b(()=>q(A,l())),a(m,A)},te=m=>{var A=we(),Y=ee(A);{var v=O=>{var X=we(),ce=ee(X);{var s=pe=>{var me=We();b(()=>q(me,(i(l()),t(()=>l().error.message)))),a(pe,me)},le=pe=>{var me=we(),de=ee(me);{var xe=ue=>{var T=We();b(()=>q(T,(i(l()),t(()=>l().detail)))),a(ue,T)},ge=ue=>{var T=we(),E=ee(T);{var d=Q=>{var D=We();b(()=>q(D,(i(l()),t(()=>l().message)))),a(Q,D)},F=Q=>{var D=We();b(y=>q(D,y),[()=>(i(l()),t(()=>JSON.stringify(l())))]),a(Q,D)};g(E,Q=>{i(l()),t(()=>{var D;return(D=l())==null?void 0:D.message})?Q(d):Q(F,!1)},!0)}a(ue,T)};g(de,ue=>{i(l()),t(()=>{var T;return(T=l())==null?void 0:T.detail})?ue(xe):ue(ge,!1)},!0)}a(pe,me)};g(ce,pe=>{i(l()),t(()=>{var me,de,xe;return((me=l())==null?void 0:me.error)&&((xe=(de=l())==null?void 0:de.error)==null?void 0:xe.message)})?pe(s):pe(le,!1)})}a(O,X)},se=O=>{var X=We();b(ce=>q(X,ce),[()=>(i(l()),t(()=>JSON.stringify(l())))]),a(O,X)};g(Y,O=>{typeof l()=="object"&&l()!==null?O(v):O(se,!1)},!0)}a(m,A)};g(R,m=>{typeof l()=="string"?m(G):m(te,!1)})}r(w),r(u),a(Te,u),Ct()}var Ns=f('<a class="hover:text-gray-500 dark:hover:text-gray-100 underline grow line-clamp-1" target="_blank"> </a>'),Ps=f('<div><div class="text-sm font-medium dark:text-gray-300 mb-1"> </div> <!></div>'),Bs=f("<span> </span>"),Ts=f('<span class="text-gray-500 dark:text-gray-500"> </span>'),Ls=f('<div class="text-sm my-1 dark:text-gray-400 flex items-center gap-2 w-fit"><!></div>'),Os=f('<span class="text-sm text-gray-500 dark:text-gray-400"> </span>'),Rs=f('<iframe class="w-full border-0 h-auto rounded-none" sandbox="allow-scripts allow-forms allow-same-origin"></iframe>'),zs=f('<pre class="text-sm dark:text-gray-400 whitespace-pre-line"> </pre>'),js=f('<div class="flex flex-col w-full gap-2"><!> <div><div class=" text-sm font-medium dark:text-gray-300 flex items-center gap-2 w-fit mb-1"> <!> <!></div> <!></div></div>'),As=f('<div><div class=" flex justify-between dark:text-gray-300 px-4.5 pt-3 pb-2"><div class=" text-lg font-medium self-center flex items-center"><!></div> <button class="self-center"><!></button></div> <div class="flex flex-col md:flex-row w-full px-5 pb-5 md:space-x-4"><div class="flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-thin gap-1"></div></div></div>');function Hs(Te,o){Mt(o,!1);const l=()=>De($,"$i18n",u),[u,L]=Jt(),$=Dt("i18n");let w=c(o,"show",12,!1),R=c(o,"citation",8),G=c(o,"showPercentage",8,!1),te=c(o,"showRelevance",8,!0),m=$e([]);function A(se){return typeof se!="number"?null:se<0?0:se>1?100:Math.round(se*1e4)/100}function Y(se){return se>=80?"bg-green-200 dark:bg-green-800 text-green-800 dark:text-green-200":se>=60?"bg-yellow-200 dark:bg-yellow-800 text-yellow-800 dark:text-yellow-200":se>=40?"bg-orange-200 dark:bg-orange-800 text-orange-800 dark:text-orange-200":"bg-red-200 dark:bg-red-800 text-red-800 dark:text-red-200"}const v=se=>{try{return decodeURIComponent(se)}catch{return se}};yt(()=>(i(R()),e(m)),()=>{var se;R()&&(k(m,(se=R().document)==null?void 0:se.map((O,X)=>{var ce,s;return{source:R().source,document:O,metadata:(ce=R().metadata)==null?void 0:ce[X],distance:(s=R().distances)==null?void 0:s[X]}})),e(m).every(O=>O.distance!==void 0)&&k(m,e(m).sort((O,X)=>(X.distance??1/0)-(O.distance??1/0))))}),ea(),It(),kr(Te,{size:"lg",get show(){return w()},set show(se){w(se)},children:(se,O)=>{var X=As(),ce=n(X),s=n(ce),le=n(s);{var pe=T=>{const E=_e(()=>(e(m),t(()=>{var y;return(y=e(m))==null?void 0:y[0]})));var d=we(),F=ee(d);{var Q=y=>{{let h=_e(()=>(i(e(E)),l(),t(()=>{var p,H;return(H=(p=e(E).source)==null?void 0:p.url)!=null&&H.includes("http")?l().t("Open link"):l().t("Open file")})));mt(y,{className:"w-fit",get content(){return e(h)},placement:"top-start",tippyOptions:{duration:[500,0]},children:(p,H)=>{var x=Ns(),M=n(x,!0);r(x),b((_,B)=>{Le(x,"href",_),q(M,B)},[()=>(i(e(E)),i(da),t(()=>{var _,B,U,z,C,V,P,ae;return(B=(_=e(E))==null?void 0:_.metadata)!=null&&B.file_id?`${da}/files/${(z=(U=e(E))==null?void 0:U.metadata)==null?void 0:z.file_id}/content${((V=(C=e(E))==null?void 0:C.metadata)==null?void 0:V.page)!==void 0?`#page=${e(E).metadata.page+1}`:""}`:(ae=(P=e(E).source)==null?void 0:P.url)!=null&&ae.includes("http")?e(E).source.url:"#"})),()=>(i(R()),t(()=>{var _,B;return v((B=(_=R())==null?void 0:_.source)==null?void 0:B.name)}))]),a(p,x)},$$slots:{default:!0}})}},D=y=>{var h=We();b(p=>q(h,p),[()=>(i(R()),t(()=>{var p,H;return v((H=(p=R())==null?void 0:p.source)==null?void 0:H.name)}))]),a(y,h)};g(F,y=>{i(e(E)),t(()=>{var h,p,H,x;return((p=(h=e(E))==null?void 0:h.metadata)==null?void 0:p.file_id)||((x=(H=e(E).source)==null?void 0:H.url)==null?void 0:x.includes("http"))})?y(Q):y(D,!1)})}a(T,d)},me=T=>{var E=We();b(d=>q(E,d),[()=>(l(),t(()=>l().t("Citation")))]),a(T,E)};g(le,T=>{i(R()),t(()=>{var E,d;return(d=(E=R())==null?void 0:E.source)==null?void 0:d.name})?T(pe):T(me,!1)})}r(s);var de=I(s,2),xe=n(de);Wa(xe,{className:"size-5"}),r(de),r(ce);var ge=I(ce,2),ue=n(ge);ht(ue,5,()=>e(m),Lt,(T,E)=>{var d=js(),F=n(d);{var Q=z=>{var C=Ps(),V=n(C),P=n(V,!0);r(V);var ae=I(V,2);{let K=_e(()=>(e(E),t(()=>JSON.stringify(e(E).metadata.parameters,null,2))));as(ae,{readonly:!0,get value(){return e(K)}})}r(C),b(K=>q(P,K),[()=>(l(),t(()=>l().t("Parameters")))]),a(z,C)};g(F,z=>{e(E),t(()=>{var C;return(C=e(E).metadata)==null?void 0:C.parameters})&&z(Q)})}var D=I(F,2),y=n(D),h=n(y),p=I(h);{var H=z=>{{let C=_e(()=>(l(),t(()=>l().t("Relevance"))));mt(z,{className:"w-fit",get content(){return e(C)},placement:"top-start",tippyOptions:{duration:[500,0]},children:(V,P)=>{var ae=Ls(),K=n(ae);{var fe=oe=>{const N=_e(()=>(e(E),t(()=>A(e(E).distance))));var j=we(),S=ee(j);{var J=W=>{var ie=Bs(),ve=n(ie);r(ie),b((Ne,be)=>{ze(ie,1,Ne),q(ve,`${be??""}%`)},[()=>(i(e(N)),t(()=>`px-1 rounded-sm font-medium ${Y(e(N))}`)),()=>(i(e(N)),t(()=>e(N).toFixed(2)))]),a(W,ie)};g(S,W=>{typeof e(N)=="number"&&W(J)})}a(oe,j)},ne=oe=>{var N=we(),j=ee(N);{var S=J=>{var W=Ts(),ie=n(W);r(W),b(ve=>q(ie,`(${ve??""})`),[()=>(e(E),t(()=>{var ve;return(((ve=e(E))==null?void 0:ve.distance)??0).toFixed(4)}))]),a(J,W)};g(j,J=>{e(E),t(()=>{var W;return typeof((W=e(E))==null?void 0:W.distance)=="number"})&&J(S)},!0)}a(oe,N)};g(K,oe=>{G()?oe(fe):oe(ne,!1)})}r(ae),a(V,ae)},$$slots:{default:!0}})}};g(p,z=>{i(te()),e(E),t(()=>te()&&e(E).distance!==void 0)&&z(H)})}var x=I(p,2);{var M=z=>{var C=Os(),V=n(C);r(C),b(P=>q(V,`(${P??""}
										${e(E),t(()=>e(E).metadata.page+1)??""})`),[()=>(l(),t(()=>l().t("page")))]),a(z,C)};g(x,z=>{e(E),t(()=>{var C,V;return Number.isInteger((V=(C=e(E))==null?void 0:C.metadata)==null?void 0:V.page)})&&z(M)})}r(y);var _=I(y,2);{var B=z=>{var C=Rs();b(V=>{Le(C,"srcdoc",(e(E),t(()=>e(E).document))),Le(C,"title",V)},[()=>(l(),t(()=>l().t("Content")))]),a(z,C)},U=z=>{var C=zs(),V=n(C,!0);r(C),b(P=>q(V,P),[()=>(e(E),t(()=>e(E).document.trim().replace(/\n\n+/g,`

`)))]),a(z,C)};g(_,z=>{e(E),t(()=>{var C;return(C=e(E).metadata)==null?void 0:C.html})?z(B):z(U,!1)})}r(D),r(d),b(z=>q(h,`${z??""} `),[()=>(l(),t(()=>l().t("Content")))]),a(T,d)}),r(ue),r(ge),r(X),Ce("click",de,()=>{w(!1)}),a(se,X)},$$slots:{default:!0},$$legacy:!0}),Ct(),L()}var qs=f('<img alt="favicon" class="size-4 rounded-full shrink-0 border border-white dark:border-gray-850 bg-white dark:bg-gray-900"/>'),Ds=f('<div class="flex -space-x-1 items-center"></div>'),Ws=f('<div class=" py-1 -mx-0.5 w-full flex gap-1 items-center flex-wrap"><button class="text-xs font-medium text-gray-600 dark:text-gray-300 px-3.5 h-8 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition flex items-center gap-1 border border-gray-50 dark:border-gray-850/30"><!> <div><!></div></button></div>'),Fs=f('<button class="no-toggle outline-hidden flex dark:text-gray-300 bg-transparent text-gray-600 rounded-xl gap-1.5 items-center"><div class=" font-medium bg-gray-50 dark:bg-gray-850 rounded-md px-1"></div> <div class="flex-1 truncate hover:text-black dark:text-white/60 dark:hover:text-white transition text-left"> </div></button>'),Us=f('<div class="py-1.5"><div class="text-xs gap-2 flex flex-col"></div></div>'),Js=f("<!> <!> <!>",1);function Vs(Te,o){Mt(o,!1);const l=()=>De($,"$i18n",u),[u,L]=Jt(),$=Dt("i18n");let w=c(o,"id",8,""),R=c(o,"chatId",8,""),G=c(o,"sources",24,()=>[]),te=c(o,"readOnly",8,!1),m=$e([]),A=$e(!1),Y=$e(!0),v=$e(!1),se=$e(!1),O=$e(null);const X=d=>{var F,Q,D,y;if(e(m)[d])if(e(m)[d],(Q=(F=e(m)[d])==null?void 0:F.source)!=null&&Q.embed_url){const h=e(m)[d].source.embed_url;if(h)if(te()){window.open(h,"_blank");return}else Za.set(!0),fr.set(!0),Br.set({url:h,title:((y=(D=e(m)[d])==null?void 0:D.source)==null?void 0:y.name)||"Embedded Content",source:e(m)[d],chatId:R(),messageId:w()});else k(O,e(m)[d]),k(se,!0)}else k(O,e(m)[d]),k(se,!0)};function ce(d){const F=d.flatMap(y=>y.distances??[]),Q=F.filter(y=>y!==void 0&&y>=-1&&y<=1).length,D=F.filter(y=>y!==void 0&&(y<-1||y>1)).length;return!(F.length===0||Q===F.length-1&&D===1||D===F.length-1&&Q===1)}function s(d){return d.flatMap(Q=>Q.distances??[]).every(Q=>Q!==void 0&&Q>=-1&&Q<=1)}const le=d=>{try{return decodeURIComponent(d)}catch{return d}};yt(()=>(e(m),i(G())),()=>{k(m,G().reduce((d,F)=>{var Q;return Object.keys(F).length===0||(Q=F==null?void 0:F.document)==null||Q.forEach((D,y)=>{var _,B,U;const h=(_=F==null?void 0:F.metadata)==null?void 0:_[y],p=(B=F==null?void 0:F.distances)==null?void 0:B[y],H=(h==null?void 0:h.source)??((U=F==null?void 0:F.source)==null?void 0:U.id)??"N/A";let x=F==null?void 0:F.source;h!=null&&h.name&&(x={...x,name:h.name}),(H.startsWith("http://")||H.startsWith("https://"))&&(x={...x,name:H,url:H});const M=d.find(z=>z.id===H);M?(M.document.push(D),M.metadata.push(h),p!==void 0&&M.distances.push(p)):d.push({id:H,source:x,document:[D],metadata:h?[h]:[],distances:p!==void 0?[p]:[]})}),d},[])),e(m),k(Y,ce(e(m))),k(A,s(e(m)))}),ea();var pe={showSourceModal:X};It();var me=Js(),de=ee(me);Hs(de,{get citation(){return e(O)},get showPercentage(){return e(A)},get showRelevance(){return e(Y)},get show(){return e(se)},set show(d){k(se,d)},$$legacy:!0});var xe=I(de,2);{var ge=d=>{const F=_e(()=>(e(m),t(()=>e(m).filter(_=>{var B,U;return(U=(B=_==null?void 0:_.source)==null?void 0:B.name)==null?void 0:U.startsWith("http")}))));var Q=Ws(),D=n(Q),y=n(D);{var h=_=>{var B=Ds();ht(B,5,()=>(i(e(F)),t(()=>e(F).slice(0,3))),Lt,(U,z)=>{var C=qs();b(()=>Le(C,"src",`https://www.google.com/s2/favicons?sz=32&domain=${e(z),t(()=>e(z).source.name)??""}`)),a(U,C)}),r(B),a(_,B)};g(y,_=>{i(e(F)),t(()=>e(F).length>0)&&_(h)})}var p=I(y,2),H=n(p);{var x=_=>{var B=We();b(U=>q(B,U),[()=>(l(),t(()=>l().t("1 Source")))]),a(_,B)},M=_=>{var B=We();b(U=>q(B,U),[()=>(l(),e(m),t(()=>l().t("{{COUNT}} Sources",{COUNT:e(m).length})))]),a(_,B)};g(H,_=>{e(m),t(()=>e(m).length===1)?_(x):_(M,!1)})}r(p),r(D),r(Q),Ce("click",D,()=>{k(v,!e(v))}),a(d,Q)};g(xe,d=>{e(m),t(()=>e(m).length>0)&&d(ge)})}var ue=I(xe,2);{var T=d=>{var F=Us(),Q=n(F);ht(Q,5,()=>e(m),Lt,(D,y,h)=>{var p=Fs(),H=n(p);H.textContent=h+1;var x=I(H,2),M=n(x,!0);r(x),r(p),b(_=>{Le(p,"id",`source-${w()}-${h+1}`),q(M,_)},[()=>(e(y),t(()=>le(e(y).source.name)))]),Ce("click",p,()=>{k(se,!0),k(O,e(y))}),a(D,p)}),r(Q),r(F),a(d,F)};g(ue,d=>{e(v)&&d(T)})}a(Te,me),yr(o,"showSourceModal",X);var E=Ct(pe);return L(),E}var Zs=f("<div><!></div>"),Ks=f("<div><!></div>"),Gs=f('<div><div class=" text-gray-500 text-xs mb-1"> </div> <div class="text-sm"> </div></div>'),Qs=f('<div><div class=" text-gray-500 text-xs mb-1"> </div> <div class="text-sm"> </div></div>'),Ys=f('<div class="dark:bg-[#202123] dark:text-white px-4 py-4 rounded-b-lg flex flex-col gap-3"><!> <!></div>'),Xs=f('<li><a target="_blank"> </a></li>'),en=f('<div class="flex flex-col w-full"><hr class="border-gray-100/30 dark:border-gray-850/30 my-2"/> <div class=" text-sm font-medium dark:text-gray-300"> </div> <ul class="mt-1 list-disc pl-4 text-xs"></ul></div>'),tn=f('<div><div class="flex justify-between dark:text-gray-300 px-5 pt-4 pb-2"><div class="text-lg font-medium self-center flex flex-col gap-0.5 capitalize"><!> <div class="flex gap-2 items-center"><!> <div><!></div></div></div> <button class="self-center"><!></button></div> <div class="flex flex-col md:flex-row w-full px-4 pb-5"><div class="flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden"><div class="flex flex-col w-full"><!></div> <!> <!></div></div></div>');function an(Te,o){Mt(o,!1);const l=()=>De($,"$i18n",u),[u,L]=Jt(),$=Dt("i18n");let w=c(o,"show",12,!1),R=c(o,"codeExecution",12,null);It(),kr(Te,{size:"lg",get show(){return w()},set show(G){w(G)},children:(G,te)=>{var m=tn(),A=n(m),Y=n(A),v=n(Y);{var se=y=>{var h=Zs(),p=n(h);{var H=M=>{Ua(M,{type:"error",content:"error"})},x=M=>{var _=we(),B=ee(_);{var U=C=>{Ua(C,{type:"success",content:"success"})},z=C=>{Ua(C,{type:"warning",content:"incomplete"})};g(B,C=>{i(R()),t(()=>{var V;return(V=R().result)==null?void 0:V.output})?C(U):C(z,!1)},!0)}a(M,_)};g(p,M=>{i(R()),t(()=>{var _;return(_=R().result)==null?void 0:_.error})?M(H):M(x,!1)})}r(h),a(y,h)};g(v,y=>{i(R()),t(()=>{var h;return(h=R())==null?void 0:h.result})&&y(se)})}var O=I(v,2),X=n(O);{var ce=y=>{var h=Ks(),p=n(h);nr(p,{className:"size-4"}),r(h),a(y,h)};g(X,y=>{i(R()),t(()=>{var h;return!((h=R())!=null&&h.result)})&&y(ce)})}var s=I(X,2),le=n(s);{var pe=y=>{var h=We();b(p=>q(h,`${p??""}: ${i(R()),t(()=>{var H;return(H=R())==null?void 0:H.name})??""}`),[()=>(l(),t(()=>l().t("Code execution")))]),a(y,h)},me=y=>{var h=We();b(p=>q(h,p),[()=>(l(),t(()=>l().t("Code execution")))]),a(y,h)};g(le,y=>{i(R()),t(()=>{var h;return(h=R())==null?void 0:h.name})?y(pe):y(me,!1)})}r(s),r(O),r(Y);var de=I(Y,2),xe=n(de);Wa(xe,{className:"size-5"}),r(de),r(A);var ge=I(A,2),ue=n(ge),T=n(ue),E=n(T);{let y=_e(()=>(i(R()),t(()=>{var x;return(x=R())==null?void 0:x.id}))),h=_e(()=>(i(R()),t(()=>{var x;return((x=R())==null?void 0:x.language)??""}))),p=_e(()=>(i(R()),t(()=>{var x;return((x=R())==null?void 0:x.code)??""}))),H=_e(()=>(i(R()),t(()=>{var x,M,_,B,U;return(x=R())!=null&&x.result&&((_=(M=R())==null?void 0:M.result)!=null&&_.error||(U=(B=R())==null?void 0:B.result)!=null&&U.output)?"rounded-b-none":""})));Kr(E,{get id(){return`code-exec-${e(y)??""}-code`},get lang(){return e(h)},get code(){return e(p)},className:"",get editorClassName(){return e(H)},run:!1})}r(T);var d=I(T,2);{var F=y=>{var h=Ys(),p=n(h);{var H=_=>{var B=Gs(),U=n(B),z=n(U,!0);r(U);var C=I(U,2),V=n(C,!0);r(C),r(B),b(P=>{q(z,P),q(V,(i(R()),t(()=>{var ae,K;return(K=(ae=R())==null?void 0:ae.result)==null?void 0:K.error})))},[()=>(l(),t(()=>l().t("ERROR")))]),a(_,B)};g(p,_=>{i(R()),t(()=>{var B,U;return(U=(B=R())==null?void 0:B.result)==null?void 0:U.error})&&_(H)})}var x=I(p,2);{var M=_=>{var B=Qs(),U=n(B),z=n(U,!0);r(U);var C=I(U,2),V=n(C,!0);r(C),r(B),b(P=>{q(z,P),q(V,(i(R()),t(()=>{var ae,K;return(K=(ae=R())==null?void 0:ae.result)==null?void 0:K.output})))},[()=>(l(),t(()=>l().t("OUTPUT")))]),a(_,B)};g(x,_=>{i(R()),t(()=>{var B,U;return(U=(B=R())==null?void 0:B.result)==null?void 0:U.output})&&_(M)})}r(h),a(y,h)};g(d,y=>{i(R()),t(()=>{var h,p,H,x,M;return((h=R())==null?void 0:h.result)&&(((H=(p=R())==null?void 0:p.result)==null?void 0:H.error)||((M=(x=R())==null?void 0:x.result)==null?void 0:M.output))})&&y(F)})}var Q=I(d,2);{var D=y=>{var h=en(),p=I(n(h),2),H=n(p,!0);r(p);var x=I(p,2);ht(x,5,()=>(i(R()),t(()=>{var M,_;return(_=(M=R())==null?void 0:M.result)==null?void 0:_.files})),Lt,(M,_)=>{var B=Xs(),U=n(B),z=n(U,!0);r(U),r(B),b(()=>{Le(U,"href",(e(_),t(()=>e(_).url))),q(z,(e(_),t(()=>e(_).name)))}),a(M,B)}),r(x),r(h),b(M=>q(H,M),[()=>(l(),t(()=>l().t("Files")))]),a(y,h)};g(Q,y=>{i(R()),t(()=>{var h,p,H,x;return((p=(h=R())==null?void 0:h.result)==null?void 0:p.files)&&((x=(H=R())==null?void 0:H.result)==null?void 0:x.files.length)>0})&&y(D)})}r(ue),r(ge),r(m),Ce("click",de,()=>{w(!1),R(null)}),a(G,m)},$$slots:{default:!0},$$legacy:!0}),Ct(),L()}var rn=f('<div class="flex gap-1 text-xs font-semibold svelte-tclqny"><button class="flex dark:text-gray-300 py-1 px-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-xl max-w-96 svelte-tclqny"><div class="bg-white dark:bg-gray-700 rounded-full size-4 flex items-center justify-center svelte-tclqny"><!></div> <div> </div></button></div>'),sn=f('<div class="mt-1 mb-2 w-full flex gap-1 items-center flex-wrap svelte-tclqny"></div>'),nn=f("<!> <!>",1);function on(Te,o){Mt(o,!1);let l=c(o,"codeExecutions",24,()=>[]),u=$e(null),L=$e(!1);const $=()=>{e(u)&&k(u,l().find(m=>m.id===e(u).id))};yt(()=>i(l()),()=>{l()&&$()}),ea(),It();var w=nn(),R=ee(w);an(R,{get codeExecution(){return e(u)},get show(){return e(L)},set show(m){k(L,m)},$$legacy:!0});var G=I(R,2);{var te=m=>{var A=sn();ht(A,5,l,Y=>Y.id,(Y,v)=>{var se=rn(),O=n(se),X=n(O),ce=n(X);{var s=de=>{var xe=we(),ge=ee(xe);{var ue=E=>{Wa(E,{})},T=E=>{var d=we(),F=ee(d);{var Q=y=>{rs(y,{strokeWidth:"3",className:"size-3"})},D=y=>{ss(y,{})};g(F,y=>{e(v),t(()=>{var h;return(h=e(v).result)==null?void 0:h.output})?y(Q):y(D,!1)},!0)}a(E,d)};g(ge,E=>{e(v),t(()=>{var d;return(d=e(v).result)==null?void 0:d.error})?E(ue):E(T,!1)})}a(de,xe)},le=de=>{nr(de,{className:"size-4"})};g(ce,de=>{e(v),t(()=>{var xe;return(xe=e(v))==null?void 0:xe.result})?de(s):de(le,!1)})}r(X);var pe=I(X,2),me=n(pe,!0);r(pe),r(O),r(se),b(()=>{ze(pe,1,`flex-1 mx-2 line-clamp-1 code-execution-name ${e(v),t(()=>{var de;return(de=e(v))!=null&&de.result?"":"pulse"})??""}`,"svelte-tclqny"),q(me,(e(v),t(()=>e(v).name)))}),Ce("click",O,()=>{k(u,e(v)),k(L,!0)}),a(Y,se)}),r(A),a(m,A)};g(G,m=>{i(l()),t(()=>l().length>0)&&m(te)})}a(Te,w),Ct()}var ln=f('<button class="px-1.5 py-[1px] hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl flex items-center gap-1 min-w-fit transition"><!> <div class="shrink-0"> </div></button>'),dn=f('<div class="flex flex-row shrink-0 p-0.5 bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-xl shadow-xl border border-gray-100 dark:border-gray-800"></div>'),vn=f('<div class="py-1 flex dark:text-gray-100 bg-white dark:bg-gray-850 border border-gray-100 dark:border-gray-800 w-72 rounded-full shadow-xl"><input type="text" id="floating-message-input" class="ml-5 bg-transparent outline-hidden w-full flex-1 text-sm"/> <div class="ml-1 mr-1"><button><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z" clip-rule="evenodd"></path></svg></button></div></div>'),cn=f('<div class="flex justify-end pt-3 text-sm font-medium"><button class="px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"> </button></div>'),gn=f('<div class="bg-white dark:bg-gray-850 dark:text-gray-100 rounded-3xl shadow-xl w-80 max-w-full border border-gray-100 dark:border-gray-800"><div class="bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-3xl px-3.5 pt-3 w-full"><div class="font-medium"><!></div></div> <div class="bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-4xl w-full"><div class=" max-h-80 overflow-y-auto w-full markdown-prose-xs px-3.5 py-3" id="response-container"><!> <!></div></div></div>'),un=f('<div class="absolute rounded-lg mt-1 text-xs z-9999" style="display: none"><!></div>');function fn(Te,o){Mt(o,!1);const l=()=>De(G,"$i18n",w),u=()=>De(ja,"$models",w),L=()=>De(Tr,"$socket",w),$=()=>De(mr,"$chatId",w),[w,R]=Jt(),G=Dt("i18n");let te=c(o,"id",8,""),m=c(o,"messageId",8,""),A=c(o,"model",8,null),Y=c(o,"messages",24,()=>[]),v=c(o,"actions",28,()=>[]),se=c(o,"onAdd",8,p=>{}),O=$e(!1),X=$e(null),ce=$e(""),s=$e(""),le=$e(""),pe=$e(null),me=$e(!1),de=null;const xe=[{id:"ask",label:l().t("Ask"),icon:is,input:!0,prompt:`{{SELECTED_CONTENT}}


{{INPUT_CONTENT}}`},{id:"explain",label:l().t("Explain"),icon:Gr,prompt:`{{SELECTED_CONTENT}}


${l().t("Explain")}`}],ge=async()=>{const p=document.getElementById("response-container");p&&p.scrollHeight-p.clientHeight<=p.scrollTop+50&&(p.scrollTop=p.scrollHeight)},ue=async p=>{var V;if(!A()){jt.error(l().t("Model not selected"));return}let H=e(ce).split(`
`).map(P=>`> ${P}`).join(`
`),x=v().find(P=>P.id===p);if(!x){jt.error(l().t("Action not found"));return}let M=(x==null?void 0:x.prompt)??"",_=[];const B=/\{\{(.*?)\|tool:id="([^"]+)"\}\}/g;M=M.replace(B,(P,ae,K)=>(_.push(K),ae));let U=/\{\{TOOL:([^\}]+)\}\}/g,z;for(;(z=U.exec(M))!==null;)_.push(z[1]);M=M.replace(U,""),M.includes("{{INPUT_CONTENT}}")&&e(O)&&(M=M.replace("{{INPUT_CONTENT}}",e(s)),k(s,"")),M=M.replace("{{CONTENT}}",e(ce)),M=M.replace("{{SELECTED_CONTENT}}",H),k(le,M),k(pe,"");let C;if([C,de]=await os(localStorage.token,{model:A(),model_item:u().find(P=>P.id===A()),session_id:(V=L())==null?void 0:V.id,chat_id:$(),messages:[...Y(),{role:"user",content:e(le)}].map(P=>({role:P.role,content:P.content})),..._.length>0?{tool_ids:_}:{},stream:!0}),C&&C.ok){const P=C.body.getReader(),ae=new TextDecoder,K=async()=>{var fe,ne;for(;;){const{done:oe,value:N}=await P.read();if(oe)break;const S=ae.decode(N,{stream:!0}).split(`
`).filter(J=>J.trim()!=="");for(const J of S)if(J.startsWith("data: "))if(J.startsWith("data: [DONE]")){k(me,!0),await lt(),ge();continue}else try{const W=JSON.parse(J.slice(6));W.choices&&((ne=(fe=W.choices[0])==null?void 0:fe.delta)!=null&&ne.content)&&(k(pe,e(pe)+W.choices[0].delta.content),ge())}catch(W){}}};try{await K()}catch(fe){fe.name}}else jt.error(l().t("An error occurred while fetching the explanation"))},T=async()=>{const p=[{role:"user",content:e(le)},{role:"assistant",content:e(pe)}];se()({modelId:A(),parentId:m(),messages:p})},E=()=>{de&&de.abort(),k(X,null),k(ce,""),k(pe,null),k(me,!1),k(O,!1),k(s,"")};tr(()=>{de&&de.abort()}),yt(()=>i(v()),()=>{v().length===0&&v(xe)}),ea();var d={closeHandler:E};It();var F=un(),Q=n(F);{var D=p=>{var H=we(),x=ee(H);{var M=B=>{var U=dn();ht(U,5,v,Lt,(z,C)=>{var V=ln(),P=n(V);{var ae=ne=>{var oe=we(),N=ee(oe);ns(N,()=>e(C).icon,(j,S)=>{S(j,{className:"size-3 shrink-0"})}),a(ne,oe)};g(P,ne=>{e(C),t(()=>e(C).icon)&&ne(ae)})}var K=I(P,2),fe=n(K,!0);r(K),r(V),b(()=>q(fe,(e(C),t(()=>e(C).label)))),Ce("click",V,async()=>{k(ce,window.getSelection().toString()),k(X,e(C)),e(C).prompt.includes("{{INPUT_CONTENT}}")?(k(O,!0),k(s,""),await lt(),setTimeout(()=>{const ne=document.getElementById("floating-message-input");ne&&ne.focus()},0)):ue(e(C).id)}),a(z,V)}),r(U),a(B,U)},_=B=>{var U=vn(),z=n(U);La(z);var C=I(z,2),V=n(C);r(C),r(U),b(P=>{Le(z,"placeholder",P),ze(V,1,`${e(s)!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled"} transition rounded-full p-1.5 m-0.5 self-center`)},[()=>(l(),t(()=>l().t("Ask a question")))]),Aa(z,()=>e(s),P=>k(s,P)),Ce("keydown",z,P=>{var ae;P.key==="Enter"&&ue((ae=e(X))==null?void 0:ae.id)}),Ce("click",V,()=>{var P;ue((P=e(X))==null?void 0:P.id)}),a(B,U)};g(x,B=>{e(O)?B(_,!1):B(M)})}a(p,H)},y=p=>{var H=gn(),x=n(H),M=n(x),_=n(M);{let K=_e(()=>`${te()}-float-prompt`);Oa(_,{get id(){return e(K)},get content(){return e(le)}})}r(M),r(x);var B=I(x,2),U=n(B),z=n(U);{var C=K=>{sr(K,{size:"sm"})},V=K=>{{let fe=_e(()=>`${te()}-float-response`);Oa(K,{get id(){return e(fe)},get content(){return e(pe)}})}};g(z,K=>{e(pe),t(()=>{var fe;return!e(pe)||((fe=e(pe))==null?void 0:fe.trim())===""})?K(C):K(V,!1)})}var P=I(z,2);{var ae=K=>{var fe=cn(),ne=n(fe),oe=n(ne,!0);r(ne),r(fe),b(N=>q(oe,N),[()=>(l(),t(()=>l().t("Add")))]),Ce("click",ne,T),a(K,fe)};g(P,K=>{e(me)&&K(ae)})}r(U),r(B),r(H),a(p,H)};g(Q,p=>{e(pe)===null?p(D):p(y,!1)})}r(F),b(()=>Le(F,"id",`floating-buttons-${te()}`)),a(Te,F),yr(o,"closeHandler",E);var h=Ct(d);return R(),h}var mn=f("<div><!></div> <!>",1);function hn(Te,o){Mt(o,!1);const l=()=>De(hr,"$mobile",$),u=()=>De(ba,"$settings",$),L=()=>De(mr,"$chatId",$),[$,w]=Jt();Dt("i18n");let R=c(o,"id",8),G=c(o,"content",8),te=c(o,"history",8),m=c(o,"messageId",8),A=c(o,"selectedModels",24,()=>[]),Y=c(o,"done",8,!0),v=c(o,"model",8,null),se=c(o,"sources",8,null),O=c(o,"save",8,!1),X=c(o,"preview",8,!1),ce=c(o,"floatingButtons",8,!0),s=c(o,"editCodeBlock",8,!0),le=c(o,"topPadding",8,!1),pe=c(o,"onSave",8,p=>{}),me=c(o,"onSourceClick",8,p=>{}),de=c(o,"onTaskClick",8,p=>{}),xe=c(o,"onAddMessages",8,p=>{}),ge=$e(),ue=$e();const T=p=>{var x;const H=document.getElementById(`floating-buttons-${R()}`);if(!((x=e(ge))!=null&&x.contains(p.target))&&!(H!=null&&H.contains(p.target))){E();return}setTimeout(async()=>{var _;if(await lt(),!((_=e(ge))!=null&&_.contains(p.target)))return;let M=window.getSelection();if(M.toString().trim().length>0){const U=M.getRangeAt(0).getBoundingClientRect(),z=e(ge).getBoundingClientRect(),C=U.bottom-z.top,V=U.left-z.left;if(H){H.style.display="block";const P=z.width-V;let ae=l()?window.innerWidth/2:window.innerWidth/3;if(P<ae){const K=z.right-U.right;H.style.right=`${K}px`,H.style.left="auto"}else H.style.left=`${V}px`,H.style.right="auto";H.style.top=`${C+5}px`}}else E()},0)},E=()=>{var H,x;const p=document.getElementById(`floating-buttons-${R()}`);p&&(p.style.display="none"),e(ue)&&typeof((H=e(ue))==null?void 0:H.closeHandler)=="function"&&((x=e(ue))==null||x.closeHandler())},d=p=>{p.key==="Escape"&&E()};Pa(()=>{var p;ce()&&((p=e(ge))==null||p.addEventListener("mouseup",T),document.addEventListener("mouseup",T),document.addEventListener("keydown",d))}),tr(()=>{var p;ce()&&((p=e(ge))==null||p.removeEventListener("mouseup",T),document.removeEventListener("mouseup",T),document.removeEventListener("keydown",d))}),It();var F=mn(),Q=ee(F),D=n(Q);{let p=_e(()=>(i(se()),i(v()),t(()=>(se()??[]).reduce((H,x)=>{let M=[];return x.document.forEach((_,B)=>{var C,V,P,ae,K,fe;if(((ae=(P=(V=(C=v())==null?void 0:C.info)==null?void 0:V.meta)==null?void 0:P.capabilities)==null?void 0:ae.citations)==!1)return M.push("N/A"),M;const U=(K=x.metadata)==null?void 0:K[B],z=(U==null?void 0:U.source)??"N/A";return U!=null&&U.name?(M.push(U.name),M):(z.startsWith("http://")||z.startsWith("https://")?M.push(z):M.push(((fe=x==null?void 0:x.source)==null?void 0:fe.name)??z),M)}),H=[...H,...M],H.filter((_,B)=>H.indexOf(_)===B)},[]))));Oa(D,{get id(){return R()},get content(){return G()},get model(){return v()},get save(){return O()},get preview(){return X()},get done(){return Y()},get editCodeBlock(){return s()},get topPadding(){return le()},get sourceIds(){return e(p)},get onSourceClick(){return me()},get onTaskClick(){return de()},get onSave(){return pe()},onUpdate:async H=>{var _;const{lang:x,text:M}=H;(((_=u())==null?void 0:_.detectArtifacts)??!0)&&(["html","svg"].includes(x)||x==="xml"&&M.includes("svg"))&&!l()&&L()&&(await lt(),or.set(!0),Za.set(!0))},onPreview:async H=>{await Lr.set(H),await Za.set(!0),await or.set(!0),await Or.set(!1),await fr.set(!1)}})}r(Q),xa(Q,p=>k(ge,p),()=>e(ge));var y=I(Q,2);{var h=p=>{{let H=_e(()=>(u(),t(()=>{var _;return((_=u())==null?void 0:_.floatingActionButtons)??[]}))),x=_e(()=>(i(A()),i(v()),t(()=>{var _,B,U;return(A()??[]).includes((_=v())==null?void 0:_.id)?(B=v())==null?void 0:B.id:(A()??[]).length>0?A().at(0):(U=v())==null?void 0:U.id}))),M=_e(()=>(i(Ka),i(te()),i(m()),t(()=>Ka(te(),m()))));xa(fn(p,{get id(){return R()},get messageId(){return m()},get actions(){return e(H)},get model(){return e(x)},get messages(){return e(M)},onAdd:({modelId:_,parentId:B,messages:U})=>{xe()({modelId:_,parentId:B,messages:U}),E()},$$legacy:!0}),_=>k(ue,_),()=>e(ue))}};g(y,p=>{ce()&&v()&&p(h)})}a(Te,F),Ct(),w()}function _n(Te){return new Worker(""+new URL("../workers/kokoro.worker-DH_kWnDg.js",import.meta.url).href,{type:"module",name:Te==null?void 0:Te.name})}class pn{constructor(o="fp32"){$a(this,"worker",null);$a(this,"initialized",!1);$a(this,"dtype");$a(this,"requestQueue",[]);$a(this,"processing",!1);this.dtype=o}async init(){if(this.worker){console.warn("KokoroWorker is already initialized.");return}return this.worker=new _n,this.worker.onmessage=o=>{const{status:l,error:u,audioUrl:L}=o.data;if(l==="init:complete")this.initialized=!0;else if(l==="init:error")this.initialized=!1;else if(l==="generate:complete"){const $=this.requestQueue.shift();$&&($.resolve(L),this.processNextRequest())}else if(l==="generate:error"){const $=this.requestQueue.shift();$&&($.reject(new Error(u)),this.processNextRequest())}},new Promise((o,l)=>{this.worker.postMessage({type:"init",payload:{dtype:this.dtype}});const u=L=>{L.data.status==="init:complete"?(this.worker.removeEventListener("message",u),this.initialized=!0,o()):L.data.status==="init:error"&&(this.worker.removeEventListener("message",u),l(new Error(L.data.error)))};this.worker.addEventListener("message",u)})}async generate({text:o,voice:l}){if(!this.initialized||!this.worker)throw new Error("KokoroTTS Worker is not initialized yet.");return new Promise((u,L)=>{this.requestQueue.push({text:o,voice:l,resolve:u,reject:L}),this.processing||this.processNextRequest()})}processNextRequest(){if(this.requestQueue.length===0){this.processing=!1;return}this.processing=!0;const{text:o,voice:l}=this.requestQueue[0];this.worker.postMessage({type:"generate",payload:{text:o,voice:l}})}terminate(){this.worker&&(this.worker.terminate(),this.worker=null,this.initialized=!1,this.requestQueue=[],this.processing=!1)}}var xn=f('<div class=" py-1.5 bg-transparent text-left text-sm flex items-center gap-2 text-gray-500 dark:text-gray-400 hover:text-black dark:hover:text-white transition cursor-pointer"><div class="line-clamp-1"> </div></div>'),bn=f('<hr class="border-gray-50 dark:border-gray-850/30"/>'),wn=f("<!> <!>",1),yn=f('<div class="mt-4"><div class="text-sm font-medium"> </div> <div class="flex flex-col text-left gap-1 mt-1.5"></div></div>');function kn(Te,o){Mt(o,!1);const l=()=>De($,"$i18n",u),[u,L]=Jt(),$=Dt("i18n");let w=c(o,"followUps",24,()=>[]),R=c(o,"onClick",8,()=>{});It();var G=yn(),te=n(G),m=n(te,!0);r(te);var A=I(te,2);ht(A,5,w,Lt,(Y,v,se)=>{var O=wn(),X=ee(O);mt(X,{get content(){return e(v)},placement:"top-start",className:"line-clamp-1",children:(le,pe)=>{var me=xn(),de=n(me),xe=n(de,!0);r(de),r(me),b(()=>{Le(me,"aria-label",e(v)),q(xe,e(v))}),Ce("click",me,()=>R()(e(v))),a(le,me)},$$slots:{default:!0}});var ce=I(X,2);{var s=le=>{var pe=bn();a(le,pe)};g(ce,le=>{i(w()),t(()=>se<w().length-1)&&le(s)})}a(Y,O)}),r(A),r(G),b(Y=>q(m,Y),[()=>(l(),t(()=>l().t("Follow up")))]),a(Te,G),Ct(),L()}var Mn=fa('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path d="M11 6H21" stroke-linecap="round" stroke-linejoin="round"></path><path d="M11 12H21" stroke-linecap="round" stroke-linejoin="round"></path><path d="M11 18H21" stroke-linecap="round" stroke-linejoin="round"></path><path d="M5 19V5M5 19L3 16.5M5 19L7 16.5M5 5L3 7M5 5L7 7" stroke-linecap="round" stroke-linejoin="round"></path></svg>');function Cn(Te,o){let l=c(o,"className",8,"size-4"),u=c(o,"strokeWidth",8,"1.5");var L=Mn();b(()=>{Le(L,"stroke-width",u()),ze(L,0,za(l()))}),a(Te,L)}var In=fa('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path d="M11 6H21" stroke-linecap="round" stroke-linejoin="round"></path><path d="M11 12H21" stroke-linecap="round" stroke-linejoin="round"></path><path d="M11 18H21" stroke-linecap="round" stroke-linejoin="round"></path><path d="M5 19V5M5 10L3 8M5 10L7 8M5 14L3 16M5 14L7 16" stroke-linecap="round" stroke-linejoin="round"></path></svg>');function $n(Te,o){let l=c(o,"className",8,"size-4"),u=c(o,"strokeWidth",8,"1.5");var L=In();b(()=>{Le(L,"stroke-width",u()),ze(L,0,za(l()))}),a(Te,L)}var En=f('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" aria-hidden="true" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"></path></svg> <div class="flex items-center"> </div>',1),Sn=f('<!> <div class="flex items-center"> </div>',1),Nn=f('<!> <div class="flex items-center"> </div>',1),Pn=f('<div class="py-1.5 px-2.5 flex dark:text-gray-100"><input type="text" id="floating-message-input" class="bg-transparent outline-hidden w-full flex-1 text-sm" autocomplete="off"/> <div class="ml-2 self-center flex items-center"><button><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-3.5"><path fill-rule="evenodd" d="M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z" clip-rule="evenodd"></path></svg></button></div></div> <hr class="border-gray-50/30 dark:border-gray-800/30 my-1 mx-2"/> <!> <!> <!>',1),Bn=f('<div slot="content"><!></div>');function Tn(Te,o){Mt(o,!1);const l=()=>De($,"$i18n",u),[u,L]=Jt(),$=Dt("i18n");let w=c(o,"onRegenerate",8,(m=null)=>{}),R=c(o,"onClose",8,()=>{}),G=$e(!1),te=$e("");It(),vs(Te,{align:"end",get show(){return e(G)},set show(m){k(G,m)},$$events:{change:m=>{m.detail===!1&&R()()}},children:(m,A)=>{var Y=we(),v=ee(Y);Mr(v,o,"default",{},null),a(m,Y)},$$slots:{default:!0,content:(m,A)=>{var Y=Bn(),v=n(Y);ls(v,{class:"w-full max-w-[200px] rounded-2xl px-1 py-1 border border-gray-100 dark:border-gray-800 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg transition",sideOffset:-2,side:"bottom",align:"start",get transition(){return ds},children:(se,O)=>{var X=Pn(),ce=ee(X),s=n(ce);La(s);var le=I(s,2),pe=n(le);r(le),r(ce);var me=I(ce,4);Ja(me,{class:"flex  gap-2  items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl",$$events:{click:()=>{w()(),k(G,!1)}},children:(ge,ue)=>{var T=En(),E=I(ee(T),2),d=n(E,!0);r(E),b(F=>q(d,F),[()=>(l(),t(()=>l().t("Try Again")))]),a(ge,T)},$$slots:{default:!0}});var de=I(me,2);Ja(de,{class:"flex  gap-2  items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl",$$events:{click:()=>{w()(l().t("Add Details"))}},children:(ge,ue)=>{var T=Sn(),E=ee(T);Cn(E,{strokeWidth:"2"});var d=I(E,2),F=n(d,!0);r(d),b(Q=>q(F,Q),[()=>(l(),t(()=>l().t("Add Details")))]),a(ge,T)},$$slots:{default:!0}});var xe=I(de,2);Ja(xe,{class:"flex  gap-2  items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl",$$events:{click:()=>{w()(l().t("More Concise"))}},children:(ge,ue)=>{var T=Nn(),E=ee(T);$n(E,{strokeWidth:"2"});var d=I(E,2),F=n(d,!0);r(d),b(Q=>q(F,Q),[()=>(l(),t(()=>l().t("More Concise")))]),a(ge,T)},$$slots:{default:!0}}),b(ge=>{Le(s,"placeholder",ge),ze(pe,1,`${e(te)!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled"} transition rounded-full p-1 self-center`)},[()=>(l(),t(()=>l().t("Suggest a change")))]),Aa(s,()=>e(te),ge=>k(te,ge)),Ce("keydown",s,ge=>{ge.key==="Enter"&&(w()(e(te)),k(G,!1))}),Ce("click",pe,()=>{w()(e(te)),k(G,!1)}),a(se,X)},$$slots:{default:!0}}),r(Y),a(m,Y)}},$$legacy:!0}),Ct(),L()}var Ln=f('<div class="flex flex-col justify-center -space-y-0.5"><div><!></div></div>'),On=f('<div class="flex flex-col justify-center -space-y-0.5"><div> </div></div>'),Rn=f('<div class="bg-gray-50 dark:bg-gray-850 flex rounded-lg py-1 px-2 items-center gap-1 text-xs"><div><!></div> <span class="line-clamp-1"> </span></div>'),zn=f('<div class="flex flex-col justify-center -space-y-0.5"><div> </div> <div class=" flex gap-1 flex-wrap mt-2"></div></div>'),jn=f('<div class="bg-gray-50 dark:bg-gray-850 flex rounded-lg py-1 px-2 items-center gap-1 text-xs"><div><!></div> <span class="line-clamp-1"> </span></div>'),An=f('<div class="flex flex-col justify-center -space-y-0.5"><div> </div> <div class=" flex gap-1 flex-wrap mt-2"></div></div>'),Hn=f('<div class="flex flex-col justify-center -space-y-0.5"><div><!></div></div>'),qn=f('<div class="flex flex-col justify-center -space-y-0.5"><div><!></div></div>'),Dn=f('<div class="status-description flex items-center gap-2 py-0.5 w-full text-left"><!></div>');function ur(Te,o){Mt(o,!1);const l=()=>De($,"$i18n",u),[u,L]=Jt(),$=Dt("i18n");let w=c(o,"status",8,null),R=c(o,"done",8,!1);It();var G=we(),te=ee(G);{var m=A=>{var Y=Dn(),v=n(Y);{var se=X=>{$s(X,{get status(){return w()},children:(ce,s)=>{var le=Ln(),pe=n(le),me=n(pe);{var de=ge=>{var ue=We();b(T=>q(ue,T),[()=>(l(),i(w()),t(()=>{var T,E,d;return l().t((T=w())==null?void 0:T.description,{count:(((E=w())==null?void 0:E.urls)||((d=w())==null?void 0:d.items)).length})}))]),a(ge,ue)},xe=ge=>{var ue=we(),T=ee(ue);{var E=F=>{var Q=We();b(D=>q(Q,D),[()=>(l(),t(()=>l().t("No search query generated")))]),a(F,Q)},d=F=>{var Q=we(),D=ee(Q);{var y=p=>{var H=We();b(x=>q(H,x),[()=>(l(),t(()=>l().t("Generating search query")))]),a(p,H)},h=p=>{var H=We();b(()=>q(H,(i(w()),t(()=>{var x;return(x=w())==null?void 0:x.description})))),a(p,H)};g(D,p=>{i(w()),t(()=>{var H;return((H=w())==null?void 0:H.description)==="Generating search query"})?p(y):p(h,!1)},!0)}a(F,Q)};g(T,F=>{i(w()),t(()=>{var Q;return((Q=w())==null?void 0:Q.description)==="No search query generated"})?F(E):F(d,!1)},!0)}a(ge,ue)};g(me,ge=>{i(w()),t(()=>{var ue,T;return(T=(ue=w())==null?void 0:ue.description)==null?void 0:T.includes("{{count}}")})?ge(de):ge(xe,!1)})}r(pe),r(le),b(()=>ze(pe,1,`${i(R()),i(w()),t(()=>{var ge;return(R()||((ge=w())==null?void 0:ge.done))===!1?"shimmer":""})??""} text-base line-clamp-1 text-wrap`)),a(ce,le)},$$slots:{default:!0}})},O=X=>{var ce=we(),s=ee(ce);{var le=me=>{var de=On(),xe=n(de),ge=n(xe,!0);r(xe),r(de),b(ue=>{ze(xe,1,`${i(R()),i(w()),t(()=>{var T;return(R()||((T=w())==null?void 0:T.done))===!1?"shimmer":""})??""} text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap`),q(ge,ue)},[()=>(l(),i(w()),t(()=>l().t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:w().query})))]),a(me,de)},pe=me=>{var de=we(),xe=ee(de);{var ge=T=>{var E=zn(),d=n(E),F=n(d,!0);r(d);var Q=I(d,2);ht(Q,7,()=>(i(w()),t(()=>w().queries)),D=>D,(D,y)=>{var h=Rn(),p=n(h),H=n(p);Ya(H,{className:"size-3"}),r(p);var x=I(p,2),M=n(x,!0);r(x),r(h),b(()=>q(M,e(y))),a(D,h)}),r(Q),r(E),b(D=>{ze(d,1,`${i(R()),i(w()),t(()=>{var y;return(R()||((y=w())==null?void 0:y.done))===!1?"shimmer":""})??""} text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap`),q(F,D)},[()=>(l(),t(()=>l().t("Searching")))]),a(T,E)},ue=T=>{var E=we(),d=ee(E);{var F=D=>{var y=An(),h=n(y),p=n(h,!0);r(h);var H=I(h,2);ht(H,7,()=>(i(w()),t(()=>w().queries)),x=>x,(x,M)=>{var _=jn(),B=n(_),U=n(B);Ya(U,{className:"size-3"}),r(B);var z=I(B,2),C=n(z,!0);r(z),r(_),b(()=>q(C,e(M))),a(x,_)}),r(H),r(y),b(x=>{ze(h,1,`${i(R()),i(w()),t(()=>{var M;return(R()||((M=w())==null?void 0:M.done))===!1?"shimmer":""})??""} text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap`),q(p,x)},[()=>(l(),t(()=>l().t("Querying")))]),a(D,y)},Q=D=>{var y=we(),h=ee(y);{var p=x=>{var M=Hn(),_=n(M),B=n(_);{var U=C=>{var V=We();b(P=>q(V,P),[()=>(l(),t(()=>l().t("No sources found")))]),a(C,V)},z=C=>{var V=we(),P=ee(V);{var ae=fe=>{var ne=We();b(oe=>q(ne,oe),[()=>(l(),t(()=>l().t("Retrieved 1 source")))]),a(fe,ne)},K=fe=>{var ne=We();b(oe=>q(ne,oe),[()=>(l(),i(w()),t(()=>l().t("Retrieved {{count}} sources",{count:w().count})))]),a(fe,ne)};g(P,fe=>{i(w()),t(()=>w().count===1)?fe(ae):fe(K,!1)},!0)}a(C,V)};g(B,C=>{i(w()),t(()=>w().count===0)?C(U):C(z,!1)})}r(_),r(M),b(()=>ze(_,1,`${i(R()),i(w()),t(()=>{var C;return(R()||((C=w())==null?void 0:C.done))===!1?"shimmer":""})??""} text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap`)),a(x,M)},H=x=>{var M=qn(),_=n(M),B=n(_);{var U=C=>{var V=We();b(P=>q(V,P),[()=>(l(),i(w()),t(()=>{var P,ae;return l().t((P=w())==null?void 0:P.description,{searchQuery:(ae=w())==null?void 0:ae.query})}))]),a(C,V)},z=C=>{var V=we(),P=ee(V);{var ae=fe=>{var ne=We();b(oe=>q(ne,oe),[()=>(l(),t(()=>l().t("No search query generated")))]),a(fe,ne)},K=fe=>{var ne=we(),oe=ee(ne);{var N=S=>{var J=We();b(W=>q(J,W),[()=>(l(),t(()=>l().t("Generating search query")))]),a(S,J)},j=S=>{var J=we(),W=ee(J);{var ie=Ne=>{var be=We();b(Re=>q(be,Re),[()=>(l(),t(()=>l().t("Searching the web")))]),a(Ne,be)},ve=Ne=>{var be=We();b(()=>q(be,(i(w()),t(()=>{var Re;return(Re=w())==null?void 0:Re.description})))),a(Ne,be)};g(W,Ne=>{i(w()),t(()=>{var be;return((be=w())==null?void 0:be.description)==="Searching the web"})?Ne(ie):Ne(ve,!1)},!0)}a(S,J)};g(oe,S=>{i(w()),t(()=>{var J;return((J=w())==null?void 0:J.description)==="Generating search query"})?S(N):S(j,!1)},!0)}a(fe,ne)};g(P,fe=>{i(w()),t(()=>{var ne;return((ne=w())==null?void 0:ne.description)==="No search query generated"})?fe(ae):fe(K,!1)},!0)}a(C,V)};g(B,C=>{i(w()),t(()=>{var V,P;return(P=(V=w())==null?void 0:V.description)==null?void 0:P.includes("{{searchQuery}}")})?C(U):C(z,!1)})}r(_),r(M),b(()=>ze(_,1,`${i(R()),i(w()),t(()=>{var C;return(R()||((C=w())==null?void 0:C.done))===!1?"shimmer":""})??""} text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap`)),a(x,M)};g(h,x=>{i(w()),t(()=>{var M,_;return((M=w())==null?void 0:M.action)==="sources_retrieved"&&((_=w())==null?void 0:_.count)!==void 0})?x(p):x(H,!1)},!0)}a(D,y)};g(d,D=>{i(w()),t(()=>{var y,h;return((y=w())==null?void 0:y.action)==="queries_generated"&&((h=w())==null?void 0:h.queries)})?D(F):D(Q,!1)},!0)}a(T,E)};g(xe,T=>{i(w()),t(()=>{var E,d;return((E=w())==null?void 0:E.action)==="web_search_queries_generated"&&((d=w())==null?void 0:d.queries)})?T(ge):T(ue,!1)},!0)}a(me,de)};g(s,me=>{i(w()),t(()=>{var de;return((de=w())==null?void 0:de.action)==="knowledge_search"})?me(le):me(pe,!1)},!0)}a(X,ce)};g(v,X=>{i(w()),t(()=>{var ce,s,le;return((ce=w())==null?void 0:ce.action)==="web_search"&&(((s=w())==null?void 0:s.urls)||((le=w())==null?void 0:le.items))})?X(se):X(O,!1)})}r(Y),a(A,Y)};g(te,A=>{i(w()),t(()=>{var Y;return!((Y=w())!=null&&Y.hidden)})&&A(m)})}a(Te,G),Ct(),L()}var Wn=f('<div class="w-[0.5px] ml-[6.5px] h-[calc(100%-14px)] bg-gray-300 dark:bg-gray-700"></div>'),Fn=f('<div class="flex items-stretch gap-2 mb-1"><div class=" "><div class="pt-3 px-1 mb-1.5"><span class="relative flex size-1.5 rounded-full justify-center items-center"><span class="relative inline-flex size-1.5 rounded-full bg-gray-500 dark:bg-gray-400"></span></span></div> <!></div> <!></div>'),Un=f('<div class="w-full"></div>'),Jn=f('<div class="flex flex-row"><!></div>'),Vn=f('<div class="text-sm flex flex-col w-full"><button class="w-full"><div class="flex items-start gap-2"><!></div></button> <!></div>');function Zn(Te,o){Mt(o,!1),Dt("i18n");let l=c(o,"statusHistory",24,()=>[]),u=c(o,"expand",8,!1),L=$e(!0),$=$e([]),w=$e(null);yt(()=>i(u()),()=>{u()?k(L,!0):k(L,!1)}),yt(()=>(i(l()),e($)),()=>{JSON.stringify(l())!==JSON.stringify(e($))&&k($,l())}),yt(()=>e($),()=>{e($)&&e($).length>0&&k(w,e($).at(-1))}),ea(),It();var R=we(),G=ee(R);{var te=m=>{var A=we(),Y=ee(A);{var v=se=>{var O=Vn(),X=n(O),ce=n(X),s=n(ce);ur(s,{get status(){return e(w)}}),r(ce),r(X);var le=I(X,2);{var pe=me=>{var de=Jn(),xe=n(de);{var ge=ue=>{var T=Un();ht(T,5,()=>e($),Lt,(E,d,F,Q)=>{var D=Fn(),y=n(D),h=I(n(y),2);{var p=x=>{var M=Wn();a(x,M)};g(h,x=>{e($),t(()=>F!==e($).length-1)&&x(p)})}r(y);var H=I(y,2);ur(H,{get status(){return e(d)},done:!0}),r(D),a(E,D)}),r(T),a(ue,T)};g(xe,ue=>{e($),t(()=>e($).length>1)&&ue(ge)})}r(de),a(me,de)};g(le,me=>{e(L)&&me(pe)})}r(O),Ce("click",X,()=>{k(L,!e(L))}),a(se,O)};g(Y,se=>{e(w),t(()=>{var O;return((O=e(w))==null?void 0:O.hidden)!==!0})&&se(v)})}a(m,A)};g(G,m=>{e($),t(()=>e($)&&e($).length>0)&&m(te)})}a(Te,R),Ct()}var Kn=f('<span id="response-message-model-name" class="line-clamp-1 text-black dark:text-white"> </span>'),Gn=f('<span class="line-clamp-1"> </span>'),Qn=f("<div><!></div>"),Yn=f("<!> <!>",1),Xn=f("<div><!></div>"),eo=f('<div class="my-1 w-full flex overflow-x-auto gap-2 flex-wrap"></div>'),to=f('<div class="my-2 w-full"><!></div>'),ao=f('<div class="my-1 w-full flex overflow-x-auto gap-2 flex-wrap"></div>'),ro=f('<div class="w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 my-2"><textarea class=" bg-transparent outline-hidden w-full resize-none"></textarea> <div class=" mt-2 mb-1 flex justify-between text-sm font-medium"><div><button id="save-new-message-button" class="px-3.5 py-1.5 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border border-gray-100 dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"> </button></div> <div class="flex space-x-1.5"><button id="close-edit-message-button" class="px-3.5 py-1.5 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"> </button> <button id="confirm-edit-message-button" class="px-3.5 py-1.5 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"> </button></div></div></div>'),so=f('<div class="text-sm flex justify-center font-semibold self-center dark:text-gray-100 min-w-fit"><input type="number" min="1" class="bg-transparent font-semibold self-center dark:text-gray-100 min-w-fit outline-hidden"/> </div>'),no=f('<div class="text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit"> </div>'),oo=f('<div class="flex self-center min-w-fit" dir="ltr"><button class="self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"><svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg></button> <!> <button class="self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"><svg xmlns="http://www.w3.org/2000/svg" fill="none" aria-hidden="true" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg></button></div>'),io=f('<button><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" aria-hidden="true" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"></path></svg></button>'),lo=f('<button><svg xmlns="http://www.w3.org/2000/svg" fill="none" aria-hidden="true" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"></path></svg></button>'),vo=fa(`<svg class=" w-4 h-4" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"><style>.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}</style><circle class="spinner_S1WN" cx="4" cy="12" r="3"></circle><circle class="spinner_S1WN spinner_Km9P" cx="12" cy="12" r="3"></circle><circle class="spinner_S1WN spinner_JApP" cx="20" cy="12" r="3"></circle></svg>`),co=fa('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" aria-hidden="true" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M17.25 9.75 19.5 12m0 0 2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6 4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"></path></svg>'),go=fa('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" aria-hidden="true" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"></path></svg>'),uo=f("<button><!></button>"),fo=fa(`<svg aria-hidden="true" class=" w-4 h-4" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><style>.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}</style><circle class="spinner_S1WN" cx="4" cy="12" r="3"></circle><circle class="spinner_S1WN spinner_Km9P" cx="12" cy="12" r="3"></circle><circle class="spinner_S1WN spinner_JApP" cx="20" cy="12" r="3"></circle></svg>`),mo=fa('<svg xmlns="http://www.w3.org/2000/svg" fill="none" aria-hidden="true" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"></path></svg>'),ho=f("<button><!></button>"),_o=f('<button aria-hidden="true"><svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"></path></svg></button>'),po=f('<button><svg aria-hidden="true" stroke="currentColor" fill="none" stroke-width="2.3" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4" xmlns="http://www.w3.org/2000/svg"><path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"></path></svg></button>'),xo=f('<button><svg aria-hidden="true" stroke="currentColor" fill="none" stroke-width="2.3" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4" xmlns="http://www.w3.org/2000/svg"><path d="M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17"></path></svg></button>'),bo=f("<!> <!>",1),wo=f('<button type="button" id="continue-response-button"><svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113a.375.375 0 0 1-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112Z"></path></svg></button>'),yo=f('<div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" aria-hidden="true" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"></path></svg></div>'),ko=f('<button type="button" class="hidden regenerate-response-button"></button> <!>',1),Mo=f('<button type="button"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" aria-hidden="true" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"></path></svg></button>'),Co=f('<button type="button" id="delete-response-button"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"></path></svg></button>'),Io=f('<div class="size-4"><img style="fill: currentColor;"/></div>'),$o=f('<button type="button"><!></button>'),Eo=f("<!> <!> <!> <!> <!>",1),So=f("<!> <!> <!> <!> <!> <!>",1),No=f("<!> <!>",1),Po=f('<div class="mt-2.5"><!></div>'),Bo=f('<div class="flex justify-start overflow-x-auto buttons text-gray-600 dark:text-gray-500 mt-0.5 svelte-1qscqw6"><!></div> <!> <!>',1),To=f('<div><div><!></div> <div class="flex-auto w-0 pl-1 relative"><!> <div><div><div><!> <!> <!> <!> <div id="response-content-container"><!> <!> <!> <!></div></div></div> <!></div></div></div>'),Lo=f("<!> <!>",1);function Xa(Te,o){Mt(o,!1);const l=()=>De(ja,"$models",m),u=()=>De(_r,"$config",m),L=()=>De(ba,"$settings",m),$=()=>De(Y,"$i18n",m),w=()=>De(ir,"$audioQueue",m),R=()=>De(lr,"$TTSWorker",m),G=()=>De(Da,"$user",m),te=()=>De(ar,"$temporaryChatEnabled",m),[m,A]=Jt(),Y=Dt("i18n"),v=Ra();let se=c(o,"chatId",8,""),O=c(o,"history",12),X=c(o,"messageId",8),ce=c(o,"selectedModels",24,()=>[]),s=$e(JSON.parse(JSON.stringify(O().messages[X()]))),le=c(o,"siblings",8),pe=c(o,"setInputText",8,()=>{}),me=c(o,"gotoMessage",8,()=>{}),de=c(o,"showPreviousMessage",8),xe=c(o,"showNextMessage",8),ge=c(o,"updateChat",8),ue=c(o,"editMessage",8),T=c(o,"saveMessage",8);c(o,"rateMessage",8);let E=c(o,"actionMessage",8),d=c(o,"deleteMessage",8),F=c(o,"submitMessage",8),Q=c(o,"continueResponse",8),D=c(o,"regenerateResponse",8),y=c(o,"addMessages",8),h=c(o,"isLastMessage",8,!0),p=c(o,"readOnly",8,!1),H=c(o,"editCodeBlock",8,!0),x=c(o,"topPadding",8,!1),M=$e(),_=$e(),B=$e(),U=$e(!1),z=$e(null),C=$e(!1),V=$e(""),P=$e(),ae=$e(!1),K=$e(!1),fe=$e(!1),ne=$e(!1),oe=$e(!1);const N=async re=>{var Se,Ke,ct,Ue,Fe;re=vr(re),(((Ke=(Se=u())==null?void 0:Se.ui)==null?void 0:Ke.response_watermark)??"").trim()!==""&&(re=`${re}

${(Ue=(ct=u())==null?void 0:ct.ui)==null?void 0:Ue.response_watermark}`),await pr(re,null,((Fe=L())==null?void 0:Fe.copyFormatted)??!1)&&jt.success($().t("Copying to clipboard was successful!"))},j=()=>{try{speechSynthesis.cancel(),w().stop()}catch{}e(K)&&k(K,!1)},S=async()=>{var ke,Se,Ke,ct,Ue,Fe,qe,Ge,Ye,$t,Et,Gt,ft,Wt,Ot,Qt,Yt,ma,wa,ta,aa,ca,ha,ya,ra,ia,ga,ka,Ae;if(!(((ke=e(s))==null?void 0:ke.content)??"").trim().length){jt.info($().t("No content to speak"));return}k(K,!0);const re=vr(e(s).content);if(u().audio.tts.engine===""){let Me=[];const Oe=setInterval(()=>{var Be,Je,Xe;if(Me=speechSynthesis.getVoices(),Me.length>0){clearInterval(Oe);const rt=((Be=Me==null?void 0:Me.filter(dt=>{var et,je,tt,at,kt,Vt;return dt.voiceURI===(((tt=(je=(et=L())==null?void 0:et.audio)==null?void 0:je.tts)==null?void 0:tt.voice)??((Vt=(kt=(at=u())==null?void 0:at.audio)==null?void 0:kt.tts)==null?void 0:Vt.voice))}))==null?void 0:Be.at(0))??void 0,nt=new SpeechSynthesisUtterance(re);nt.rate=((Xe=(Je=L().audio)==null?void 0:Je.tts)==null?void 0:Xe.playbackRate)??1,nt.onend=()=>{var dt;k(K,!1),L().conversationMode&&((dt=document.getElementById("voice-input-button"))==null||dt.click())},rt&&(nt.voice=rt),speechSynthesis.speak(nt)}},100)}else{w().setId(`${e(s).id}`),w().setPlaybackRate(((Ke=(Se=L().audio)==null?void 0:Se.tts)==null?void 0:Ke.playbackRate)??1),Nr(ir,t(w).onStopped=()=>{k(K,!1)},t(w)),k(fe,!0);const Me=qr(re,((Fe=(Ue=(ct=u())==null?void 0:ct.audio)==null?void 0:Ue.tts)==null?void 0:Fe.split_on)??"punctuation");if(!Me.length){jt.info($().t("No content to speak")),k(K,!1),k(fe,!1);return}if(((Ge=(qe=L().audio)==null?void 0:qe.tts)==null?void 0:Ge.engine)==="browser-kokoro"){R()||(await lr.set(new pn({dtype:((Et=($t=(Ye=L().audio)==null?void 0:Ye.tts)==null?void 0:$t.engineConfig)==null?void 0:Et.dtype)??"fp32"})),await R().init());for(const[Oe,Be]of Me.entries()){const Je=await R().generate({text:Be,voice:((Wt=(ft=(Gt=L())==null?void 0:Gt.audio)==null?void 0:ft.tts)==null?void 0:Wt.voice)??((Yt=(Qt=(Ot=u())==null?void 0:Ot.audio)==null?void 0:Qt.tts)==null?void 0:Yt.voice)}).catch(Xe=>{jt.error(`${Xe}`),k(K,!1),k(fe,!1)});Je&&e(K)&&(w().enqueue(Je),k(fe,!1))}}else for(const[Oe,Be]of Me.entries()){const Je=await Fr(localStorage.token,((ta=(wa=(ma=L())==null?void 0:ma.audio)==null?void 0:wa.tts)==null?void 0:ta.defaultVoice)===u().audio.tts.voice?((ha=(ca=(aa=L())==null?void 0:aa.audio)==null?void 0:ca.tts)==null?void 0:ha.voice)??((ia=(ra=(ya=u())==null?void 0:ya.audio)==null?void 0:ra.tts)==null?void 0:ia.voice):(Ae=(ka=(ga=u())==null?void 0:ga.audio)==null?void 0:ka.tts)==null?void 0:Ae.voice,Be).catch(Xe=>{jt.error(`${Xe}`),k(K,!1),k(fe,!1)});if(Je&&e(K)){const Xe=await Je.blob(),rt=URL.createObjectURL(Xe);w().enqueue(rt),k(fe,!1)}}}};let J=[];function W(re){const ke=[];let Se=0;return re=re.replace(/<details[\s\S]*?<\/details>/gi,Ke=>(ke.push(Ke),`<details id="__DETAIL_${Se++}__"/>`)),J=ke,re}function ie(re){return re.replace(/<details id="__DETAIL_(\d+)__"\/>/g,(Se,Ke)=>J[parseInt(Ke)]||"")}const ve=async()=>{k(C,!0),k(V,W(e(s).content)),await lt(),la(P,e(P).style.height=""),la(P,e(P).style.height=`${e(P).scrollHeight}px`)},Ne=async()=>{const re=ie(e(V)?e(V):"");ue()(e(s).id,{content:re},!1),k(C,!1),k(V,""),await lt()},be=async()=>{const re=ie(e(V)?e(V):"");ue()(e(s).id,{content:re}),k(C,!1),k(V,""),await lt()},Re=async()=>{k(C,!1),k(V,""),await lt()},Ve=async re=>{k(ne,!0);const ke=await Ur(localStorage.token,re.content).catch(Se=>{jt.error(`${Se}`)});if(ke){const Se=ke.map(Ke=>({type:"image",url:`${Ke.url}`}));T()(re.id,{...re,files:Se})}k(ne,!1)};let Ze=$e(!1);const He=async(re=null,ke=null)=>{var Ge,Ye,$t,Et,Gt;k(Ze,!0);const Se={...e(s),annotation:{...((Ge=e(s))==null?void 0:Ge.annotation)??{},...re!==null?{rating:re}:{},...ke||{}}},Ke=await jr(localStorage.token,se()).catch(ft=>{jt.error(`${ft}`)});if(!Ke)return;const ct=Ka(O(),e(s).id);let Ue={type:"rating",data:{...Se!=null&&Se.annotation?Se.annotation:{},model_id:((Ye=e(s))==null?void 0:Ye.selectedModelId)??e(s).model,...O().messages[e(s).parentId].childrenIds.length>1?{sibling_model_ids:O().messages[e(s).parentId].childrenIds.filter(ft=>ft!==e(s).id).map(ft=>{var Wt;return((Wt=O().messages[ft])==null?void 0:Wt.selectedModelId)??O().messages[ft].model})}:{}},meta:{arena:e(s)?e(s).arena:!1,model_id:e(s).model,message_id:e(s).id,message_index:ct.length,chat_id:se()},snapshot:{chat:Ke}};const Fe=[Ue.data.model_id,...Ue.data.sibling_model_ids??[]].reduce((ft,Wt)=>{var Qt;const Ot=l().find(Yt=>Yt.id===Wt);return Ot?ft[Ot.id]=((Qt=Ot==null?void 0:Ot.info)==null?void 0:Qt.base_model_id)??null:console.warn(`Model with ID ${Wt} not found`),ft},{});Ue.meta.base_models=Fe;let qe=null;if(($t=e(s))!=null&&$t.feedbackId?qe=await gr(localStorage.token,e(s).feedbackId,Ue).catch(ft=>{jt.error(`${ft}`)}):(qe=await Dr(localStorage.token,Ue).catch(ft=>{jt.error(`${ft}`)}),qe&&(Se.feedbackId=qe.id)),T()(e(s).id,Se),await lt(),!ke&&(k(oe,!0),!((Et=Se.annotation)!=null&&Et.tags)&&(((Gt=e(s))==null?void 0:Gt.content)??"")!=="")){const ft=await Wr(localStorage.token,e(s).model,ct,se()).catch(Wt=>[]);ft&&(Se.annotation.tags=ft,Ue.data.tags=ft,T()(e(s).id,Se),await gr(localStorage.token,Se.feedbackId,Ue).catch(Wt=>{jt.error(`${Wt}`)}))}k(Ze,!1)},he=async()=>{d()(e(s).id)},Z=re=>{if(e(B)){if(e(B).scrollWidth<=e(B).clientWidth)return;re.preventDefault(),re.deltaY!==0&&la(B,e(B).scrollLeft+=re.deltaY)}},Ee=re=>{if(e(_)){re.preventDefault();const ke=window.getSelection(),Se=ke.getRangeAt(0),Ke=document.createElement("div");Ke.appendChild(Se.cloneContents()),Ke.querySelectorAll("table").forEach(ct=>{ct.style.borderCollapse="collapse",ct.style.width="auto",ct.style.tableLayout="auto"}),Ke.querySelectorAll("th").forEach(ct=>{ct.style.whiteSpace="nowrap",ct.style.padding="4px 8px"}),re.clipboardData.setData("text/html",Ke.innerHTML),re.clipboardData.setData("text/plain",ke.toString())}};Pa(async()=>{await lt(),e(B)&&e(B).addEventListener("wheel",Z),e(_)&&e(_).addEventListener("copy",Ee)}),tr(()=>{e(B)&&e(B).removeEventListener("wheel",Z),e(_)&&e(_).removeEventListener("copy",Ee)}),yt(()=>(i(O()),e(s),i(X())),()=>{O().messages&&JSON.stringify(e(s))!==JSON.stringify(O().messages[X()])&&k(s,JSON.parse(JSON.stringify(O().messages[X()])))}),yt(()=>(l(),e(s)),()=>{k(z,l().find(re=>re.id===e(s).model))}),yt(()=>(e(C),lt),()=>{e(C)||(async()=>await lt())()}),ea(),It();var ye=Lo(),Ie=ee(ye);{let re=_e(()=>($(),t(()=>$().t("Delete message?"))));wr(Ie,{get title(){return e(re)},get show(){return e(U)},set show(ke){k(U,ke)},$$events:{confirm:()=>{he()}},$$legacy:!0})}var Pe=I(Ie,2);Na(Pe,()=>(e(s),t(()=>e(s).id)),re=>{var ke=To(),Se=n(ke);ze(Se,1,"shrink-0 ltr:mr-3 rtl:ml-3 hidden @lg:flex mt-1 ","svelte-1qscqw6");var Ke=n(Se);{let Ae=_e(()=>(i(da),e(z),$(),t(()=>{var Me;return`${da}/models/model/profile/image?id=${(Me=e(z))==null?void 0:Me.id}&lang=${$().language}`})));br(Ke,{get src(){return e(Ae)},className:"size-8 assistant-message-profile-image"})}r(Se);var ct=I(Se,2),Ue=n(ct);rr(Ue,{children:(Ae,Me)=>{var Oe=Yn(),Be=ee(Oe);{let rt=_e(()=>(e(z),e(s),t(()=>{var nt;return((nt=e(z))==null?void 0:nt.name)??e(s).model})));mt(Be,{get content(){return e(rt)},placement:"top-start",children:(nt,dt)=>{var et=Kn(),je=n(et,!0);r(et),b(()=>q(je,(e(z),e(s),t(()=>{var tt;return((tt=e(z))==null?void 0:tt.name)??e(s).model})))),a(nt,et)},$$slots:{default:!0}})}var Je=I(Be,2);{var Xe=rt=>{var nt=Qn(),dt=n(nt);{let et=_e(()=>(i(Tt),e(s),t(()=>Tt(e(s).timestamp*1e3).format("LLLL"))));mt(dt,{get content(){return e(et)},children:(je,tt)=>{var at=Gn(),kt=n(at,!0);r(at),b(Vt=>q(kt,Vt),[()=>($(),i(Ea),e(s),i(Tt),t(()=>$().t(Ea(e(s).timestamp*1e3),{LOCALIZED_TIME:Tt(e(s).timestamp*1e3).format("LT"),LOCALIZED_DATE:Tt(e(s).timestamp*1e3).format("L")})))]),a(je,at)},$$slots:{default:!0}})}r(nt),b(()=>ze(nt,1,`self-center text-xs font-medium first-letter:capitalize ml-0.5 translate-y-[1px] ${L(),t(()=>{var et;return((et=L())==null?void 0:et.highContrastMode)??!1?"dark:text-gray-100 text-gray-900":"invisible group-hover:visible transition text-gray-400"})??""}`)),a(rt,nt)};g(Je,rt=>{e(s),t(()=>e(s).timestamp)&&rt(Xe)})}a(Ae,Oe)},$$slots:{default:!0}});var Fe=I(Ue,2),qe=n(Fe),Ge=n(qe),Ye=n(Ge);{var $t=Ae=>{{let Me=_e(()=>(e(s),t(()=>{var Oe;return(Oe=e(s))==null?void 0:Oe.statusHistory})));Zn(Ae,{get statusHistory(){return e(Me)}})}};g(Ye,Ae=>{e(z),t(()=>{var Me,Oe,Be,Je;return((Je=(Be=(Oe=(Me=e(z))==null?void 0:Me.info)==null?void 0:Oe.meta)==null?void 0:Be.capabilities)==null?void 0:Je.status_updates)??!0})&&Ae($t)})}var Et=I(Ye,2);{var Gt=Ae=>{var Me=eo();ht(Me,5,()=>(e(s),t(()=>e(s).files)),Lt,(Oe,Be)=>{var Je=Xn(),Xe=n(Je);{var rt=dt=>{Ga(dt,{get src(){return e(Be),t(()=>e(Be).url)},get alt(){return e(s),t(()=>e(s).content)}})},nt=dt=>{{let et=_e(()=>(e(Be),t(()=>{var je;return(je=e(Be))==null?void 0:je.size})));Qa(dt,{get item(){return e(Be)},get url(){return e(Be),t(()=>e(Be).url)},get name(){return e(Be),t(()=>e(Be).name)},get type(){return e(Be),t(()=>e(Be).type)},get size(){return e(et)},small:!0})}};g(Xe,dt=>{e(Be),t(()=>e(Be).type==="image")?dt(rt):dt(nt,!1)})}r(Je),a(Oe,Je)}),r(Me),b(()=>{Le(Me,"dir",(L(),t(()=>{var Oe;return((Oe=L())==null?void 0:Oe.chatDirection)??"auto"}))),Me.dir=Me.dir}),a(Ae,Me)};g(Et,Ae=>{e(s),t(()=>{var Me,Oe;return((Me=e(s))==null?void 0:Me.files)&&((Oe=e(s).files)==null?void 0:Oe.filter(Be=>Be.type==="image").length)>0})&&Ae(Gt)})}var ft=I(Et,2);{var Wt=Ae=>{var Me=ao();ht(Me,5,()=>(e(s),t(()=>e(s).embeds)),Lt,(Oe,Be,Je)=>{var Xe=to(),rt=n(Xe);Qr(rt,{get src(){return e(Be)},allowScripts:!0,allowForms:!0,allowSameOrigin:!0,allowPopups:!0}),r(Xe),b(()=>Le(Xe,"id",(e(s),t(()=>`${e(s).id}-embeds-${Je}`)))),a(Oe,Xe)}),r(Me),a(Ae,Me)};g(ft,Ae=>{e(s),t(()=>{var Me;return((Me=e(s))==null?void 0:Me.embeds)&&e(s).embeds.length>0})&&Ae(Wt)})}var Ot=I(ft,2);{var Qt=Ae=>{var Me=ro(),Oe=n(Me);er(Oe),xa(Oe,at=>k(P,at),()=>e(P));var Be=I(Oe,2),Je=n(Be),Xe=n(Je),rt=n(Xe,!0);r(Xe),r(Je);var nt=I(Je,2),dt=n(nt),et=n(dt,!0);r(dt);var je=I(dt,2),tt=n(je,!0);r(je),r(nt),r(Be),r(Me),b((at,kt,Vt)=>{Le(Oe,"id",`message-edit-${e(s),t(()=>e(s).id)??""}`),q(rt,at),q(et,kt),q(tt,Vt)},[()=>($(),t(()=>$().t("Save As Copy"))),()=>($(),t(()=>$().t("Cancel"))),()=>($(),t(()=>$().t("Save")))]),Aa(Oe,()=>e(V),at=>k(V,at)),Ce("input",Oe,at=>{at.target.style.height="",at.target.style.height=`${at.target.scrollHeight}px`}),Ce("keydown",Oe,at=>{var Zt,Rt;at.key==="Escape"&&((Zt=document.getElementById("close-edit-message-button"))==null||Zt.click());const kt=at.metaKey||at.ctrlKey,Vt=at.key==="Enter";kt&&Vt&&((Rt=document.getElementById("confirm-edit-message-button"))==null||Rt.click())}),Ce("click",Xe,()=>{be()}),Ce("click",dt,()=>{Re()}),Ce("click",je,()=>{Ne()}),a(Ae,Me)};g(Ot,Ae=>{e(C)===!0&&Ae(Qt)})}var Yt=I(Ot,2),ma=n(Yt);{var wa=Ae=>{sr(Ae,{})},ta=Ae=>{var Me=we(),Oe=ee(Me);{var Be=Je=>{{let Xe=_e(()=>(i(se()),e(s),t(()=>`${se()}-${e(s).id}`))),rt=_e(()=>(e(s),i(p()),L(),t(()=>{var je,tt;return((je=e(s))==null?void 0:je.done)&&!p()&&(((tt=L())==null?void 0:tt.showFloatingActionButtons)??!0)}))),nt=_e(()=>!p()),dt=_e(()=>!p()),et=_e(()=>(L(),e(s),t(()=>{var je,tt;return((je=L())==null?void 0:je.chatFadeStreamingText)??!0?((tt=e(s))==null?void 0:tt.done)??!1:!0})));hn(Je,{get id(){return e(Xe)},get messageId(){return e(s),t(()=>e(s).id)},get history(){return O()},get selectedModels(){return ce()},get content(){return e(s),t(()=>e(s).content)},get sources(){return e(s),t(()=>e(s).sources)},get floatingButtons(){return e(rt)},get save(){return e(nt)},get preview(){return e(dt)},get editCodeBlock(){return H()},get topPadding(){return x()},get done(){return e(et)},get model(){return e(z)},onTaskClick:async je=>{},onSourceClick:async je=>{var tt;e(M)&&((tt=e(M))==null||tt.showSourceModal(je))},onAddMessages:({modelId:je,parentId:tt,messages:at})=>{y()({modelId:je,parentId:tt,messages:at})},onSave:({raw:je,oldContent:tt,newContent:at})=>{O(O().messages[e(s).id].content=O().messages[e(s).id].content.replace(je,je.replace(tt,at)),!0),ge()()}})}};g(Oe,Je=>{e(s),t(()=>e(s).content&&e(s).error!==!0)&&Je(Be)},!0)}a(Ae,Me)};g(ma,Ae=>{e(s),e(z),t(()=>{var Me,Oe,Be,Je,Xe,rt,nt,dt,et,je;return e(s).content===""&&!e(s).error&&(((Je=(Be=(Oe=(Me=e(z))==null?void 0:Me.info)==null?void 0:Oe.meta)==null?void 0:Be.capabilities)==null?void 0:Je.status_updates)??!0?(((Xe=e(s))==null?void 0:Xe.statusHistory)??[...(rt=e(s))!=null&&rt.status?[(nt=e(s))==null?void 0:nt.status]:[]]).length===0||(((je=(et=(dt=e(s))==null?void 0:dt.statusHistory)==null?void 0:et.at(-1))==null?void 0:je.hidden)??!1):!0)})?Ae(wa):Ae(ta,!1)})}var aa=I(ma,2);{var ca=Ae=>{{let Me=_e(()=>(e(s),t(()=>{var Oe,Be;return((Be=(Oe=e(s))==null?void 0:Oe.error)==null?void 0:Be.content)??e(s).content})));Ss(Ae,{get content(){return e(Me)}})}};g(aa,Ae=>{e(s),t(()=>{var Me;return(Me=e(s))==null?void 0:Me.error})&&Ae(ca)})}var ha=I(aa,2);{var ya=Ae=>{{let Me=_e(()=>(e(s),t(()=>{var Be;return(Be=e(s))==null?void 0:Be.id}))),Oe=_e(()=>(e(s),t(()=>{var Be,Je;return((Be=e(s))==null?void 0:Be.sources)??((Je=e(s))==null?void 0:Je.citations)})));xa(Vs(Ae,{get id(){return e(Me)},get chatId(){return se()},get sources(){return e(Oe)},get readOnly(){return p()},$$legacy:!0}),Be=>k(M,Be),()=>e(M))}};g(ha,Ae=>{e(s),e(z),t(()=>{var Me,Oe,Be,Je,Xe,rt;return(((Me=e(s))==null?void 0:Me.sources)||((Oe=e(s))==null?void 0:Oe.citations))&&(((rt=(Xe=(Je=(Be=e(z))==null?void 0:Be.info)==null?void 0:Je.meta)==null?void 0:Xe.capabilities)==null?void 0:rt.citations)??!0)})&&Ae(ya)})}var ra=I(ha,2);{var ia=Ae=>{on(Ae,{get codeExecutions(){return e(s),t(()=>e(s).code_executions)}})};g(ra,Ae=>{e(s),t(()=>e(s).code_executions)&&Ae(ia)})}r(Yt),xa(Yt,Ae=>k(_,Ae),()=>e(_)),r(Ge),r(qe);var ga=I(qe,2);{var ka=Ae=>{var Me=Bo(),Oe=ee(Me),Be=n(Oe);{var Je=et=>{var je=No(),tt=ee(je);{var at=Zt=>{var Rt=oo(),Xt=n(Rt),ua=I(Xt,2);{var Ma=At=>{var Ft=so(),Kt=n(Ft);La(Kt);var na=I(Kt);r(Ft),b(Ht=>{Le(Kt,"id",`message-index-input-${e(s),t(()=>e(s).id)??""}`),Va(Kt,Ht),Le(Kt,"max",(i(le()),t(()=>le().length))),q(na,`/${i(le()),t(()=>le().length)??""}`)},[()=>(i(le()),e(s),t(()=>le().indexOf(e(s).id)+1))]),Ce("focus",Kt,Ht=>{Ht.target.select()}),Ce("blur",Kt,Ht=>{me()(e(s),Ht.target.value-1),k(ae,!1)}),Ce("keydown",Kt,Ht=>{Ht.key==="Enter"&&(me()(e(s),Ht.target.value-1),k(ae,!1))}),a(At,Ft)},Ca=At=>{var Ft=no(),Kt=n(Ft);r(Ft),b(na=>q(Kt,`${na??""}/${i(le()),t(()=>le().length)??""}`),[()=>(i(le()),e(s),t(()=>le().indexOf(e(s).id)+1))]),Ce("dblclick",Ft,async()=>{k(ae,!0),await lt();const na=document.getElementById(`message-index-input-${e(s).id}`);na&&(na.focus(),na.select())}),a(At,Ft)};g(ua,At=>{e(ae)?At(Ma):At(Ca,!1)})}var sa=I(ua,2);r(Rt),b((At,Ft)=>{Le(Xt,"aria-label",At),Le(sa,"aria-label",Ft),Rt.dir=Rt.dir},[()=>($(),t(()=>$().t("Previous message"))),()=>($(),t(()=>$().t("Next message")))]),Ce("click",Xt,()=>{de()(e(s))}),Ce("click",sa,()=>{xe()(e(s))}),a(Zt,Rt)};g(tt,Zt=>{i(le()),t(()=>le().length>1)&&Zt(at)})}var kt=I(tt,2);{var Vt=Zt=>{var Rt=So(),Xt=ee(Rt);{var ua=_t=>{var St=we(),pt=ee(St);{var qt=st=>{{let Nt=_e(()=>($(),t(()=>$().t("Edit"))));mt(st,{get content(){return e(Nt)},placement:"bottom",children:(oa,va)=>{var ut=io();b(zt=>{Le(ut,"aria-label",zt),ze(ut,1,`${i(h()),L(),t(()=>{var Ia;return h()||(((Ia=L())==null?void 0:Ia.highContrastMode)??!1)?"visible":"invisible group-hover:visible"})??""} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition`)},[()=>($(),t(()=>$().t("Edit")))]),Ce("click",ut,()=>{ve()}),a(oa,ut)},$$slots:{default:!0}})}};g(pt,st=>{G(),t(()=>{var Nt,oa,va,ut;return((Nt=G())==null?void 0:Nt.role)==="user"?((ut=(va=(oa=G())==null?void 0:oa.permissions)==null?void 0:va.chat)==null?void 0:ut.edit)??!0:!0})&&st(qt)})}a(_t,St)};g(Xt,_t=>{p()||_t(ua)})}var Ma=I(Xt,2);{let _t=_e(()=>($(),t(()=>$().t("Copy"))));mt(Ma,{get content(){return e(_t)},placement:"bottom",children:(St,pt)=>{var qt=lo();b(st=>{Le(qt,"aria-label",st),ze(qt,1,`${i(h()),L(),t(()=>{var Nt;return h()||(((Nt=L())==null?void 0:Nt.highContrastMode)??!1)?"visible":"invisible group-hover:visible"})??""} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button`)},[()=>($(),t(()=>$().t("Copy")))]),Ce("click",qt,()=>{N(e(s).content)}),a(St,qt)},$$slots:{default:!0}})}var Ca=I(Ma,2);{var sa=_t=>{{let St=_e(()=>($(),t(()=>$().t("Read Aloud"))));mt(_t,{get content(){return e(St)},placement:"bottom",children:(pt,qt)=>{var st=uo(),Nt=n(st);{var oa=ut=>{var zt=vo();a(ut,zt)},va=ut=>{var zt=we(),Ia=ee(zt);{var wt=gt=>{var xt=co();a(gt,xt)},Qe=gt=>{var xt=go();a(gt,xt)};g(Ia,gt=>{e(K)?gt(wt):gt(Qe,!1)},!0)}a(ut,zt)};g(Nt,ut=>{e(fe)?ut(oa):ut(va,!1)})}r(st),b(ut=>{Le(st,"aria-label",ut),Le(st,"id",`speak-button-${e(s),t(()=>e(s).id)??""}`),ze(st,1,`${i(h()),L(),t(()=>{var zt;return h()||(((zt=L())==null?void 0:zt.highContrastMode)??!1)?"visible":"invisible group-hover:visible"})??""} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition`)},[()=>($(),t(()=>$().t("Read Aloud")))]),Ce("click",st,()=>{e(fe)||(e(K)?j():S())}),a(pt,st)},$$slots:{default:!0}})}};g(Ca,_t=>{G(),t(()=>{var St,pt,qt,st;return((St=G())==null?void 0:St.role)==="admin"||(((st=(qt=(pt=G())==null?void 0:pt.permissions)==null?void 0:qt.chat)==null?void 0:st.tts)??!0)})&&_t(sa)})}var At=I(Ca,2);{var Ft=_t=>{{let St=_e(()=>($(),t(()=>$().t("Generate Image"))));mt(_t,{get content(){return e(St)},placement:"bottom",children:(pt,qt)=>{var st=ho(),Nt=n(st);{var oa=ut=>{var zt=fo();a(ut,zt)},va=ut=>{var zt=mo();a(ut,zt)};g(Nt,ut=>{e(ne)?ut(oa):ut(va,!1)})}r(st),b(ut=>{Le(st,"aria-label",ut),ze(st,1,`${i(h()),L(),t(()=>{var zt;return h()||(((zt=L())==null?void 0:zt.highContrastMode)??!1)?"visible":"invisible group-hover:visible"})??""}  p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition`)},[()=>($(),t(()=>$().t("Generate Image")))]),Ce("click",st,()=>{e(ne)||Ve(e(s))}),a(pt,st)},$$slots:{default:!0}})}};g(At,_t=>{u(),G(),i(p()),t(()=>{var St,pt,qt,st,Nt;return((St=u())==null?void 0:St.features.enable_image_generation)&&(((pt=G())==null?void 0:pt.role)==="admin"||((Nt=(st=(qt=G())==null?void 0:qt.permissions)==null?void 0:st.features)==null?void 0:Nt.image_generation))&&!p()})&&_t(Ft)})}var Kt=I(At,2);{var na=_t=>{{let St=_e(()=>(e(s),i(Sa),t(()=>e(s).usage?`<pre>${Sa(JSON.stringify(e(s).usage,null,2).replace(/"([^(")"]+)":/g,"$1:").slice(1,-1).split(`
`).map(pt=>pt.slice(2)).map(pt=>pt.endsWith(",")?pt.slice(0,-1):pt).join(`
`))}</pre>`:"")));mt(_t,{get content(){return e(St)},placement:"bottom",children:(pt,qt)=>{var st=_o();b(()=>{ze(st,1,` ${i(h()),L(),t(()=>{var Nt;return h()||(((Nt=L())==null?void 0:Nt.highContrastMode)??!1)?"visible":"invisible group-hover:visible"})??""} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap`),Le(st,"id",`info-${e(s),t(()=>e(s).id)??""}`)}),Ce("click",st,()=>{e(s)}),a(pt,st)},$$slots:{default:!0}})}};g(Kt,_t=>{e(s),t(()=>e(s).usage)&&_t(na)})}var Ht=I(Kt,2);{var _a=_t=>{var St=Eo(),pt=ee(St);{var qt=wt=>{var Qe=bo(),gt=ee(Qe);{let ot=_e(()=>($(),t(()=>$().t("Good Response"))));mt(gt,{get content(){return e(ot)},placement:"bottom",children:(Pt,Ut)=>{var Bt=po();b((it,vt)=>{Le(Bt,"aria-label",it),ze(Bt,1,`${i(h()),L(),t(()=>{var bt;return h()||(((bt=L())==null?void 0:bt.highContrastMode)??!1)?"visible":"invisible group-hover:visible"})??""} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg ${vt??""} dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent`),Bt.disabled=e(Ze)},[()=>($(),t(()=>$().t("Good Response"))),()=>(e(s),t(()=>{var it,vt;return(((vt=(it=e(s))==null?void 0:it.annotation)==null?void 0:vt.rating)??"").toString()==="1"?"bg-gray-100 dark:bg-gray-800":""}))]),Ce("click",Bt,async()=>{await He(1),window.setTimeout(()=>{var it;(it=document.getElementById(`message-feedback-${e(s).id}`))==null||it.scrollIntoView()},0)}),a(Pt,Bt)},$$slots:{default:!0}})}var xt=I(gt,2);{let ot=_e(()=>($(),t(()=>$().t("Bad Response"))));mt(xt,{get content(){return e(ot)},placement:"bottom",children:(Pt,Ut)=>{var Bt=xo();b((it,vt)=>{Le(Bt,"aria-label",it),ze(Bt,1,`${i(h()),L(),t(()=>{var bt;return h()||(((bt=L())==null?void 0:bt.highContrastMode)??!1)?"visible":"invisible group-hover:visible"})??""} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg ${vt??""} dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent`),Bt.disabled=e(Ze)},[()=>($(),t(()=>$().t("Bad Response"))),()=>(e(s),t(()=>{var it,vt;return(((vt=(it=e(s))==null?void 0:it.annotation)==null?void 0:vt.rating)??"").toString()==="-1"?"bg-gray-100 dark:bg-gray-800":""}))]),Ce("click",Bt,async()=>{await He(-1),window.setTimeout(()=>{var it;(it=document.getElementById(`message-feedback-${e(s).id}`))==null||it.scrollIntoView()},0)}),a(Pt,Bt)},$$slots:{default:!0}})}a(wt,Qe)};g(pt,wt=>{te(),u(),G(),t(()=>{var Qe,gt,xt,ot,Pt;return!te()&&(((Qe=u())==null?void 0:Qe.features.enable_message_rating)??!0)&&(((gt=G())==null?void 0:gt.role)==="admin"||(((Pt=(ot=(xt=G())==null?void 0:xt.permissions)==null?void 0:ot.chat)==null?void 0:Pt.rate_response)??!0))})&&wt(qt)})}var st=I(pt,2);{var Nt=wt=>{{let Qe=_e(()=>($(),t(()=>$().t("Continue Response"))));mt(wt,{get content(){return e(Qe)},placement:"bottom",children:(gt,xt)=>{var ot=wo();b(Pt=>{Le(ot,"aria-label",Pt),ze(ot,1,`${i(h()),L(),t(()=>{var Ut;return h()||(((Ut=L())==null?void 0:Ut.highContrastMode)??!1)?"visible":"invisible group-hover:visible"})??""} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition`)},[()=>($(),t(()=>$().t("Continue Response")))]),Ce("click",ot,()=>{Q()()}),a(gt,ot)},$$slots:{default:!0}})}};g(st,wt=>{i(h()),G(),t(()=>{var Qe,gt,xt,ot;return h()&&(((Qe=G())==null?void 0:Qe.role)==="admin"||(((ot=(xt=(gt=G())==null?void 0:gt.permissions)==null?void 0:xt.chat)==null?void 0:ot.continue_response)??!0))})&&wt(Nt)})}var oa=I(st,2);{var va=wt=>{var Qe=we(),gt=ee(Qe);{var xt=Pt=>{var Ut=ko(),Bt=ee(Ut),it=I(Bt,2);Tn(it,{onRegenerate:(vt=null)=>{var bt;k(oe,!1),D()(e(s),vt),(((bt=e(z))==null?void 0:bt.actions)??[]).forEach(pa=>{v("action",{id:pa.id,event:{id:"regenerate-response",data:{messageId:e(s).id}}})})},children:(vt,bt)=>{{let pa=_e(()=>($(),t(()=>$().t("Regenerate"))));mt(vt,{get content(){return e(pa)},placement:"bottom",children:(Cr,Fi)=>{var Fa=yo();b(Ir=>{Le(Fa,"aria-label",Ir),ze(Fa,1,`${h()?"visible":"invisible group-hover:visible"} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition`)},[()=>($(),t(()=>$().t("Regenerate")))]),a(Cr,Fa)},$$slots:{default:!0}})}},$$slots:{default:!0}}),Ce("click",Bt,()=>{var vt;k(oe,!1),D()(e(s)),(((vt=e(z))==null?void 0:vt.actions)??[]).forEach(bt=>{v("action",{id:bt.id,event:{id:"regenerate-response",data:{messageId:e(s).id}}})})}),a(Pt,Ut)},ot=Pt=>{{let Ut=_e(()=>($(),t(()=>$().t("Regenerate"))));mt(Pt,{get content(){return e(Ut)},placement:"bottom",children:(Bt,it)=>{var vt=Mo();b(bt=>{Le(vt,"aria-label",bt),ze(vt,1,`${h()?"visible":"invisible group-hover:visible"} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button`)},[()=>($(),t(()=>$().t("Regenerate")))]),Ce("click",vt,()=>{var bt;k(oe,!1),D()(e(s)),(((bt=e(z))==null?void 0:bt.actions)??[]).forEach(pa=>{v("action",{id:pa.id,event:{id:"regenerate-response",data:{messageId:e(s).id}}})})}),a(Bt,vt)},$$slots:{default:!0}})}};g(gt,Pt=>{L(),t(()=>{var Ut;return((Ut=L())==null?void 0:Ut.regenerateMenu)??!0})?Pt(xt):Pt(ot,!1)})}a(wt,Qe)};g(oa,wt=>{G(),t(()=>{var Qe,gt,xt,ot;return((Qe=G())==null?void 0:Qe.role)==="admin"||(((ot=(xt=(gt=G())==null?void 0:gt.permissions)==null?void 0:xt.chat)==null?void 0:ot.regenerate_response)??!0)})&&wt(va)})}var ut=I(oa,2);{var zt=wt=>{var Qe=we(),gt=ee(Qe);{var xt=ot=>{{let Pt=_e(()=>($(),t(()=>$().t("Delete"))));mt(ot,{get content(){return e(Pt)},placement:"bottom",children:(Ut,Bt)=>{var it=Co();b(vt=>{Le(it,"aria-label",vt),ze(it,1,`${i(h()),L(),t(()=>{var bt;return h()||(((bt=L())==null?void 0:bt.highContrastMode)??!1)?"visible":"invisible group-hover:visible"})??""} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition`)},[()=>($(),t(()=>$().t("Delete")))]),Ce("click",it,()=>{k(U,!0)}),a(Ut,it)},$$slots:{default:!0}})}};g(gt,ot=>{i(le()),t(()=>le().length>1)&&ot(xt)})}a(wt,Qe)};g(ut,wt=>{G(),t(()=>{var Qe,gt,xt,ot;return((Qe=G())==null?void 0:Qe.role)==="admin"||(((ot=(xt=(gt=G())==null?void 0:gt.permissions)==null?void 0:xt.chat)==null?void 0:ot.delete_message)??!0)})&&wt(zt)})}var Ia=I(ut,2);ht(Ia,1,()=>(e(z),t(()=>{var wt;return((wt=e(z))==null?void 0:wt.actions)??[]})),Lt,(wt,Qe)=>{mt(wt,{get content(){return e(Qe),t(()=>e(Qe).name)},placement:"bottom",children:(gt,xt)=>{var ot=$o(),Pt=n(ot);{var Ut=it=>{var vt=Io(),bt=n(vt);r(vt),b(pa=>{Le(bt,"src",(e(Qe),t(()=>e(Qe).icon))),ze(bt,1,`w-4 h-4 ${pa??""}`),Le(bt,"alt",(e(Qe),t(()=>e(Qe).name)))},[()=>(e(Qe),t(()=>e(Qe).icon.includes("svg")?"dark:invert-[80%]":""))]),a(it,vt)},Bt=it=>{ts(it,{strokeWidth:"2.1",className:"size-4"})};g(Pt,it=>{e(Qe),t(()=>{var vt;return(vt=e(Qe))==null?void 0:vt.icon})?it(Ut):it(Bt,!1)})}r(ot),b(()=>{Le(ot,"aria-label",(e(Qe),t(()=>e(Qe).name))),ze(ot,1,`${i(h()),L(),t(()=>{var it;return h()||(((it=L())==null?void 0:it.highContrastMode)??!1)?"visible":"invisible group-hover:visible"})??""} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition`)}),Ce("click",ot,()=>{E()(e(Qe).id,e(s))}),a(gt,ot)},$$slots:{default:!0}})}),a(_t,St)};g(Ht,_t=>{p()||_t(_a)})}a(Zt,Rt)};g(kt,Zt=>{e(s),t(()=>e(s).done)&&Zt(Vt)})}a(et,je)};g(Be,et=>{e(s),i(le()),t(()=>e(s).done||le().length>1)&&et(Je)})}r(Oe),xa(Oe,et=>k(B,et),()=>e(B));var Xe=I(Oe,2);{var rt=et=>{ws(et,{get message(){return e(s)},set message(je){k(s,je)},get show(){return e(oe)},set show(je){k(oe,je)},$$events:{save:async je=>{await He(null,{...je.detail})}},$$legacy:!0})};g(Xe,et=>{e(s),e(oe),t(()=>e(s).done&&e(oe))&&et(rt)})}var nt=I(Xe,2);{var dt=et=>{var je=Po(),tt=n(je);{let at=_e(()=>(e(s),t(()=>{var kt;return(kt=e(s))==null?void 0:kt.followUps})));kn(tt,{get followUps(){return e(at)},onClick:kt=>{var Vt,Zt;((Vt=L())==null?void 0:Vt.insertFollowUpPrompt)??!1?pe()(kt):F()((Zt=e(s))==null?void 0:Zt.id,kt)}})}r(je),Ba(1,je,()=>Ta,()=>({duration:100})),a(et,je)};g(nt,et=>{i(h()),L(),e(s),i(p()),t(()=>{var je,tt;return(h()||(((je=L())==null?void 0:je.keepFollowUpPrompts)??!1))&&e(s).done&&!p()&&(((tt=e(s))==null?void 0:tt.followUps)??[]).length>0})&&et(dt)})}a(Ae,Me)};g(ga,Ae=>{e(C)||Ae(ka)})}r(Fe),r(ct),r(ke),b(()=>{ze(ke,1,` flex w-full message-${e(s),t(()=>e(s).id)??""}`,"svelte-1qscqw6"),Le(ke,"id",`message-${e(s),t(()=>e(s).id)??""}`),Le(ke,"dir",(L(),t(()=>L().chatDirection))),ze(qe,1,`chat-${e(s),t(()=>e(s).role)??""} w-full min-w-full markdown-prose`,"svelte-1qscqw6"),ze(Yt,1,`w-full flex flex-col relative ${e(C)?"hidden":""}`),ke.dir=ke.dir}),a(re,ke)}),a(Te,ye),Ct(),A()}var Oo=fa('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M8 8v8m0-8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0 8a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm6-2a2 2 0 1 1 4 0 2 2 0 0 1-4 0Zm0 0h-1a5 5 0 0 1-5-5v-.5"></path></svg>');function Ro(Te,o){let l=c(o,"className",8,"w-4 h-4"),u=c(o,"strokeWidth",8,"1.5");var L=Oo();b(()=>{Le(L,"stroke-width",u()),ze(L,0,za(l()))}),a(Te,L)}var zo=f('<button><div class="flex items-center gap-1.5"><div class="-translate-y-[1px]"> </div></div></button>'),jo=f('<div class="w-full"><div class=" flex w-full mb-4.5 border-b border-gray-200 dark:border-gray-850"><div class="flex gap-2 scrollbar-none overflow-x-auto w-fit text-center font-medium bg-transparent pt-1 text-sm"></div></div> <!></div>'),Ao=f("<div><!></div>"),Ho=f('<span class=" self-center invisible group-hover:visible text-gray-400 text-xs font-medium uppercase ml-0.5 -mt-0.5"> </span>'),qo=f(" <!>",1),Do=f('<div class="w-full rounded-xl pl-5 pr-2 py-2 mt-2"><!> <div class="mt-1 markdown-prose w-full min-w-full"><!></div></div>'),Wo=f('<button type="button" id="merge-response-button"><!></button>'),Fo=f('<div class=" shrink-0 text-gray-600 dark:text-gray-500 mt-1"><!></div>'),Uo=f('<div class="flex justify-end"><div class="w-full"><!></div> <!></div>'),Jo=f('<div><div class="flex snap-x snap-mandatory overflow-x-auto scrollbar-hidden"><!></div> <!></div>');function Vo(Te,o){Mt(o,!1);const l=()=>De(ba,"$settings",w),u=()=>De(ja,"$models",w),L=()=>De(hr,"$mobile",w),$=()=>De(G,"$i18n",w),[w,R]=Jt(),G=Dt("i18n");Tt.extend(xr);let te=c(o,"chatId",8),m=c(o,"history",12),A=c(o,"messageId",8),Y=c(o,"selectedModels",24,()=>[]),v=c(o,"isLastMessage",8),se=c(o,"readOnly",8,!1),O=c(o,"editCodeBlock",8,!0),X=c(o,"setInputText",8,()=>{}),ce=c(o,"updateChat",8),s=c(o,"editMessage",8),le=c(o,"saveMessage",8),pe=c(o,"rateMessage",8),me=c(o,"actionMessage",8),de=c(o,"submitMessage",8),xe=c(o,"deleteMessage",8),ge=c(o,"continueResponse",8),ue=c(o,"regenerateResponse",8),T=c(o,"mergeResponses",8),E=c(o,"addMessages",8),d=c(o,"triggerScroll",8),F=c(o,"topPadding",8,!1);Ra();let Q=$e(),D=$e({}),y=$e({}),h=$e(null),p=$e(JSON.parse(JSON.stringify(m().messages[A()])));const H=async(P,ae)=>{la(y,e(y)[P]=Math.max(0,Math.min(ae,e(D)[P].messageIds.length-1)));let K=e(D)[P].messageIds[e(y)[P]],fe=m().messages[K].childrenIds;for(;fe.length!==0;)K=fe.at(-1),fe=m().messages[K].childrenIds;m(m().currentId=K,!0),await lt(),await ce()(),d()()},x=async P=>{la(y,e(y)[P]=Math.max(0,e(y)[P]-1));let ae=e(D)[P].messageIds[e(y)[P]],K=m().messages[ae].childrenIds;for(;K.length!==0;)ae=K.at(-1),K=m().messages[ae].childrenIds;m(m().currentId=ae,!0),await lt(),await ce()(),d()()},M=async P=>{la(y,e(y)[P]=Math.min(e(D)[P].messageIds.length-1,e(y)[P]+1));let ae=e(D)[P].messageIds[e(y)[P]],K=m().messages[ae].childrenIds;for(;K.length!==0;)ae=K.at(-1),K=m().messages[ae].childrenIds;m(m().currentId=ae,!0),await lt(),await ce()(),d()()},_=async()=>{var P,ae,K;await lt(),A(),k(Q,m().messages[A()].parentId?m().messages[m().messages[A()].parentId]:null),k(D,(P=e(Q))==null?void 0:P.models.reduce((fe,ne,oe)=>{var j,S;let N=(j=e(Q))==null?void 0:j.childrenIds.map(J=>m().messages[J]).filter(J=>(J==null?void 0:J.modelIdx)===oe).map(J=>J.id);if(N.length===0){let J=(S=e(Q))==null?void 0:S.childrenIds.map(W=>m().messages[W]).filter(W=>(W==null?void 0:W.model)===ne);J.forEach(W=>{W.modelIdx=oe}),N=J.map(W=>W.id)}return{...fe,[oe]:{messageIds:N}}},{})),k(y,(ae=e(Q))==null?void 0:ae.models.reduce((fe,ne,oe)=>{const N=e(D)[oe].messageIds.findIndex(j=>j===A());return N!==-1?{...fe,[oe]:N}:{...fe,[oe]:e(D)[oe].messageIds.length-1}},{})),k(h,(K=m().messages[A()])==null?void 0:K.modelIdx),e(D),e(y),await lt()},B=async(P,ae)=>{if(A()!=P){let K=P,fe=m().messages[K].childrenIds;for(;fe.length!==0;)K=fe.at(-1),fe=m().messages[K].childrenIds;m(m().currentId=K,!0),k(h,ae)}},U=async()=>{const P=Object.keys(e(D)).map(ae=>{const{messageIds:K}=e(D)[ae],fe=K[e(y)[ae]];return m().messages[fe].content});T()(A(),P,te())};Pa(async()=>{var P;if(await _(),await lt(),((P=l())==null?void 0:P.scrollOnBranchChange)??!0){const ae=document.getElementById(`message-${A()}`);ae&&ae.scrollIntoView({block:"start"})}}),yt(()=>(i(m()),e(p),i(A())),()=>{m().messages&&JSON.stringify(e(p))!==JSON.stringify(m().messages[A()])&&k(p,JSON.parse(JSON.stringify(m().messages[A()])))}),ea(),It();var z=we(),C=ee(z);{var V=P=>{var ae=Jo(),K=n(ae),fe=n(K);{var ne=S=>{var J=jo(),W=n(J),ie=n(W);ht(ie,5,()=>(e(D),t(()=>Object.keys(e(D)))),Lt,(be,Re)=>{var Ve=we(),Ze=ee(Ve);{var He=he=>{const Z=_e(()=>(e(D),e(Re),e(y),t(()=>e(D)[e(Re)].messageIds[e(y)[e(Re)]]))),Ee=_e(()=>(u(),i(m()),i(e(Z)),t(()=>u().find(ke=>{var Se;return ke.id===((Se=m().messages[e(Z)])==null?void 0:Se.model)}))));var ye=zo(),Ie=n(ye),Pe=n(Ie),re=n(Pe,!0);r(Pe),r(Ie),r(ye),b(()=>{ze(ye,1,`min-w-fit ${e(h)==e(Re)?" dark:border-gray-300 ":" opacity-35 border-transparent"} pb-1.5 px-2.5 transition border-b-2`),q(re,(i(e(Ee)),i(m()),i(e(Z)),t(()=>{var ke;return e(Ee)?`${e(Ee).name}`:(ke=m().messages[e(Z)])==null?void 0:ke.model})))}),Ce("click",ye,async()=>{e(h)!=e(Re)&&k(h,e(Re)),B(e(Z),e(Re))}),a(he,ye)};g(Ze,he=>{e(y),e(Re),e(D),t(()=>{var Z;return e(y)[e(Re)]!==void 0&&(((Z=e(D)[e(Re)])==null?void 0:Z.messageIds)??[]).length>0})&&he(He)})}a(be,Ve)}),r(ie),r(W);var ve=I(W,2);{var Ne=be=>{var Re=we(),Ve=ee(Re);Na(Ve,()=>(i(m()),t(()=>m().currentId)),Ze=>{var He=we(),he=ee(He);{var Z=Ee=>{{let ye=_e(()=>(e(p),t(()=>{var Ie;return(Ie=e(p))==null?void 0:Ie.id})));Xa(Ee,{get chatId(){return te()},get history(){return m()},get messageId(){return e(ye)},get selectedModels(){return Y()},isLastMessage:!0,get siblings(){return e(D),e(h),t(()=>e(D)[e(h)].messageIds)},gotoMessage:(Ie,Pe)=>H(e(h),Pe),showPreviousMessage:()=>x(e(h)),showNextMessage:()=>M(e(h)),get setInputText(){return X()},get updateChat(){return ce()},get editMessage(){return s()},get saveMessage(){return le()},get rateMessage(){return pe()},get deleteMessage(){return xe()},get actionMessage(){return me()},get submitMessage(){return de()},get continueResponse(){return ge()},regenerateResponse:async(Ie,Pe=null)=>{ue()(Ie,Pe),await lt(),la(y,e(y)[e(h)]=e(D)[e(h)].messageIds.length-1)},get addMessages(){return E()},get readOnly(){return se()},get topPadding(){return F()}})}};g(he,Ee=>{e(p)&&Ee(Z)})}a(Ze,He)}),a(be,Re)};g(ve,be=>{e(h)!==null&&be(Ne)})}r(J),a(S,J)},oe=S=>{var J=we(),W=ee(J);ht(W,1,()=>(e(D),t(()=>Object.keys(e(D)))),Lt,(ie,ve)=>{var Ne=we(),be=ee(Ne);{var Re=Ve=>{const Ze=_e(()=>(e(D),e(ve),e(y),t(()=>e(D)[e(ve)].messageIds[e(y)[e(ve)]])));var He=Ao(),he=n(He);Na(he,()=>(i(m()),t(()=>m().currentId)),Z=>{var Ee=we(),ye=ee(Ee);{var Ie=Pe=>{Xa(Pe,{get chatId(){return te()},get history(){return m()},get messageId(){return e(Ze)},get selectedModels(){return Y()},isLastMessage:!0,get siblings(){return e(D),e(ve),t(()=>e(D)[e(ve)].messageIds)},gotoMessage:(re,ke)=>H(e(ve),ke),showPreviousMessage:()=>x(e(ve)),showNextMessage:()=>M(e(ve)),get setInputText(){return X()},get updateChat(){return ce()},get editMessage(){return s()},get saveMessage(){return le()},get rateMessage(){return pe()},get deleteMessage(){return xe()},get actionMessage(){return me()},get submitMessage(){return de()},get continueResponse(){return ge()},regenerateResponse:async(re,ke=null)=>{ue()(re,ke),await lt(),la(y,e(y)[e(ve)]=e(D)[e(ve)].messageIds.length-1)},get addMessages(){return E()},get readOnly(){return se()},get editCodeBlock(){return O()},get topPadding(){return F()}})};g(ye,Pe=>{e(p)&&Pe(Ie)})}a(Z,Ee)}),r(He),b(()=>ze(He,1,` snap-center w-full max-w-full m-1 border ${i(m()),i(A()),e(ve),L(),t(()=>{var Z;return((Z=m().messages[A()])==null?void 0:Z.modelIdx)==e(ve)?`bg-gray-50 dark:bg-gray-850 border-gray-100 dark:border-gray-800 border-2 ${L()?"min-w-full":"min-w-80"}`:`border-gray-100/30 dark:border-gray-850/30 border-dashed ${L()?"min-w-full":"min-w-80"}`})??""} transition-all p-5 rounded-2xl`)),Ce("click",He,async()=>{B(e(Ze),e(ve))}),a(Ve,He)};g(be,Ve=>{e(y),e(ve),e(D),t(()=>e(y)[e(ve)]!==void 0&&e(D)[e(ve)].messageIds.length>0)&&Ve(Re)})}a(ie,Ne)}),a(S,J)};g(fe,S=>{l(),t(()=>{var J;return((J=l())==null?void 0:J.displayMultiModelResponsesInTabs)??!1})?S(ne):S(oe,!1)})}r(K);var N=I(K,2);{var j=S=>{var J=we(),W=ee(J);{var ie=ve=>{var Ne=Uo(),be=n(Ne),Re=n(be);{var Ve=he=>{const Z=_e(()=>(i(m()),i(A()),t(()=>{var Se;return(Se=m().messages[A()])==null?void 0:Se.merged})));var Ee=Do(),ye=n(Ee);rr(ye,{children:(Se,Ke)=>{qa();var ct=qo(),Ue=ee(ct),Fe=I(Ue);{var qe=Ge=>{var Ye=Ho(),$t=n(Ye,!0);r(Ye),b(Et=>q($t,Et),[()=>(i(Tt),i(e(Z)),t(()=>Tt(e(Z).timestamp*1e3).format("LT")))]),a(Ge,Ye)};g(Fe,Ge=>{i(e(Z)),t(()=>e(Z).timestamp)&&Ge(qe)})}b(Ge=>q(Ue,`${Ge??""} `),[()=>($(),t(()=>$().t("Merged Response")))]),a(Se,ct)},$$slots:{default:!0}});var Ie=I(ye,2),Pe=n(Ie);{var re=Se=>{sr(Se,{})},ke=Se=>{{let Ke=_e(()=>(i(e(Z)),t(()=>e(Z).content??"")));Oa(Se,{id:"merged",get content(){return e(Ke)}})}};g(Pe,Se=>{i(e(Z)),t(()=>{var Ke;return(((Ke=e(Z))==null?void 0:Ke.content)??"")===""})?Se(re):Se(ke,!1)})}r(Ie),r(Ee),a(he,Ee)};g(Re,he=>{i(m()),i(A()),t(()=>{var Z,Ee;return(Ee=(Z=m().messages[A()])==null?void 0:Z.merged)==null?void 0:Ee.status})&&he(Ve)})}r(be);var Ze=I(be,2);{var He=he=>{var Z=Fo(),Ee=n(Z);{let ye=_e(()=>($(),t(()=>$().t("Merge Responses"))));mt(Ee,{get content(){return e(ye)},placement:"bottom",children:(Ie,Pe)=>{var re=Wo();ze(re,1,"visible p-1 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition");var ke=n(re);Ro(ke,{className:" size-5 "}),r(re),Ce("click",re,()=>{U()}),a(Ie,re)},$$slots:{default:!0}})}r(Z),a(he,Z)};g(Ze,he=>{v()&&he(He)})}r(Ne),a(ve,Ne)};g(W,ve=>{e(D),e(y),i(m()),t(()=>!Object.keys(e(D)).find(Ne=>{var Ve;const{messageIds:be}=e(D)[Ne],Re=be[e(y)[Ne]];return!((Ve=m().messages[Re])!=null&&Ve.done)}))&&ve(ie)})}a(S,J)};g(N,S=>{se()||S(j)})}r(ae),b(()=>Le(K,"id",`responses-container-${te()??""}-${e(Q),t(()=>e(Q).id)??""}`)),a(P,ae)};g(C,P=>{e(Q)&&P(V)})}a(Te,z),Ct(),R()}var Zo=f("<div><!></div>"),Ko=f(' <span class=" text-gray-500 text-sm font-medium"> </span>',1),Go=f('<span class="line-clamp-1"> </span>'),Qo=f("<div><!></div>"),Yo=f("<!> <!>",1),Xo=f("<div><!></div>"),ei=f('<span class="line-clamp-1"> </span>'),ti=f('<div class="flex justify-end pr-2 text-xs"><div><!></div></div>'),ai=f("<div><!></div>"),ri=f('<div class="mb-1 w-full flex flex-col justify-end overflow-x-auto gap-1 flex-wrap"></div>'),si=f('<div class=" relative group"><div class="relative flex items-center"><!></div> <div class=" absolute -top-1 -right-1"><button type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-4"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg></button></div></div>'),ni=f('<div class="flex items-center flex-wrap gap-2 -mx-2 mb-1"></div>'),oi=f('<div class=" w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 mb-2"><!> <div class="max-h-96 overflow-auto"><textarea class=" bg-transparent outline-hidden w-full resize-none"></textarea></div> <div class=" mt-2 mb-1 flex justify-between text-sm font-medium"><div><button id="save-edit-message-button" class="px-3.5 py-1.5 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border border-gray-100 dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"> </button></div> <div class="flex space-x-1.5"><button id="close-edit-message-button" class="px-3.5 py-1.5 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"> </button> <button id="confirm-edit-message-button" class="px-3.5 py-1.5 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"> </button></div></div></div>'),ii=f('<div class="w-full"><div><div><!></div></div></div>'),li=f('<div class="text-sm flex justify-center font-semibold self-center dark:text-gray-100 min-w-fit"><input type="number" min="1" class="bg-transparent font-semibold self-center dark:text-gray-100 min-w-fit outline-hidden"/> </div>'),di=f('<div class="text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit"> </div>'),vi=f('<div class="flex self-center" dir="ltr"><button class="self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg></button> <!> <button class="self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg></button></div>'),ci=f('<button><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"></path></svg></button>'),gi=f('<button><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"></path></svg></button>'),ui=f('<button><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"></path></svg></button>'),fi=f('<div class="text-sm flex justify-center font-semibold self-center dark:text-gray-100 min-w-fit"><input type="number" min="1" class="bg-transparent font-semibold self-center dark:text-gray-100 min-w-fit outline-hidden"/> </div>'),mi=f('<div class="text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit"> </div>'),hi=f('<div class="flex self-center" dir="ltr"><button class="self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg></button> <!> <button class="self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg></button></div>'),_i=f("<div><!> <!> <!> <!> <!></div>"),pi=f('<!> <div class=" flex w-full user-message group"><!> <div class="flex-auto w-0 max-w-full pl-1"><!> <div><!> <!> <!></div></div></div>',1);function xi(Te,o){Mt(o,!1);const l=()=>De(R,"$i18n",$),u=()=>De(ba,"$settings",$),L=()=>De(Da,"$_user",$),[$,w]=Jt(),R=Dt("i18n");Tt.extend(xr);let G=c(o,"user",8),te=c(o,"chatId",8),m=c(o,"history",8),A=c(o,"messageId",8),Y=c(o,"siblings",8),v=c(o,"gotoMessage",8),se=c(o,"showPreviousMessage",8),O=c(o,"showNextMessage",8),X=c(o,"editMessage",8),ce=c(o,"deleteMessage",8),s=c(o,"isFirstMessage",8),le=c(o,"readOnly",8),pe=c(o,"editCodeBlock",8,!0),me=c(o,"topPadding",8,!1),de=$e(!1),xe=$e(!1),ge=$e(!1),ue=$e(""),T=$e([]),E=$e(),d=$e(JSON.parse(JSON.stringify(m().messages[A()])));const F=async j=>{await pr(j)&&jt.success(l().t("Copying to clipboard was successful!"))},Q=async()=>{var j,S;k(ge,!0),k(ue,((j=e(d))==null?void 0:j.content)??""),k(T,e(d).files),await lt(),e(E)&&(la(E,e(E).style.height=""),la(E,e(E).style.height=`${e(E).scrollHeight}px`),(S=e(E))==null||S.focus())},D=async(j=!0)=>{if(!e(ue)&&(e(T)??[]).length===0){jt.error(l().t("Please enter a message or attach a file."));return}X()(e(d).id,{content:e(ue),files:e(T)},j),k(ge,!1),k(ue,""),k(T,[])},y=()=>{k(ge,!1),k(ue,""),k(T,[])},h=async()=>{ce()(e(d).id)};Pa(()=>{}),yt(()=>(i(m()),e(d),i(A())),()=>{m().messages&&JSON.stringify(e(d))!==JSON.stringify(m().messages[A()])&&k(d,JSON.parse(JSON.stringify(m().messages[A()])))}),ea(),It();var p=pi(),H=ee(p);{let j=_e(()=>(l(),t(()=>l().t("Delete message?"))));wr(H,{get title(){return e(j)},get show(){return e(de)},set show(S){k(de,S)},$$events:{confirm:()=>{h()}},$$legacy:!0})}var x=I(H,2),M=n(x);{var _=j=>{var S=Zo();ze(S,1,"shrink-0 ltr:mr-3 rtl:ml-3 mt-1");var J=n(S);{let W=_e(()=>(i(da),i(G()),t(()=>`${da}/users/${G().id}/profile/image`)));br(J,{get src(){return e(W)},className:"size-8 user-message-profile-image"})}r(S),a(j,S)};g(M,j=>{u(),t(()=>{var S;return!(((S=u())==null?void 0:S.chatBubble)??!0)})&&j(_)})}var B=I(M,2),U=n(B);{var z=j=>{var S=Xo(),J=n(S);rr(J,{children:(W,ie)=>{var ve=Yo(),Ne=ee(ve);{var be=He=>{var he=Ko(),Z=ee(he),Ee=I(Z),ye=n(Ee,!0);r(Ee),b(Ie=>{q(Z,`${Ie??""} `),q(ye,(e(d),t(()=>{var Pe;return((Pe=e(d))==null?void 0:Pe.user)??""})))},[()=>(l(),t(()=>l().t("You")))]),a(He,he)},Re=He=>{var he=we(),Z=ee(he);{var Ee=Ie=>{var Pe=We();b(()=>q(Pe,(i(G()),t(()=>G().name)))),a(Ie,Pe)},ye=Ie=>{var Pe=We();b(re=>q(Pe,re),[()=>(l(),t(()=>l().t("You")))]),a(Ie,Pe)};g(Z,Ie=>{u(),L(),i(G()),t(()=>u().showUsername||L().name!==G().name)?Ie(Ee):Ie(ye,!1)},!0)}a(He,he)};g(Ne,He=>{e(d),t(()=>e(d).user)?He(be):He(Re,!1)})}var Ve=I(Ne,2);{var Ze=He=>{var he=Qo(),Z=n(he);{let Ee=_e(()=>(i(Tt),e(d),t(()=>Tt(e(d).timestamp*1e3).format("LLLL"))));mt(Z,{get content(){return e(Ee)},children:(ye,Ie)=>{var Pe=Go(),re=n(Pe,!0);r(Pe),b(ke=>q(re,ke),[()=>(l(),i(Ea),e(d),i(Tt),t(()=>l().t(Ea(e(d).timestamp*1e3),{LOCALIZED_TIME:Tt(e(d).timestamp*1e3).format("LT"),LOCALIZED_DATE:Tt(e(d).timestamp*1e3).format("L")})))]),a(ye,Pe)},$$slots:{default:!0}})}r(he),b(()=>ze(he,1,`self-center text-xs font-medium first-letter:capitalize ml-0.5 translate-y-[1px] ${u(),t(()=>{var Ee;return((Ee=u())==null?void 0:Ee.highContrastMode)??!1?"dark:text-gray-900 text-gray-100":"invisible group-hover:visible transition"})??""}`)),a(He,he)};g(Ve,He=>{e(d),t(()=>e(d).timestamp)&&He(Ze)})}a(W,ve)},$$slots:{default:!0}}),r(S),a(j,S)},C=j=>{var S=we(),J=ee(S);{var W=ie=>{var ve=ti(),Ne=n(ve),be=n(Ne);{let Re=_e(()=>(i(Tt),e(d),t(()=>Tt(e(d).timestamp*1e3).format("LLLL"))));mt(be,{get content(){return e(Re)},children:(Ve,Ze)=>{var He=ei(),he=n(He,!0);r(He),b(Z=>q(he,Z),[()=>(l(),i(Ea),e(d),i(Tt),t(()=>l().t(Ea(e(d).timestamp*1e3),{LOCALIZED_TIME:Tt(e(d).timestamp*1e3).format("LT"),LOCALIZED_DATE:Tt(e(d).timestamp*1e3).format("L")})))]),a(Ve,He)},$$slots:{default:!0}})}r(Ne),r(ve),b(()=>ze(Ne,1,`text-[0.65rem] font-medium first-letter:capitalize mb-0.5 ${u(),t(()=>{var Re;return((Re=u())==null?void 0:Re.highContrastMode)??!1?"dark:text-gray-100 text-gray-900":"invisible group-hover:visible transition text-gray-400"})??""}`)),a(ie,ve)};g(J,ie=>{e(d),t(()=>e(d).timestamp)&&ie(W)},!0)}a(j,S)};g(U,j=>{u(),t(()=>{var S;return!(((S=u())==null?void 0:S.chatBubble)??!0)})?j(z):j(C,!1)})}var V=I(U,2),P=n(V);{var ae=j=>{var S=we(),J=ee(S);{var W=ie=>{var ve=ri();ht(ve,5,()=>(e(d),t(()=>e(d).files)),Lt,(Ne,be)=>{const Re=_e(()=>(e(be),i(da),t(()=>{var Z;return e(be).url.startsWith("data")||e(be).url.startsWith("http")?e(be).url:`${da}/files/${e(be).url}${(Z=e(be))!=null&&Z.content_type?"/content":""}`})));var Ve=ai(),Ze=n(Ve);{var He=Z=>{Ga(Z,{get src(){return e(Re)},imageClassName:" max-h-96 rounded-lg"})},he=Z=>{{let Ee=_e(()=>(e(be),t(()=>{var ye;return(ye=e(be))==null?void 0:ye.size})));Qa(Z,{get item(){return e(be)},get url(){return e(be),t(()=>e(be).url)},get name(){return e(be),t(()=>e(be).name)},get type(){return e(be),t(()=>e(be).type)},get size(){return e(Ee)},small:!0})}};g(Ze,Z=>{e(be),t(()=>{var Ee;return e(be).type==="image"||(((Ee=e(be))==null?void 0:Ee.content_type)??"").startsWith("image/")})?Z(He):Z(he,!1)})}r(Ve),b(()=>ze(Ve,1,za((u(),t(()=>{var Z;return((Z=u())==null?void 0:Z.chatBubble)??!0?"self-end":""}))))),a(Ne,Ve)}),r(ve),b(()=>{Le(ve,"dir",(u(),t(()=>{var Ne;return((Ne=u())==null?void 0:Ne.chatDirection)??"auto"}))),ve.dir=ve.dir}),a(ie,ve)};g(J,ie=>{e(d),t(()=>e(d).files)&&ie(W)})}a(j,S)};g(P,j=>{e(ge)!==!0&&j(ae)})}var K=I(P,2);{var fe=j=>{var S=oi(),J=n(S);{var W=ye=>{var Ie=ni();ht(Ie,5,()=>e(T),Lt,(Pe,re,ke)=>{var Se=we(),Ke=ee(Se);{var ct=Fe=>{var qe=si(),Ge=n(qe),Ye=n(Ge);Ga(Ye,{get src(){return e(re),t(()=>e(re).url)},alt:"input",imageClassName:" size-14 rounded-xl object-cover"}),r(Ge);var $t=I(Ge,2),Et=n($t);r($t),r(qe),b(()=>ze(Et,1,` bg-white text-black border border-white rounded-full ${u(),t(()=>{var Gt;return((Gt=u())==null?void 0:Gt.highContrastMode)??!1?"":"group-hover:visible invisible transition"})??""}`)),Ce("click",Et,()=>{e(T).splice(ke,1),k(T,e(T))}),a(Fe,qe)},Ue=Fe=>{{let qe=_e(()=>(e(re),t(()=>{var Ye;return(Ye=e(re))==null?void 0:Ye.size}))),Ge=_e(()=>(e(re),t(()=>e(re).status==="uploading")));Qa(Fe,{get item(){return e(re)},get name(){return e(re),t(()=>e(re).name)},get type(){return e(re),t(()=>e(re).type)},get size(){return e(qe)},get loading(){return e(Ge)},dismissible:!0,edit:!0,$$events:{dismiss:async()=>{e(T).splice(ke,1),k(T,e(T))},click:()=>{e(re)}}})}};g(Ke,Fe=>{e(re),t(()=>e(re).type==="image")?Fe(ct):Fe(Ue,!1)})}a(Pe,Se)}),r(Ie),a(ye,Ie)};g(J,ye=>{e(T),t(()=>(e(T)??[]).length>0)&&ye(W)})}var ie=I(J,2),ve=n(ie);er(ve),xa(ve,ye=>k(E,ye),()=>e(E)),r(ie);var Ne=I(ie,2),be=n(Ne),Re=n(be),Ve=n(Re,!0);r(Re),r(be);var Ze=I(be,2),He=n(Ze),he=n(He,!0);r(He);var Z=I(He,2),Ee=n(Z,!0);r(Z),r(Ze),r(Ne),r(S),b((ye,Ie,Pe)=>{Le(ve,"id",`message-edit-${e(d),t(()=>e(d).id)??""}`),q(Ve,ye),q(he,Ie),q(Ee,Pe)},[()=>(l(),t(()=>l().t("Save"))),()=>(l(),t(()=>l().t("Cancel"))),()=>(l(),t(()=>l().t("Send")))]),Aa(ve,()=>e(ue),ye=>k(ue,ye)),Ce("input",ve,ye=>{ye.target.style.height="",ye.target.style.height=`${ye.target.scrollHeight}px`}),Ce("keydown",ve,ye=>{var re,ke;ye.key==="Escape"&&((re=document.getElementById("close-edit-message-button"))==null||re.click());const Ie=ye.metaKey||ye.ctrlKey,Pe=ye.key==="Enter";Ie&&Pe&&((ke=document.getElementById("confirm-edit-message-button"))==null||ke.click())}),Ce("click",Re,()=>{D(!1)}),Ce("click",He,()=>{y()}),Ce("click",Z,()=>{D()}),a(j,S)},ne=j=>{var S=we(),J=ee(S);{var W=ie=>{var ve=ii(),Ne=n(ve),be=n(Ne),Re=n(be);{var Ve=Ze=>{{let He=_e(()=>(i(te()),e(d),t(()=>`${te()}-${e(d).id}`)));Oa(Ze,{get id(){return e(He)},get content(){return e(d),t(()=>e(d).content)},get editCodeBlock(){return pe()},get topPadding(){return me()}})}};g(Re,Ze=>{e(d),t(()=>e(d).content)&&Ze(Ve)})}r(be),r(Ne),r(ve),b(()=>{ze(Ne,1,`flex ${u(),t(()=>{var Ze;return((Ze=u())==null?void 0:Ze.chatBubble)??!0?"justify-end pb-1":"w-full"})??""}`),ze(be,1,`rounded-3xl ${u(),e(d),t(()=>{var Ze;return((Ze=u())==null?void 0:Ze.chatBubble)??!0?`max-w-[90%] px-4 py-1.5  bg-gray-50 dark:bg-gray-850 ${e(d).files?"rounded-tr-lg":""}`:" w-full"})??""}`)}),a(ie,ve)};g(J,ie=>{e(d),t(()=>e(d).content!=="")&&ie(W)},!0)}a(j,S)};g(K,j=>{e(ge)===!0?j(fe):j(ne,!1)})}var oe=I(K,2);{var N=j=>{var S=_i(),J=n(S);{var W=he=>{var Z=we(),Ee=ee(Z);{var ye=Ie=>{var Pe=vi(),re=n(Pe),ke=I(re,2);{var Se=Ue=>{var Fe=li(),qe=n(Fe);La(qe);var Ge=I(qe);r(Fe),b(Ye=>{Le(qe,"id",`message-index-input-${e(d),t(()=>e(d).id)??""}`),Va(qe,Ye),Le(qe,"max",(i(Y()),t(()=>Y().length))),q(Ge,`/${i(Y()),t(()=>Y().length)??""}`)},[()=>(i(Y()),e(d),t(()=>Y().indexOf(e(d).id)+1))]),Ce("focus",qe,Ye=>{Ye.target.select()}),Ce("blur",qe,Ye=>{v()(e(d),Ye.target.value-1),k(xe,!1)}),Ce("keydown",qe,Ye=>{Ye.key==="Enter"&&(v()(e(d),Ye.target.value-1),k(xe,!1))}),a(Ue,Fe)},Ke=Ue=>{var Fe=di(),qe=n(Fe);r(Fe),b(Ge=>q(qe,`${Ge??""}/${i(Y()),t(()=>Y().length)??""}`),[()=>(i(Y()),e(d),t(()=>Y().indexOf(e(d).id)+1))]),Ce("dblclick",Fe,async()=>{k(xe,!0),await lt();const Ge=document.getElementById(`message-index-input-${e(d).id}`);Ge&&(Ge.focus(),Ge.select())}),a(Ue,Fe)};g(ke,Ue=>{e(xe)?Ue(Se):Ue(Ke,!1)})}var ct=I(ke,2);r(Pe),b(()=>Pe.dir=Pe.dir),Ce("click",re,()=>{se()(e(d))}),Ce("click",ct,()=>{O()(e(d))}),a(Ie,Pe)};g(Ee,Ie=>{i(Y()),t(()=>Y().length>1)&&Ie(ye)})}a(he,Z)};g(J,he=>{u(),t(()=>{var Z;return!(((Z=u())==null?void 0:Z.chatBubble)??!0)})&&he(W)})}var ie=I(J,2);{var ve=he=>{{let Z=_e(()=>(l(),t(()=>l().t("Edit"))));mt(he,{get content(){return e(Z)},placement:"bottom",children:(Ee,ye)=>{var Ie=ci();b(()=>ze(Ie,1,`${u(),t(()=>{var Pe;return((Pe=u())==null?void 0:Pe.highContrastMode)??!1?"":"invisible group-hover:visible"})??""} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition edit-user-message-button`)),Ce("click",Ie,()=>{Q()}),a(Ee,Ie)},$$slots:{default:!0}})}};g(ie,he=>{le()||he(ve)})}var Ne=I(ie,2);{var be=he=>{{let Z=_e(()=>(l(),t(()=>l().t("Copy"))));mt(he,{get content(){return e(Z)},placement:"bottom",children:(Ee,ye)=>{var Ie=gi();b(()=>ze(Ie,1,`${u(),t(()=>{var Pe;return((Pe=u())==null?void 0:Pe.highContrastMode)??!1?"":"invisible group-hover:visible"})??""} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition`)),Ce("click",Ie,()=>{F(e(d).content)}),a(Ee,Ie)},$$slots:{default:!0}})}};g(Ne,he=>{e(d),t(()=>{var Z;return(Z=e(d))==null?void 0:Z.content})&&he(be)})}var Re=I(Ne,2);{var Ve=he=>{var Z=we(),Ee=ee(Z);{var ye=Ie=>{{let Pe=_e(()=>(l(),t(()=>l().t("Delete"))));mt(Ie,{get content(){return e(Pe)},placement:"bottom",children:(re,ke)=>{var Se=ui();b(()=>ze(Se,1,`${u(),t(()=>{var Ke;return((Ke=u())==null?void 0:Ke.highContrastMode)??!1?"":"invisible group-hover:visible"})??""} p-1 rounded-sm dark:hover:text-white hover:text-black transition`)),Ce("click",Se,()=>{k(de,!0)}),a(re,Se)},$$slots:{default:!0}})}};g(Ee,Ie=>{i(le()),i(s()),i(Y()),t(()=>!le()&&(!s()||Y().length>1))&&Ie(ye)})}a(he,Z)};g(Re,he=>{L(),t(()=>{var Z,Ee,ye,Ie;return((Z=L())==null?void 0:Z.role)==="admin"||(((Ie=(ye=(Ee=L())==null?void 0:Ee.permissions)==null?void 0:ye.chat)==null?void 0:Ie.delete_message)??!1)})&&he(Ve)})}var Ze=I(Re,2);{var He=he=>{var Z=we(),Ee=ee(Z);{var ye=Ie=>{var Pe=hi(),re=n(Pe),ke=I(re,2);{var Se=Ue=>{var Fe=fi(),qe=n(Fe);La(qe);var Ge=I(qe);r(Fe),b(Ye=>{Le(qe,"id",`message-index-input-${e(d),t(()=>e(d).id)??""}`),Va(qe,Ye),Le(qe,"max",(i(Y()),t(()=>Y().length))),q(Ge,`/${i(Y()),t(()=>Y().length)??""}`)},[()=>(i(Y()),e(d),t(()=>Y().indexOf(e(d).id)+1))]),Ce("focus",qe,Ye=>{Ye.target.select()}),Ce("blur",qe,Ye=>{v()(e(d),Ye.target.value-1),k(xe,!1)}),Ce("keydown",qe,Ye=>{Ye.key==="Enter"&&(v()(e(d),Ye.target.value-1),k(xe,!1))}),a(Ue,Fe)},Ke=Ue=>{var Fe=mi(),qe=n(Fe);r(Fe),b(Ge=>q(qe,`${Ge??""}/${i(Y()),t(()=>Y().length)??""}`),[()=>(i(Y()),e(d),t(()=>Y().indexOf(e(d).id)+1))]),Ce("dblclick",Fe,async()=>{k(xe,!0),await lt();const Ge=document.getElementById(`message-index-input-${e(d).id}`);Ge&&(Ge.focus(),Ge.select())}),a(Ue,Fe)};g(ke,Ue=>{e(xe)?Ue(Se):Ue(Ke,!1)})}var ct=I(ke,2);r(Pe),b(()=>Pe.dir=Pe.dir),Ce("click",re,()=>{se()(e(d))}),Ce("click",ct,()=>{O()(e(d))}),a(Ie,Pe)};g(Ee,Ie=>{i(Y()),t(()=>Y().length>1)&&Ie(ye)})}a(he,Z)};g(Ze,he=>{u(),t(()=>{var Z;return((Z=u())==null?void 0:Z.chatBubble)??!0})&&he(He)})}r(S),b(()=>ze(S,1,` flex ${u(),t(()=>{var he;return((he=u())==null?void 0:he.chatBubble)??!0?"justify-end":""})??""}  text-gray-600 dark:text-gray-500`)),a(j,S)};g(oe,j=>{e(ge)!==!0&&j(N)})}r(V),r(B),r(x),b(()=>{Le(x,"dir",(u(),t(()=>u().chatDirection))),Le(x,"id",`message-${e(d),t(()=>e(d).id)??""}`),ze(V,1,`chat-${e(d),t(()=>e(d).role)??""} w-full min-w-full markdown-prose`),x.dir=x.dir}),a(Te,p),Ct(),w()}var bi=f('<div role="listitem"><!></div>');function wi(Te,o){Mt(o,!1);const l=()=>De(ba,"$settings",u),[u,L]=Jt();Ra(),Dt("i18n");let $=c(o,"chatId",8),w=c(o,"selectedModels",24,()=>[]),R=c(o,"idx",8,0),G=c(o,"history",12),te=c(o,"messageId",8),m=c(o,"user",8),A=c(o,"setInputText",8,()=>{}),Y=c(o,"gotoMessage",8),v=c(o,"showPreviousMessage",8),se=c(o,"showNextMessage",8),O=c(o,"updateChat",8),X=c(o,"editMessage",8),ce=c(o,"saveMessage",8),s=c(o,"deleteMessage",8),le=c(o,"rateMessage",8),pe=c(o,"actionMessage",8),me=c(o,"submitMessage",8),de=c(o,"regenerateResponse",8),xe=c(o,"continueResponse",8),ge=c(o,"mergeResponses",8),ue=c(o,"addMessages",8),T=c(o,"triggerScroll",8),E=c(o,"readOnly",8,!1),d=c(o,"editCodeBlock",8,!0),F=c(o,"topPadding",8,!1);It();var Q=bi(),D=n(Q);{var y=h=>{var p=we(),H=ee(p);{var x=_=>{{let B=_e(()=>R()===0),U=_e(()=>(i(G()),i(te()),t(()=>{var z;return G().messages[te()].parentId!==null?((z=G().messages[G().messages[te()].parentId])==null?void 0:z.childrenIds)??[]:Object.values(G().messages).filter(C=>C.parentId===null).map(C=>C.id)??[]})));xi(_,{get user(){return m()},get chatId(){return $()},get history(){return G()},get messageId(){return te()},get isFirstMessage(){return e(B)},get siblings(){return e(U)},get gotoMessage(){return Y()},get showPreviousMessage(){return v()},get showNextMessage(){return se()},get editMessage(){return X()},get deleteMessage(){return s()},get readOnly(){return E()},get editCodeBlock(){return d()},get topPadding(){return F()}})}},M=_=>{var B=we(),U=ee(B);{var z=V=>{{let P=_e(()=>(i(te()),i(G()),t(()=>te()===G().currentId))),ae=_e(()=>(i(G()),i(te()),t(()=>{var K;return((K=G().messages[G().messages[te()].parentId])==null?void 0:K.childrenIds)??[]})));Xa(V,{get chatId(){return $()},get history(){return G()},get messageId(){return te()},get selectedModels(){return w()},get isLastMessage(){return e(P)},get siblings(){return e(ae)},get setInputText(){return A()},get gotoMessage(){return Y()},get showPreviousMessage(){return v()},get showNextMessage(){return se()},get updateChat(){return O()},get editMessage(){return X()},get saveMessage(){return ce()},get rateMessage(){return le()},get actionMessage(){return pe()},get submitMessage(){return me()},get deleteMessage(){return s()},get continueResponse(){return xe()},get regenerateResponse(){return de()},get addMessages(){return ue()},get readOnly(){return E()},get editCodeBlock(){return d()},get topPadding(){return F()}})}},C=V=>{var P=we(),ae=ee(P);Na(ae,te,K=>{{let fe=_e(()=>(i(te()),i(G()),t(()=>{var ne;return te()===((ne=G())==null?void 0:ne.currentId)})));Vo(K,{get chatId(){return $()},get messageId(){return te()},get selectedModels(){return w()},get isLastMessage(){return e(fe)},get setInputText(){return A()},get updateChat(){return O()},get editMessage(){return X()},get saveMessage(){return ce()},get rateMessage(){return le()},get actionMessage(){return pe()},get submitMessage(){return me()},get deleteMessage(){return s()},get continueResponse(){return xe()},get regenerateResponse(){return de()},get mergeResponses(){return ge()},get triggerScroll(){return T()},get addMessages(){return ue()},get readOnly(){return E()},get editCodeBlock(){return d()},get topPadding(){return F()},get history(){return G()},set history(ne){G(ne)},$$legacy:!0})}}),a(V,P)};g(U,V=>{i(G()),i(te()),t(()=>{var P,ae;return(((ae=(P=G().messages[G().messages[te()].parentId])==null?void 0:P.models)==null?void 0:ae.length)??1)===1})?V(z):V(C,!1)},!0)}a(_,B)};g(H,_=>{i(G()),i(te()),t(()=>G().messages[te()].role==="user")?_(x):_(M,!1)})}a(h,p)};g(D,h=>{i(G()),i(te()),t(()=>G().messages[te()])&&h(y)})}r(Q),b(()=>ze(Q,1,`flex flex-col justify-between px-5 mb-3 w-full ${l(),t(()=>{var h;return((h=l())==null?void 0:h.widescreenMode)??null?"max-w-full":"max-w-5xl"})??""} mx-auto rounded-lg group`)),a(Te,Q),Ct(),L()}var yi=f("<!> ",1),ki=f("<div> </div>"),Mi=f('<div class="font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1 svelte-6tnq1o"> </div> <div class="text-xs text-gray-600 dark:text-gray-400 font-normal line-clamp-1 svelte-6tnq1o"> </div>',1),Ci=f('<div class="font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1 svelte-6tnq1o"> </div> <div class="text-xs text-gray-600 dark:text-gray-400 font-normal line-clamp-1 svelte-6tnq1o"> </div>',1),Ii=f(`<button role="listitem" class="waterfall flex flex-col flex-1 shrink-0 w-full justify-between
				       px-3 py-2 rounded-xl bg-transparent hover:bg-black/5
				       dark:hover:bg-white/5 transition group svelte-6tnq1o"><div class="flex flex-col text-left svelte-6tnq1o"><!></div></button>`),$i=f('<div role="list"></div>'),Ei=f('<div class="mb-1 flex gap-1 text-xs font-medium items-center text-gray-600 dark:text-gray-400 svelte-6tnq1o"><!></div> <div class="h-40 w-full svelte-6tnq1o"><!></div>',1);function Si(Te,o){Mt(o,!1);const l=()=>De(R,"$i18n",$),u=()=>De(ba,"$settings",$),L=()=>De(Rr,"$WEBUI_NAME",$),[$,w]=Jt(),R=Dt("i18n");let G=c(o,"suggestionPrompts",24,()=>[]),te=c(o,"className",8,""),m=c(o,"inputValue",8,""),A=c(o,"onSelect",8,T=>{}),Y=$e([]);const v={keys:["content","title"],threshold:.5};let se=$e(),O=$e([]);function X(T,E){if(T.length!==E.length)return!1;for(let d=0;d<T.length;d++)if((T[d].id??T[d].content)!==(E[d].id??E[d].content))return!1;return!0}const ce=T=>{if(T.length>500)k(O,[]);else{const E=T.trim()&&e(se)?e(se).search(T.trim()).map(d=>d.item):e(Y);X(e(O),E)||k(O,E)}};yt(()=>(i(G()),i(m())),()=>{G()&&(k(Y,[...G()??[]].sort(()=>Math.random()-.5)),ce(m()))}),yt(()=>e(Y),()=>{k(se,new fs(e(Y),v))}),yt(()=>i(m()),()=>{ce(m())}),ea(),It();var s=Ei(),le=ee(s),pe=n(le);{var me=T=>{var E=yi(),d=ee(E);Yr(d,{});var F=I(d);b(Q=>q(F,` ${Q??""}`),[()=>(l(),t(()=>l().t("Suggested")))]),a(T,E)},de=T=>{var E=ki(),d=n(E);r(E),b(()=>{ze(E,1,`flex w-full ${u(),t(()=>{var F;return((F=u())==null?void 0:F.landingPageMode)==="chat"?" -mt-1":"text-center items-center justify-center"})??""}  self-start text-gray-600 dark:text-gray-400`,"svelte-6tnq1o"),q(d,`${L()??""}  v${Jr}`)}),a(T,E)};g(pe,T=>{e(O),t(()=>e(O).length>0)?T(me):T(de,!1)})}r(le);var xe=I(le,2),ge=n(xe);{var ue=T=>{var E=$i();ht(E,7,()=>e(O),(d,F)=>d.id||`${d.content}-${F}`,(d,F,Q)=>{var D=Ii(),y=n(D),h=n(y);{var p=x=>{var M=Mi(),_=ee(M),B=n(_,!0);r(_);var U=I(_,2),z=n(U,!0);r(U),b(()=>{q(B,(e(F),t(()=>e(F).title[0]))),q(z,(e(F),t(()=>e(F).title[1])))}),a(x,M)},H=x=>{var M=Ci(),_=ee(M),B=n(_,!0);r(_);var U=I(_,2),z=n(U,!0);r(U),b(C=>{q(B,(e(F),t(()=>e(F).content))),q(z,C)},[()=>(l(),t(()=>l().t("Prompt")))]),a(x,M)};g(h,x=>{e(F),t(()=>e(F).title&&e(F).title[0]!=="")?x(p):x(H,!1)})}r(y),r(D),b(()=>Sr(D,`animation-delay: ${e(Q)*60}ms`)),Ce("click",D,()=>A()({type:"prompt",data:e(F).content})),a(d,D)}),r(E),b(()=>ze(E,1,`max-h-40 overflow-auto scrollbar-none items-start ${te()??""}`,"svelte-6tnq1o")),a(T,E)};g(ge,T=>{e(O),t(()=>e(O).length>0)&&T(ue)})}r(xe),a(Te,s),Ct(),w()}var Ni=f('<img class=" size-[2.7rem] rounded-full border-[1px] border-gray-100 dark:border-none" alt="logo" draggable="false"/>'),Pi=f("<button><!></button>"),Bi=f('<div class="flex items-center gap-2 text-gray-500 text-lg mt-2 w-fit"><!> </div>'),Ti=f("<a> </a>"),Li=f('<div class="mt-0.5 text-sm font-normal text-gray-400 dark:text-gray-500">By <!></div>'),Oi=f('<div class="mt-0.5 text-base font-normal text-gray-500 dark:text-gray-400 line-clamp-3 markdown"><!></div> <!>',1),Ri=f('<div class=" text-gray-400 dark:text-gray-500 line-clamp-1 font-p"> </div>'),zi=f('<div class="m-auto w-full max-w-6xl px-8 lg:px-20"><div class="flex justify-start"><div class="flex -space-x-4 mb-0.5"></div></div> <!> <div class=" mt-2 mb-4 text-3xl text-gray-800 dark:text-gray-100 text-left flex items-center gap-4 font-primary"><div><div class=" capitalize line-clamp-1"><!></div> <div><!></div></div></div> <div class=" w-full font-primary"><!></div></div>');function ji(Te,o){Mt(o,!1);const l=()=>De(ja,"$_models",R),u=()=>De(te,"$i18n",R),L=()=>De(ar,"$temporaryChatEnabled",R),$=()=>De(Da,"$user",R),w=()=>De(_r,"$config",R),[R,G]=Jt(),te=Dt("i18n");let m=c(o,"modelIds",24,()=>[]),A=c(o,"models",28,()=>[]),Y=c(o,"atSelectedModel",8),v=c(o,"onSelect",8,s=>{}),se=$e(!1),O=$e(0);Pa(()=>{k(se,!0)}),yt(()=>(i(m()),l()),()=>{A(m().map(s=>l().find(le=>le.id===s)))}),yt(()=>(i(m()),i(A())),()=>{m().length>0&&k(O,A().length-1)}),ea(),It();var X=we(),ce=ee(X);Na(ce,()=>e(se),s=>{var le=zi(),pe=n(le),me=n(pe);ht(me,5,A,Lt,(x,M,_)=>{var B=Pi(),U=n(B);{let z=_e(()=>(i(Ha),i(Sa),i(A()),e(O),t(()=>{var C,V,P;return Ha.parse(Sa(((P=(V=(C=A()[e(O)])==null?void 0:C.info)==null?void 0:V.meta)==null?void 0:P.description)??"").replaceAll(`
`,"<br>"))})));mt(U,{get content(){return e(z)},placement:"right",children:(C,V)=>{var P=Ni();b(()=>Le(P,"src",(i(da),e(M),u(),t(()=>{var ae;return`${da}/models/model/profile/image?id=${(ae=e(M))==null?void 0:ae.id}&lang=${u().language}`})))),a(C,P)},$$slots:{default:!0}})}r(B),Ce("click",B,()=>{k(O,_)}),a(x,B)}),r(me),r(pe);var de=I(pe,2);{var xe=x=>{{let M=_e(()=>(u(),t(()=>u().t("This chat won't appear in history and your messages will not be saved."))));mt(x,{get content(){return e(M)},className:"w-full flex justify-start mb-0.5",placement:"top",children:(_,B)=>{var U=Bi(),z=n(U);ms(z,{strokeWidth:"2.5",className:"size-5"});var C=I(z,1,!0);r(U),b(V=>q(C,V),[()=>(u(),t(()=>u().t("Temporary Chat")))]),a(_,U)},$$slots:{default:!0}})}};g(de,x=>{L()&&x(xe)})}var ge=I(de,2),ue=n(ge),T=n(ue),E=n(T);{var d=x=>{var M=We();b(()=>q(M,(i(A()),e(O),t(()=>{var _;return(_=A()[e(O)])==null?void 0:_.name})))),a(x,M)},F=x=>{var M=We();b(_=>q(M,_),[()=>(u(),$(),t(()=>{var _;return u().t("Hello, {{name}}",{name:(_=$())==null?void 0:_.name})}))]),a(x,M)};g(E,x=>{i(A()),e(O),t(()=>{var M;return(M=A()[e(O)])==null?void 0:M.name})?x(d):x(F,!1)})}r(T);var Q=I(T,2),D=n(Q);{var y=x=>{var M=Oi(),_=ee(M),B=n(_);us(B,()=>(i(Ha),i(Sa),i(A()),e(O),t(()=>{var C,V,P;return Ha.parse(Sa((P=(V=(C=A()[e(O)])==null?void 0:C.info)==null?void 0:V.meta)==null?void 0:P.description).replaceAll(`
`,"<br>"))}))),r(_);var U=I(_,2);{var z=C=>{var V=Li(),P=I(n(V));{var ae=fe=>{var ne=Ti(),oe=n(ne,!0);r(ne),b(()=>{Le(ne,"href",`https://openwebui.com/m/${i(A()),e(O),t(()=>{var N,j,S;return(S=(j=(N=A()[e(O)])==null?void 0:N.info)==null?void 0:j.meta)==null?void 0:S.user.username})??""}`),q(oe,(i(A()),e(O),t(()=>{var N,j,S,J,W,ie,ve,Ne,be;return(S=(j=(N=A()[e(O)])==null?void 0:N.info)==null?void 0:j.meta)!=null&&S.user.name?(ie=(W=(J=A()[e(O)])==null?void 0:J.info)==null?void 0:W.meta)==null?void 0:ie.user.name:`@${(be=(Ne=(ve=A()[e(O)])==null?void 0:ve.info)==null?void 0:Ne.meta)==null?void 0:be.user.username}`})))}),a(fe,ne)},K=fe=>{var ne=We();b(()=>q(ne,(i(A()),e(O),t(()=>{var oe,N,j;return(j=(N=(oe=A()[e(O)])==null?void 0:oe.info)==null?void 0:N.meta)==null?void 0:j.user.name})))),a(fe,ne)};g(P,fe=>{i(A()),e(O),t(()=>{var ne,oe,N;return(N=(oe=(ne=A()[e(O)])==null?void 0:ne.info)==null?void 0:oe.meta)==null?void 0:N.user.community})?fe(ae):fe(K,!1)})}r(V),a(C,V)};g(U,C=>{i(A()),e(O),t(()=>{var V,P,ae;return(ae=(P=(V=A()[e(O)])==null?void 0:V.info)==null?void 0:P.meta)==null?void 0:ae.user})&&C(z)})}a(x,M)},h=x=>{var M=Ri(),_=n(M,!0);r(M),b(B=>q(_,B),[()=>(u(),t(()=>u().t("How can I help you today?")))]),a(x,M)};g(D,x=>{i(A()),e(O),t(()=>{var M,_,B;return((B=(_=(M=A()[e(O)])==null?void 0:M.info)==null?void 0:_.meta)==null?void 0:B.description)??null})?x(y):x(h,!1)})}r(Q),r(ue),r(ge);var p=I(ge,2),H=n(p);{let x=_e(()=>(i(Y()),i(A()),e(O),w(),t(()=>{var M,_,B,U,z,C,V;return((B=(_=(M=Y())==null?void 0:M.info)==null?void 0:_.meta)==null?void 0:B.suggestion_prompts)??((C=(z=(U=A()[e(O)])==null?void 0:U.info)==null?void 0:z.meta)==null?void 0:C.suggestion_prompts)??((V=w())==null?void 0:V.default_prompt_suggestions)??[]})));Si(H,{className:"grid grid-cols-2",get suggestionPrompts(){return e(x)},get onSelect(){return v()}})}r(p),r(le),Ba(1,me,()=>Ta,()=>({duration:200})),Ba(1,T,()=>Ta,()=>({duration:200})),Ba(1,Q,()=>Ta,()=>({duration:200,delay:200})),Ba(1,p,()=>Ta,()=>({duration:200,delay:300})),a(s,le)}),a(Te,X),Ct(),G()}var Ai=f('<div class="w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2"><!> <div class=" "> </div></div>'),Hi=f('<div class="  pb-6"></div>'),qi=f('<section class="w-full" aria-labelledby="chat-conversation"><h2 class="sr-only" id="chat-conversation"> </h2> <!> <ul role="log" aria-live="polite" aria-relevant="additions" aria-atomic="false"></ul></section> <div class="pb-18"></div> <!>',1),Di=f('<div class="w-full pt-2"><!></div>'),Wi=f("<div><!></div>");function Yl(Te,o){Mt(o,!1);const l=()=>De(Da,"$_user",R),u=()=>De(ar,"$temporaryChatEnabled",R),L=()=>De(dr,"$currentChatPage",R),$=()=>De(ba,"$settings",R),w=()=>De(te,"$i18n",R),[R,G]=Jt();Ra();const te=Dt("i18n");let m=c(o,"className",8,"h-full flex pt-8"),A=c(o,"chatId",8,""),Y=c(o,"user",24,l);c(o,"prompt",8);let v=c(o,"history",28,()=>({})),se=c(o,"selectedModels",8),O=c(o,"atSelectedModel",8),X=$e([]),ce=c(o,"setInputText",8,()=>{}),s=c(o,"sendMessage",8),le=c(o,"continueResponse",8),pe=c(o,"regenerateResponse",8),me=c(o,"mergeResponses",8),de=c(o,"chatActionHandler",8),xe=c(o,"showMessage",8,()=>{}),ge=c(o,"submitMessage",8,()=>{}),ue=c(o,"addMessages",8,()=>{}),T=c(o,"readOnly",8,!1),E=c(o,"editCodeBlock",8,!0),d=c(o,"topPadding",8,!1),F=c(o,"bottomPadding",8,!1),Q=c(o,"autoScroll",12),D=c(o,"onSelect",8,N=>{}),y=c(o,"messagesCount",12,20),h=$e(!1);const p=async()=>{const N=document.getElementById("messages-container");N.scrollTop=N.scrollTop+100,k(h,!0),y(y()+20),await lt(),k(h,!1)},H=()=>{const N=document.getElementById("messages-container");N.scrollTop=N.scrollHeight},x=async()=>{u()||(v(v()),await lt(),await Ar(localStorage.token,A(),{history:v(),messages:e(X)}),dr.set(1),await zr.set(await Hr(localStorage.token,L())))},M=async(N,j)=>{var W;let S;N.parentId!==null?S=v().messages[N.parentId].childrenIds:S=Object.values(v().messages).filter(ie=>ie.parentId===null).map(ie=>ie.id),j=Math.max(0,Math.min(j,S.length-1));let J=S[j];if(N.id!==J){let ie=v().messages[J].childrenIds;for(;ie.length!==0;)J=ie.at(-1),ie=v().messages[J].childrenIds;v(v().currentId=J,!0)}if(await lt(),((W=$())==null?void 0:W.scrollOnBranchChange)??!0){const ie=document.getElementById("messages-container");Q(ie.scrollHeight-ie.scrollTop<=ie.clientHeight+50),setTimeout(()=>{H()},100)}},_=async N=>{var j;if(N.parentId!==null){let S=v().messages[N.parentId].childrenIds[Math.max(v().messages[N.parentId].childrenIds.indexOf(N.id)-1,0)];if(N.id!==S){let J=v().messages[S].childrenIds;for(;J.length!==0;)S=J.at(-1),J=v().messages[S].childrenIds;v(v().currentId=S,!0)}}else{let S=Object.values(v().messages).filter(W=>W.parentId===null).map(W=>W.id),J=S[Math.max(S.indexOf(N.id)-1,0)];if(N.id!==J){let W=v().messages[J].childrenIds;for(;W.length!==0;)J=W.at(-1),W=v().messages[J].childrenIds;v(v().currentId=J,!0)}}if(await lt(),((j=$())==null?void 0:j.scrollOnBranchChange)??!0){const S=document.getElementById("messages-container");Q(S.scrollHeight-S.scrollTop<=S.clientHeight+50),setTimeout(()=>{H()},100)}},B=async N=>{var j;if(N.parentId!==null){let S=v().messages[N.parentId].childrenIds[Math.min(v().messages[N.parentId].childrenIds.indexOf(N.id)+1,v().messages[N.parentId].childrenIds.length-1)];if(N.id!==S){let J=v().messages[S].childrenIds;for(;J.length!==0;)S=J.at(-1),J=v().messages[S].childrenIds;v(v().currentId=S,!0)}}else{let S=Object.values(v().messages).filter(W=>W.parentId===null).map(W=>W.id),J=S[Math.min(S.indexOf(N.id)+1,S.length-1)];if(N.id!==J){let W=v().messages[J].childrenIds;for(;W.length!==0;)J=W.at(-1),W=v().messages[J].childrenIds;v(v().currentId=J,!0)}}if(await lt(),((j=$())==null?void 0:j.scrollOnBranchChange)??!0){const S=document.getElementById("messages-container");Q(S.scrollHeight-S.scrollTop<=S.clientHeight+50),setTimeout(()=>{H()},100)}},U=async(N,j)=>{v(v().messages[N].annotation={...v().messages[N].annotation,rating:j},!0),await x()},z=async(N,{content:j,files:S},J=!0)=>{if((se()??[]).filter(W=>W).length===0){jt.error(w().t("Model not selected"));return}if(v().messages[N].role==="user")if(J){let W=j,ie=cr(),ve={id:ie,parentId:v().messages[N].parentId,childrenIds:[],role:"user",content:W,...S&&{files:S},models:se(),timestamp:Math.floor(Date.now()/1e3)},Ne=v().messages[N].parentId;Ne!==null&&v(v().messages[Ne].childrenIds=[...v().messages[Ne].childrenIds,ie],!0),v(v().messages[ie]=ve,!0),v(v().currentId=ie,!0),await lt(),await s()(v(),ie)}else v(v().messages[N].content=j,!0),v(v().messages[N].files=S,!0),await x();else if(J){const W=cr(),ie=v().messages[N],ve=ie.parentId,Ne={...ie,id:W,parentId:ve,childrenIds:[],files:void 0,content:j,timestamp:Math.floor(Date.now()/1e3)};v(v().messages[W]=Ne,!0),v(v().currentId=W,!0),ve!==null&&v(v().messages[ve].childrenIds=[...v().messages[ve].childrenIds,W],!0),await x()}else v(v().messages[N].originalContent=v().messages[N].content,!0),v(v().messages[N].content=j,!0),await x()},C=async(N,j,S=null)=>{await de()(A(),N,j.model,j.id,S)},V=async(N,j)=>{v(v().messages[N]=j,!0),await x()},P=async N=>{const j=v().messages[N],S=j.parentId,J=j.childrenIds??[],W=J.flatMap(ie=>{var ve;return((ve=v().messages[ie])==null?void 0:ve.childrenIds)??[]});S&&v().messages[S]&&v(v().messages[S].childrenIds=[...v().messages[S].childrenIds.filter(ie=>ie!==N),...W],!0),W.forEach(ie=>{v().messages[ie]&&v(v().messages[ie].parentId=S,!0)}),[N,...J].forEach(ie=>{delete v().messages[ie]}),await lt(),xe()({id:S}),await x()},ae=()=>{if(Q()){const N=document.getElementById("messages-container");Q(N.scrollHeight-N.scrollTop<=N.clientHeight+50),setTimeout(()=>{H()},100)}};yt(()=>(i(v()),i(y())),()=>{if(v().currentId){let N=[],j=v().messages[v().currentId];for(;j&&(y()===null||N.length<=y());)N.unshift({...j}),j=j.parentId!==null?v().messages[j.parentId]:null;k(X,N)}else k(X,[])}),yt(()=>(i(Q()),i(F()),lt),()=>{Q()&&F()&&(async()=>(await lt(),H()))()}),ea(),It();var K=Wi(),fe=n(K);{var ne=N=>{ji(N,{get modelIds(){return se()},get atSelectedModel(){return O()},get onSelect(){return D()}})},oe=N=>{var j=Di(),S=n(j);Na(S,A,J=>{var W=qi(),ie=ee(W),ve=n(ie),Ne=n(ve,!0);r(ve);var be=I(ve,2);{var Re=he=>{gs(he,{$$events:{visible:Z=>{e(h)||p()}},children:(Z,Ee)=>{var ye=Ai(),Ie=n(ye);nr(Ie,{className:" size-4"});var Pe=I(Ie,2),re=n(Pe,!0);r(Pe),r(ye),b(ke=>q(re,ke),[()=>(w(),t(()=>w().t("Loading...")))]),a(Z,ye)},$$slots:{default:!0}})};g(be,he=>{e(X),t(()=>{var Z;return((Z=e(X).at(0))==null?void 0:Z.parentId)!==null})&&he(Re)})}var Ve=I(be,2);ht(Ve,7,()=>e(X),he=>he.id,(he,Z,Ee)=>{wi(he,{get chatId(){return A()},get selectedModels(){return se()},get messageId(){return e(Z),t(()=>e(Z).id)},get idx(){return e(Ee)},get user(){return Y()},get setInputText(){return ce()},gotoMessage:M,showPreviousMessage:_,showNextMessage:B,updateChat:x,editMessage:z,deleteMessage:P,rateMessage:U,actionMessage:C,saveMessage:V,get submitMessage(){return ge()},get regenerateResponse(){return pe()},get continueResponse(){return le()},get mergeResponses(){return me()},get addMessages(){return ue()},triggerScroll:ae,get readOnly(){return T()},get editCodeBlock(){return E()},get topPadding(){return d()},get history(){return v()},set history(ye){v(ye)},$$legacy:!0})}),r(Ve),r(ie);var Ze=I(ie,4);{var He=he=>{var Z=Hi();a(he,Z)};g(Ze,he=>{F()&&he(He)})}b(he=>q(Ne,he),[()=>(w(),t(()=>w().t("Chat Conversation")))]),a(J,W)}),r(j),a(N,j)};g(fe,N=>{i(v()),t(()=>{var j;return Object.keys(((j=v())==null?void 0:j.messages)??{}).length==0})?N(ne):N(oe,!1)})}r(K),b(()=>ze(K,1,za(m()))),a(Te,K),Ct(),G()}export{pn as K,Yl as M,Si as S};
//# sourceMappingURL=Buw7-5Ca.js.map
