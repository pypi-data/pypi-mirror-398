"""Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT."""

from __future__ import annotations
from cribl_control_plane import models, utils
from cribl_control_plane.types import BaseModel
from cribl_control_plane.utils import validate_open_enum
from enum import Enum
import pydantic
from pydantic import field_serializer
from pydantic.functional_validators import PlainValidator
from typing import Any, List, Optional, Union
from typing_extensions import Annotated, NotRequired, TypeAliasType, TypedDict


class CollectorHealthCheckAuthentication10(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Authentication method for Discover and Collect REST calls. You can specify API Key–based authentication by adding the appropriate Collect headers."""

    NONE = "none"
    BASIC = "basic"
    BASIC_SECRET = "basicSecret"
    LOGIN = "login"
    LOGIN_SECRET = "loginSecret"
    OAUTH = "oauth"
    OAUTH_SECRET = "oauthSecret"


class CollectorHealthCheckAuthRequestParam10TypedDict(TypedDict):
    name: str
    r"""Parameter name."""
    value: str
    r"""JavaScript expression to compute the parameter's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckAuthRequestParam10(BaseModel):
    name: str
    r"""Parameter name."""

    value: str
    r"""JavaScript expression to compute the parameter's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckAuthRequestHeader10TypedDict(TypedDict):
    name: str
    r"""Header name."""
    value: str
    r"""JavaScript expression to compute the header's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckAuthRequestHeader10(BaseModel):
    name: str
    r"""Header name."""

    value: str
    r"""JavaScript expression to compute the header's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckDiscoverType10(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Defines how task discovery will be performed. Use None to skip the discovery. Use HTTP Request to make a REST call to discover tasks. Use Item List to enumerate items for collect to retrieve. Use JSON Response to manually define discover tasks as a JSON array of objects. Each entry returned by the discover operation will result in a collect task."""

    # HTTP Request
    HTTP = "http"
    # JSON Response
    JSON = "json"
    # Item List
    LIST = "list"
    # None
    NONE = "none"


class CollectorHealthCheckDiscovery10TypedDict(TypedDict):
    discover_type: NotRequired[CollectorHealthCheckDiscoverType10]
    r"""Defines how task discovery will be performed. Use None to skip the discovery. Use HTTP Request to make a REST call to discover tasks. Use Item List to enumerate items for collect to retrieve. Use JSON Response to manually define discover tasks as a JSON array of objects. Each entry returned by the discover operation will result in a collect task."""


class CollectorHealthCheckDiscovery10(BaseModel):
    discover_type: Annotated[
        Annotated[
            Optional[CollectorHealthCheckDiscoverType10],
            PlainValidator(validate_open_enum(False)),
        ],
        pydantic.Field(alias="discoverType"),
    ] = CollectorHealthCheckDiscoverType10.NONE
    r"""Defines how task discovery will be performed. Use None to skip the discovery. Use HTTP Request to make a REST call to discover tasks. Use Item List to enumerate items for collect to retrieve. Use JSON Response to manually define discover tasks as a JSON array of objects. Each entry returned by the discover operation will result in a collect task."""

    @field_serializer("discover_type")
    def serialize_discover_type(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckDiscoverType10(value)
            except ValueError:
                return value
        return value


class HealthCheckMethod10(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Health check HTTP method."""

    # GET
    GET = "get"
    # POST
    POST = "post"
    # POST with Body
    POST_WITH_BODY = "post_with_body"


class CollectorHealthCheckCollectRequestParam10TypedDict(TypedDict):
    name: str
    r"""Parameter name."""
    value: str
    r"""JavaScript expression to compute the parameter value (can be a constant)."""


class CollectorHealthCheckCollectRequestParam10(BaseModel):
    name: str
    r"""Parameter name."""

    value: str
    r"""JavaScript expression to compute the parameter value (can be a constant)."""


class CollectorHealthCheckCollectRequestHeader10TypedDict(TypedDict):
    name: str
    r"""Header Name"""
    value: str
    r"""JavaScript expression to compute the header value (can be a constant)."""


class CollectorHealthCheckCollectRequestHeader10(BaseModel):
    name: str
    r"""Header Name"""

    value: str
    r"""JavaScript expression to compute the header value (can be a constant)."""


class CollectorHealthCheckHiddenDefaultBreakers10(
    str, Enum, metaclass=utils.OpenEnumMeta
):
    CRIBL = "Cribl"


class CollectorHealthCheckRetryType10(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""The algorithm to use when performing HTTP retries"""

    # Disabled
    NONE = "none"
    # Backoff
    BACKOFF = "backoff"
    # Static
    STATIC = "static"


class CollectorHealthCheckRetryRules10TypedDict(TypedDict):
    type: NotRequired[CollectorHealthCheckRetryType10]
    r"""The algorithm to use when performing HTTP retries"""
    interval: NotRequired[Any]
    limit: NotRequired[Any]
    multiplier: NotRequired[Any]
    codes: NotRequired[Any]
    enable_header: NotRequired[Any]


class CollectorHealthCheckRetryRules10(BaseModel):
    type: Annotated[
        Optional[CollectorHealthCheckRetryType10],
        PlainValidator(validate_open_enum(False)),
    ] = CollectorHealthCheckRetryType10.BACKOFF
    r"""The algorithm to use when performing HTTP retries"""

    interval: Optional[Any] = None

    limit: Optional[Any] = None

    multiplier: Optional[Any] = None

    codes: Optional[Any] = None

    enable_header: Annotated[Optional[Any], pydantic.Field(alias="enableHeader")] = None

    @field_serializer("type")
    def serialize_type(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckRetryType10(value)
            except ValueError:
                return value
        return value


class CollectorHealthCheckType10(str, Enum):
    r"""Collector type: health_check"""

    HEALTH_CHECK = "health_check"


class CollectorHealthCheckHealthCheck10TypedDict(TypedDict):
    text_secret: str
    r"""Select or create a text secret that contains the client secret's value."""
    collect_url: str
    r"""Expression to derive URL to use for the health check operation (can be a constant)."""
    type: CollectorHealthCheckType10
    r"""Collector type: health_check"""
    authentication: NotRequired[CollectorHealthCheckAuthentication10]
    r"""Authentication method for Discover and Collect REST calls. You can specify API Key–based authentication by adding the appropriate Collect headers."""
    login_url: NotRequired[str]
    r"""URL to use for the OAuth API call. This call is expected to be a POST."""
    token_resp_attribute: NotRequired[str]
    r"""Path to token attribute in login response body. Nested attributes are OK. Leave blank if the response content type is text/plain; the entire response body will be used to derive the authorization header."""
    auth_header_expr: NotRequired[str]
    r"""JavaScript expression to compute the Authorization header to pass in discover and collect calls. The value ${token} is used to reference the token obtained from login."""
    client_secret_param_name: NotRequired[str]
    r"""Parameter name that contains client secret. Defaults to 'client_secret', and is automatically added to request parameters."""
    auth_request_params: NotRequired[
        List[CollectorHealthCheckAuthRequestParam10TypedDict]
    ]
    r"""OAuth request parameters added to the POST body. The Content-Type header will automatically be set to application/x-www-form-urlencoded."""
    auth_request_headers: NotRequired[
        List[CollectorHealthCheckAuthRequestHeader10TypedDict]
    ]
    r"""Optional authentication request headers."""
    discovery: NotRequired[CollectorHealthCheckDiscovery10TypedDict]
    collect_method: NotRequired[HealthCheckMethod10]
    r"""Health check HTTP method."""
    collect_request_params: NotRequired[
        List[CollectorHealthCheckCollectRequestParam10TypedDict]
    ]
    r"""Optional health check request parameters."""
    collect_body: NotRequired[str]
    r"""Template for POST body to send with the health check request. You can reference parameters from the Discover response, using template params of the form: ${variable}."""
    collect_request_headers: NotRequired[
        List[CollectorHealthCheckCollectRequestHeader10TypedDict]
    ]
    r"""Optional health check request headers."""
    authenticate_collect: NotRequired[bool]
    r"""Enable to make auth health check call."""
    timeout: NotRequired[float]
    r"""HTTP request inactivity timeout, use 0 to disable"""
    reject_unauthorized: NotRequired[bool]
    r"""Whether to reject certificates that cannot be verified against a valid CA (e.g., self-signed certificates)."""
    default_breakers: NotRequired[CollectorHealthCheckHiddenDefaultBreakers10]
    safe_headers: NotRequired[List[str]]
    r"""List of headers that are safe to log in plain text."""
    retry_rules: NotRequired[CollectorHealthCheckRetryRules10TypedDict]
    username: NotRequired[str]
    r"""Login username"""
    password: NotRequired[str]
    r"""Login password"""
    credentials_secret: NotRequired[str]
    r"""Select or create a stored secret that references your login credentials"""
    login_body: NotRequired[str]
    r"""Template for POST body to send with login request, ${username} and ${password} are used to specify location of these attributes in the message"""
    client_secret_param_value: NotRequired[str]
    r"""Secret value to add to HTTP requests as the 'client secret' parameter. Stored on disk encrypted, and is automatically added to request parameters"""


class CollectorHealthCheckHealthCheck10(BaseModel):
    text_secret: Annotated[str, pydantic.Field(alias="textSecret")]
    r"""Select or create a text secret that contains the client secret's value."""

    collect_url: Annotated[str, pydantic.Field(alias="collectUrl")]
    r"""Expression to derive URL to use for the health check operation (can be a constant)."""

    type: CollectorHealthCheckType10
    r"""Collector type: health_check"""

    authentication: Annotated[
        Optional[CollectorHealthCheckAuthentication10],
        PlainValidator(validate_open_enum(False)),
    ] = CollectorHealthCheckAuthentication10.NONE
    r"""Authentication method for Discover and Collect REST calls. You can specify API Key–based authentication by adding the appropriate Collect headers."""

    login_url: Annotated[Optional[str], pydantic.Field(alias="loginUrl")] = ""
    r"""URL to use for the OAuth API call. This call is expected to be a POST."""

    token_resp_attribute: Annotated[
        Optional[str], pydantic.Field(alias="tokenRespAttribute")
    ] = None
    r"""Path to token attribute in login response body. Nested attributes are OK. Leave blank if the response content type is text/plain; the entire response body will be used to derive the authorization header."""

    auth_header_expr: Annotated[
        Optional[str], pydantic.Field(alias="authHeaderExpr")
    ] = "`Bearer ${token}`"
    r"""JavaScript expression to compute the Authorization header to pass in discover and collect calls. The value ${token} is used to reference the token obtained from login."""

    client_secret_param_name: Annotated[
        Optional[str], pydantic.Field(alias="clientSecretParamName")
    ] = "client_secret"
    r"""Parameter name that contains client secret. Defaults to 'client_secret', and is automatically added to request parameters."""

    auth_request_params: Annotated[
        Optional[List[CollectorHealthCheckAuthRequestParam10]],
        pydantic.Field(alias="authRequestParams"),
    ] = None
    r"""OAuth request parameters added to the POST body. The Content-Type header will automatically be set to application/x-www-form-urlencoded."""

    auth_request_headers: Annotated[
        Optional[List[CollectorHealthCheckAuthRequestHeader10]],
        pydantic.Field(alias="authRequestHeaders"),
    ] = None
    r"""Optional authentication request headers."""

    discovery: Optional[CollectorHealthCheckDiscovery10] = None

    collect_method: Annotated[
        Annotated[
            Optional[HealthCheckMethod10], PlainValidator(validate_open_enum(False))
        ],
        pydantic.Field(alias="collectMethod"),
    ] = HealthCheckMethod10.GET
    r"""Health check HTTP method."""

    collect_request_params: Annotated[
        Optional[List[CollectorHealthCheckCollectRequestParam10]],
        pydantic.Field(alias="collectRequestParams"),
    ] = None
    r"""Optional health check request parameters."""

    collect_body: Annotated[Optional[str], pydantic.Field(alias="collectBody")] = (
        "`{ }`"
    )
    r"""Template for POST body to send with the health check request. You can reference parameters from the Discover response, using template params of the form: ${variable}."""

    collect_request_headers: Annotated[
        Optional[List[CollectorHealthCheckCollectRequestHeader10]],
        pydantic.Field(alias="collectRequestHeaders"),
    ] = None
    r"""Optional health check request headers."""

    authenticate_collect: Annotated[
        Optional[bool], pydantic.Field(alias="authenticateCollect")
    ] = False
    r"""Enable to make auth health check call."""

    timeout: Optional[float] = 30
    r"""HTTP request inactivity timeout, use 0 to disable"""

    reject_unauthorized: Annotated[
        Optional[bool], pydantic.Field(alias="rejectUnauthorized")
    ] = False
    r"""Whether to reject certificates that cannot be verified against a valid CA (e.g., self-signed certificates)."""

    default_breakers: Annotated[
        Annotated[
            Optional[CollectorHealthCheckHiddenDefaultBreakers10],
            PlainValidator(validate_open_enum(False)),
        ],
        pydantic.Field(alias="defaultBreakers"),
    ] = None

    safe_headers: Annotated[
        Optional[List[str]], pydantic.Field(alias="safeHeaders")
    ] = None
    r"""List of headers that are safe to log in plain text."""

    retry_rules: Annotated[
        Optional[CollectorHealthCheckRetryRules10], pydantic.Field(alias="retryRules")
    ] = None

    username: Optional[str] = None
    r"""Login username"""

    password: Optional[str] = None
    r"""Login password"""

    credentials_secret: Annotated[
        Optional[str], pydantic.Field(alias="credentialsSecret")
    ] = None
    r"""Select or create a stored secret that references your login credentials"""

    login_body: Annotated[Optional[str], pydantic.Field(alias="loginBody")] = (
        '`{ "username": "${username}", "password": "${password}" }`'
    )
    r"""Template for POST body to send with login request, ${username} and ${password} are used to specify location of these attributes in the message"""

    client_secret_param_value: Annotated[
        Optional[str], pydantic.Field(alias="clientSecretParamValue")
    ] = None
    r"""Secret value to add to HTTP requests as the 'client secret' parameter. Stored on disk encrypted, and is automatically added to request parameters"""

    @field_serializer("authentication")
    def serialize_authentication(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckAuthentication10(value)
            except ValueError:
                return value
        return value

    @field_serializer("collect_method")
    def serialize_collect_method(self, value):
        if isinstance(value, str):
            try:
                return models.HealthCheckMethod10(value)
            except ValueError:
                return value
        return value

    @field_serializer("default_breakers")
    def serialize_default_breakers(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckHiddenDefaultBreakers10(value)
            except ValueError:
                return value
        return value


class CollectorHealthCheckAuthentication9(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Authentication method for Discover and Collect REST calls. You can specify API Key–based authentication by adding the appropriate Collect headers."""

    NONE = "none"
    BASIC = "basic"
    BASIC_SECRET = "basicSecret"
    LOGIN = "login"
    LOGIN_SECRET = "loginSecret"
    OAUTH = "oauth"
    OAUTH_SECRET = "oauthSecret"


class CollectorHealthCheckAuthRequestParam9TypedDict(TypedDict):
    name: str
    r"""Parameter name."""
    value: str
    r"""JavaScript expression to compute the parameter's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckAuthRequestParam9(BaseModel):
    name: str
    r"""Parameter name."""

    value: str
    r"""JavaScript expression to compute the parameter's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckAuthRequestHeader9TypedDict(TypedDict):
    name: str
    r"""Header name."""
    value: str
    r"""JavaScript expression to compute the header's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckAuthRequestHeader9(BaseModel):
    name: str
    r"""Header name."""

    value: str
    r"""JavaScript expression to compute the header's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckDiscoverType9(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Defines how task discovery will be performed. Use None to skip the discovery. Use HTTP Request to make a REST call to discover tasks. Use Item List to enumerate items for collect to retrieve. Use JSON Response to manually define discover tasks as a JSON array of objects. Each entry returned by the discover operation will result in a collect task."""

    # HTTP Request
    HTTP = "http"
    # JSON Response
    JSON = "json"
    # Item List
    LIST = "list"
    # None
    NONE = "none"


class CollectorHealthCheckDiscovery9TypedDict(TypedDict):
    discover_type: NotRequired[CollectorHealthCheckDiscoverType9]
    r"""Defines how task discovery will be performed. Use None to skip the discovery. Use HTTP Request to make a REST call to discover tasks. Use Item List to enumerate items for collect to retrieve. Use JSON Response to manually define discover tasks as a JSON array of objects. Each entry returned by the discover operation will result in a collect task."""


class CollectorHealthCheckDiscovery9(BaseModel):
    discover_type: Annotated[
        Annotated[
            Optional[CollectorHealthCheckDiscoverType9],
            PlainValidator(validate_open_enum(False)),
        ],
        pydantic.Field(alias="discoverType"),
    ] = CollectorHealthCheckDiscoverType9.NONE
    r"""Defines how task discovery will be performed. Use None to skip the discovery. Use HTTP Request to make a REST call to discover tasks. Use Item List to enumerate items for collect to retrieve. Use JSON Response to manually define discover tasks as a JSON array of objects. Each entry returned by the discover operation will result in a collect task."""

    @field_serializer("discover_type")
    def serialize_discover_type(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckDiscoverType9(value)
            except ValueError:
                return value
        return value


class HealthCheckMethod9(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Health check HTTP method."""

    # GET
    GET = "get"
    # POST
    POST = "post"
    # POST with Body
    POST_WITH_BODY = "post_with_body"


class CollectorHealthCheckCollectRequestParam9TypedDict(TypedDict):
    name: str
    r"""Parameter name."""
    value: str
    r"""JavaScript expression to compute the parameter value (can be a constant)."""


class CollectorHealthCheckCollectRequestParam9(BaseModel):
    name: str
    r"""Parameter name."""

    value: str
    r"""JavaScript expression to compute the parameter value (can be a constant)."""


class CollectorHealthCheckCollectRequestHeader9TypedDict(TypedDict):
    name: str
    r"""Header Name"""
    value: str
    r"""JavaScript expression to compute the header value (can be a constant)."""


class CollectorHealthCheckCollectRequestHeader9(BaseModel):
    name: str
    r"""Header Name"""

    value: str
    r"""JavaScript expression to compute the header value (can be a constant)."""


class CollectorHealthCheckHiddenDefaultBreakers9(
    str, Enum, metaclass=utils.OpenEnumMeta
):
    CRIBL = "Cribl"


class CollectorHealthCheckRetryType9(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""The algorithm to use when performing HTTP retries"""

    # Disabled
    NONE = "none"
    # Backoff
    BACKOFF = "backoff"
    # Static
    STATIC = "static"


class CollectorHealthCheckRetryRules9TypedDict(TypedDict):
    type: NotRequired[CollectorHealthCheckRetryType9]
    r"""The algorithm to use when performing HTTP retries"""
    interval: NotRequired[Any]
    limit: NotRequired[Any]
    multiplier: NotRequired[Any]
    codes: NotRequired[Any]
    enable_header: NotRequired[Any]


class CollectorHealthCheckRetryRules9(BaseModel):
    type: Annotated[
        Optional[CollectorHealthCheckRetryType9],
        PlainValidator(validate_open_enum(False)),
    ] = CollectorHealthCheckRetryType9.BACKOFF
    r"""The algorithm to use when performing HTTP retries"""

    interval: Optional[Any] = None

    limit: Optional[Any] = None

    multiplier: Optional[Any] = None

    codes: Optional[Any] = None

    enable_header: Annotated[Optional[Any], pydantic.Field(alias="enableHeader")] = None

    @field_serializer("type")
    def serialize_type(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckRetryType9(value)
            except ValueError:
                return value
        return value


class CollectorHealthCheckType9(str, Enum):
    r"""Collector type: health_check"""

    HEALTH_CHECK = "health_check"


class CollectorHealthCheckHealthCheck9TypedDict(TypedDict):
    client_secret_param_value: str
    r"""Secret value to add to HTTP requests as the 'client secret' parameter. Stored on disk encrypted, and is automatically added to request parameters"""
    collect_url: str
    r"""Expression to derive URL to use for the health check operation (can be a constant)."""
    type: CollectorHealthCheckType9
    r"""Collector type: health_check"""
    authentication: NotRequired[CollectorHealthCheckAuthentication9]
    r"""Authentication method for Discover and Collect REST calls. You can specify API Key–based authentication by adding the appropriate Collect headers."""
    login_url: NotRequired[str]
    r"""URL to use for the OAuth API call. This call is expected to be a POST."""
    token_resp_attribute: NotRequired[str]
    r"""Path to token attribute in login response body. Nested attributes are OK. Leave blank if the response content type is text/plain; the entire response body will be used to derive the authorization header."""
    auth_header_expr: NotRequired[str]
    r"""JavaScript expression to compute the Authorization header to pass in discover and collect calls. The value ${token} is used to reference the token obtained from login."""
    client_secret_param_name: NotRequired[str]
    r"""Parameter name that contains client secret. Defaults to 'client_secret', and is automatically added to request parameters."""
    auth_request_params: NotRequired[
        List[CollectorHealthCheckAuthRequestParam9TypedDict]
    ]
    r"""OAuth request parameters added to the POST body. The Content-Type header will automatically be set to application/x-www-form-urlencoded."""
    auth_request_headers: NotRequired[
        List[CollectorHealthCheckAuthRequestHeader9TypedDict]
    ]
    r"""Optional authentication request headers."""
    discovery: NotRequired[CollectorHealthCheckDiscovery9TypedDict]
    collect_method: NotRequired[HealthCheckMethod9]
    r"""Health check HTTP method."""
    collect_request_params: NotRequired[
        List[CollectorHealthCheckCollectRequestParam9TypedDict]
    ]
    r"""Optional health check request parameters."""
    collect_body: NotRequired[str]
    r"""Template for POST body to send with the health check request. You can reference parameters from the Discover response, using template params of the form: ${variable}."""
    collect_request_headers: NotRequired[
        List[CollectorHealthCheckCollectRequestHeader9TypedDict]
    ]
    r"""Optional health check request headers."""
    authenticate_collect: NotRequired[bool]
    r"""Enable to make auth health check call."""
    timeout: NotRequired[float]
    r"""HTTP request inactivity timeout, use 0 to disable"""
    reject_unauthorized: NotRequired[bool]
    r"""Whether to reject certificates that cannot be verified against a valid CA (e.g., self-signed certificates)."""
    default_breakers: NotRequired[CollectorHealthCheckHiddenDefaultBreakers9]
    safe_headers: NotRequired[List[str]]
    r"""List of headers that are safe to log in plain text."""
    retry_rules: NotRequired[CollectorHealthCheckRetryRules9TypedDict]
    username: NotRequired[str]
    r"""Login username"""
    password: NotRequired[str]
    r"""Login password"""
    credentials_secret: NotRequired[str]
    r"""Select or create a stored secret that references your login credentials"""
    login_body: NotRequired[str]
    r"""Template for POST body to send with login request, ${username} and ${password} are used to specify location of these attributes in the message"""
    text_secret: NotRequired[str]
    r"""Select or create a text secret that contains the client secret's value."""


class CollectorHealthCheckHealthCheck9(BaseModel):
    client_secret_param_value: Annotated[
        str, pydantic.Field(alias="clientSecretParamValue")
    ]
    r"""Secret value to add to HTTP requests as the 'client secret' parameter. Stored on disk encrypted, and is automatically added to request parameters"""

    collect_url: Annotated[str, pydantic.Field(alias="collectUrl")]
    r"""Expression to derive URL to use for the health check operation (can be a constant)."""

    type: CollectorHealthCheckType9
    r"""Collector type: health_check"""

    authentication: Annotated[
        Optional[CollectorHealthCheckAuthentication9],
        PlainValidator(validate_open_enum(False)),
    ] = CollectorHealthCheckAuthentication9.NONE
    r"""Authentication method for Discover and Collect REST calls. You can specify API Key–based authentication by adding the appropriate Collect headers."""

    login_url: Annotated[Optional[str], pydantic.Field(alias="loginUrl")] = ""
    r"""URL to use for the OAuth API call. This call is expected to be a POST."""

    token_resp_attribute: Annotated[
        Optional[str], pydantic.Field(alias="tokenRespAttribute")
    ] = None
    r"""Path to token attribute in login response body. Nested attributes are OK. Leave blank if the response content type is text/plain; the entire response body will be used to derive the authorization header."""

    auth_header_expr: Annotated[
        Optional[str], pydantic.Field(alias="authHeaderExpr")
    ] = "`Bearer ${token}`"
    r"""JavaScript expression to compute the Authorization header to pass in discover and collect calls. The value ${token} is used to reference the token obtained from login."""

    client_secret_param_name: Annotated[
        Optional[str], pydantic.Field(alias="clientSecretParamName")
    ] = "client_secret"
    r"""Parameter name that contains client secret. Defaults to 'client_secret', and is automatically added to request parameters."""

    auth_request_params: Annotated[
        Optional[List[CollectorHealthCheckAuthRequestParam9]],
        pydantic.Field(alias="authRequestParams"),
    ] = None
    r"""OAuth request parameters added to the POST body. The Content-Type header will automatically be set to application/x-www-form-urlencoded."""

    auth_request_headers: Annotated[
        Optional[List[CollectorHealthCheckAuthRequestHeader9]],
        pydantic.Field(alias="authRequestHeaders"),
    ] = None
    r"""Optional authentication request headers."""

    discovery: Optional[CollectorHealthCheckDiscovery9] = None

    collect_method: Annotated[
        Annotated[
            Optional[HealthCheckMethod9], PlainValidator(validate_open_enum(False))
        ],
        pydantic.Field(alias="collectMethod"),
    ] = HealthCheckMethod9.GET
    r"""Health check HTTP method."""

    collect_request_params: Annotated[
        Optional[List[CollectorHealthCheckCollectRequestParam9]],
        pydantic.Field(alias="collectRequestParams"),
    ] = None
    r"""Optional health check request parameters."""

    collect_body: Annotated[Optional[str], pydantic.Field(alias="collectBody")] = (
        "`{ }`"
    )
    r"""Template for POST body to send with the health check request. You can reference parameters from the Discover response, using template params of the form: ${variable}."""

    collect_request_headers: Annotated[
        Optional[List[CollectorHealthCheckCollectRequestHeader9]],
        pydantic.Field(alias="collectRequestHeaders"),
    ] = None
    r"""Optional health check request headers."""

    authenticate_collect: Annotated[
        Optional[bool], pydantic.Field(alias="authenticateCollect")
    ] = False
    r"""Enable to make auth health check call."""

    timeout: Optional[float] = 30
    r"""HTTP request inactivity timeout, use 0 to disable"""

    reject_unauthorized: Annotated[
        Optional[bool], pydantic.Field(alias="rejectUnauthorized")
    ] = False
    r"""Whether to reject certificates that cannot be verified against a valid CA (e.g., self-signed certificates)."""

    default_breakers: Annotated[
        Annotated[
            Optional[CollectorHealthCheckHiddenDefaultBreakers9],
            PlainValidator(validate_open_enum(False)),
        ],
        pydantic.Field(alias="defaultBreakers"),
    ] = None

    safe_headers: Annotated[
        Optional[List[str]], pydantic.Field(alias="safeHeaders")
    ] = None
    r"""List of headers that are safe to log in plain text."""

    retry_rules: Annotated[
        Optional[CollectorHealthCheckRetryRules9], pydantic.Field(alias="retryRules")
    ] = None

    username: Optional[str] = None
    r"""Login username"""

    password: Optional[str] = None
    r"""Login password"""

    credentials_secret: Annotated[
        Optional[str], pydantic.Field(alias="credentialsSecret")
    ] = None
    r"""Select or create a stored secret that references your login credentials"""

    login_body: Annotated[Optional[str], pydantic.Field(alias="loginBody")] = (
        '`{ "username": "${username}", "password": "${password}" }`'
    )
    r"""Template for POST body to send with login request, ${username} and ${password} are used to specify location of these attributes in the message"""

    text_secret: Annotated[Optional[str], pydantic.Field(alias="textSecret")] = None
    r"""Select or create a text secret that contains the client secret's value."""

    @field_serializer("authentication")
    def serialize_authentication(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckAuthentication9(value)
            except ValueError:
                return value
        return value

    @field_serializer("collect_method")
    def serialize_collect_method(self, value):
        if isinstance(value, str):
            try:
                return models.HealthCheckMethod9(value)
            except ValueError:
                return value
        return value

    @field_serializer("default_breakers")
    def serialize_default_breakers(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckHiddenDefaultBreakers9(value)
            except ValueError:
                return value
        return value


class CollectorHealthCheckAuthentication8(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Authentication method for Discover and Collect REST calls. You can specify API Key–based authentication by adding the appropriate Collect headers."""

    NONE = "none"
    BASIC = "basic"
    BASIC_SECRET = "basicSecret"
    LOGIN = "login"
    LOGIN_SECRET = "loginSecret"
    OAUTH = "oauth"
    OAUTH_SECRET = "oauthSecret"


class CollectorHealthCheckAuthRequestHeader8TypedDict(TypedDict):
    name: str
    r"""Header name."""
    value: str
    r"""JavaScript expression to compute the header's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckAuthRequestHeader8(BaseModel):
    name: str
    r"""Header name."""

    value: str
    r"""JavaScript expression to compute the header's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckDiscoverType8(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Defines how task discovery will be performed. Use None to skip the discovery. Use HTTP Request to make a REST call to discover tasks. Use Item List to enumerate items for collect to retrieve. Use JSON Response to manually define discover tasks as a JSON array of objects. Each entry returned by the discover operation will result in a collect task."""

    # HTTP Request
    HTTP = "http"
    # JSON Response
    JSON = "json"
    # Item List
    LIST = "list"
    # None
    NONE = "none"


class CollectorHealthCheckDiscovery8TypedDict(TypedDict):
    discover_type: NotRequired[CollectorHealthCheckDiscoverType8]
    r"""Defines how task discovery will be performed. Use None to skip the discovery. Use HTTP Request to make a REST call to discover tasks. Use Item List to enumerate items for collect to retrieve. Use JSON Response to manually define discover tasks as a JSON array of objects. Each entry returned by the discover operation will result in a collect task."""


class CollectorHealthCheckDiscovery8(BaseModel):
    discover_type: Annotated[
        Annotated[
            Optional[CollectorHealthCheckDiscoverType8],
            PlainValidator(validate_open_enum(False)),
        ],
        pydantic.Field(alias="discoverType"),
    ] = CollectorHealthCheckDiscoverType8.NONE
    r"""Defines how task discovery will be performed. Use None to skip the discovery. Use HTTP Request to make a REST call to discover tasks. Use Item List to enumerate items for collect to retrieve. Use JSON Response to manually define discover tasks as a JSON array of objects. Each entry returned by the discover operation will result in a collect task."""

    @field_serializer("discover_type")
    def serialize_discover_type(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckDiscoverType8(value)
            except ValueError:
                return value
        return value


class HealthCheckMethod8(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Health check HTTP method."""

    # GET
    GET = "get"
    # POST
    POST = "post"
    # POST with Body
    POST_WITH_BODY = "post_with_body"


class CollectorHealthCheckCollectRequestParam8TypedDict(TypedDict):
    name: str
    r"""Parameter name."""
    value: str
    r"""JavaScript expression to compute the parameter value (can be a constant)."""


class CollectorHealthCheckCollectRequestParam8(BaseModel):
    name: str
    r"""Parameter name."""

    value: str
    r"""JavaScript expression to compute the parameter value (can be a constant)."""


class CollectorHealthCheckCollectRequestHeader8TypedDict(TypedDict):
    name: str
    r"""Header Name"""
    value: str
    r"""JavaScript expression to compute the header value (can be a constant)."""


class CollectorHealthCheckCollectRequestHeader8(BaseModel):
    name: str
    r"""Header Name"""

    value: str
    r"""JavaScript expression to compute the header value (can be a constant)."""


class CollectorHealthCheckHiddenDefaultBreakers8(
    str, Enum, metaclass=utils.OpenEnumMeta
):
    CRIBL = "Cribl"


class CollectorHealthCheckRetryType8(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""The algorithm to use when performing HTTP retries"""

    # Disabled
    NONE = "none"
    # Backoff
    BACKOFF = "backoff"
    # Static
    STATIC = "static"


class CollectorHealthCheckRetryRules8TypedDict(TypedDict):
    type: NotRequired[CollectorHealthCheckRetryType8]
    r"""The algorithm to use when performing HTTP retries"""
    interval: NotRequired[Any]
    limit: NotRequired[Any]
    multiplier: NotRequired[Any]
    codes: NotRequired[Any]
    enable_header: NotRequired[Any]


class CollectorHealthCheckRetryRules8(BaseModel):
    type: Annotated[
        Optional[CollectorHealthCheckRetryType8],
        PlainValidator(validate_open_enum(False)),
    ] = CollectorHealthCheckRetryType8.BACKOFF
    r"""The algorithm to use when performing HTTP retries"""

    interval: Optional[Any] = None

    limit: Optional[Any] = None

    multiplier: Optional[Any] = None

    codes: Optional[Any] = None

    enable_header: Annotated[Optional[Any], pydantic.Field(alias="enableHeader")] = None

    @field_serializer("type")
    def serialize_type(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckRetryType8(value)
            except ValueError:
                return value
        return value


class CollectorHealthCheckAuthRequestParam8TypedDict(TypedDict):
    name: str
    r"""Parameter name."""
    value: str
    r"""JavaScript expression to compute the parameter's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckAuthRequestParam8(BaseModel):
    name: str
    r"""Parameter name."""

    value: str
    r"""JavaScript expression to compute the parameter's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckType8(str, Enum):
    r"""Collector type: health_check"""

    HEALTH_CHECK = "health_check"


class CollectorHealthCheckHealthCheck8TypedDict(TypedDict):
    credentials_secret: str
    r"""Select or create a stored secret that references your login credentials"""
    collect_url: str
    r"""Expression to derive URL to use for the health check operation (can be a constant)."""
    type: CollectorHealthCheckType8
    r"""Collector type: health_check"""
    authentication: NotRequired[CollectorHealthCheckAuthentication8]
    r"""Authentication method for Discover and Collect REST calls. You can specify API Key–based authentication by adding the appropriate Collect headers."""
    login_url: NotRequired[str]
    r"""URL to use for the OAuth API call. This call is expected to be a POST."""
    login_body: NotRequired[str]
    r"""Template for POST body to send with login request, ${username} and ${password} are used to specify location of these attributes in the message"""
    token_resp_attribute: NotRequired[str]
    r"""Path to token attribute in login response body. Nested attributes are OK. Leave blank if the response content type is text/plain; the entire response body will be used to derive the authorization header."""
    auth_header_expr: NotRequired[str]
    r"""JavaScript expression to compute the Authorization header to pass in discover and collect calls. The value ${token} is used to reference the token obtained from login."""
    auth_request_headers: NotRequired[
        List[CollectorHealthCheckAuthRequestHeader8TypedDict]
    ]
    r"""Optional authentication request headers."""
    discovery: NotRequired[CollectorHealthCheckDiscovery8TypedDict]
    collect_method: NotRequired[HealthCheckMethod8]
    r"""Health check HTTP method."""
    collect_request_params: NotRequired[
        List[CollectorHealthCheckCollectRequestParam8TypedDict]
    ]
    r"""Optional health check request parameters."""
    collect_body: NotRequired[str]
    r"""Template for POST body to send with the health check request. You can reference parameters from the Discover response, using template params of the form: ${variable}."""
    collect_request_headers: NotRequired[
        List[CollectorHealthCheckCollectRequestHeader8TypedDict]
    ]
    r"""Optional health check request headers."""
    authenticate_collect: NotRequired[bool]
    r"""Enable to make auth health check call."""
    timeout: NotRequired[float]
    r"""HTTP request inactivity timeout, use 0 to disable"""
    reject_unauthorized: NotRequired[bool]
    r"""Whether to reject certificates that cannot be verified against a valid CA (e.g., self-signed certificates)."""
    default_breakers: NotRequired[CollectorHealthCheckHiddenDefaultBreakers8]
    safe_headers: NotRequired[List[str]]
    r"""List of headers that are safe to log in plain text."""
    retry_rules: NotRequired[CollectorHealthCheckRetryRules8TypedDict]
    username: NotRequired[str]
    r"""Login username"""
    password: NotRequired[str]
    r"""Login password"""
    client_secret_param_name: NotRequired[str]
    r"""Parameter name that contains client secret. Defaults to 'client_secret', and is automatically added to request parameters."""
    client_secret_param_value: NotRequired[str]
    r"""Secret value to add to HTTP requests as the 'client secret' parameter. Stored on disk encrypted, and is automatically added to request parameters"""
    auth_request_params: NotRequired[
        List[CollectorHealthCheckAuthRequestParam8TypedDict]
    ]
    r"""OAuth request parameters added to the POST body. The Content-Type header will automatically be set to application/x-www-form-urlencoded."""
    text_secret: NotRequired[str]
    r"""Select or create a text secret that contains the client secret's value."""


class CollectorHealthCheckHealthCheck8(BaseModel):
    credentials_secret: Annotated[str, pydantic.Field(alias="credentialsSecret")]
    r"""Select or create a stored secret that references your login credentials"""

    collect_url: Annotated[str, pydantic.Field(alias="collectUrl")]
    r"""Expression to derive URL to use for the health check operation (can be a constant)."""

    type: CollectorHealthCheckType8
    r"""Collector type: health_check"""

    authentication: Annotated[
        Optional[CollectorHealthCheckAuthentication8],
        PlainValidator(validate_open_enum(False)),
    ] = CollectorHealthCheckAuthentication8.NONE
    r"""Authentication method for Discover and Collect REST calls. You can specify API Key–based authentication by adding the appropriate Collect headers."""

    login_url: Annotated[Optional[str], pydantic.Field(alias="loginUrl")] = ""
    r"""URL to use for the OAuth API call. This call is expected to be a POST."""

    login_body: Annotated[Optional[str], pydantic.Field(alias="loginBody")] = (
        '`{ "username": "${username}", "password": "${password}" }`'
    )
    r"""Template for POST body to send with login request, ${username} and ${password} are used to specify location of these attributes in the message"""

    token_resp_attribute: Annotated[
        Optional[str], pydantic.Field(alias="tokenRespAttribute")
    ] = None
    r"""Path to token attribute in login response body. Nested attributes are OK. Leave blank if the response content type is text/plain; the entire response body will be used to derive the authorization header."""

    auth_header_expr: Annotated[
        Optional[str], pydantic.Field(alias="authHeaderExpr")
    ] = "`Bearer ${token}`"
    r"""JavaScript expression to compute the Authorization header to pass in discover and collect calls. The value ${token} is used to reference the token obtained from login."""

    auth_request_headers: Annotated[
        Optional[List[CollectorHealthCheckAuthRequestHeader8]],
        pydantic.Field(alias="authRequestHeaders"),
    ] = None
    r"""Optional authentication request headers."""

    discovery: Optional[CollectorHealthCheckDiscovery8] = None

    collect_method: Annotated[
        Annotated[
            Optional[HealthCheckMethod8], PlainValidator(validate_open_enum(False))
        ],
        pydantic.Field(alias="collectMethod"),
    ] = HealthCheckMethod8.GET
    r"""Health check HTTP method."""

    collect_request_params: Annotated[
        Optional[List[CollectorHealthCheckCollectRequestParam8]],
        pydantic.Field(alias="collectRequestParams"),
    ] = None
    r"""Optional health check request parameters."""

    collect_body: Annotated[Optional[str], pydantic.Field(alias="collectBody")] = (
        "`{ }`"
    )
    r"""Template for POST body to send with the health check request. You can reference parameters from the Discover response, using template params of the form: ${variable}."""

    collect_request_headers: Annotated[
        Optional[List[CollectorHealthCheckCollectRequestHeader8]],
        pydantic.Field(alias="collectRequestHeaders"),
    ] = None
    r"""Optional health check request headers."""

    authenticate_collect: Annotated[
        Optional[bool], pydantic.Field(alias="authenticateCollect")
    ] = False
    r"""Enable to make auth health check call."""

    timeout: Optional[float] = 30
    r"""HTTP request inactivity timeout, use 0 to disable"""

    reject_unauthorized: Annotated[
        Optional[bool], pydantic.Field(alias="rejectUnauthorized")
    ] = False
    r"""Whether to reject certificates that cannot be verified against a valid CA (e.g., self-signed certificates)."""

    default_breakers: Annotated[
        Annotated[
            Optional[CollectorHealthCheckHiddenDefaultBreakers8],
            PlainValidator(validate_open_enum(False)),
        ],
        pydantic.Field(alias="defaultBreakers"),
    ] = None

    safe_headers: Annotated[
        Optional[List[str]], pydantic.Field(alias="safeHeaders")
    ] = None
    r"""List of headers that are safe to log in plain text."""

    retry_rules: Annotated[
        Optional[CollectorHealthCheckRetryRules8], pydantic.Field(alias="retryRules")
    ] = None

    username: Optional[str] = None
    r"""Login username"""

    password: Optional[str] = None
    r"""Login password"""

    client_secret_param_name: Annotated[
        Optional[str], pydantic.Field(alias="clientSecretParamName")
    ] = "client_secret"
    r"""Parameter name that contains client secret. Defaults to 'client_secret', and is automatically added to request parameters."""

    client_secret_param_value: Annotated[
        Optional[str], pydantic.Field(alias="clientSecretParamValue")
    ] = None
    r"""Secret value to add to HTTP requests as the 'client secret' parameter. Stored on disk encrypted, and is automatically added to request parameters"""

    auth_request_params: Annotated[
        Optional[List[CollectorHealthCheckAuthRequestParam8]],
        pydantic.Field(alias="authRequestParams"),
    ] = None
    r"""OAuth request parameters added to the POST body. The Content-Type header will automatically be set to application/x-www-form-urlencoded."""

    text_secret: Annotated[Optional[str], pydantic.Field(alias="textSecret")] = None
    r"""Select or create a text secret that contains the client secret's value."""

    @field_serializer("authentication")
    def serialize_authentication(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckAuthentication8(value)
            except ValueError:
                return value
        return value

    @field_serializer("collect_method")
    def serialize_collect_method(self, value):
        if isinstance(value, str):
            try:
                return models.HealthCheckMethod8(value)
            except ValueError:
                return value
        return value

    @field_serializer("default_breakers")
    def serialize_default_breakers(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckHiddenDefaultBreakers8(value)
            except ValueError:
                return value
        return value


class CollectorHealthCheckAuthentication7(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Authentication method for Discover and Collect REST calls. You can specify API Key–based authentication by adding the appropriate Collect headers."""

    NONE = "none"
    BASIC = "basic"
    BASIC_SECRET = "basicSecret"
    LOGIN = "login"
    LOGIN_SECRET = "loginSecret"
    OAUTH = "oauth"
    OAUTH_SECRET = "oauthSecret"


class CollectorHealthCheckAuthRequestHeader7TypedDict(TypedDict):
    name: str
    r"""Header name."""
    value: str
    r"""JavaScript expression to compute the header's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckAuthRequestHeader7(BaseModel):
    name: str
    r"""Header name."""

    value: str
    r"""JavaScript expression to compute the header's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckDiscoverType7(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Defines how task discovery will be performed. Use None to skip the discovery. Use HTTP Request to make a REST call to discover tasks. Use Item List to enumerate items for collect to retrieve. Use JSON Response to manually define discover tasks as a JSON array of objects. Each entry returned by the discover operation will result in a collect task."""

    # HTTP Request
    HTTP = "http"
    # JSON Response
    JSON = "json"
    # Item List
    LIST = "list"
    # None
    NONE = "none"


class CollectorHealthCheckDiscovery7TypedDict(TypedDict):
    discover_type: NotRequired[CollectorHealthCheckDiscoverType7]
    r"""Defines how task discovery will be performed. Use None to skip the discovery. Use HTTP Request to make a REST call to discover tasks. Use Item List to enumerate items for collect to retrieve. Use JSON Response to manually define discover tasks as a JSON array of objects. Each entry returned by the discover operation will result in a collect task."""


class CollectorHealthCheckDiscovery7(BaseModel):
    discover_type: Annotated[
        Annotated[
            Optional[CollectorHealthCheckDiscoverType7],
            PlainValidator(validate_open_enum(False)),
        ],
        pydantic.Field(alias="discoverType"),
    ] = CollectorHealthCheckDiscoverType7.NONE
    r"""Defines how task discovery will be performed. Use None to skip the discovery. Use HTTP Request to make a REST call to discover tasks. Use Item List to enumerate items for collect to retrieve. Use JSON Response to manually define discover tasks as a JSON array of objects. Each entry returned by the discover operation will result in a collect task."""

    @field_serializer("discover_type")
    def serialize_discover_type(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckDiscoverType7(value)
            except ValueError:
                return value
        return value


class HealthCheckMethod7(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Health check HTTP method."""

    # GET
    GET = "get"
    # POST
    POST = "post"
    # POST with Body
    POST_WITH_BODY = "post_with_body"


class CollectorHealthCheckCollectRequestParam7TypedDict(TypedDict):
    name: str
    r"""Parameter name."""
    value: str
    r"""JavaScript expression to compute the parameter value (can be a constant)."""


class CollectorHealthCheckCollectRequestParam7(BaseModel):
    name: str
    r"""Parameter name."""

    value: str
    r"""JavaScript expression to compute the parameter value (can be a constant)."""


class CollectorHealthCheckCollectRequestHeader7TypedDict(TypedDict):
    name: str
    r"""Header Name"""
    value: str
    r"""JavaScript expression to compute the header value (can be a constant)."""


class CollectorHealthCheckCollectRequestHeader7(BaseModel):
    name: str
    r"""Header Name"""

    value: str
    r"""JavaScript expression to compute the header value (can be a constant)."""


class CollectorHealthCheckHiddenDefaultBreakers7(
    str, Enum, metaclass=utils.OpenEnumMeta
):
    CRIBL = "Cribl"


class CollectorHealthCheckRetryType7(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""The algorithm to use when performing HTTP retries"""

    # Disabled
    NONE = "none"
    # Backoff
    BACKOFF = "backoff"
    # Static
    STATIC = "static"


class CollectorHealthCheckRetryRules7TypedDict(TypedDict):
    type: NotRequired[CollectorHealthCheckRetryType7]
    r"""The algorithm to use when performing HTTP retries"""
    interval: NotRequired[Any]
    limit: NotRequired[Any]
    multiplier: NotRequired[Any]
    codes: NotRequired[Any]
    enable_header: NotRequired[Any]


class CollectorHealthCheckRetryRules7(BaseModel):
    type: Annotated[
        Optional[CollectorHealthCheckRetryType7],
        PlainValidator(validate_open_enum(False)),
    ] = CollectorHealthCheckRetryType7.BACKOFF
    r"""The algorithm to use when performing HTTP retries"""

    interval: Optional[Any] = None

    limit: Optional[Any] = None

    multiplier: Optional[Any] = None

    codes: Optional[Any] = None

    enable_header: Annotated[Optional[Any], pydantic.Field(alias="enableHeader")] = None

    @field_serializer("type")
    def serialize_type(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckRetryType7(value)
            except ValueError:
                return value
        return value


class CollectorHealthCheckAuthRequestParam7TypedDict(TypedDict):
    name: str
    r"""Parameter name."""
    value: str
    r"""JavaScript expression to compute the parameter's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckAuthRequestParam7(BaseModel):
    name: str
    r"""Parameter name."""

    value: str
    r"""JavaScript expression to compute the parameter's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckType7(str, Enum):
    r"""Collector type: health_check"""

    HEALTH_CHECK = "health_check"


class CollectorHealthCheckHealthCheck7TypedDict(TypedDict):
    username: str
    r"""Login username"""
    password: str
    r"""Login password"""
    collect_url: str
    r"""Expression to derive URL to use for the health check operation (can be a constant)."""
    type: CollectorHealthCheckType7
    r"""Collector type: health_check"""
    authentication: NotRequired[CollectorHealthCheckAuthentication7]
    r"""Authentication method for Discover and Collect REST calls. You can specify API Key–based authentication by adding the appropriate Collect headers."""
    login_url: NotRequired[str]
    r"""URL to use for the OAuth API call. This call is expected to be a POST."""
    login_body: NotRequired[str]
    r"""Template for POST body to send with login request, ${username} and ${password} are used to specify location of these attributes in the message"""
    token_resp_attribute: NotRequired[str]
    r"""Path to token attribute in login response body. Nested attributes are OK. Leave blank if the response content type is text/plain; the entire response body will be used to derive the authorization header."""
    auth_header_expr: NotRequired[str]
    r"""JavaScript expression to compute the Authorization header to pass in discover and collect calls. The value ${token} is used to reference the token obtained from login."""
    auth_request_headers: NotRequired[
        List[CollectorHealthCheckAuthRequestHeader7TypedDict]
    ]
    r"""Optional authentication request headers."""
    discovery: NotRequired[CollectorHealthCheckDiscovery7TypedDict]
    collect_method: NotRequired[HealthCheckMethod7]
    r"""Health check HTTP method."""
    collect_request_params: NotRequired[
        List[CollectorHealthCheckCollectRequestParam7TypedDict]
    ]
    r"""Optional health check request parameters."""
    collect_body: NotRequired[str]
    r"""Template for POST body to send with the health check request. You can reference parameters from the Discover response, using template params of the form: ${variable}."""
    collect_request_headers: NotRequired[
        List[CollectorHealthCheckCollectRequestHeader7TypedDict]
    ]
    r"""Optional health check request headers."""
    authenticate_collect: NotRequired[bool]
    r"""Enable to make auth health check call."""
    timeout: NotRequired[float]
    r"""HTTP request inactivity timeout, use 0 to disable"""
    reject_unauthorized: NotRequired[bool]
    r"""Whether to reject certificates that cannot be verified against a valid CA (e.g., self-signed certificates)."""
    default_breakers: NotRequired[CollectorHealthCheckHiddenDefaultBreakers7]
    safe_headers: NotRequired[List[str]]
    r"""List of headers that are safe to log in plain text."""
    retry_rules: NotRequired[CollectorHealthCheckRetryRules7TypedDict]
    credentials_secret: NotRequired[str]
    r"""Select or create a stored secret that references your login credentials"""
    client_secret_param_name: NotRequired[str]
    r"""Parameter name that contains client secret. Defaults to 'client_secret', and is automatically added to request parameters."""
    client_secret_param_value: NotRequired[str]
    r"""Secret value to add to HTTP requests as the 'client secret' parameter. Stored on disk encrypted, and is automatically added to request parameters"""
    auth_request_params: NotRequired[
        List[CollectorHealthCheckAuthRequestParam7TypedDict]
    ]
    r"""OAuth request parameters added to the POST body. The Content-Type header will automatically be set to application/x-www-form-urlencoded."""
    text_secret: NotRequired[str]
    r"""Select or create a text secret that contains the client secret's value."""


class CollectorHealthCheckHealthCheck7(BaseModel):
    username: str
    r"""Login username"""

    password: str
    r"""Login password"""

    collect_url: Annotated[str, pydantic.Field(alias="collectUrl")]
    r"""Expression to derive URL to use for the health check operation (can be a constant)."""

    type: CollectorHealthCheckType7
    r"""Collector type: health_check"""

    authentication: Annotated[
        Optional[CollectorHealthCheckAuthentication7],
        PlainValidator(validate_open_enum(False)),
    ] = CollectorHealthCheckAuthentication7.NONE
    r"""Authentication method for Discover and Collect REST calls. You can specify API Key–based authentication by adding the appropriate Collect headers."""

    login_url: Annotated[Optional[str], pydantic.Field(alias="loginUrl")] = ""
    r"""URL to use for the OAuth API call. This call is expected to be a POST."""

    login_body: Annotated[Optional[str], pydantic.Field(alias="loginBody")] = (
        '`{ "username": "${username}", "password": "${password}" }`'
    )
    r"""Template for POST body to send with login request, ${username} and ${password} are used to specify location of these attributes in the message"""

    token_resp_attribute: Annotated[
        Optional[str], pydantic.Field(alias="tokenRespAttribute")
    ] = None
    r"""Path to token attribute in login response body. Nested attributes are OK. Leave blank if the response content type is text/plain; the entire response body will be used to derive the authorization header."""

    auth_header_expr: Annotated[
        Optional[str], pydantic.Field(alias="authHeaderExpr")
    ] = "`Bearer ${token}`"
    r"""JavaScript expression to compute the Authorization header to pass in discover and collect calls. The value ${token} is used to reference the token obtained from login."""

    auth_request_headers: Annotated[
        Optional[List[CollectorHealthCheckAuthRequestHeader7]],
        pydantic.Field(alias="authRequestHeaders"),
    ] = None
    r"""Optional authentication request headers."""

    discovery: Optional[CollectorHealthCheckDiscovery7] = None

    collect_method: Annotated[
        Annotated[
            Optional[HealthCheckMethod7], PlainValidator(validate_open_enum(False))
        ],
        pydantic.Field(alias="collectMethod"),
    ] = HealthCheckMethod7.GET
    r"""Health check HTTP method."""

    collect_request_params: Annotated[
        Optional[List[CollectorHealthCheckCollectRequestParam7]],
        pydantic.Field(alias="collectRequestParams"),
    ] = None
    r"""Optional health check request parameters."""

    collect_body: Annotated[Optional[str], pydantic.Field(alias="collectBody")] = (
        "`{ }`"
    )
    r"""Template for POST body to send with the health check request. You can reference parameters from the Discover response, using template params of the form: ${variable}."""

    collect_request_headers: Annotated[
        Optional[List[CollectorHealthCheckCollectRequestHeader7]],
        pydantic.Field(alias="collectRequestHeaders"),
    ] = None
    r"""Optional health check request headers."""

    authenticate_collect: Annotated[
        Optional[bool], pydantic.Field(alias="authenticateCollect")
    ] = False
    r"""Enable to make auth health check call."""

    timeout: Optional[float] = 30
    r"""HTTP request inactivity timeout, use 0 to disable"""

    reject_unauthorized: Annotated[
        Optional[bool], pydantic.Field(alias="rejectUnauthorized")
    ] = False
    r"""Whether to reject certificates that cannot be verified against a valid CA (e.g., self-signed certificates)."""

    default_breakers: Annotated[
        Annotated[
            Optional[CollectorHealthCheckHiddenDefaultBreakers7],
            PlainValidator(validate_open_enum(False)),
        ],
        pydantic.Field(alias="defaultBreakers"),
    ] = None

    safe_headers: Annotated[
        Optional[List[str]], pydantic.Field(alias="safeHeaders")
    ] = None
    r"""List of headers that are safe to log in plain text."""

    retry_rules: Annotated[
        Optional[CollectorHealthCheckRetryRules7], pydantic.Field(alias="retryRules")
    ] = None

    credentials_secret: Annotated[
        Optional[str], pydantic.Field(alias="credentialsSecret")
    ] = None
    r"""Select or create a stored secret that references your login credentials"""

    client_secret_param_name: Annotated[
        Optional[str], pydantic.Field(alias="clientSecretParamName")
    ] = "client_secret"
    r"""Parameter name that contains client secret. Defaults to 'client_secret', and is automatically added to request parameters."""

    client_secret_param_value: Annotated[
        Optional[str], pydantic.Field(alias="clientSecretParamValue")
    ] = None
    r"""Secret value to add to HTTP requests as the 'client secret' parameter. Stored on disk encrypted, and is automatically added to request parameters"""

    auth_request_params: Annotated[
        Optional[List[CollectorHealthCheckAuthRequestParam7]],
        pydantic.Field(alias="authRequestParams"),
    ] = None
    r"""OAuth request parameters added to the POST body. The Content-Type header will automatically be set to application/x-www-form-urlencoded."""

    text_secret: Annotated[Optional[str], pydantic.Field(alias="textSecret")] = None
    r"""Select or create a text secret that contains the client secret's value."""

    @field_serializer("authentication")
    def serialize_authentication(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckAuthentication7(value)
            except ValueError:
                return value
        return value

    @field_serializer("collect_method")
    def serialize_collect_method(self, value):
        if isinstance(value, str):
            try:
                return models.HealthCheckMethod7(value)
            except ValueError:
                return value
        return value

    @field_serializer("default_breakers")
    def serialize_default_breakers(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckHiddenDefaultBreakers7(value)
            except ValueError:
                return value
        return value


class CollectorHealthCheckAuthentication6(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Authentication method for Discover and Collect REST calls. You can specify API Key–based authentication by adding the appropriate Collect headers."""

    NONE = "none"
    BASIC = "basic"
    BASIC_SECRET = "basicSecret"
    LOGIN = "login"
    LOGIN_SECRET = "loginSecret"
    OAUTH = "oauth"
    OAUTH_SECRET = "oauthSecret"


class CollectorHealthCheckDiscoverType6(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Defines how task discovery will be performed. Use None to skip the discovery. Use HTTP Request to make a REST call to discover tasks. Use Item List to enumerate items for collect to retrieve. Use JSON Response to manually define discover tasks as a JSON array of objects. Each entry returned by the discover operation will result in a collect task."""

    # HTTP Request
    HTTP = "http"
    # JSON Response
    JSON = "json"
    # Item List
    LIST = "list"
    # None
    NONE = "none"


class CollectorHealthCheckDiscovery6TypedDict(TypedDict):
    discover_type: NotRequired[CollectorHealthCheckDiscoverType6]
    r"""Defines how task discovery will be performed. Use None to skip the discovery. Use HTTP Request to make a REST call to discover tasks. Use Item List to enumerate items for collect to retrieve. Use JSON Response to manually define discover tasks as a JSON array of objects. Each entry returned by the discover operation will result in a collect task."""


class CollectorHealthCheckDiscovery6(BaseModel):
    discover_type: Annotated[
        Annotated[
            Optional[CollectorHealthCheckDiscoverType6],
            PlainValidator(validate_open_enum(False)),
        ],
        pydantic.Field(alias="discoverType"),
    ] = CollectorHealthCheckDiscoverType6.NONE
    r"""Defines how task discovery will be performed. Use None to skip the discovery. Use HTTP Request to make a REST call to discover tasks. Use Item List to enumerate items for collect to retrieve. Use JSON Response to manually define discover tasks as a JSON array of objects. Each entry returned by the discover operation will result in a collect task."""

    @field_serializer("discover_type")
    def serialize_discover_type(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckDiscoverType6(value)
            except ValueError:
                return value
        return value


class HealthCheckMethod6(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Health check HTTP method."""

    # GET
    GET = "get"
    # POST
    POST = "post"
    # POST with Body
    POST_WITH_BODY = "post_with_body"


class CollectorHealthCheckCollectRequestParam6TypedDict(TypedDict):
    name: str
    r"""Parameter name."""
    value: str
    r"""JavaScript expression to compute the parameter value (can be a constant)."""


class CollectorHealthCheckCollectRequestParam6(BaseModel):
    name: str
    r"""Parameter name."""

    value: str
    r"""JavaScript expression to compute the parameter value (can be a constant)."""


class CollectorHealthCheckCollectRequestHeader6TypedDict(TypedDict):
    name: str
    r"""Header Name"""
    value: str
    r"""JavaScript expression to compute the header value (can be a constant)."""


class CollectorHealthCheckCollectRequestHeader6(BaseModel):
    name: str
    r"""Header Name"""

    value: str
    r"""JavaScript expression to compute the header value (can be a constant)."""


class CollectorHealthCheckHiddenDefaultBreakers6(
    str, Enum, metaclass=utils.OpenEnumMeta
):
    CRIBL = "Cribl"


class CollectorHealthCheckRetryType6(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""The algorithm to use when performing HTTP retries"""

    # Disabled
    NONE = "none"
    # Backoff
    BACKOFF = "backoff"
    # Static
    STATIC = "static"


class CollectorHealthCheckRetryRules6TypedDict(TypedDict):
    type: NotRequired[CollectorHealthCheckRetryType6]
    r"""The algorithm to use when performing HTTP retries"""
    interval: NotRequired[Any]
    limit: NotRequired[Any]
    multiplier: NotRequired[Any]
    codes: NotRequired[Any]
    enable_header: NotRequired[Any]


class CollectorHealthCheckRetryRules6(BaseModel):
    type: Annotated[
        Optional[CollectorHealthCheckRetryType6],
        PlainValidator(validate_open_enum(False)),
    ] = CollectorHealthCheckRetryType6.BACKOFF
    r"""The algorithm to use when performing HTTP retries"""

    interval: Optional[Any] = None

    limit: Optional[Any] = None

    multiplier: Optional[Any] = None

    codes: Optional[Any] = None

    enable_header: Annotated[Optional[Any], pydantic.Field(alias="enableHeader")] = None

    @field_serializer("type")
    def serialize_type(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckRetryType6(value)
            except ValueError:
                return value
        return value


class CollectorHealthCheckAuthRequestHeader6TypedDict(TypedDict):
    name: str
    r"""Header name."""
    value: str
    r"""JavaScript expression to compute the header's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckAuthRequestHeader6(BaseModel):
    name: str
    r"""Header name."""

    value: str
    r"""JavaScript expression to compute the header's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckAuthRequestParam6TypedDict(TypedDict):
    name: str
    r"""Parameter name."""
    value: str
    r"""JavaScript expression to compute the parameter's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckAuthRequestParam6(BaseModel):
    name: str
    r"""Parameter name."""

    value: str
    r"""JavaScript expression to compute the parameter's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckType6(str, Enum):
    r"""Collector type: health_check"""

    HEALTH_CHECK = "health_check"


class CollectorHealthCheckHealthCheck6TypedDict(TypedDict):
    credentials_secret: str
    r"""Select or create a stored secret that references your login credentials"""
    collect_url: str
    r"""Expression to derive URL to use for the health check operation (can be a constant)."""
    type: CollectorHealthCheckType6
    r"""Collector type: health_check"""
    authentication: NotRequired[CollectorHealthCheckAuthentication6]
    r"""Authentication method for Discover and Collect REST calls. You can specify API Key–based authentication by adding the appropriate Collect headers."""
    discovery: NotRequired[CollectorHealthCheckDiscovery6TypedDict]
    collect_method: NotRequired[HealthCheckMethod6]
    r"""Health check HTTP method."""
    collect_request_params: NotRequired[
        List[CollectorHealthCheckCollectRequestParam6TypedDict]
    ]
    r"""Optional health check request parameters."""
    collect_body: NotRequired[str]
    r"""Template for POST body to send with the health check request. You can reference parameters from the Discover response, using template params of the form: ${variable}."""
    collect_request_headers: NotRequired[
        List[CollectorHealthCheckCollectRequestHeader6TypedDict]
    ]
    r"""Optional health check request headers."""
    authenticate_collect: NotRequired[bool]
    r"""Enable to make auth health check call."""
    timeout: NotRequired[float]
    r"""HTTP request inactivity timeout, use 0 to disable"""
    reject_unauthorized: NotRequired[bool]
    r"""Whether to reject certificates that cannot be verified against a valid CA (e.g., self-signed certificates)."""
    default_breakers: NotRequired[CollectorHealthCheckHiddenDefaultBreakers6]
    safe_headers: NotRequired[List[str]]
    r"""List of headers that are safe to log in plain text."""
    retry_rules: NotRequired[CollectorHealthCheckRetryRules6TypedDict]
    username: NotRequired[str]
    r"""Login username"""
    password: NotRequired[str]
    r"""Login password"""
    login_url: NotRequired[str]
    r"""URL to use for the OAuth API call. This call is expected to be a POST."""
    login_body: NotRequired[str]
    r"""Template for POST body to send with login request, ${username} and ${password} are used to specify location of these attributes in the message"""
    token_resp_attribute: NotRequired[str]
    r"""Path to token attribute in login response body. Nested attributes are OK. Leave blank if the response content type is text/plain; the entire response body will be used to derive the authorization header."""
    auth_header_expr: NotRequired[str]
    r"""JavaScript expression to compute the Authorization header to pass in discover and collect calls. The value ${token} is used to reference the token obtained from login."""
    auth_request_headers: NotRequired[
        List[CollectorHealthCheckAuthRequestHeader6TypedDict]
    ]
    r"""Optional authentication request headers."""
    client_secret_param_name: NotRequired[str]
    r"""Parameter name that contains client secret. Defaults to 'client_secret', and is automatically added to request parameters."""
    client_secret_param_value: NotRequired[str]
    r"""Secret value to add to HTTP requests as the 'client secret' parameter. Stored on disk encrypted, and is automatically added to request parameters"""
    auth_request_params: NotRequired[
        List[CollectorHealthCheckAuthRequestParam6TypedDict]
    ]
    r"""OAuth request parameters added to the POST body. The Content-Type header will automatically be set to application/x-www-form-urlencoded."""
    text_secret: NotRequired[str]
    r"""Select or create a text secret that contains the client secret's value."""


class CollectorHealthCheckHealthCheck6(BaseModel):
    credentials_secret: Annotated[str, pydantic.Field(alias="credentialsSecret")]
    r"""Select or create a stored secret that references your login credentials"""

    collect_url: Annotated[str, pydantic.Field(alias="collectUrl")]
    r"""Expression to derive URL to use for the health check operation (can be a constant)."""

    type: CollectorHealthCheckType6
    r"""Collector type: health_check"""

    authentication: Annotated[
        Optional[CollectorHealthCheckAuthentication6],
        PlainValidator(validate_open_enum(False)),
    ] = CollectorHealthCheckAuthentication6.NONE
    r"""Authentication method for Discover and Collect REST calls. You can specify API Key–based authentication by adding the appropriate Collect headers."""

    discovery: Optional[CollectorHealthCheckDiscovery6] = None

    collect_method: Annotated[
        Annotated[
            Optional[HealthCheckMethod6], PlainValidator(validate_open_enum(False))
        ],
        pydantic.Field(alias="collectMethod"),
    ] = HealthCheckMethod6.GET
    r"""Health check HTTP method."""

    collect_request_params: Annotated[
        Optional[List[CollectorHealthCheckCollectRequestParam6]],
        pydantic.Field(alias="collectRequestParams"),
    ] = None
    r"""Optional health check request parameters."""

    collect_body: Annotated[Optional[str], pydantic.Field(alias="collectBody")] = (
        "`{ }`"
    )
    r"""Template for POST body to send with the health check request. You can reference parameters from the Discover response, using template params of the form: ${variable}."""

    collect_request_headers: Annotated[
        Optional[List[CollectorHealthCheckCollectRequestHeader6]],
        pydantic.Field(alias="collectRequestHeaders"),
    ] = None
    r"""Optional health check request headers."""

    authenticate_collect: Annotated[
        Optional[bool], pydantic.Field(alias="authenticateCollect")
    ] = False
    r"""Enable to make auth health check call."""

    timeout: Optional[float] = 30
    r"""HTTP request inactivity timeout, use 0 to disable"""

    reject_unauthorized: Annotated[
        Optional[bool], pydantic.Field(alias="rejectUnauthorized")
    ] = False
    r"""Whether to reject certificates that cannot be verified against a valid CA (e.g., self-signed certificates)."""

    default_breakers: Annotated[
        Annotated[
            Optional[CollectorHealthCheckHiddenDefaultBreakers6],
            PlainValidator(validate_open_enum(False)),
        ],
        pydantic.Field(alias="defaultBreakers"),
    ] = None

    safe_headers: Annotated[
        Optional[List[str]], pydantic.Field(alias="safeHeaders")
    ] = None
    r"""List of headers that are safe to log in plain text."""

    retry_rules: Annotated[
        Optional[CollectorHealthCheckRetryRules6], pydantic.Field(alias="retryRules")
    ] = None

    username: Optional[str] = None
    r"""Login username"""

    password: Optional[str] = None
    r"""Login password"""

    login_url: Annotated[Optional[str], pydantic.Field(alias="loginUrl")] = ""
    r"""URL to use for the OAuth API call. This call is expected to be a POST."""

    login_body: Annotated[Optional[str], pydantic.Field(alias="loginBody")] = (
        '`{ "username": "${username}", "password": "${password}" }`'
    )
    r"""Template for POST body to send with login request, ${username} and ${password} are used to specify location of these attributes in the message"""

    token_resp_attribute: Annotated[
        Optional[str], pydantic.Field(alias="tokenRespAttribute")
    ] = None
    r"""Path to token attribute in login response body. Nested attributes are OK. Leave blank if the response content type is text/plain; the entire response body will be used to derive the authorization header."""

    auth_header_expr: Annotated[
        Optional[str], pydantic.Field(alias="authHeaderExpr")
    ] = "`Bearer ${token}`"
    r"""JavaScript expression to compute the Authorization header to pass in discover and collect calls. The value ${token} is used to reference the token obtained from login."""

    auth_request_headers: Annotated[
        Optional[List[CollectorHealthCheckAuthRequestHeader6]],
        pydantic.Field(alias="authRequestHeaders"),
    ] = None
    r"""Optional authentication request headers."""

    client_secret_param_name: Annotated[
        Optional[str], pydantic.Field(alias="clientSecretParamName")
    ] = "client_secret"
    r"""Parameter name that contains client secret. Defaults to 'client_secret', and is automatically added to request parameters."""

    client_secret_param_value: Annotated[
        Optional[str], pydantic.Field(alias="clientSecretParamValue")
    ] = None
    r"""Secret value to add to HTTP requests as the 'client secret' parameter. Stored on disk encrypted, and is automatically added to request parameters"""

    auth_request_params: Annotated[
        Optional[List[CollectorHealthCheckAuthRequestParam6]],
        pydantic.Field(alias="authRequestParams"),
    ] = None
    r"""OAuth request parameters added to the POST body. The Content-Type header will automatically be set to application/x-www-form-urlencoded."""

    text_secret: Annotated[Optional[str], pydantic.Field(alias="textSecret")] = None
    r"""Select or create a text secret that contains the client secret's value."""

    @field_serializer("authentication")
    def serialize_authentication(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckAuthentication6(value)
            except ValueError:
                return value
        return value

    @field_serializer("collect_method")
    def serialize_collect_method(self, value):
        if isinstance(value, str):
            try:
                return models.HealthCheckMethod6(value)
            except ValueError:
                return value
        return value

    @field_serializer("default_breakers")
    def serialize_default_breakers(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckHiddenDefaultBreakers6(value)
            except ValueError:
                return value
        return value


class CollectorHealthCheckAuthentication5(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Authentication method for Discover and Collect REST calls. You can specify API Key–based authentication by adding the appropriate Collect headers."""

    NONE = "none"
    BASIC = "basic"
    BASIC_SECRET = "basicSecret"
    LOGIN = "login"
    LOGIN_SECRET = "loginSecret"
    OAUTH = "oauth"
    OAUTH_SECRET = "oauthSecret"


class CollectorHealthCheckDiscoverType5(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Defines how task discovery will be performed. Use None to skip the discovery. Use HTTP Request to make a REST call to discover tasks. Use Item List to enumerate items for collect to retrieve. Use JSON Response to manually define discover tasks as a JSON array of objects. Each entry returned by the discover operation will result in a collect task."""

    # HTTP Request
    HTTP = "http"
    # JSON Response
    JSON = "json"
    # Item List
    LIST = "list"
    # None
    NONE = "none"


class CollectorHealthCheckDiscovery5TypedDict(TypedDict):
    discover_type: NotRequired[CollectorHealthCheckDiscoverType5]
    r"""Defines how task discovery will be performed. Use None to skip the discovery. Use HTTP Request to make a REST call to discover tasks. Use Item List to enumerate items for collect to retrieve. Use JSON Response to manually define discover tasks as a JSON array of objects. Each entry returned by the discover operation will result in a collect task."""


class CollectorHealthCheckDiscovery5(BaseModel):
    discover_type: Annotated[
        Annotated[
            Optional[CollectorHealthCheckDiscoverType5],
            PlainValidator(validate_open_enum(False)),
        ],
        pydantic.Field(alias="discoverType"),
    ] = CollectorHealthCheckDiscoverType5.NONE
    r"""Defines how task discovery will be performed. Use None to skip the discovery. Use HTTP Request to make a REST call to discover tasks. Use Item List to enumerate items for collect to retrieve. Use JSON Response to manually define discover tasks as a JSON array of objects. Each entry returned by the discover operation will result in a collect task."""

    @field_serializer("discover_type")
    def serialize_discover_type(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckDiscoverType5(value)
            except ValueError:
                return value
        return value


class HealthCheckMethod5(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Health check HTTP method."""

    # GET
    GET = "get"
    # POST
    POST = "post"
    # POST with Body
    POST_WITH_BODY = "post_with_body"


class CollectorHealthCheckCollectRequestParam5TypedDict(TypedDict):
    name: str
    r"""Parameter name."""
    value: str
    r"""JavaScript expression to compute the parameter value (can be a constant)."""


class CollectorHealthCheckCollectRequestParam5(BaseModel):
    name: str
    r"""Parameter name."""

    value: str
    r"""JavaScript expression to compute the parameter value (can be a constant)."""


class CollectorHealthCheckCollectRequestHeader5TypedDict(TypedDict):
    name: str
    r"""Header Name"""
    value: str
    r"""JavaScript expression to compute the header value (can be a constant)."""


class CollectorHealthCheckCollectRequestHeader5(BaseModel):
    name: str
    r"""Header Name"""

    value: str
    r"""JavaScript expression to compute the header value (can be a constant)."""


class CollectorHealthCheckHiddenDefaultBreakers5(
    str, Enum, metaclass=utils.OpenEnumMeta
):
    CRIBL = "Cribl"


class CollectorHealthCheckRetryType5(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""The algorithm to use when performing HTTP retries"""

    # Disabled
    NONE = "none"
    # Backoff
    BACKOFF = "backoff"
    # Static
    STATIC = "static"


class CollectorHealthCheckRetryRules5TypedDict(TypedDict):
    type: NotRequired[CollectorHealthCheckRetryType5]
    r"""The algorithm to use when performing HTTP retries"""
    interval: NotRequired[Any]
    limit: NotRequired[Any]
    multiplier: NotRequired[Any]
    codes: NotRequired[Any]
    enable_header: NotRequired[Any]


class CollectorHealthCheckRetryRules5(BaseModel):
    type: Annotated[
        Optional[CollectorHealthCheckRetryType5],
        PlainValidator(validate_open_enum(False)),
    ] = CollectorHealthCheckRetryType5.BACKOFF
    r"""The algorithm to use when performing HTTP retries"""

    interval: Optional[Any] = None

    limit: Optional[Any] = None

    multiplier: Optional[Any] = None

    codes: Optional[Any] = None

    enable_header: Annotated[Optional[Any], pydantic.Field(alias="enableHeader")] = None

    @field_serializer("type")
    def serialize_type(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckRetryType5(value)
            except ValueError:
                return value
        return value


class CollectorHealthCheckAuthRequestHeader5TypedDict(TypedDict):
    name: str
    r"""Header name."""
    value: str
    r"""JavaScript expression to compute the header's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckAuthRequestHeader5(BaseModel):
    name: str
    r"""Header name."""

    value: str
    r"""JavaScript expression to compute the header's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckAuthRequestParam5TypedDict(TypedDict):
    name: str
    r"""Parameter name."""
    value: str
    r"""JavaScript expression to compute the parameter's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckAuthRequestParam5(BaseModel):
    name: str
    r"""Parameter name."""

    value: str
    r"""JavaScript expression to compute the parameter's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckType5(str, Enum):
    r"""Collector type: health_check"""

    HEALTH_CHECK = "health_check"


class CollectorHealthCheckHealthCheck5TypedDict(TypedDict):
    username: str
    r"""Login username"""
    password: str
    r"""Login password"""
    collect_url: str
    r"""Expression to derive URL to use for the health check operation (can be a constant)."""
    type: CollectorHealthCheckType5
    r"""Collector type: health_check"""
    authentication: NotRequired[CollectorHealthCheckAuthentication5]
    r"""Authentication method for Discover and Collect REST calls. You can specify API Key–based authentication by adding the appropriate Collect headers."""
    discovery: NotRequired[CollectorHealthCheckDiscovery5TypedDict]
    collect_method: NotRequired[HealthCheckMethod5]
    r"""Health check HTTP method."""
    collect_request_params: NotRequired[
        List[CollectorHealthCheckCollectRequestParam5TypedDict]
    ]
    r"""Optional health check request parameters."""
    collect_body: NotRequired[str]
    r"""Template for POST body to send with the health check request. You can reference parameters from the Discover response, using template params of the form: ${variable}."""
    collect_request_headers: NotRequired[
        List[CollectorHealthCheckCollectRequestHeader5TypedDict]
    ]
    r"""Optional health check request headers."""
    authenticate_collect: NotRequired[bool]
    r"""Enable to make auth health check call."""
    timeout: NotRequired[float]
    r"""HTTP request inactivity timeout, use 0 to disable"""
    reject_unauthorized: NotRequired[bool]
    r"""Whether to reject certificates that cannot be verified against a valid CA (e.g., self-signed certificates)."""
    default_breakers: NotRequired[CollectorHealthCheckHiddenDefaultBreakers5]
    safe_headers: NotRequired[List[str]]
    r"""List of headers that are safe to log in plain text."""
    retry_rules: NotRequired[CollectorHealthCheckRetryRules5TypedDict]
    credentials_secret: NotRequired[str]
    r"""Select or create a stored secret that references your login credentials"""
    login_url: NotRequired[str]
    r"""URL to use for the OAuth API call. This call is expected to be a POST."""
    login_body: NotRequired[str]
    r"""Template for POST body to send with login request, ${username} and ${password} are used to specify location of these attributes in the message"""
    token_resp_attribute: NotRequired[str]
    r"""Path to token attribute in login response body. Nested attributes are OK. Leave blank if the response content type is text/plain; the entire response body will be used to derive the authorization header."""
    auth_header_expr: NotRequired[str]
    r"""JavaScript expression to compute the Authorization header to pass in discover and collect calls. The value ${token} is used to reference the token obtained from login."""
    auth_request_headers: NotRequired[
        List[CollectorHealthCheckAuthRequestHeader5TypedDict]
    ]
    r"""Optional authentication request headers."""
    client_secret_param_name: NotRequired[str]
    r"""Parameter name that contains client secret. Defaults to 'client_secret', and is automatically added to request parameters."""
    client_secret_param_value: NotRequired[str]
    r"""Secret value to add to HTTP requests as the 'client secret' parameter. Stored on disk encrypted, and is automatically added to request parameters"""
    auth_request_params: NotRequired[
        List[CollectorHealthCheckAuthRequestParam5TypedDict]
    ]
    r"""OAuth request parameters added to the POST body. The Content-Type header will automatically be set to application/x-www-form-urlencoded."""
    text_secret: NotRequired[str]
    r"""Select or create a text secret that contains the client secret's value."""


class CollectorHealthCheckHealthCheck5(BaseModel):
    username: str
    r"""Login username"""

    password: str
    r"""Login password"""

    collect_url: Annotated[str, pydantic.Field(alias="collectUrl")]
    r"""Expression to derive URL to use for the health check operation (can be a constant)."""

    type: CollectorHealthCheckType5
    r"""Collector type: health_check"""

    authentication: Annotated[
        Optional[CollectorHealthCheckAuthentication5],
        PlainValidator(validate_open_enum(False)),
    ] = CollectorHealthCheckAuthentication5.NONE
    r"""Authentication method for Discover and Collect REST calls. You can specify API Key–based authentication by adding the appropriate Collect headers."""

    discovery: Optional[CollectorHealthCheckDiscovery5] = None

    collect_method: Annotated[
        Annotated[
            Optional[HealthCheckMethod5], PlainValidator(validate_open_enum(False))
        ],
        pydantic.Field(alias="collectMethod"),
    ] = HealthCheckMethod5.GET
    r"""Health check HTTP method."""

    collect_request_params: Annotated[
        Optional[List[CollectorHealthCheckCollectRequestParam5]],
        pydantic.Field(alias="collectRequestParams"),
    ] = None
    r"""Optional health check request parameters."""

    collect_body: Annotated[Optional[str], pydantic.Field(alias="collectBody")] = (
        "`{ }`"
    )
    r"""Template for POST body to send with the health check request. You can reference parameters from the Discover response, using template params of the form: ${variable}."""

    collect_request_headers: Annotated[
        Optional[List[CollectorHealthCheckCollectRequestHeader5]],
        pydantic.Field(alias="collectRequestHeaders"),
    ] = None
    r"""Optional health check request headers."""

    authenticate_collect: Annotated[
        Optional[bool], pydantic.Field(alias="authenticateCollect")
    ] = False
    r"""Enable to make auth health check call."""

    timeout: Optional[float] = 30
    r"""HTTP request inactivity timeout, use 0 to disable"""

    reject_unauthorized: Annotated[
        Optional[bool], pydantic.Field(alias="rejectUnauthorized")
    ] = False
    r"""Whether to reject certificates that cannot be verified against a valid CA (e.g., self-signed certificates)."""

    default_breakers: Annotated[
        Annotated[
            Optional[CollectorHealthCheckHiddenDefaultBreakers5],
            PlainValidator(validate_open_enum(False)),
        ],
        pydantic.Field(alias="defaultBreakers"),
    ] = None

    safe_headers: Annotated[
        Optional[List[str]], pydantic.Field(alias="safeHeaders")
    ] = None
    r"""List of headers that are safe to log in plain text."""

    retry_rules: Annotated[
        Optional[CollectorHealthCheckRetryRules5], pydantic.Field(alias="retryRules")
    ] = None

    credentials_secret: Annotated[
        Optional[str], pydantic.Field(alias="credentialsSecret")
    ] = None
    r"""Select or create a stored secret that references your login credentials"""

    login_url: Annotated[Optional[str], pydantic.Field(alias="loginUrl")] = ""
    r"""URL to use for the OAuth API call. This call is expected to be a POST."""

    login_body: Annotated[Optional[str], pydantic.Field(alias="loginBody")] = (
        '`{ "username": "${username}", "password": "${password}" }`'
    )
    r"""Template for POST body to send with login request, ${username} and ${password} are used to specify location of these attributes in the message"""

    token_resp_attribute: Annotated[
        Optional[str], pydantic.Field(alias="tokenRespAttribute")
    ] = None
    r"""Path to token attribute in login response body. Nested attributes are OK. Leave blank if the response content type is text/plain; the entire response body will be used to derive the authorization header."""

    auth_header_expr: Annotated[
        Optional[str], pydantic.Field(alias="authHeaderExpr")
    ] = "`Bearer ${token}`"
    r"""JavaScript expression to compute the Authorization header to pass in discover and collect calls. The value ${token} is used to reference the token obtained from login."""

    auth_request_headers: Annotated[
        Optional[List[CollectorHealthCheckAuthRequestHeader5]],
        pydantic.Field(alias="authRequestHeaders"),
    ] = None
    r"""Optional authentication request headers."""

    client_secret_param_name: Annotated[
        Optional[str], pydantic.Field(alias="clientSecretParamName")
    ] = "client_secret"
    r"""Parameter name that contains client secret. Defaults to 'client_secret', and is automatically added to request parameters."""

    client_secret_param_value: Annotated[
        Optional[str], pydantic.Field(alias="clientSecretParamValue")
    ] = None
    r"""Secret value to add to HTTP requests as the 'client secret' parameter. Stored on disk encrypted, and is automatically added to request parameters"""

    auth_request_params: Annotated[
        Optional[List[CollectorHealthCheckAuthRequestParam5]],
        pydantic.Field(alias="authRequestParams"),
    ] = None
    r"""OAuth request parameters added to the POST body. The Content-Type header will automatically be set to application/x-www-form-urlencoded."""

    text_secret: Annotated[Optional[str], pydantic.Field(alias="textSecret")] = None
    r"""Select or create a text secret that contains the client secret's value."""

    @field_serializer("authentication")
    def serialize_authentication(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckAuthentication5(value)
            except ValueError:
                return value
        return value

    @field_serializer("collect_method")
    def serialize_collect_method(self, value):
        if isinstance(value, str):
            try:
                return models.HealthCheckMethod5(value)
            except ValueError:
                return value
        return value

    @field_serializer("default_breakers")
    def serialize_default_breakers(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckHiddenDefaultBreakers5(value)
            except ValueError:
                return value
        return value


class CollectorHealthCheckAuthentication4(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Authentication method for Discover and Collect REST calls. You can specify API Key–based authentication by adding the appropriate Collect headers."""

    NONE = "none"
    BASIC = "basic"
    BASIC_SECRET = "basicSecret"
    LOGIN = "login"
    LOGIN_SECRET = "loginSecret"
    OAUTH = "oauth"
    OAUTH_SECRET = "oauthSecret"


class CollectorHealthCheckDiscoverType4(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Defines how task discovery will be performed. Use None to skip the discovery. Use HTTP Request to make a REST call to discover tasks. Use Item List to enumerate items for collect to retrieve. Use JSON Response to manually define discover tasks as a JSON array of objects. Each entry returned by the discover operation will result in a collect task."""

    # HTTP Request
    HTTP = "http"
    # JSON Response
    JSON = "json"
    # Item List
    LIST = "list"
    # None
    NONE = "none"


class CollectorHealthCheckDiscovery4TypedDict(TypedDict):
    discover_type: NotRequired[CollectorHealthCheckDiscoverType4]
    r"""Defines how task discovery will be performed. Use None to skip the discovery. Use HTTP Request to make a REST call to discover tasks. Use Item List to enumerate items for collect to retrieve. Use JSON Response to manually define discover tasks as a JSON array of objects. Each entry returned by the discover operation will result in a collect task."""


class CollectorHealthCheckDiscovery4(BaseModel):
    discover_type: Annotated[
        Annotated[
            Optional[CollectorHealthCheckDiscoverType4],
            PlainValidator(validate_open_enum(False)),
        ],
        pydantic.Field(alias="discoverType"),
    ] = CollectorHealthCheckDiscoverType4.NONE
    r"""Defines how task discovery will be performed. Use None to skip the discovery. Use HTTP Request to make a REST call to discover tasks. Use Item List to enumerate items for collect to retrieve. Use JSON Response to manually define discover tasks as a JSON array of objects. Each entry returned by the discover operation will result in a collect task."""

    @field_serializer("discover_type")
    def serialize_discover_type(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckDiscoverType4(value)
            except ValueError:
                return value
        return value


class HealthCheckMethod4(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Health check HTTP method."""

    # GET
    GET = "get"
    # POST
    POST = "post"
    # POST with Body
    POST_WITH_BODY = "post_with_body"


class CollectorHealthCheckCollectRequestParam4TypedDict(TypedDict):
    name: str
    r"""Parameter name."""
    value: str
    r"""JavaScript expression to compute the parameter value (can be a constant)."""


class CollectorHealthCheckCollectRequestParam4(BaseModel):
    name: str
    r"""Parameter name."""

    value: str
    r"""JavaScript expression to compute the parameter value (can be a constant)."""


class CollectorHealthCheckCollectRequestHeader4TypedDict(TypedDict):
    name: str
    r"""Header Name"""
    value: str
    r"""JavaScript expression to compute the header value (can be a constant)."""


class CollectorHealthCheckCollectRequestHeader4(BaseModel):
    name: str
    r"""Header Name"""

    value: str
    r"""JavaScript expression to compute the header value (can be a constant)."""


class CollectorHealthCheckHiddenDefaultBreakers4(
    str, Enum, metaclass=utils.OpenEnumMeta
):
    CRIBL = "Cribl"


class CollectorHealthCheckRetryType4(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""The algorithm to use when performing HTTP retries"""

    # Disabled
    NONE = "none"
    # Backoff
    BACKOFF = "backoff"
    # Static
    STATIC = "static"


class CollectorHealthCheckRetryRules4TypedDict(TypedDict):
    type: NotRequired[CollectorHealthCheckRetryType4]
    r"""The algorithm to use when performing HTTP retries"""
    interval: NotRequired[Any]
    limit: NotRequired[Any]
    multiplier: NotRequired[Any]
    codes: NotRequired[Any]
    enable_header: NotRequired[Any]


class CollectorHealthCheckRetryRules4(BaseModel):
    type: Annotated[
        Optional[CollectorHealthCheckRetryType4],
        PlainValidator(validate_open_enum(False)),
    ] = CollectorHealthCheckRetryType4.BACKOFF
    r"""The algorithm to use when performing HTTP retries"""

    interval: Optional[Any] = None

    limit: Optional[Any] = None

    multiplier: Optional[Any] = None

    codes: Optional[Any] = None

    enable_header: Annotated[Optional[Any], pydantic.Field(alias="enableHeader")] = None

    @field_serializer("type")
    def serialize_type(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckRetryType4(value)
            except ValueError:
                return value
        return value


class CollectorHealthCheckAuthRequestHeader4TypedDict(TypedDict):
    name: str
    r"""Header name."""
    value: str
    r"""JavaScript expression to compute the header's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckAuthRequestHeader4(BaseModel):
    name: str
    r"""Header name."""

    value: str
    r"""JavaScript expression to compute the header's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckAuthRequestParam4TypedDict(TypedDict):
    name: str
    r"""Parameter name."""
    value: str
    r"""JavaScript expression to compute the parameter's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckAuthRequestParam4(BaseModel):
    name: str
    r"""Parameter name."""

    value: str
    r"""JavaScript expression to compute the parameter's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckType4(str, Enum):
    r"""Collector type: health_check"""

    HEALTH_CHECK = "health_check"


class CollectorHealthCheckHealthCheck4TypedDict(TypedDict):
    collect_url: str
    r"""Expression to derive URL to use for the health check operation (can be a constant)."""
    type: CollectorHealthCheckType4
    r"""Collector type: health_check"""
    authentication: NotRequired[CollectorHealthCheckAuthentication4]
    r"""Authentication method for Discover and Collect REST calls. You can specify API Key–based authentication by adding the appropriate Collect headers."""
    discovery: NotRequired[CollectorHealthCheckDiscovery4TypedDict]
    collect_method: NotRequired[HealthCheckMethod4]
    r"""Health check HTTP method."""
    collect_request_params: NotRequired[
        List[CollectorHealthCheckCollectRequestParam4TypedDict]
    ]
    r"""Optional health check request parameters."""
    collect_body: NotRequired[str]
    r"""Template for POST body to send with the health check request. You can reference parameters from the Discover response, using template params of the form: ${variable}."""
    collect_request_headers: NotRequired[
        List[CollectorHealthCheckCollectRequestHeader4TypedDict]
    ]
    r"""Optional health check request headers."""
    authenticate_collect: NotRequired[bool]
    r"""Enable to make auth health check call."""
    timeout: NotRequired[float]
    r"""HTTP request inactivity timeout, use 0 to disable"""
    reject_unauthorized: NotRequired[bool]
    r"""Whether to reject certificates that cannot be verified against a valid CA (e.g., self-signed certificates)."""
    default_breakers: NotRequired[CollectorHealthCheckHiddenDefaultBreakers4]
    safe_headers: NotRequired[List[str]]
    r"""List of headers that are safe to log in plain text."""
    retry_rules: NotRequired[CollectorHealthCheckRetryRules4TypedDict]
    username: NotRequired[str]
    r"""Login username"""
    password: NotRequired[str]
    r"""Login password"""
    credentials_secret: NotRequired[str]
    r"""Select or create a stored secret that references your login credentials"""
    login_url: NotRequired[str]
    r"""URL to use for the OAuth API call. This call is expected to be a POST."""
    login_body: NotRequired[str]
    r"""Template for POST body to send with login request, ${username} and ${password} are used to specify location of these attributes in the message"""
    token_resp_attribute: NotRequired[str]
    r"""Path to token attribute in login response body. Nested attributes are OK. Leave blank if the response content type is text/plain; the entire response body will be used to derive the authorization header."""
    auth_header_expr: NotRequired[str]
    r"""JavaScript expression to compute the Authorization header to pass in discover and collect calls. The value ${token} is used to reference the token obtained from login."""
    auth_request_headers: NotRequired[
        List[CollectorHealthCheckAuthRequestHeader4TypedDict]
    ]
    r"""Optional authentication request headers."""
    client_secret_param_name: NotRequired[str]
    r"""Parameter name that contains client secret. Defaults to 'client_secret', and is automatically added to request parameters."""
    client_secret_param_value: NotRequired[str]
    r"""Secret value to add to HTTP requests as the 'client secret' parameter. Stored on disk encrypted, and is automatically added to request parameters"""
    auth_request_params: NotRequired[
        List[CollectorHealthCheckAuthRequestParam4TypedDict]
    ]
    r"""OAuth request parameters added to the POST body. The Content-Type header will automatically be set to application/x-www-form-urlencoded."""
    text_secret: NotRequired[str]
    r"""Select or create a text secret that contains the client secret's value."""


class CollectorHealthCheckHealthCheck4(BaseModel):
    collect_url: Annotated[str, pydantic.Field(alias="collectUrl")]
    r"""Expression to derive URL to use for the health check operation (can be a constant)."""

    type: CollectorHealthCheckType4
    r"""Collector type: health_check"""

    authentication: Annotated[
        Optional[CollectorHealthCheckAuthentication4],
        PlainValidator(validate_open_enum(False)),
    ] = CollectorHealthCheckAuthentication4.NONE
    r"""Authentication method for Discover and Collect REST calls. You can specify API Key–based authentication by adding the appropriate Collect headers."""

    discovery: Optional[CollectorHealthCheckDiscovery4] = None

    collect_method: Annotated[
        Annotated[
            Optional[HealthCheckMethod4], PlainValidator(validate_open_enum(False))
        ],
        pydantic.Field(alias="collectMethod"),
    ] = HealthCheckMethod4.GET
    r"""Health check HTTP method."""

    collect_request_params: Annotated[
        Optional[List[CollectorHealthCheckCollectRequestParam4]],
        pydantic.Field(alias="collectRequestParams"),
    ] = None
    r"""Optional health check request parameters."""

    collect_body: Annotated[Optional[str], pydantic.Field(alias="collectBody")] = (
        "`{ }`"
    )
    r"""Template for POST body to send with the health check request. You can reference parameters from the Discover response, using template params of the form: ${variable}."""

    collect_request_headers: Annotated[
        Optional[List[CollectorHealthCheckCollectRequestHeader4]],
        pydantic.Field(alias="collectRequestHeaders"),
    ] = None
    r"""Optional health check request headers."""

    authenticate_collect: Annotated[
        Optional[bool], pydantic.Field(alias="authenticateCollect")
    ] = False
    r"""Enable to make auth health check call."""

    timeout: Optional[float] = 30
    r"""HTTP request inactivity timeout, use 0 to disable"""

    reject_unauthorized: Annotated[
        Optional[bool], pydantic.Field(alias="rejectUnauthorized")
    ] = False
    r"""Whether to reject certificates that cannot be verified against a valid CA (e.g., self-signed certificates)."""

    default_breakers: Annotated[
        Annotated[
            Optional[CollectorHealthCheckHiddenDefaultBreakers4],
            PlainValidator(validate_open_enum(False)),
        ],
        pydantic.Field(alias="defaultBreakers"),
    ] = None

    safe_headers: Annotated[
        Optional[List[str]], pydantic.Field(alias="safeHeaders")
    ] = None
    r"""List of headers that are safe to log in plain text."""

    retry_rules: Annotated[
        Optional[CollectorHealthCheckRetryRules4], pydantic.Field(alias="retryRules")
    ] = None

    username: Optional[str] = None
    r"""Login username"""

    password: Optional[str] = None
    r"""Login password"""

    credentials_secret: Annotated[
        Optional[str], pydantic.Field(alias="credentialsSecret")
    ] = None
    r"""Select or create a stored secret that references your login credentials"""

    login_url: Annotated[Optional[str], pydantic.Field(alias="loginUrl")] = ""
    r"""URL to use for the OAuth API call. This call is expected to be a POST."""

    login_body: Annotated[Optional[str], pydantic.Field(alias="loginBody")] = (
        '`{ "username": "${username}", "password": "${password}" }`'
    )
    r"""Template for POST body to send with login request, ${username} and ${password} are used to specify location of these attributes in the message"""

    token_resp_attribute: Annotated[
        Optional[str], pydantic.Field(alias="tokenRespAttribute")
    ] = None
    r"""Path to token attribute in login response body. Nested attributes are OK. Leave blank if the response content type is text/plain; the entire response body will be used to derive the authorization header."""

    auth_header_expr: Annotated[
        Optional[str], pydantic.Field(alias="authHeaderExpr")
    ] = "`Bearer ${token}`"
    r"""JavaScript expression to compute the Authorization header to pass in discover and collect calls. The value ${token} is used to reference the token obtained from login."""

    auth_request_headers: Annotated[
        Optional[List[CollectorHealthCheckAuthRequestHeader4]],
        pydantic.Field(alias="authRequestHeaders"),
    ] = None
    r"""Optional authentication request headers."""

    client_secret_param_name: Annotated[
        Optional[str], pydantic.Field(alias="clientSecretParamName")
    ] = "client_secret"
    r"""Parameter name that contains client secret. Defaults to 'client_secret', and is automatically added to request parameters."""

    client_secret_param_value: Annotated[
        Optional[str], pydantic.Field(alias="clientSecretParamValue")
    ] = None
    r"""Secret value to add to HTTP requests as the 'client secret' parameter. Stored on disk encrypted, and is automatically added to request parameters"""

    auth_request_params: Annotated[
        Optional[List[CollectorHealthCheckAuthRequestParam4]],
        pydantic.Field(alias="authRequestParams"),
    ] = None
    r"""OAuth request parameters added to the POST body. The Content-Type header will automatically be set to application/x-www-form-urlencoded."""

    text_secret: Annotated[Optional[str], pydantic.Field(alias="textSecret")] = None
    r"""Select or create a text secret that contains the client secret's value."""

    @field_serializer("authentication")
    def serialize_authentication(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckAuthentication4(value)
            except ValueError:
                return value
        return value

    @field_serializer("collect_method")
    def serialize_collect_method(self, value):
        if isinstance(value, str):
            try:
                return models.HealthCheckMethod4(value)
            except ValueError:
                return value
        return value

    @field_serializer("default_breakers")
    def serialize_default_breakers(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckHiddenDefaultBreakers4(value)
            except ValueError:
                return value
        return value


class HealthCheckMethod3(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Health check HTTP method."""

    # GET
    GET = "get"
    # POST
    POST = "post"
    # POST with Body
    POST_WITH_BODY = "post_with_body"


class CollectorHealthCheckDiscoverType3(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Defines how task discovery will be performed. Use None to skip the discovery. Use HTTP Request to make a REST call to discover tasks. Use Item List to enumerate items for collect to retrieve. Use JSON Response to manually define discover tasks as a JSON array of objects. Each entry returned by the discover operation will result in a collect task."""

    # HTTP Request
    HTTP = "http"
    # JSON Response
    JSON = "json"
    # Item List
    LIST = "list"
    # None
    NONE = "none"


class CollectorHealthCheckDiscovery3TypedDict(TypedDict):
    discover_type: NotRequired[CollectorHealthCheckDiscoverType3]
    r"""Defines how task discovery will be performed. Use None to skip the discovery. Use HTTP Request to make a REST call to discover tasks. Use Item List to enumerate items for collect to retrieve. Use JSON Response to manually define discover tasks as a JSON array of objects. Each entry returned by the discover operation will result in a collect task."""


class CollectorHealthCheckDiscovery3(BaseModel):
    discover_type: Annotated[
        Annotated[
            Optional[CollectorHealthCheckDiscoverType3],
            PlainValidator(validate_open_enum(False)),
        ],
        pydantic.Field(alias="discoverType"),
    ] = CollectorHealthCheckDiscoverType3.NONE
    r"""Defines how task discovery will be performed. Use None to skip the discovery. Use HTTP Request to make a REST call to discover tasks. Use Item List to enumerate items for collect to retrieve. Use JSON Response to manually define discover tasks as a JSON array of objects. Each entry returned by the discover operation will result in a collect task."""

    @field_serializer("discover_type")
    def serialize_discover_type(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckDiscoverType3(value)
            except ValueError:
                return value
        return value


class CollectorHealthCheckCollectRequestParam3TypedDict(TypedDict):
    name: str
    r"""Parameter name."""
    value: str
    r"""JavaScript expression to compute the parameter value (can be a constant)."""


class CollectorHealthCheckCollectRequestParam3(BaseModel):
    name: str
    r"""Parameter name."""

    value: str
    r"""JavaScript expression to compute the parameter value (can be a constant)."""


class CollectorHealthCheckCollectRequestHeader3TypedDict(TypedDict):
    name: str
    r"""Header Name"""
    value: str
    r"""JavaScript expression to compute the header value (can be a constant)."""


class CollectorHealthCheckCollectRequestHeader3(BaseModel):
    name: str
    r"""Header Name"""

    value: str
    r"""JavaScript expression to compute the header value (can be a constant)."""


class CollectorHealthCheckAuthentication3(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Authentication method for Discover and Collect REST calls. You can specify API Key–based authentication by adding the appropriate Collect headers."""

    NONE = "none"
    BASIC = "basic"
    BASIC_SECRET = "basicSecret"
    LOGIN = "login"
    LOGIN_SECRET = "loginSecret"
    OAUTH = "oauth"
    OAUTH_SECRET = "oauthSecret"


class CollectorHealthCheckHiddenDefaultBreakers3(
    str, Enum, metaclass=utils.OpenEnumMeta
):
    CRIBL = "Cribl"


class CollectorHealthCheckRetryType3(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""The algorithm to use when performing HTTP retries"""

    # Disabled
    NONE = "none"
    # Backoff
    BACKOFF = "backoff"
    # Static
    STATIC = "static"


class CollectorHealthCheckRetryRules3TypedDict(TypedDict):
    type: NotRequired[CollectorHealthCheckRetryType3]
    r"""The algorithm to use when performing HTTP retries"""
    interval: NotRequired[Any]
    limit: NotRequired[Any]
    multiplier: NotRequired[Any]
    codes: NotRequired[Any]
    enable_header: NotRequired[Any]


class CollectorHealthCheckRetryRules3(BaseModel):
    type: Annotated[
        Optional[CollectorHealthCheckRetryType3],
        PlainValidator(validate_open_enum(False)),
    ] = CollectorHealthCheckRetryType3.BACKOFF
    r"""The algorithm to use when performing HTTP retries"""

    interval: Optional[Any] = None

    limit: Optional[Any] = None

    multiplier: Optional[Any] = None

    codes: Optional[Any] = None

    enable_header: Annotated[Optional[Any], pydantic.Field(alias="enableHeader")] = None

    @field_serializer("type")
    def serialize_type(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckRetryType3(value)
            except ValueError:
                return value
        return value


class CollectorHealthCheckAuthRequestHeader3TypedDict(TypedDict):
    name: str
    r"""Header name."""
    value: str
    r"""JavaScript expression to compute the header's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckAuthRequestHeader3(BaseModel):
    name: str
    r"""Header name."""

    value: str
    r"""JavaScript expression to compute the header's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckAuthRequestParam3TypedDict(TypedDict):
    name: str
    r"""Parameter name."""
    value: str
    r"""JavaScript expression to compute the parameter's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckAuthRequestParam3(BaseModel):
    name: str
    r"""Parameter name."""

    value: str
    r"""JavaScript expression to compute the parameter's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckType3(str, Enum):
    r"""Collector type: health_check"""

    HEALTH_CHECK = "health_check"


class CollectorHealthCheckHealthCheck3TypedDict(TypedDict):
    collect_url: str
    r"""Expression to derive URL to use for the health check operation (can be a constant)."""
    type: CollectorHealthCheckType3
    r"""Collector type: health_check"""
    collect_method: NotRequired[HealthCheckMethod3]
    r"""Health check HTTP method."""
    collect_body: NotRequired[str]
    r"""Template for POST body to send with the health check request. You can reference parameters from the Discover response, using template params of the form: ${variable}."""
    discovery: NotRequired[CollectorHealthCheckDiscovery3TypedDict]
    collect_request_params: NotRequired[
        List[CollectorHealthCheckCollectRequestParam3TypedDict]
    ]
    r"""Optional health check request parameters."""
    collect_request_headers: NotRequired[
        List[CollectorHealthCheckCollectRequestHeader3TypedDict]
    ]
    r"""Optional health check request headers."""
    authenticate_collect: NotRequired[bool]
    r"""Enable to make auth health check call."""
    authentication: NotRequired[CollectorHealthCheckAuthentication3]
    r"""Authentication method for Discover and Collect REST calls. You can specify API Key–based authentication by adding the appropriate Collect headers."""
    timeout: NotRequired[float]
    r"""HTTP request inactivity timeout, use 0 to disable"""
    reject_unauthorized: NotRequired[bool]
    r"""Whether to reject certificates that cannot be verified against a valid CA (e.g., self-signed certificates)."""
    default_breakers: NotRequired[CollectorHealthCheckHiddenDefaultBreakers3]
    safe_headers: NotRequired[List[str]]
    r"""List of headers that are safe to log in plain text."""
    retry_rules: NotRequired[CollectorHealthCheckRetryRules3TypedDict]
    username: NotRequired[str]
    r"""Login username"""
    password: NotRequired[str]
    r"""Login password"""
    credentials_secret: NotRequired[str]
    r"""Select or create a stored secret that references your login credentials"""
    login_url: NotRequired[str]
    r"""URL to use for the OAuth API call. This call is expected to be a POST."""
    login_body: NotRequired[str]
    r"""Template for POST body to send with login request, ${username} and ${password} are used to specify location of these attributes in the message"""
    token_resp_attribute: NotRequired[str]
    r"""Path to token attribute in login response body. Nested attributes are OK. Leave blank if the response content type is text/plain; the entire response body will be used to derive the authorization header."""
    auth_header_expr: NotRequired[str]
    r"""JavaScript expression to compute the Authorization header to pass in discover and collect calls. The value ${token} is used to reference the token obtained from login."""
    auth_request_headers: NotRequired[
        List[CollectorHealthCheckAuthRequestHeader3TypedDict]
    ]
    r"""Optional authentication request headers."""
    client_secret_param_name: NotRequired[str]
    r"""Parameter name that contains client secret. Defaults to 'client_secret', and is automatically added to request parameters."""
    client_secret_param_value: NotRequired[str]
    r"""Secret value to add to HTTP requests as the 'client secret' parameter. Stored on disk encrypted, and is automatically added to request parameters"""
    auth_request_params: NotRequired[
        List[CollectorHealthCheckAuthRequestParam3TypedDict]
    ]
    r"""OAuth request parameters added to the POST body. The Content-Type header will automatically be set to application/x-www-form-urlencoded."""
    text_secret: NotRequired[str]
    r"""Select or create a text secret that contains the client secret's value."""


class CollectorHealthCheckHealthCheck3(BaseModel):
    collect_url: Annotated[str, pydantic.Field(alias="collectUrl")]
    r"""Expression to derive URL to use for the health check operation (can be a constant)."""

    type: CollectorHealthCheckType3
    r"""Collector type: health_check"""

    collect_method: Annotated[
        Annotated[
            Optional[HealthCheckMethod3], PlainValidator(validate_open_enum(False))
        ],
        pydantic.Field(alias="collectMethod"),
    ] = HealthCheckMethod3.GET
    r"""Health check HTTP method."""

    collect_body: Annotated[Optional[str], pydantic.Field(alias="collectBody")] = (
        "`{ }`"
    )
    r"""Template for POST body to send with the health check request. You can reference parameters from the Discover response, using template params of the form: ${variable}."""

    discovery: Optional[CollectorHealthCheckDiscovery3] = None

    collect_request_params: Annotated[
        Optional[List[CollectorHealthCheckCollectRequestParam3]],
        pydantic.Field(alias="collectRequestParams"),
    ] = None
    r"""Optional health check request parameters."""

    collect_request_headers: Annotated[
        Optional[List[CollectorHealthCheckCollectRequestHeader3]],
        pydantic.Field(alias="collectRequestHeaders"),
    ] = None
    r"""Optional health check request headers."""

    authenticate_collect: Annotated[
        Optional[bool], pydantic.Field(alias="authenticateCollect")
    ] = False
    r"""Enable to make auth health check call."""

    authentication: Annotated[
        Optional[CollectorHealthCheckAuthentication3],
        PlainValidator(validate_open_enum(False)),
    ] = CollectorHealthCheckAuthentication3.NONE
    r"""Authentication method for Discover and Collect REST calls. You can specify API Key–based authentication by adding the appropriate Collect headers."""

    timeout: Optional[float] = 30
    r"""HTTP request inactivity timeout, use 0 to disable"""

    reject_unauthorized: Annotated[
        Optional[bool], pydantic.Field(alias="rejectUnauthorized")
    ] = False
    r"""Whether to reject certificates that cannot be verified against a valid CA (e.g., self-signed certificates)."""

    default_breakers: Annotated[
        Annotated[
            Optional[CollectorHealthCheckHiddenDefaultBreakers3],
            PlainValidator(validate_open_enum(False)),
        ],
        pydantic.Field(alias="defaultBreakers"),
    ] = None

    safe_headers: Annotated[
        Optional[List[str]], pydantic.Field(alias="safeHeaders")
    ] = None
    r"""List of headers that are safe to log in plain text."""

    retry_rules: Annotated[
        Optional[CollectorHealthCheckRetryRules3], pydantic.Field(alias="retryRules")
    ] = None

    username: Optional[str] = None
    r"""Login username"""

    password: Optional[str] = None
    r"""Login password"""

    credentials_secret: Annotated[
        Optional[str], pydantic.Field(alias="credentialsSecret")
    ] = None
    r"""Select or create a stored secret that references your login credentials"""

    login_url: Annotated[Optional[str], pydantic.Field(alias="loginUrl")] = ""
    r"""URL to use for the OAuth API call. This call is expected to be a POST."""

    login_body: Annotated[Optional[str], pydantic.Field(alias="loginBody")] = (
        '`{ "username": "${username}", "password": "${password}" }`'
    )
    r"""Template for POST body to send with login request, ${username} and ${password} are used to specify location of these attributes in the message"""

    token_resp_attribute: Annotated[
        Optional[str], pydantic.Field(alias="tokenRespAttribute")
    ] = None
    r"""Path to token attribute in login response body. Nested attributes are OK. Leave blank if the response content type is text/plain; the entire response body will be used to derive the authorization header."""

    auth_header_expr: Annotated[
        Optional[str], pydantic.Field(alias="authHeaderExpr")
    ] = "`Bearer ${token}`"
    r"""JavaScript expression to compute the Authorization header to pass in discover and collect calls. The value ${token} is used to reference the token obtained from login."""

    auth_request_headers: Annotated[
        Optional[List[CollectorHealthCheckAuthRequestHeader3]],
        pydantic.Field(alias="authRequestHeaders"),
    ] = None
    r"""Optional authentication request headers."""

    client_secret_param_name: Annotated[
        Optional[str], pydantic.Field(alias="clientSecretParamName")
    ] = "client_secret"
    r"""Parameter name that contains client secret. Defaults to 'client_secret', and is automatically added to request parameters."""

    client_secret_param_value: Annotated[
        Optional[str], pydantic.Field(alias="clientSecretParamValue")
    ] = None
    r"""Secret value to add to HTTP requests as the 'client secret' parameter. Stored on disk encrypted, and is automatically added to request parameters"""

    auth_request_params: Annotated[
        Optional[List[CollectorHealthCheckAuthRequestParam3]],
        pydantic.Field(alias="authRequestParams"),
    ] = None
    r"""OAuth request parameters added to the POST body. The Content-Type header will automatically be set to application/x-www-form-urlencoded."""

    text_secret: Annotated[Optional[str], pydantic.Field(alias="textSecret")] = None
    r"""Select or create a text secret that contains the client secret's value."""

    @field_serializer("collect_method")
    def serialize_collect_method(self, value):
        if isinstance(value, str):
            try:
                return models.HealthCheckMethod3(value)
            except ValueError:
                return value
        return value

    @field_serializer("authentication")
    def serialize_authentication(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckAuthentication3(value)
            except ValueError:
                return value
        return value

    @field_serializer("default_breakers")
    def serialize_default_breakers(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckHiddenDefaultBreakers3(value)
            except ValueError:
                return value
        return value


class HealthCheckMethod2(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Health check HTTP method."""

    # GET
    GET = "get"
    # POST
    POST = "post"
    # POST with Body
    POST_WITH_BODY = "post_with_body"


class CollectorHealthCheckCollectRequestParam2TypedDict(TypedDict):
    name: str
    r"""Parameter name."""
    value: str
    r"""JavaScript expression to compute the parameter value (can be a constant)."""


class CollectorHealthCheckCollectRequestParam2(BaseModel):
    name: str
    r"""Parameter name."""

    value: str
    r"""JavaScript expression to compute the parameter value (can be a constant)."""


class CollectorHealthCheckDiscoverType2(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Defines how task discovery will be performed. Use None to skip the discovery. Use HTTP Request to make a REST call to discover tasks. Use Item List to enumerate items for collect to retrieve. Use JSON Response to manually define discover tasks as a JSON array of objects. Each entry returned by the discover operation will result in a collect task."""

    # HTTP Request
    HTTP = "http"
    # JSON Response
    JSON = "json"
    # Item List
    LIST = "list"
    # None
    NONE = "none"


class CollectorHealthCheckDiscovery2TypedDict(TypedDict):
    discover_type: NotRequired[CollectorHealthCheckDiscoverType2]
    r"""Defines how task discovery will be performed. Use None to skip the discovery. Use HTTP Request to make a REST call to discover tasks. Use Item List to enumerate items for collect to retrieve. Use JSON Response to manually define discover tasks as a JSON array of objects. Each entry returned by the discover operation will result in a collect task."""


class CollectorHealthCheckDiscovery2(BaseModel):
    discover_type: Annotated[
        Annotated[
            Optional[CollectorHealthCheckDiscoverType2],
            PlainValidator(validate_open_enum(False)),
        ],
        pydantic.Field(alias="discoverType"),
    ] = CollectorHealthCheckDiscoverType2.NONE
    r"""Defines how task discovery will be performed. Use None to skip the discovery. Use HTTP Request to make a REST call to discover tasks. Use Item List to enumerate items for collect to retrieve. Use JSON Response to manually define discover tasks as a JSON array of objects. Each entry returned by the discover operation will result in a collect task."""

    @field_serializer("discover_type")
    def serialize_discover_type(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckDiscoverType2(value)
            except ValueError:
                return value
        return value


class CollectorHealthCheckCollectRequestHeader2TypedDict(TypedDict):
    name: str
    r"""Header Name"""
    value: str
    r"""JavaScript expression to compute the header value (can be a constant)."""


class CollectorHealthCheckCollectRequestHeader2(BaseModel):
    name: str
    r"""Header Name"""

    value: str
    r"""JavaScript expression to compute the header value (can be a constant)."""


class CollectorHealthCheckAuthentication2(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Authentication method for Discover and Collect REST calls. You can specify API Key–based authentication by adding the appropriate Collect headers."""

    NONE = "none"
    BASIC = "basic"
    BASIC_SECRET = "basicSecret"
    LOGIN = "login"
    LOGIN_SECRET = "loginSecret"
    OAUTH = "oauth"
    OAUTH_SECRET = "oauthSecret"


class CollectorHealthCheckHiddenDefaultBreakers2(
    str, Enum, metaclass=utils.OpenEnumMeta
):
    CRIBL = "Cribl"


class CollectorHealthCheckRetryType2(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""The algorithm to use when performing HTTP retries"""

    # Disabled
    NONE = "none"
    # Backoff
    BACKOFF = "backoff"
    # Static
    STATIC = "static"


class CollectorHealthCheckRetryRules2TypedDict(TypedDict):
    type: NotRequired[CollectorHealthCheckRetryType2]
    r"""The algorithm to use when performing HTTP retries"""
    interval: NotRequired[Any]
    limit: NotRequired[Any]
    multiplier: NotRequired[Any]
    codes: NotRequired[Any]
    enable_header: NotRequired[Any]


class CollectorHealthCheckRetryRules2(BaseModel):
    type: Annotated[
        Optional[CollectorHealthCheckRetryType2],
        PlainValidator(validate_open_enum(False)),
    ] = CollectorHealthCheckRetryType2.BACKOFF
    r"""The algorithm to use when performing HTTP retries"""

    interval: Optional[Any] = None

    limit: Optional[Any] = None

    multiplier: Optional[Any] = None

    codes: Optional[Any] = None

    enable_header: Annotated[Optional[Any], pydantic.Field(alias="enableHeader")] = None

    @field_serializer("type")
    def serialize_type(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckRetryType2(value)
            except ValueError:
                return value
        return value


class CollectorHealthCheckAuthRequestHeader2TypedDict(TypedDict):
    name: str
    r"""Header name."""
    value: str
    r"""JavaScript expression to compute the header's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckAuthRequestHeader2(BaseModel):
    name: str
    r"""Header name."""

    value: str
    r"""JavaScript expression to compute the header's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckAuthRequestParam2TypedDict(TypedDict):
    name: str
    r"""Parameter name."""
    value: str
    r"""JavaScript expression to compute the parameter's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckAuthRequestParam2(BaseModel):
    name: str
    r"""Parameter name."""

    value: str
    r"""JavaScript expression to compute the parameter's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckType2(str, Enum):
    r"""Collector type: health_check"""

    HEALTH_CHECK = "health_check"


class CollectorHealthCheckHealthCheck2TypedDict(TypedDict):
    collect_url: str
    r"""Expression to derive URL to use for the health check operation (can be a constant)."""
    type: CollectorHealthCheckType2
    r"""Collector type: health_check"""
    collect_method: NotRequired[HealthCheckMethod2]
    r"""Health check HTTP method."""
    collect_request_params: NotRequired[
        List[CollectorHealthCheckCollectRequestParam2TypedDict]
    ]
    r"""Optional health check request parameters."""
    discovery: NotRequired[CollectorHealthCheckDiscovery2TypedDict]
    collect_body: NotRequired[str]
    r"""Template for POST body to send with the health check request. You can reference parameters from the Discover response, using template params of the form: ${variable}."""
    collect_request_headers: NotRequired[
        List[CollectorHealthCheckCollectRequestHeader2TypedDict]
    ]
    r"""Optional health check request headers."""
    authenticate_collect: NotRequired[bool]
    r"""Enable to make auth health check call."""
    authentication: NotRequired[CollectorHealthCheckAuthentication2]
    r"""Authentication method for Discover and Collect REST calls. You can specify API Key–based authentication by adding the appropriate Collect headers."""
    timeout: NotRequired[float]
    r"""HTTP request inactivity timeout, use 0 to disable"""
    reject_unauthorized: NotRequired[bool]
    r"""Whether to reject certificates that cannot be verified against a valid CA (e.g., self-signed certificates)."""
    default_breakers: NotRequired[CollectorHealthCheckHiddenDefaultBreakers2]
    safe_headers: NotRequired[List[str]]
    r"""List of headers that are safe to log in plain text."""
    retry_rules: NotRequired[CollectorHealthCheckRetryRules2TypedDict]
    username: NotRequired[str]
    r"""Login username"""
    password: NotRequired[str]
    r"""Login password"""
    credentials_secret: NotRequired[str]
    r"""Select or create a stored secret that references your login credentials"""
    login_url: NotRequired[str]
    r"""URL to use for the OAuth API call. This call is expected to be a POST."""
    login_body: NotRequired[str]
    r"""Template for POST body to send with login request, ${username} and ${password} are used to specify location of these attributes in the message"""
    token_resp_attribute: NotRequired[str]
    r"""Path to token attribute in login response body. Nested attributes are OK. Leave blank if the response content type is text/plain; the entire response body will be used to derive the authorization header."""
    auth_header_expr: NotRequired[str]
    r"""JavaScript expression to compute the Authorization header to pass in discover and collect calls. The value ${token} is used to reference the token obtained from login."""
    auth_request_headers: NotRequired[
        List[CollectorHealthCheckAuthRequestHeader2TypedDict]
    ]
    r"""Optional authentication request headers."""
    client_secret_param_name: NotRequired[str]
    r"""Parameter name that contains client secret. Defaults to 'client_secret', and is automatically added to request parameters."""
    client_secret_param_value: NotRequired[str]
    r"""Secret value to add to HTTP requests as the 'client secret' parameter. Stored on disk encrypted, and is automatically added to request parameters"""
    auth_request_params: NotRequired[
        List[CollectorHealthCheckAuthRequestParam2TypedDict]
    ]
    r"""OAuth request parameters added to the POST body. The Content-Type header will automatically be set to application/x-www-form-urlencoded."""
    text_secret: NotRequired[str]
    r"""Select or create a text secret that contains the client secret's value."""


class CollectorHealthCheckHealthCheck2(BaseModel):
    collect_url: Annotated[str, pydantic.Field(alias="collectUrl")]
    r"""Expression to derive URL to use for the health check operation (can be a constant)."""

    type: CollectorHealthCheckType2
    r"""Collector type: health_check"""

    collect_method: Annotated[
        Annotated[
            Optional[HealthCheckMethod2], PlainValidator(validate_open_enum(False))
        ],
        pydantic.Field(alias="collectMethod"),
    ] = HealthCheckMethod2.GET
    r"""Health check HTTP method."""

    collect_request_params: Annotated[
        Optional[List[CollectorHealthCheckCollectRequestParam2]],
        pydantic.Field(alias="collectRequestParams"),
    ] = None
    r"""Optional health check request parameters."""

    discovery: Optional[CollectorHealthCheckDiscovery2] = None

    collect_body: Annotated[Optional[str], pydantic.Field(alias="collectBody")] = (
        "`{ }`"
    )
    r"""Template for POST body to send with the health check request. You can reference parameters from the Discover response, using template params of the form: ${variable}."""

    collect_request_headers: Annotated[
        Optional[List[CollectorHealthCheckCollectRequestHeader2]],
        pydantic.Field(alias="collectRequestHeaders"),
    ] = None
    r"""Optional health check request headers."""

    authenticate_collect: Annotated[
        Optional[bool], pydantic.Field(alias="authenticateCollect")
    ] = False
    r"""Enable to make auth health check call."""

    authentication: Annotated[
        Optional[CollectorHealthCheckAuthentication2],
        PlainValidator(validate_open_enum(False)),
    ] = CollectorHealthCheckAuthentication2.NONE
    r"""Authentication method for Discover and Collect REST calls. You can specify API Key–based authentication by adding the appropriate Collect headers."""

    timeout: Optional[float] = 30
    r"""HTTP request inactivity timeout, use 0 to disable"""

    reject_unauthorized: Annotated[
        Optional[bool], pydantic.Field(alias="rejectUnauthorized")
    ] = False
    r"""Whether to reject certificates that cannot be verified against a valid CA (e.g., self-signed certificates)."""

    default_breakers: Annotated[
        Annotated[
            Optional[CollectorHealthCheckHiddenDefaultBreakers2],
            PlainValidator(validate_open_enum(False)),
        ],
        pydantic.Field(alias="defaultBreakers"),
    ] = None

    safe_headers: Annotated[
        Optional[List[str]], pydantic.Field(alias="safeHeaders")
    ] = None
    r"""List of headers that are safe to log in plain text."""

    retry_rules: Annotated[
        Optional[CollectorHealthCheckRetryRules2], pydantic.Field(alias="retryRules")
    ] = None

    username: Optional[str] = None
    r"""Login username"""

    password: Optional[str] = None
    r"""Login password"""

    credentials_secret: Annotated[
        Optional[str], pydantic.Field(alias="credentialsSecret")
    ] = None
    r"""Select or create a stored secret that references your login credentials"""

    login_url: Annotated[Optional[str], pydantic.Field(alias="loginUrl")] = ""
    r"""URL to use for the OAuth API call. This call is expected to be a POST."""

    login_body: Annotated[Optional[str], pydantic.Field(alias="loginBody")] = (
        '`{ "username": "${username}", "password": "${password}" }`'
    )
    r"""Template for POST body to send with login request, ${username} and ${password} are used to specify location of these attributes in the message"""

    token_resp_attribute: Annotated[
        Optional[str], pydantic.Field(alias="tokenRespAttribute")
    ] = None
    r"""Path to token attribute in login response body. Nested attributes are OK. Leave blank if the response content type is text/plain; the entire response body will be used to derive the authorization header."""

    auth_header_expr: Annotated[
        Optional[str], pydantic.Field(alias="authHeaderExpr")
    ] = "`Bearer ${token}`"
    r"""JavaScript expression to compute the Authorization header to pass in discover and collect calls. The value ${token} is used to reference the token obtained from login."""

    auth_request_headers: Annotated[
        Optional[List[CollectorHealthCheckAuthRequestHeader2]],
        pydantic.Field(alias="authRequestHeaders"),
    ] = None
    r"""Optional authentication request headers."""

    client_secret_param_name: Annotated[
        Optional[str], pydantic.Field(alias="clientSecretParamName")
    ] = "client_secret"
    r"""Parameter name that contains client secret. Defaults to 'client_secret', and is automatically added to request parameters."""

    client_secret_param_value: Annotated[
        Optional[str], pydantic.Field(alias="clientSecretParamValue")
    ] = None
    r"""Secret value to add to HTTP requests as the 'client secret' parameter. Stored on disk encrypted, and is automatically added to request parameters"""

    auth_request_params: Annotated[
        Optional[List[CollectorHealthCheckAuthRequestParam2]],
        pydantic.Field(alias="authRequestParams"),
    ] = None
    r"""OAuth request parameters added to the POST body. The Content-Type header will automatically be set to application/x-www-form-urlencoded."""

    text_secret: Annotated[Optional[str], pydantic.Field(alias="textSecret")] = None
    r"""Select or create a text secret that contains the client secret's value."""

    @field_serializer("collect_method")
    def serialize_collect_method(self, value):
        if isinstance(value, str):
            try:
                return models.HealthCheckMethod2(value)
            except ValueError:
                return value
        return value

    @field_serializer("authentication")
    def serialize_authentication(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckAuthentication2(value)
            except ValueError:
                return value
        return value

    @field_serializer("default_breakers")
    def serialize_default_breakers(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckHiddenDefaultBreakers2(value)
            except ValueError:
                return value
        return value


class HealthCheckMethod1(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Health check HTTP method."""

    # GET
    GET = "get"
    # POST
    POST = "post"
    # POST with Body
    POST_WITH_BODY = "post_with_body"


class CollectorHealthCheckCollectRequestParam1TypedDict(TypedDict):
    name: str
    r"""Parameter name."""
    value: str
    r"""JavaScript expression to compute the parameter value (can be a constant)."""


class CollectorHealthCheckCollectRequestParam1(BaseModel):
    name: str
    r"""Parameter name."""

    value: str
    r"""JavaScript expression to compute the parameter value (can be a constant)."""


class CollectorHealthCheckDiscoverType1(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Defines how task discovery will be performed. Use None to skip the discovery. Use HTTP Request to make a REST call to discover tasks. Use Item List to enumerate items for collect to retrieve. Use JSON Response to manually define discover tasks as a JSON array of objects. Each entry returned by the discover operation will result in a collect task."""

    # HTTP Request
    HTTP = "http"
    # JSON Response
    JSON = "json"
    # Item List
    LIST = "list"
    # None
    NONE = "none"


class CollectorHealthCheckDiscovery1TypedDict(TypedDict):
    discover_type: NotRequired[CollectorHealthCheckDiscoverType1]
    r"""Defines how task discovery will be performed. Use None to skip the discovery. Use HTTP Request to make a REST call to discover tasks. Use Item List to enumerate items for collect to retrieve. Use JSON Response to manually define discover tasks as a JSON array of objects. Each entry returned by the discover operation will result in a collect task."""


class CollectorHealthCheckDiscovery1(BaseModel):
    discover_type: Annotated[
        Annotated[
            Optional[CollectorHealthCheckDiscoverType1],
            PlainValidator(validate_open_enum(False)),
        ],
        pydantic.Field(alias="discoverType"),
    ] = CollectorHealthCheckDiscoverType1.NONE
    r"""Defines how task discovery will be performed. Use None to skip the discovery. Use HTTP Request to make a REST call to discover tasks. Use Item List to enumerate items for collect to retrieve. Use JSON Response to manually define discover tasks as a JSON array of objects. Each entry returned by the discover operation will result in a collect task."""

    @field_serializer("discover_type")
    def serialize_discover_type(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckDiscoverType1(value)
            except ValueError:
                return value
        return value


class CollectorHealthCheckCollectRequestHeader1TypedDict(TypedDict):
    name: str
    r"""Header Name"""
    value: str
    r"""JavaScript expression to compute the header value (can be a constant)."""


class CollectorHealthCheckCollectRequestHeader1(BaseModel):
    name: str
    r"""Header Name"""

    value: str
    r"""JavaScript expression to compute the header value (can be a constant)."""


class CollectorHealthCheckAuthentication1(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Authentication method for Discover and Collect REST calls. You can specify API Key–based authentication by adding the appropriate Collect headers."""

    NONE = "none"
    BASIC = "basic"
    BASIC_SECRET = "basicSecret"
    LOGIN = "login"
    LOGIN_SECRET = "loginSecret"
    OAUTH = "oauth"
    OAUTH_SECRET = "oauthSecret"


class CollectorHealthCheckHiddenDefaultBreakers1(
    str, Enum, metaclass=utils.OpenEnumMeta
):
    CRIBL = "Cribl"


class CollectorHealthCheckRetryType1(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""The algorithm to use when performing HTTP retries"""

    # Disabled
    NONE = "none"
    # Backoff
    BACKOFF = "backoff"
    # Static
    STATIC = "static"


class CollectorHealthCheckRetryRules1TypedDict(TypedDict):
    type: NotRequired[CollectorHealthCheckRetryType1]
    r"""The algorithm to use when performing HTTP retries"""
    interval: NotRequired[Any]
    limit: NotRequired[Any]
    multiplier: NotRequired[Any]
    codes: NotRequired[Any]
    enable_header: NotRequired[Any]


class CollectorHealthCheckRetryRules1(BaseModel):
    type: Annotated[
        Optional[CollectorHealthCheckRetryType1],
        PlainValidator(validate_open_enum(False)),
    ] = CollectorHealthCheckRetryType1.BACKOFF
    r"""The algorithm to use when performing HTTP retries"""

    interval: Optional[Any] = None

    limit: Optional[Any] = None

    multiplier: Optional[Any] = None

    codes: Optional[Any] = None

    enable_header: Annotated[Optional[Any], pydantic.Field(alias="enableHeader")] = None

    @field_serializer("type")
    def serialize_type(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckRetryType1(value)
            except ValueError:
                return value
        return value


class CollectorHealthCheckAuthRequestHeader1TypedDict(TypedDict):
    name: str
    r"""Header name."""
    value: str
    r"""JavaScript expression to compute the header's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckAuthRequestHeader1(BaseModel):
    name: str
    r"""Header name."""

    value: str
    r"""JavaScript expression to compute the header's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckAuthRequestParam1TypedDict(TypedDict):
    name: str
    r"""Parameter name."""
    value: str
    r"""JavaScript expression to compute the parameter's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckAuthRequestParam1(BaseModel):
    name: str
    r"""Parameter name."""

    value: str
    r"""JavaScript expression to compute the parameter's value, normally enclosed in backticks (e.g., `${earliest}`). If a constant, use single quotes (e.g., 'earliest'). Values without delimiters (e.g., earliest) are evaluated as strings."""


class CollectorHealthCheckType1(str, Enum):
    r"""Collector type: health_check"""

    HEALTH_CHECK = "health_check"


class CollectorHealthCheckHealthCheck1TypedDict(TypedDict):
    collect_url: str
    r"""Expression to derive URL to use for the health check operation (can be a constant)."""
    type: CollectorHealthCheckType1
    r"""Collector type: health_check"""
    collect_method: NotRequired[HealthCheckMethod1]
    r"""Health check HTTP method."""
    collect_request_params: NotRequired[
        List[CollectorHealthCheckCollectRequestParam1TypedDict]
    ]
    r"""Optional health check request parameters."""
    discovery: NotRequired[CollectorHealthCheckDiscovery1TypedDict]
    collect_body: NotRequired[str]
    r"""Template for POST body to send with the health check request. You can reference parameters from the Discover response, using template params of the form: ${variable}."""
    collect_request_headers: NotRequired[
        List[CollectorHealthCheckCollectRequestHeader1TypedDict]
    ]
    r"""Optional health check request headers."""
    authenticate_collect: NotRequired[bool]
    r"""Enable to make auth health check call."""
    authentication: NotRequired[CollectorHealthCheckAuthentication1]
    r"""Authentication method for Discover and Collect REST calls. You can specify API Key–based authentication by adding the appropriate Collect headers."""
    timeout: NotRequired[float]
    r"""HTTP request inactivity timeout, use 0 to disable"""
    reject_unauthorized: NotRequired[bool]
    r"""Whether to reject certificates that cannot be verified against a valid CA (e.g., self-signed certificates)."""
    default_breakers: NotRequired[CollectorHealthCheckHiddenDefaultBreakers1]
    safe_headers: NotRequired[List[str]]
    r"""List of headers that are safe to log in plain text."""
    retry_rules: NotRequired[CollectorHealthCheckRetryRules1TypedDict]
    username: NotRequired[str]
    r"""Login username"""
    password: NotRequired[str]
    r"""Login password"""
    credentials_secret: NotRequired[str]
    r"""Select or create a stored secret that references your login credentials"""
    login_url: NotRequired[str]
    r"""URL to use for the OAuth API call. This call is expected to be a POST."""
    login_body: NotRequired[str]
    r"""Template for POST body to send with login request, ${username} and ${password} are used to specify location of these attributes in the message"""
    token_resp_attribute: NotRequired[str]
    r"""Path to token attribute in login response body. Nested attributes are OK. Leave blank if the response content type is text/plain; the entire response body will be used to derive the authorization header."""
    auth_header_expr: NotRequired[str]
    r"""JavaScript expression to compute the Authorization header to pass in discover and collect calls. The value ${token} is used to reference the token obtained from login."""
    auth_request_headers: NotRequired[
        List[CollectorHealthCheckAuthRequestHeader1TypedDict]
    ]
    r"""Optional authentication request headers."""
    client_secret_param_name: NotRequired[str]
    r"""Parameter name that contains client secret. Defaults to 'client_secret', and is automatically added to request parameters."""
    client_secret_param_value: NotRequired[str]
    r"""Secret value to add to HTTP requests as the 'client secret' parameter. Stored on disk encrypted, and is automatically added to request parameters"""
    auth_request_params: NotRequired[
        List[CollectorHealthCheckAuthRequestParam1TypedDict]
    ]
    r"""OAuth request parameters added to the POST body. The Content-Type header will automatically be set to application/x-www-form-urlencoded."""
    text_secret: NotRequired[str]
    r"""Select or create a text secret that contains the client secret's value."""


class CollectorHealthCheckHealthCheck1(BaseModel):
    collect_url: Annotated[str, pydantic.Field(alias="collectUrl")]
    r"""Expression to derive URL to use for the health check operation (can be a constant)."""

    type: CollectorHealthCheckType1
    r"""Collector type: health_check"""

    collect_method: Annotated[
        Annotated[
            Optional[HealthCheckMethod1], PlainValidator(validate_open_enum(False))
        ],
        pydantic.Field(alias="collectMethod"),
    ] = HealthCheckMethod1.GET
    r"""Health check HTTP method."""

    collect_request_params: Annotated[
        Optional[List[CollectorHealthCheckCollectRequestParam1]],
        pydantic.Field(alias="collectRequestParams"),
    ] = None
    r"""Optional health check request parameters."""

    discovery: Optional[CollectorHealthCheckDiscovery1] = None

    collect_body: Annotated[Optional[str], pydantic.Field(alias="collectBody")] = (
        "`{ }`"
    )
    r"""Template for POST body to send with the health check request. You can reference parameters from the Discover response, using template params of the form: ${variable}."""

    collect_request_headers: Annotated[
        Optional[List[CollectorHealthCheckCollectRequestHeader1]],
        pydantic.Field(alias="collectRequestHeaders"),
    ] = None
    r"""Optional health check request headers."""

    authenticate_collect: Annotated[
        Optional[bool], pydantic.Field(alias="authenticateCollect")
    ] = False
    r"""Enable to make auth health check call."""

    authentication: Annotated[
        Optional[CollectorHealthCheckAuthentication1],
        PlainValidator(validate_open_enum(False)),
    ] = CollectorHealthCheckAuthentication1.NONE
    r"""Authentication method for Discover and Collect REST calls. You can specify API Key–based authentication by adding the appropriate Collect headers."""

    timeout: Optional[float] = 30
    r"""HTTP request inactivity timeout, use 0 to disable"""

    reject_unauthorized: Annotated[
        Optional[bool], pydantic.Field(alias="rejectUnauthorized")
    ] = False
    r"""Whether to reject certificates that cannot be verified against a valid CA (e.g., self-signed certificates)."""

    default_breakers: Annotated[
        Annotated[
            Optional[CollectorHealthCheckHiddenDefaultBreakers1],
            PlainValidator(validate_open_enum(False)),
        ],
        pydantic.Field(alias="defaultBreakers"),
    ] = None

    safe_headers: Annotated[
        Optional[List[str]], pydantic.Field(alias="safeHeaders")
    ] = None
    r"""List of headers that are safe to log in plain text."""

    retry_rules: Annotated[
        Optional[CollectorHealthCheckRetryRules1], pydantic.Field(alias="retryRules")
    ] = None

    username: Optional[str] = None
    r"""Login username"""

    password: Optional[str] = None
    r"""Login password"""

    credentials_secret: Annotated[
        Optional[str], pydantic.Field(alias="credentialsSecret")
    ] = None
    r"""Select or create a stored secret that references your login credentials"""

    login_url: Annotated[Optional[str], pydantic.Field(alias="loginUrl")] = ""
    r"""URL to use for the OAuth API call. This call is expected to be a POST."""

    login_body: Annotated[Optional[str], pydantic.Field(alias="loginBody")] = (
        '`{ "username": "${username}", "password": "${password}" }`'
    )
    r"""Template for POST body to send with login request, ${username} and ${password} are used to specify location of these attributes in the message"""

    token_resp_attribute: Annotated[
        Optional[str], pydantic.Field(alias="tokenRespAttribute")
    ] = None
    r"""Path to token attribute in login response body. Nested attributes are OK. Leave blank if the response content type is text/plain; the entire response body will be used to derive the authorization header."""

    auth_header_expr: Annotated[
        Optional[str], pydantic.Field(alias="authHeaderExpr")
    ] = "`Bearer ${token}`"
    r"""JavaScript expression to compute the Authorization header to pass in discover and collect calls. The value ${token} is used to reference the token obtained from login."""

    auth_request_headers: Annotated[
        Optional[List[CollectorHealthCheckAuthRequestHeader1]],
        pydantic.Field(alias="authRequestHeaders"),
    ] = None
    r"""Optional authentication request headers."""

    client_secret_param_name: Annotated[
        Optional[str], pydantic.Field(alias="clientSecretParamName")
    ] = "client_secret"
    r"""Parameter name that contains client secret. Defaults to 'client_secret', and is automatically added to request parameters."""

    client_secret_param_value: Annotated[
        Optional[str], pydantic.Field(alias="clientSecretParamValue")
    ] = None
    r"""Secret value to add to HTTP requests as the 'client secret' parameter. Stored on disk encrypted, and is automatically added to request parameters"""

    auth_request_params: Annotated[
        Optional[List[CollectorHealthCheckAuthRequestParam1]],
        pydantic.Field(alias="authRequestParams"),
    ] = None
    r"""OAuth request parameters added to the POST body. The Content-Type header will automatically be set to application/x-www-form-urlencoded."""

    text_secret: Annotated[Optional[str], pydantic.Field(alias="textSecret")] = None
    r"""Select or create a text secret that contains the client secret's value."""

    @field_serializer("collect_method")
    def serialize_collect_method(self, value):
        if isinstance(value, str):
            try:
                return models.HealthCheckMethod1(value)
            except ValueError:
                return value
        return value

    @field_serializer("authentication")
    def serialize_authentication(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckAuthentication1(value)
            except ValueError:
                return value
        return value

    @field_serializer("default_breakers")
    def serialize_default_breakers(self, value):
        if isinstance(value, str):
            try:
                return models.CollectorHealthCheckHiddenDefaultBreakers1(value)
            except ValueError:
                return value
        return value


CollectorHealthCheckTypedDict = TypeAliasType(
    "CollectorHealthCheckTypedDict",
    Union[
        CollectorHealthCheckHealthCheck1TypedDict,
        CollectorHealthCheckHealthCheck2TypedDict,
        CollectorHealthCheckHealthCheck3TypedDict,
        CollectorHealthCheckHealthCheck4TypedDict,
        CollectorHealthCheckHealthCheck5TypedDict,
        CollectorHealthCheckHealthCheck6TypedDict,
        CollectorHealthCheckHealthCheck7TypedDict,
        CollectorHealthCheckHealthCheck8TypedDict,
        CollectorHealthCheckHealthCheck9TypedDict,
        CollectorHealthCheckHealthCheck10TypedDict,
    ],
)


CollectorHealthCheck = TypeAliasType(
    "CollectorHealthCheck",
    Union[
        CollectorHealthCheckHealthCheck1,
        CollectorHealthCheckHealthCheck2,
        CollectorHealthCheckHealthCheck3,
        CollectorHealthCheckHealthCheck4,
        CollectorHealthCheckHealthCheck5,
        CollectorHealthCheckHealthCheck6,
        CollectorHealthCheckHealthCheck7,
        CollectorHealthCheckHealthCheck8,
        CollectorHealthCheckHealthCheck9,
        CollectorHealthCheckHealthCheck10,
    ],
)
