{#- Template for Nim types.

Context:
  entry (NimEntry): The entry to render.
  root (bool): Whether this is the root object.
  heading_level (int): The HTML heading level to use.
  config (dict): The configuration options.
-#}

<div class="doc doc-object doc-type">
  {% set html_id = entry.name %}

  {% filter heading(heading_level, id=html_id, class="doc doc-heading", toc_label=entry.name) %}
    <code class="doc-symbol doc-symbol-heading doc-symbol-type"></code>
    <span class="doc doc-object-name doc-type-name">{{ entry.name }}</span>
  {% endfilter %}

  {% if config.show_signature %}
    <div class="doc-signature highlight">
      <pre><code class="language-nim highlight">{{ entry.signature | highlight_nim }}</code></pre>
    </div>
  {% endif %}

  <div class="doc doc-contents">
    {% if entry.doc %}
      <div class="doc-description">
        {{ entry.doc | convert_markdown(heading_level, html_id) }}
      </div>
    {% endif %}

    {% if entry.fields %}
      {% set visible_fields = entry.fields if config.show_private else entry.fields | selectattr("exported") | list %}
      {% if visible_fields %}
      <div class="doc-section doc-section-fields">
        <p class="doc-section-title">Fields</p>
        <ul class="doc-field-list">
          {% for field in visible_fields %}
          <li class="doc-field{% if not field.exported %} doc-field-private{% endif %}">
            <code class="doc-field-name">{{ field.name }}</code>
            {% if field.type %}<code class="doc-field-type">{{ field.type }}</code>{% endif %}
            {% if not field.exported %}<span class="doc-field-private-label">private</span>{% endif %}
            {% if field.branch %}<span class="doc-field-branch">[{{ field.branch }}]</span>{% endif %}
            {% if field.doc %}<span class="doc-field-description"> &ndash; {{ field.doc }}</span>{% endif %}
          </li>
          {% endfor %}
        </ul>
      </div>
      {% endif %}
    {% endif %}

    {% if entry.values %}
      <div class="doc-section doc-section-values">
        <p class="doc-section-title">Values</p>
        <ul class="doc-value-list">
          {% for val in entry.values %}
          <li class="doc-value">
            <code class="doc-value-name">{{ val.name }}</code>
            {% if val.type %}<span class="doc-value-explicit"> = <code>{{ val.type }}</code></span>{% endif %}
            {% if val.doc %}<span class="doc-value-description"> &ndash; {{ val.doc }}</span>{% endif %}
          </li>
          {% endfor %}
        </ul>
      </div>
    {% endif %}

    {% if config.show_source and entry.line %}
      <div class="doc-source">
        <span class="doc-source-label">Source:</span>
        {% if config.source_url %}
          <a href="{{ config.source_url }}/blob/{{ config.source_ref }}/{{ module.file }}#L{{ entry.line }}" target="_blank" rel="noopener">
            {{ module.file }}:{{ entry.line }}
          </a>
        {% else %}
          <code>{{ module.file }}:{{ entry.line }}</code>
        {% endif %}
      </div>
    {% endif %}
  </div>
</div>
