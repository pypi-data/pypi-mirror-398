import{d as jt,e as te,f as C,h as H,aZ as st,a_ as ca,r as K,C as da,c as pa,K as _a,A as ga,b as ma,L as Vt,a0 as zt,I as F,bb as ya,p as ha,n as va,aK as ba,B as ve,N as wa,cJ as Ta,o as xa,F as Ot,ag as Aa,i as G,w as L,aa as it,ah as Pt,l as i,a8 as ae,ar as Ca,aS as Ia,as as Ea,V as Jt,t as W,am as Oa,a9 as Ge,al as Pa,s as Ee,a7 as Ra,aH as ka,j as La,be as Ma,v as Na,S as Ua,W as $a,E as He,aV as Fa}from"./index-BwlMlHGj.js";import{u as Da,b as Sa,v as qa,w as Ba,x as Ka,y as Ga,z as Ha,A as Va}from"./exp-BFwh7v1l.js";import{_ as za}from"./DynamicForm.vue_vue_type_script_setup_true_lang-DoGDCFcf.js";import{i as Ja}from"./json-editor-vue-CSlvxqm5.js";import{u as Wa}from"./exp-CUij9ySc.js";import{c as Ya}from"./index-C1C63wPC.js";import{N as ja}from"./InputNumber-RrJJyZaR.js";import{N as Xa}from"./Switch-B5yYo9Bh.js";import{_ as Za}from"./Popconfirm-GYskt_Un.js";import{_ as Qa}from"./Image-B_0rm4XX.js";import{_ as er}from"./DataTable-CfoqEf8t.js";import"./index.browser-OxPLOBIU.js";import"./download-C2161hUv.js";import"./Checkbox-UFZekRDE.js";import"./RadioGroup-BB1a5vev.js";import"./Pagination-Do-f8cxW.js";const tr={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32"},nr=jt({name:"Edit",render:function(ee,I){return C(),te("svg",tr,I[0]||(I[0]=[H("path",{d:"M2 26h28v2H2z",fill:"currentColor"},null,-1),H("path",{d:"M25.4 9c.8-.8.8-2 0-2.8l-3.6-3.6c-.8-.8-2-.8-2.8 0l-15 15V24h6.4l15-15zm-5-5L24 7.6l-3 3L17.4 7l3-3zM6 22v-3.6l10-10l3.6 3.6l-10 10H6z",fill:"currentColor"},null,-1)]))}});var Ve={exports:{}};Ve.exports;var Wt;function ar(){return Wt||(Wt=1,function(Oe,ee){var I=200,lt="Expected a function",Fe="__lodash_hash_undefined__",be=1,a=2,M=9007199254740991,pe="[object Arguments]",Y="[object Array]",ne="[object Boolean]",we="[object Date]",re="[object Error]",se="[object Function]",ut="[object GeneratorFunction]",j="[object Map]",De="[object Number]",ie="[object Object]",ze="[object Promise]",Se="[object RegExp]",_e="[object Set]",le="[object String]",Pe="[object Symbol]",Te="[object WeakMap]",Re="[object ArrayBuffer]",ke="[object DataView]",ot="[object Float32Array]",Le="[object Float64Array]",ft="[object Int8Array]",ct="[object Int16Array]",qe="[object Int32Array]",Me="[object Uint8Array]",dt="[object Uint8ClampedArray]",pt="[object Uint16Array]",_t="[object Uint32Array]",Je=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,gt=/^\w*$/,d=/^\./,l=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,g=/[\\^$.*+?()[\]{}|]/g,m=/\\(\\)?/g,h=/^\[object .+?Constructor\]$/,u=/^(?:0|[1-9]\d*)$/,f={};f[ot]=f[Le]=f[ft]=f[ct]=f[qe]=f[Me]=f[dt]=f[pt]=f[_t]=!0,f[pe]=f[Y]=f[Re]=f[ne]=f[ke]=f[we]=f[re]=f[se]=f[j]=f[De]=f[ie]=f[Se]=f[_e]=f[le]=f[Te]=!1;var v=typeof st=="object"&&st&&st.Object===Object&&st,y=typeof self=="object"&&self&&self.Object===Object&&self,p=v||y||Function("return this")(),w=ee&&!ee.nodeType&&ee,_=w&&!0&&Oe&&!Oe.nodeType&&Oe,T=_&&_.exports===w,V=T&&v.process,x=function(){try{return V&&V.binding("util")}catch{}}(),z=x&&x.isTypedArray;function D(e,t,n,r){for(var o=-1,s=e?e.length:0;++o<s;){var c=e[o];t(r,c,n(c),e)}return r}function X(e,t){for(var n=-1,r=e?e.length:0;++n<r;)if(t(e[n],n,e))return!0;return!1}function N(e){return function(t){return t==null?void 0:t[e]}}function E(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function O(e){return function(t){return e(t)}}function P(e,t){return e==null?void 0:e[t]}function k(e){var t=!1;if(e!=null&&typeof e.toString!="function")try{t=!!(e+"")}catch{}return t}function J(e){var t=-1,n=Array(e.size);return e.forEach(function(r,o){n[++t]=[o,r]}),n}function U(e,t){return function(n){return e(t(n))}}function xe(e){var t=-1,n=Array(e.size);return e.forEach(function(r){n[++t]=r}),n}var ge=Array.prototype,mt=Function.prototype,Ne=Object.prototype,yt=p["__core-js_shared__"],Rt=function(){var e=/[^.]+$/.exec(yt&&yt.keys&&yt.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),kt=mt.toString,ue=Ne.hasOwnProperty,Ue=Ne.toString,Xt=RegExp("^"+kt.call(ue).replace(g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Lt=p.Symbol,Mt=p.Uint8Array,Zt=Ne.propertyIsEnumerable,Qt=ge.splice,en=U(Object.keys,Object),ht=$e(p,"DataView"),Be=$e(p,"Map"),vt=$e(p,"Promise"),bt=$e(p,"Set"),wt=$e(p,"WeakMap"),Ke=$e(Object,"create"),tn=Ce(ht),nn=Ce(Be),an=Ce(vt),rn=Ce(bt),sn=Ce(wt),We=Lt?Lt.prototype:void 0,Tt=We?We.valueOf:void 0,Nt=We?We.toString:void 0;function Ae(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ln(){this.__data__=Ke?Ke(null):{}}function un(e){return this.has(e)&&delete this.__data__[e]}function on(e){var t=this.__data__;if(Ke){var n=t[e];return n===Fe?void 0:n}return ue.call(t,e)?t[e]:void 0}function fn(e){var t=this.__data__;return Ke?t[e]!==void 0:ue.call(t,e)}function cn(e,t){var n=this.__data__;return n[e]=Ke&&t===void 0?Fe:t,this}Ae.prototype.clear=ln,Ae.prototype.delete=un,Ae.prototype.get=on,Ae.prototype.has=fn,Ae.prototype.set=cn;function oe(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function dn(){this.__data__=[]}function pn(e){var t=this.__data__,n=je(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():Qt.call(t,n,1),!0}function _n(e){var t=this.__data__,n=je(t,e);return n<0?void 0:t[n][1]}function gn(e){return je(this.__data__,e)>-1}function mn(e,t){var n=this.__data__,r=je(n,e);return r<0?n.push([e,t]):n[r][1]=t,this}oe.prototype.clear=dn,oe.prototype.delete=pn,oe.prototype.get=_n,oe.prototype.has=gn,oe.prototype.set=mn;function fe(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function yn(){this.__data__={hash:new Ae,map:new(Be||oe),string:new Ae}}function hn(e){return Xe(this,e).delete(e)}function vn(e){return Xe(this,e).get(e)}function bn(e){return Xe(this,e).has(e)}function wn(e,t){return Xe(this,e).set(e,t),this}fe.prototype.clear=yn,fe.prototype.delete=hn,fe.prototype.get=vn,fe.prototype.has=bn,fe.prototype.set=wn;function Ye(e){var t=-1,n=e?e.length:0;for(this.__data__=new fe;++t<n;)this.add(e[t])}function Tn(e){return this.__data__.set(e,Fe),this}function xn(e){return this.__data__.has(e)}Ye.prototype.add=Ye.prototype.push=Tn,Ye.prototype.has=xn;function ce(e){this.__data__=new oe(e)}function An(){this.__data__=new oe}function Cn(e){return this.__data__.delete(e)}function In(e){return this.__data__.get(e)}function En(e){return this.__data__.has(e)}function On(e,t){var n=this.__data__;if(n instanceof oe){var r=n.__data__;if(!Be||r.length<I-1)return r.push([e,t]),this;n=this.__data__=new fe(r)}return n.set(e,t),this}ce.prototype.clear=An,ce.prototype.delete=Cn,ce.prototype.get=In,ce.prototype.has=En,ce.prototype.set=On;function Pn(e,t){var n=ye(e)||Kt(e)?E(e.length,String):[],r=n.length,o=!!r;for(var s in e)ue.call(e,s)&&!(o&&(s=="length"||Dt(s,r)))&&n.push(s);return n}function je(e,t){for(var n=e.length;n--;)if(Bt(e[n][0],t))return n;return-1}function Rn(e,t,n,r){return kn(e,function(o,s,c){t(r,o,n(o),c)}),r}var kn=Jn(Mn),Ln=Wn();function Mn(e,t){return e&&Ln(e,t,nt)}function Ut(e,t){t=Ze(t,e)?[t]:$t(t);for(var n=0,r=t.length;e!=null&&n<r;)e=e[Qe(t[n++])];return n&&n==r?e:void 0}function Nn(e){return Ue.call(e)}function Un(e,t){return e!=null&&t in Object(e)}function xt(e,t,n,r,o){return e===t?!0:e==null||t==null||!et(e)&&!tt(t)?e!==e&&t!==t:$n(e,t,xt,n,r,o)}function $n(e,t,n,r,o,s){var c=ye(e),R=ye(t),A=Y,$=Y;c||(A=me(e),A=A==pe?ie:A),R||($=me(t),$=$==pe?ie:$);var q=A==ie&&!k(e),B=$==ie&&!k(t),S=A==$;if(S&&!q)return s||(s=new ce),c||sa(e)?Ft(e,t,n,r,o,s):Yn(e,t,A,n,r,o,s);if(!(o&a)){var Z=q&&ue.call(e,"__wrapped__"),Q=B&&ue.call(t,"__wrapped__");if(Z||Q){var he=Z?e.value():e,de=Q?t.value():t;return s||(s=new ce),n(he,de,r,o,s)}}return S?(s||(s=new ce),jn(e,t,n,r,o,s)):!1}function Fn(e,t,n,r){var o=n.length,s=o;if(e==null)return!s;for(e=Object(e);o--;){var c=n[o];if(c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++o<s;){c=n[o];var R=c[0],A=e[R],$=c[1];if(c[2]){if(A===void 0&&!(R in e))return!1}else{var q=new ce,B;if(!(B===void 0?xt($,A,r,be|a,q):B))return!1}}return!0}function Dn(e){if(!et(e)||ea(e))return!1;var t=Gt(e)||k(e)?Xt:h;return t.test(Ce(e))}function Sn(e){return tt(e)&&It(e.length)&&!!f[Ue.call(e)]}function qn(e){return typeof e=="function"?e:e==null?oa:typeof e=="object"?ye(e)?Gn(e[0],e[1]):Kn(e):fa(e)}function Bn(e){if(!ta(e))return en(e);var t=[];for(var n in Object(e))ue.call(e,n)&&n!="constructor"&&t.push(n);return t}function Kn(e){var t=Xn(e);return t.length==1&&t[0][2]?qt(t[0][0],t[0][1]):function(n){return n===e||Fn(n,e,t)}}function Gn(e,t){return Ze(e)&&St(t)?qt(Qe(e),t):function(n){var r=la(n,e);return r===void 0&&r===t?ua(n,e):xt(t,r,void 0,be|a)}}function Hn(e){return function(t){return Ut(t,e)}}function Vn(e){if(typeof e=="string")return e;if(Et(e))return Nt?Nt.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}function $t(e){return ye(e)?e:na(e)}function zn(e,t){return function(n,r){var o=ye(n)?D:Rn,s=t?t():{};return o(n,e,qn(r),s)}}function Jn(e,t){return function(n,r){if(n==null)return n;if(!Ct(n))return e(n,r);for(var o=n.length,s=-1,c=Object(n);++s<o&&r(c[s],s,c)!==!1;);return n}}function Wn(e){return function(t,n,r){for(var o=-1,s=Object(t),c=r(t),R=c.length;R--;){var A=c[++o];if(n(s[A],A,s)===!1)break}return t}}function Ft(e,t,n,r,o,s){var c=o&a,R=e.length,A=t.length;if(R!=A&&!(c&&A>R))return!1;var $=s.get(e);if($&&s.get(t))return $==t;var q=-1,B=!0,S=o&be?new Ye:void 0;for(s.set(e,t),s.set(t,e);++q<R;){var Z=e[q],Q=t[q];if(r)var he=c?r(Q,Z,q,t,e,s):r(Z,Q,q,e,t,s);if(he!==void 0){if(he)continue;B=!1;break}if(S){if(!X(t,function(de,Ie){if(!S.has(Ie)&&(Z===de||n(Z,de,r,o,s)))return S.add(Ie)})){B=!1;break}}else if(!(Z===Q||n(Z,Q,r,o,s))){B=!1;break}}return s.delete(e),s.delete(t),B}function Yn(e,t,n,r,o,s,c){switch(n){case ke:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Re:return!(e.byteLength!=t.byteLength||!r(new Mt(e),new Mt(t)));case ne:case we:case De:return Bt(+e,+t);case re:return e.name==t.name&&e.message==t.message;case Se:case le:return e==t+"";case j:var R=J;case _e:var A=s&a;if(R||(R=xe),e.size!=t.size&&!A)return!1;var $=c.get(e);if($)return $==t;s|=be,c.set(e,t);var q=Ft(R(e),R(t),r,o,s,c);return c.delete(e),q;case Pe:if(Tt)return Tt.call(e)==Tt.call(t)}return!1}function jn(e,t,n,r,o,s){var c=o&a,R=nt(e),A=R.length,$=nt(t),q=$.length;if(A!=q&&!c)return!1;for(var B=A;B--;){var S=R[B];if(!(c?S in t:ue.call(t,S)))return!1}var Z=s.get(e);if(Z&&s.get(t))return Z==t;var Q=!0;s.set(e,t),s.set(t,e);for(var he=c;++B<A;){S=R[B];var de=e[S],Ie=t[S];if(r)var Ht=c?r(Ie,de,S,t,e,s):r(de,Ie,S,e,t,s);if(!(Ht===void 0?de===Ie||n(de,Ie,r,o,s):Ht)){Q=!1;break}he||(he=S=="constructor")}if(Q&&!he){var at=e.constructor,rt=t.constructor;at!=rt&&"constructor"in e&&"constructor"in t&&!(typeof at=="function"&&at instanceof at&&typeof rt=="function"&&rt instanceof rt)&&(Q=!1)}return s.delete(e),s.delete(t),Q}function Xe(e,t){var n=e.__data__;return Qn(t)?n[typeof t=="string"?"string":"hash"]:n.map}function Xn(e){for(var t=nt(e),n=t.length;n--;){var r=t[n],o=e[r];t[n]=[r,o,St(o)]}return t}function $e(e,t){var n=P(e,t);return Dn(n)?n:void 0}var me=Nn;(ht&&me(new ht(new ArrayBuffer(1)))!=ke||Be&&me(new Be)!=j||vt&&me(vt.resolve())!=ze||bt&&me(new bt)!=_e||wt&&me(new wt)!=Te)&&(me=function(e){var t=Ue.call(e),n=t==ie?e.constructor:void 0,r=n?Ce(n):void 0;if(r)switch(r){case tn:return ke;case nn:return j;case an:return ze;case rn:return _e;case sn:return Te}return t});function Zn(e,t,n){t=Ze(t,e)?[t]:$t(t);for(var r,o=-1,c=t.length;++o<c;){var s=Qe(t[o]);if(!(r=e!=null&&n(e,s)))break;e=e[s]}if(r)return r;var c=e?e.length:0;return!!c&&It(c)&&Dt(s,c)&&(ye(e)||Kt(e))}function Dt(e,t){return t=t??M,!!t&&(typeof e=="number"||u.test(e))&&e>-1&&e%1==0&&e<t}function Ze(e,t){if(ye(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||Et(e)?!0:gt.test(e)||!Je.test(e)||t!=null&&e in Object(t)}function Qn(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function ea(e){return!!Rt&&Rt in e}function ta(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||Ne;return e===n}function St(e){return e===e&&!et(e)}function qt(e,t){return function(n){return n==null?!1:n[e]===t&&(t!==void 0||e in Object(n))}}var na=At(function(e){e=ia(e);var t=[];return d.test(e)&&t.push(""),e.replace(l,function(n,r,o,s){t.push(o?s.replace(m,"$1"):r||n)}),t});function Qe(e){if(typeof e=="string"||Et(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}function Ce(e){if(e!=null){try{return kt.call(e)}catch{}try{return e+""}catch{}}return""}var aa=zn(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]});function At(e,t){if(typeof e!="function"||t&&typeof t!="function")throw new TypeError(lt);var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],s=n.cache;if(s.has(o))return s.get(o);var c=e.apply(this,r);return n.cache=s.set(o,c),c};return n.cache=new(At.Cache||fe),n}At.Cache=fe;function Bt(e,t){return e===t||e!==e&&t!==t}function Kt(e){return ra(e)&&ue.call(e,"callee")&&(!Zt.call(e,"callee")||Ue.call(e)==pe)}var ye=Array.isArray;function Ct(e){return e!=null&&It(e.length)&&!Gt(e)}function ra(e){return tt(e)&&Ct(e)}function Gt(e){var t=et(e)?Ue.call(e):"";return t==se||t==ut}function It(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=M}function et(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function tt(e){return!!e&&typeof e=="object"}function Et(e){return typeof e=="symbol"||tt(e)&&Ue.call(e)==Pe}var sa=z?O(z):Sn;function ia(e){return e==null?"":Vn(e)}function la(e,t,n){var r=e==null?void 0:Ut(e,t);return r===void 0?n:r}function ua(e,t){return e!=null&&Zn(e,t,Un)}function nt(e){return Ct(e)?Pn(e):Bn(e)}function oa(e){return e}function fa(e){return Ze(e)?N(Qe(e)):Hn(e)}Oe.exports=aa}(Ve,Ve.exports)),Ve.exports}var rr=ar();const sr=ca(rr),ir={class:"flex gap-3"},lr={class:"w-64 pl-2"},ur={class:"mb-5"},or={class:"text-xl"},fr={class:"text-sm opacity-80"},cr={key:0,class:"text-right mt-2"},dr={class:"flex justify-between items-center mb-2"},pr={class:"flex-1"},_r={key:0},gr={class:"text-xl"},mr={class:"opacity-75 italic pl-2"},yr={key:1,class:"text-xl"},hr={key:0,class:"flex gap-2"},vr={class:"mt-4 mb-2 text-xl"},br={class:"flex justify-end mt-5 gap-2"},b="__SPACE_PARAMETER_UPDATING__",Yt="__SELECTED_SPACE_PARAMETER_UPDATING__",Fr=jt({__name:"ExpRunResult",setup(Oe){const ee=K(!1),I=da(),lt=pa(),Fe=_a(),be=ga(),a=Wa(),{t:M}=ma(),pe=K(),Y=K({show:!1}),ne=K(!1),we=K(!1),re=K(!1),se=K(!1),ut=[{label:"str",value:"str"},{label:"int",value:"int"},{label:"float",value:"float"},{label:"bool",value:"bool"},{label:"list",value:"list"},{label:"tuple",value:"tuple"},{label:"dict",value:"dict"},{label:"complex",value:"complex"},{label:"ndarray",value:"ndarray"}],j=K(),De=K(),ie=K(),ze=async()=>{var g,m;const[d,l]=await Da();if(!d&&(l==null?void 0:l.status)===0){ie.value=l.data;const[h]=(m=(g=a==null?void 0:a.expInfo)==null?void 0:g.exp)!=null&&m.template?a.expInfo.exp.template.split("/"):"";h&&l.data[h]?(j.value=h,He(()=>{Te(h,!0)})):(j.value=Object.keys(l.data)[0],He(()=>{Te(Object.keys(l.data)[0])}))}},Se=async()=>{var g,m,h;if(!I.query.exp_id)return;const[d,l]=await Sa({exp_id:I.query.exp_id,device_group_name:I.query.device_group_name,space_id:I.query.space_id});if(!d&&(l==null?void 0:l.status)===0){if((g=l.data)!=null&&g.data){l.data.data=JSON.parse(l.data.data);const u=(m=l.data.data)!=null&&m.tables?(h=l.data.data)==null?void 0:h.tables[b]:null;u&&(u.crows=u.rows)}a.result=l.data}},_e=Vt(()=>{var m,h;const d=[];(m=a.result)!=null&&m.data&&zt((h=a.result.data)==null?void 0:h.tables,u=>{const f=u.rows.map(y=>{var w;const p={};return(w=u.columns)==null||w.forEach((_,T)=>{p[_.name]=typeof y[T]!==void 0?`${y[T]}`:y[T]}),p}),v=u.columns.map((y,p)=>{const w={...y,title:y.name,key:y.name};return y.name==="key"?{...w,minWidth:200,render(_){return F(ya,{},{default:()=>Le.value&&Le.value[_.key]?F("div",`${M("expInfo.latestParamsTips")}: ${Le.value[_.key]}`):F("div",_.key),trigger:()=>F("div",{class:"cursor-pointer"},_.key)})}}:y.name==="type"&&u.name===b?{...w,width:200,render(_,T){if(ee.value){const V=u.crows?u.crows[T][p]:null;return F(ha,{class:V!=_.type?"!outline !outline-red-500 w-32":"w-32",options:ut,value:_.type,onUpdateValue:x=>{var z,D,X,N,E,O,P,k;(D=(z=a==null?void 0:a.result)==null?void 0:z.data)!=null&&D.tables&&((N=(X=a==null?void 0:a.result)==null?void 0:X.data)!=null&&N.tables[b])&&(((O=(E=a==null?void 0:a.result)==null?void 0:E.data)==null?void 0:O.tables[b]).rows[T][p]=x,x==="bool"&&(((k=(P=a==null?void 0:a.result)==null?void 0:P.data)==null?void 0:k.tables[b]).rows[T][p+1]=!1))}})}return _.type}}:y.name==="value"&&u.name===b?{...w,render:(_,T)=>{const V=u.crows?u.crows[T][p]:null;if(ee.value){const x=F(ja,{value:+_.value,class:V!=_.value?"outline outline-red-500 w-full":"w-full",onUpdateValue(N){var E,O,P,k,J,U;(O=(E=a==null?void 0:a.result)==null?void 0:E.data)!=null&&O.tables&&((k=(P=a==null?void 0:a.result)==null?void 0:P.data)!=null&&k.tables[b])&&(((U=(J=a==null?void 0:a.result)==null?void 0:J.data)==null?void 0:U.tables[b]).rows[T][p]=N)}}),z=F(va,{value:String(_.value),class:V!==_.value?"!outline !outline-red-500":"",onUpdateValue(N){var E,O,P,k,J,U;(O=(E=a==null?void 0:a.result)==null?void 0:E.data)!=null&&O.tables&&((k=(P=a==null?void 0:a.result)==null?void 0:P.data)!=null&&k.tables[b])&&(((U=(J=a==null?void 0:a.result)==null?void 0:J.data)==null?void 0:U.tables[b]).rows[T][p]=N)}}),D=F("div",{class:"flex gap-2 h-[34px] leading-[34px]"},[F("div",{class:V!=_.value?"outline outline-red-500":""},F(ba,{lineClamp:1},{default:()=>_.value})),F(ve,{type:"info",size:"tiny",class:"!h-[34px] !w-[34px]",onClick:()=>{Y.value={show:!0,info:{rowIdx:T,cidx:p,value:_.value}}}},{icon:()=>F(nr)})]),X=F(Xa,{class:V!=_.value?"!outline !outline-red-500 w-32":"w-32",checkedValue:"true",uncheckedValue:"false",onUpdateValue:N=>{var E,O,P,k,J,U;(O=(E=a==null?void 0:a.result)==null?void 0:E.data)!=null&&O.tables&&((k=(P=a==null?void 0:a.result)==null?void 0:P.data)!=null&&k.tables[b])&&(((U=(J=a==null?void 0:a.result)==null?void 0:J.data)==null?void 0:U.tables[b]).rows[T][p]=N)}});return F("div",{class:"flex items-center"},Ya([["float","int"].includes(_.type)?x:null,["str","complex"].includes(_.type)?z:null,["dict","list","tuple","ndarray"].includes(_.type)?D:null,["bool"].includes(_.type)?X:null]))}return _.value}}:w});ee.value&&u.name===b&&v.push({title:M("expInfo.tableOptions"),key:"options",width:100,align:"rigth",render(y,p){const w=u.columns.findIndex(x=>x.name==="type"),_=u.crows?u.crows[p][w]:null,T=u.columns.findIndex(x=>x.name==="value"),V=u.crows?u.crows[p][T]:null;return F(ve,{type:"info",size:"small",class:"!h-[34px]",onClick:()=>{var x,z,D,X,N,E,O,P;(z=(x=a==null?void 0:a.result)==null?void 0:x.data)!=null&&z.tables&&((X=(D=a==null?void 0:a.result)==null?void 0:D.data)!=null&&X.tables[b])&&(((E=(N=a==null?void 0:a.result)==null?void 0:N.data)==null?void 0:E.tables[b]).rows[p][T]=V,((P=(O=a==null?void 0:a.result)==null?void 0:O.data)==null?void 0:P.tables[b]).rows[p][w]=_)}},{icon:()=>F(wa,{component:Ta})})}}),u.name===b&&ee.value&&v.unshift({type:"selection",key:"selection"}),d.push({oname:u.name,name:u.name===b?M("expInfo.needUpdateParams"):u.name===Yt?M("expInfo.updatedParams"):u.name,columns:v,rows:f})});const[l,g]=sr(d,{oname:Yt});return[...l,...g]}),le=K(),Pe=K(),Te=async(d,l)=>{var h,u,f;const[g,m]=await qa({fitter_group_name:d});if(!g&&(m==null?void 0:m.status)===0){De.value=m.data;const v=(f=(u=(h=a==null?void 0:a.expInfo)==null?void 0:h.exp)==null?void 0:u.template)==null?void 0:f.split("/")[1];v&&m.data[v]&&l?(le.value=v,He(()=>{Re(v)})):(le.value=Object.keys(m.data)[0],He(()=>{Re(Object.keys(m.data)[0])}))}},Re=async d=>{if(ne.value)return;ne.value=!0;const[l,g]=await Ba({fitter_group_name:j.value,fitter_name:d,group_name:I.query.device_group_name,space_id:I.query.space_id});ne.value=!1,!l&&(g==null?void 0:g.status)===0&&(g.data.exp_id&&(g.data.exp_id.default=I.query.exp_id?Number(I.query.exp_id):null),Pe.value=g.data)},ke=d=>{Te(d)},ot=d=>{Re(d)},Le=K(),ft=async()=>{var m;const d=[];(m=_e.value)==null||m.forEach(h=>{h.rows.forEach(u=>{u.key&&d.push(u.key)})});const[l,g]=await Va({device_group_name:I.query.device_group_name,space_id:+(I.query.space_id||""),keys:d});!l&&(g==null?void 0:g.status)===0&&(Le.value=g.data)},ct=async()=>{var f;if(!pe.value||we.value)return;we.value=!0;const d=await((f=pe.value[0])==null?void 0:f.submit()),l=Fa(d);if(Ot(l))return;const{device_group_name:g,space_id:m}=I.query,[h,u]=await Ka({setting:l,group_name:g,space_id:m,fitter_group:j.value,fitter_name:le.value});if(we.value=!1,!h&&(u==null?void 0:u.status)===0){a.result={...u.data,big_picture_url:"/"+u.data.plot_file_in_static};const[v,y]=await Ga("/"+u.data.table_file_in_static);v||(ee.value=!0,zt(y==null?void 0:y.tables,(p,w)=>{w===b&&(p.crows=JSON.parse(JSON.stringify(p.rows)),Me.value=p.crows.map(_=>_[0]))}),a.result={...a.result||{},data:y},He(()=>{ft()}))}},qe=async(d=!1)=>{var h,u,f,v,y;if(d){if(se.value)return;se.value=!0}else{if(re.value)return;re.value=!0}const l={group_name:I.query.device_group_name,space_id:I.query.space_id,exp_id:I.query.exp_id,task_id:((h=a.expInfo)==null?void 0:h.task_id)||"",img_file:((u=a.result)==null?void 0:u.plot_file)||"",table_file:((f=a.result)==null?void 0:f.table_file)||"",update_space_parameters:d};if(d){const p=(v=_e.value)==null?void 0:v.find(w=>w.oname===b);l.space_parameters=(y=Me.value)==null?void 0:y.map(w=>{var _;return(_=p.rows)==null?void 0:_.find(T=>T.key===w)})}const[g,m]=await Ha(l);!g&&(m==null?void 0:m.status)===0&&(Fe.success("Submit Successfully"),await Se(),ee.value=!1),d?se.value=!1:re.value=!1},Me=K(),dt=d=>{Me.value=d};xa(()=>{if(!I.query.exp_id){lt.back();return}ze(),Se()});const pt=()=>{qe()},_t=Vt(()=>{var l,g,m,h,u,f;const d=(g=(l=a.result)==null?void 0:l.data)!=null&&g.tables?(h=(m=a.result)==null?void 0:m.data)==null?void 0:h.tables[b]:null;if(!Ot(d)){const v=(u=d.columns)==null?void 0:u.findIndex(y=>y.name==="value");return v<0?!1:(f=d.crows)==null?void 0:f.some((y,p)=>y[v]!==d.rows[p][v])}return!1}),Je=()=>{Y.value={show:!1,info:void 0}},gt=()=>{var m,h,u,f,v,y;const{rowIdx:d,cidx:l,value:g}=Y.value.info;(h=(m=a==null?void 0:a.result)==null?void 0:m.data)!=null&&h.tables&&((f=(u=a==null?void 0:a.result)==null?void 0:u.data)!=null&&f.tables[b])&&(((y=(v=a==null?void 0:a.result)==null?void 0:v.data)==null?void 0:y.tables[b]).rows[d][l]=g),Je()};return Aa(()=>{a.result=void 0}),(d,l)=>{const g=Pa,m=Oa,h=ka,u=Za,f=La,v=Qa,y=er,p=Ca,w=Ea,_=Ia,T=Na,V=$a;return C(),te("div",null,[G(w,{type:"card",placement:"top",animated:"",onUpdateValue:ke,value:i(j),"onUpdate:value":l[3]||(l[3]=x=>Jt(j)?j.value=x:null),class:"!h-full"},{default:L(()=>[(C(!0),te(it,null,Pt(i(ie),(x,z)=>(C(),ae(p,{key:z,name:z,tab:x.title,disabled:i(ne)},{default:L(()=>[G(_,{class:"p-3 min-h-[260px]"},{default:L(()=>[G(w,{type:"line",placement:"left",value:i(le),"onUpdate:value":l[2]||(l[2]=D=>Jt(le)?le.value=D:null),size:"small",onUpdateValue:ot,style:{height:"calc(100vh - 330px)"}},{default:L(()=>[(C(!0),te(it,null,Pt(i(De),(D,X)=>(C(),ae(p,{key:X,name:X,tab:D.title,disabled:i(ne)},{default:L(()=>{var N,E,O,P,k,J;return[H("div",ir,[H("div",lr,[H("div",ur,[H("div",or,W(D.title),1),H("div",fr,W(D.desc),1)]),G(m,{show:i(ne)},{default:L(()=>{var U,xe;return[G(g,{style:{"max-height":"calc(100vh - 450px)"}},{default:L(()=>[i(Pe)&&!i(ne)?(C(),ae(za,{key:0,cfgs:i(Pe),ref_for:!0,ref_key:"dynamicFormRef",ref:pe},null,8,["cfgs"])):Ge("",!0)]),_:1}),(xe=(U=i(a))==null?void 0:U.expInfo)!=null&&xe.exp_id?(C(),te("div",cr,[G(i(ve),{type:"primary",onClick:ct,loading:i(we)},{default:L(()=>[Ee(W(i(M)("expInfo.ffitting")),1)]),_:1},8,["loading"])])):Ge("",!0)]}),_:1},8,["show"])]),H("div",{class:"flex-1 pl-3",style:Ra({borderLeft:`1px solid ${i(be).dividerColor}`})},[i(Ot)(i(a).result)?(C(),ae(h,{key:0,description:i(M)("expInfo.nores"),class:"mt-20"},null,8,["description"])):(C(),te(it,{key:1},[H("div",dr,[H("div",pr,[!((N=i(a).result)!=null&&N.plot_file)&&!((E=i(a).result)!=null&&E.table_file)&&((O=i(a).result)!=null&&O.create_time)?(C(),te("div",_r,[H("span",gr,W(i(M)("expInfo.resUploaded")),1),H("span",mr,W((P=i(a).result)==null?void 0:P.create_time),1)])):(C(),te("div",yr,W(i(M)("expInfo.result")),1))]),(k=i(a).result)!=null&&k.plot_file||(J=i(a).result)!=null&&J.table_file?(C(),te("div",hr,[i(_t)?(C(),ae(u,{key:0,onPositiveClick:pt},{trigger:L(()=>[G(i(ve),{loading:i(re),type:"primary",disabled:i(se)},{default:L(()=>[Ee(W(i(M)("expInfo.uploadOnly")),1)]),_:1},8,["loading","disabled"])]),default:L(()=>[Ee(" "+W(i(M)("expInfo.updateOnlyTips")),1)]),_:1})):(C(),ae(i(ve),{key:1,loading:i(re),type:"primary",onClick:l[0]||(l[0]=()=>qe()),disabled:i(se)},{default:L(()=>[Ee(W(i(M)("expInfo.uploadOnly")),1)]),_:1},8,["loading","disabled"])),G(i(ve),{loading:i(se),type:"primary",onClick:l[1]||(l[1]=()=>qe(!0)),disabled:i(re)},{default:L(()=>[Ee(W(i(M)("expInfo.uploadAndModifyParams")),1)]),_:1},8,["loading","disabled"])])):Ge("",!0)]),G(f,{class:"!my-2"}),G(g,{style:{"max-height":"calc(100vh - 400px)"}},{default:L(()=>{var U,xe;return[(U=i(a).result)!=null&&U.big_picture_url?(C(),ae(v,{key:0,src:i(Ma)((xe=i(a).result)==null?void 0:xe.big_picture_url,"t",String(+new Date)),alt:"",class:"max-w-full"},null,8,["src"])):Ge("",!0),(C(!0),te(it,null,Pt(i(_e),(ge,mt)=>(C(),te("div",{key:mt},[H("div",vr,W(ge.name),1),ge.oname===b?(C(),ae(y,{key:0,columns:ge.columns,data:ge.rows,"checked-row-keys":i(Me),"row-key":Ne=>Ne.key,"onUpdate:checkedRowKeys":dt},null,8,["columns","data","checked-row-keys","row-key"])):(C(),ae(y,{key:1,columns:ge.columns,data:ge.rows},null,8,["columns","data"]))]))),128))]}),_:2},1024)],64))],4)])]}),_:2},1032,["name","tab","disabled"]))),128))]),_:2},1032,["value"])]),_:2},1024)]),_:2},1032,["name","tab","disabled"]))),128))]),_:1},8,["value"]),G(V,{show:i(Y).show,"onUpdate:show":l[5]||(l[5]=x=>i(Y).show=x),"mask-closable":!1},{default:L(()=>[G(T,{style:{width:"1000px","min-height":"500px"},size:"huge",bordered:!1},{default:L(()=>[i(Y).info?(C(),ae(i(Ja),{key:0,class:Ua(["w-full h-[70vh] overflow-auto",[i(be).baseColor==="#000"?"jse-theme-dark":""]]),modelValue:i(Y).info.value,"onUpdate:modelValue":l[4]||(l[4]=x=>i(Y).info.value=x),mode:"text"},null,8,["class","modelValue"])):Ge("",!0),H("div",br,[G(i(ve),{onClick:Je},{default:L(()=>[Ee(W(i(M)("common.cancel")),1)]),_:1}),G(i(ve),{type:"primary",onClick:gt},{default:L(()=>[Ee(W(i(M)("common.OK")),1)]),_:1})])]),_:1})]),_:1},8,["show"])])}}});export{Fr as default};
