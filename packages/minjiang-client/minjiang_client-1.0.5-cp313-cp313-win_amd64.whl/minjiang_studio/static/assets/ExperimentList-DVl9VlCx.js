import{d as W,e as I,f,h as _,aT as We,I as Q,aU as Ue,U as Ie,aO as He,b as Z,C as ie,r as C,a3 as ue,i as t,W as ke,l as e,V as le,w as n,v as we,B as ye,as as vt,aa as _e,ah as fe,a8 as B,ar as gt,aS as ht,t as p,am as Ee,al as Le,a9 as K,s as E,aV as Be,F as Y,E as se,a2 as ce,A as Ce,L as X,aW as Ge,j as ae,a7 as J,aK as Te,aX as Je,k as Ye,m as Xe,N as pe,n as Qe,c as Ze,ao as Oe,J as et,ay as je,a5 as Ae,aH as tt,aJ as ot,R as nt,aI as st,aY as lt,aZ as Ne,a_ as yt,K as bt,a$ as oe,aP as ge,ap as at,az as kt,a0 as wt,b0 as rt,b1 as Fe,ai as Ve}from"./index-BwlMlHGj.js";import{u as ee}from"./expList-CPsdoT0A.js";import{a as Et,b as Ct,d as $t,e as St,S as Nt}from"./StarOutline-DlU6FzvB.js";import{g as Dt,s as Ft,a as It,b as Lt}from"./exp-BFwh7v1l.js";import{_ as Tt}from"./DynamicForm.vue_vue_type_script_setup_true_lang-DoGDCFcf.js";import{C as Mt,P as it}from"./Pulse-OIHU5Vrb.js";import{b as qe,m as Rt,c as jt,r as qt,d as Ot,e as zt,f as Ut,R as Bt,t as At}from"./RecordStop24Regular-A3Huc0_U.js";import{_ as Vt,a as Pt}from"./Checkbox-UFZekRDE.js";import{_ as ct}from"./Tree-BOaYkUf-.js";import{_ as dt,a as ut,H as pt,D as Kt,b as ne}from"./InfoItem.vue_vue_type_script_setup_true_lang-DeGHLkw5.js";import{F as _t}from"./Folder-91lMHgDZ.js";import{o as Wt}from"./index-Cw2lcNW7.js";import{E as Ht}from"./ExitOutline-BKfO8kvq.js";import{F as Gt}from"./FolderAdd28Regular-CEUR2cWD.js";import{A as Jt}from"./Add-CvJqOuqG.js";import{_ as Yt}from"./ConfirmModal.vue_vue_type_script_setup_true_lang-DPOFDHZH.js";import{D as Xt,_ as ft}from"./Delete24Regular-5CFfOF6G.js";import{u as Qt}from"./groupDetail-Bjf-6Lmm.js";import{u as Zt}from"./useInterval-C0oJbCEJ.js";import{c as mt}from"./index-C1C63wPC.js";import{S as he,u as eo,_ as to}from"./index-BC7X5_Ah.js";import{_ as oo,N as no}from"./Image-B_0rm4XX.js";import"./json-editor-vue-CSlvxqm5.js";import"./InputNumber-RrJJyZaR.js";import"./Switch-B5yYo9Bh.js";import"./download-C2161hUv.js";const so={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},lo=W({name:"Eye",render:function(y,r){return f(),I("svg",so,r[0]||(r[0]=[_("circle",{cx:"256",cy:"256",r:"64",fill:"currentColor"},null,-1),_("path",{d:"M490.84 238.6c-26.46-40.92-60.79-75.68-99.27-100.53C349 110.55 302 96 255.66 96c-42.52 0-84.33 12.15-124.27 36.11c-40.73 24.43-77.63 60.12-109.68 106.07a31.92 31.92 0 0 0-.64 35.54c26.41 41.33 60.4 76.14 98.28 100.65C162 402 207.9 416 255.66 416c46.71 0 93.81-14.43 136.2-41.72c38.46-24.77 72.72-59.66 99.08-100.92a32.2 32.2 0 0 0-.1-34.76zM256 352a96 96 0 1 1 96-96a96.11 96.11 0 0 1-96 96z",fill:"currentColor"},null,-1)]))}}),ao={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ro=W({name:"Move",render:function(y,r){return f(),I("svg",ao,r[0]||(r[0]=[We('<path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M176 112l80-80l80 80"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M255.98 32l.02 448"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M176 400l80 80l80-80"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M400 176l80 80l-80 80"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M112 176l-80 80l80 80"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M32 256h448"></path>',6)]))}}),io={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},co=W({name:"ArrowBarRight",render:function(y,r){return f(),I("svg",io,r[0]||(r[0]=[We('<g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 12H10"></path><path d="M20 12l-4 4"></path><path d="M20 12l-4-4"></path><path d="M4 4v16"></path></g>',1)]))}}),uo={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},po=W({name:"ArrowMove24Regular",render:function(y,r){return f(),I("svg",uo,r[0]||(r[0]=[_("g",{fill:"none"},[_("path",{d:"M15.28 6.03a.75.75 0 0 1-1.06 0l-1.47-1.47v3.69a.75.75 0 0 1-1.5 0V4.56L9.78 6.03a.75.75 0 0 1-1.06-1.06l2.75-2.75a.75.75 0 0 1 1.06 0l2.75 2.75a.75.75 0 0 1 0 1.06zm-9.25 8.19a.75.75 0 1 1-1.06 1.06l-2.75-2.75a.75.75 0 0 1 0-1.06l2.75-2.75a.75.75 0 0 1 1.06 1.06l-1.47 1.47h3.69a.75.75 0 0 1 0 1.5H4.56l1.47 1.47zm11.94 1.06a.75.75 0 0 1 0-1.06l1.47-1.47h-3.69a.75.75 0 0 1 0-1.5h3.69l-1.47-1.47a.75.75 0 0 1 1.06-1.06l2.75 2.75a.75.75 0 0 1 0 1.06l-2.75 2.75a.75.75 0 0 1-1.06 0zm-2.69 2.69a.75.75 0 0 0-1.06 0l-1.47 1.47v-3.69a.75.75 0 0 0-1.5 0v3.69l-1.47-1.47a.75.75 0 0 0-1.06 1.06l2.75 2.75a.75.75 0 0 0 1.06 0l2.75-2.75a.75.75 0 0 0 0-1.06z",fill:"currentColor"})],-1)]))}}),_o={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},fo=W({name:"DriveFileRenameOutlineFilled",render:function(y,r){return f(),I("svg",_o,r[0]||(r[0]=[_("path",{d:"M18.41 5.8L17.2 4.59c-.78-.78-2.05-.78-2.83 0l-2.68 2.68L3 15.96V20h4.04l8.74-8.74l2.63-2.63c.79-.78.79-2.05 0-2.83zM6.21 18H5v-1.21l8.66-8.66l1.21 1.21L6.21 18zM11 20l4-4h6v4H11z",fill:"currentColor"},null,-1)]))}}),Pe=(z,y)=>{var d;if(!z.length)return;const r=document.createEvent("MouseEvents");r.initEvent("click",!0,!0);const s=z.map(m=>Q(oo,{width:100,src:m}));let v=document.querySelector("#preview-image");if(!v){const m=document.createElement("div");m.id="preview-image",document.body.appendChild(m),v=m}s.length>1?Ue(Q(no,{},[Q(Ie,{},s)]),v):Ue(s[0],v),(d=v==null?void 0:v.querySelectorAll(".n-image img")[y])==null||d.dispatchEvent(r)},mo={class:"absolute top-1 right-1"},xo={class:"pl-5 h-full tpl-s-g"},vo={class:"mb-5"},go={class:"text-xl"},ho={class:"text-sm opacity-80"},yo={class:"flex justify-end items-center gap-2 mt-2 mr-[20px]"},bo=W({__name:"ExpsTpl",props:{fid:{}},setup(z,{expose:y}){const r=z,s=He(),{t:v}=Z(),d=ie(),m=C(),b=C(!1),k=C(!1),R=C(!1),L=C(!1),j=()=>{L.value=!0},T=()=>{L.value=!1},M=C(),q=C(),w=C(),$=async()=>{const[o,l]=await Et();!o&&(l==null?void 0:l.status)===0&&(w.value=l.data,M.value=Object.keys(l.data)[0],O(M.value))},g=C(),D=C(),O=async o=>{const[l,h]=await Ct({template_group_name:o});!l&&(h==null?void 0:h.status)===0&&(q.value=h.data,g.value=Object.keys(h.data)[0],N(Object.keys(h.data)[0]))},N=async o=>{if(R.value)return;R.value=!0;const[l,h]=await $t({template_group_name:M.value,template_name:o,group_name:d.query.device_group_name,space_id:d.query.space_id});R.value=!1,!l&&(h==null?void 0:h.status)===0&&(D.value=h.data)},S=o=>{O(o)},a=o=>{N(o)},i=async()=>{var H;if(b.value||!m.value)return;b.value=!0;let o={};try{o=await((H=m.value[0])==null?void 0:H.submit())}catch{b.value=!1;return}const l=Be(o);if(Y(l))return;const{device_group_name:h,space_id:u,task_id:x}=d.query,[F,U]=await St({setting:l,task_id:x,group_name:h,space_id:u,template_group:M.value,template_name:g.value,exp_folder_id:+String(r.fid)});b.value=!1,!F&&(U==null?void 0:U.status)===0&&(U.data.exp.template=U.data.exp.template||`${M.value}/${g.value}`,se(()=>{setTimeout(()=>{localStorage.setItem("t",JSON.stringify(U));const P=new URLSearchParams({device_group_name:d.query.device_group_name,task_id:d.query.task_id,task_title:d.query.task_title,space_id:d.query.space_id,create:"1",fid:String(r.fid)});window.open(`/experiment/expSettings?${P.toString()}`,s.expOpenForm)},100),T()}))},c=async()=>{var H;if(k.value||!m.value)return;k.value=!0;let o={};try{o=await((H=m.value[0])==null?void 0:H.submit())}catch{k.value=!1;return}const l=Be(o);if(Y(l))return;const{device_group_name:h,space_id:u,task_id:x}=d.query,[F,U]=await Dt({setting:l,task_id:x,group_name:h,space_id:u,template_group:M.value,template_name:g.value,exp_folder_id:+String(r.fid)});k.value=!1,!F&&(U==null?void 0:U.status)===0&&(setTimeout(()=>{const P=new URLSearchParams({device_group_name:d.query.device_group_name,task_id:d.query.task_id,task_title:d.query.task_title,space_id:d.query.space_id,exp_id:String(U.data.exp_id)});window.open(`/experiment/plotter?${P.toString()}`,s.expOpenForm)},100),T())};return ue(L,o=>{o&&$()},{immediate:!0}),y({open:j,close:T}),(o,l)=>{const h=ye,u=Le,x=Ee,F=gt,U=vt,H=ht,P=we,G=ke;return f(),I("div",null,[t(G,{show:e(L),"onUpdate:show":l[2]||(l[2]=A=>le(L)?L.value=A:null),size:"huge"},{default:n(()=>[t(P,{style:{"min-height":"700px",height:"calc(100vh - 100px)","box-sizing":"border-box",overflow:"hidden",width:"80vw","min-width":"600px",padding:"12px",position:"relative"},"content-class":"!pb-0"},{default:n(()=>[_("div",mo,[t(h,{type:"primary",onClick:T,size:"small",circle:""},{icon:n(()=>[t(e(Mt))]),_:1})]),t(U,{type:"card",placement:"left",animated:"",onUpdateValue:S,value:e(M),"onUpdate:value":l[1]||(l[1]=A=>le(M)?M.value=A:null),style:{height:"calc(100vh - 160px)"}},{default:n(()=>[(f(!0),I(_e,null,fe(e(w),(A,me)=>(f(),B(F,{key:me,name:me,tab:A.title,disabled:e(R)},{default:n(()=>[t(H,{style:{height:"100%","padding-top":"10px","box-sizing":"border-box"}},{default:n(()=>[t(U,{type:"line",placement:"left",value:e(g),"onUpdate:value":l[0]||(l[0]=te=>le(g)?g.value=te:null),onUpdateValue:a,style:{height:"100%"}},{default:n(()=>[(f(!0),I(_e,null,fe(e(q),(te,de)=>(f(),B(F,{key:de,name:de,tab:te.title,disabled:e(R)},{default:n(()=>[_("div",xo,[_("div",vo,[_("div",go,p(te.title),1),_("div",ho,p(te.desc),1)]),t(x,{show:e(R)},{default:n(()=>[t(u,{style:{"padding-right":"20px"}},{default:n(()=>[e(D)&&!e(R)?(f(),B(Tt,{key:0,cfgs:e(D),ref_for:!0,ref_key:"dynamicFormRef",ref:m},null,8,["cfgs"])):K("",!0)]),_:1}),_("div",yo,[t(h,{loading:e(k),disabled:e(b),type:"primary",onClick:c},{default:n(()=>[E(p(e(v)("groupDetail.exps.createsubmit")),1)]),_:1},8,["loading","disabled"]),t(h,{loading:e(b),disabled:e(k),type:"primary",onClick:i},{default:n(()=>[E(p(e(v)("groupDetail.exps.createExpBtn")),1)]),_:1},8,["loading","disabled"])])]),_:1},8,["show"])])]),_:2},1032,["name","tab","disabled"]))),128))]),_:1},8,["value"])]),_:1})]),_:2},1032,["name","tab","disabled"]))),128))]),_:1},8,["value"])]),_:1})]),_:1},8,["show"])])}}}),ko=ce(bo,[["__scopeId","data-v-5be5eb4a"]]),wo={class:"text-center text-lg"},Eo={class:"flex"},Co={class:"flex-1"},$o={class:"flex justify-center items-center mx-2"},So={class:"flex-1 min-h-[300px]"},No=W({__name:"BatchModal",setup(z,{expose:y}){const r=ie(),s=Ce(),{t:v}=Z(),d=C(!1),m=ee(),b=()=>{d.value=!1,L.value=["root"],q.value=!1,w.value=!1,N.value=[],g.value=[]};y({open:()=>{d.value=!0},close:b});const k=C(),R=C(!1),L=C(["root"]),j=({option:i})=>Q("div",{className:i.keys==="root"?"font-extrabold w-full":"flex justify-between w-full"},Q("div",{className:"flex justify-between items-center gap-1 w-full"},[Q("span",i.label)])),T=(i,c,o)=>{k.value=o.action==="unselect"||o==null?void 0:o.node},M=i=>{L.value=i},q=C(!1),w=C(!1),$=C(!1),g=C(),D=async()=>{var o,l;if($.value)return;$.value=!0;const[i,c]=await qe({device_group_name:r.query.device_group_name,task_id:+(r.query.task_id||""),exp_folder_id:(o=m.curNode)==null?void 0:o.exp_folder_id,limit:999999999,before_exp_id:null});$.value=!1,!i&&(c==null?void 0:c.status)===0&&(g.value=c.data.list,w.value&&(N.value=(l=c.data.list)==null?void 0:l.map(h=>h.exp_id)))};ue(w,i=>{var c,o;i&&(q.value=!0),i&&Y(g.value)&&D(),i&&!Y(g)&&(N.value=(c=g.value)==null?void 0:c.map(l=>l.exp_id)),!i&&q.value&&(N.value=(o=m.curExpList)==null?void 0:o.map(l=>l.exp_id)),!i&&!q.value&&(N.value=[])}),ue(q,i=>{var c,o;i&&w.value&&(N.value=(c=g.value)==null?void 0:c.map(l=>l.exp_id)),i&&!w.value&&(N.value=m.curExpList.map(l=>l.exp_id)),!i&&w.value&&(N.value=(o=g.value)==null?void 0:o.map(l=>l.exp_id)),!i&&!w.value&&(N.value=[])}),ue(d,i=>{i||b()});const O=X(()=>w.value?g.value:(q.value,m.curExpList)),N=C(),S=async()=>{var o;const[i,c]=await Rt({task_id:+(r.query.task_id||""),sub_process_ids:N.value||[],target_exp_folder_id:(o=k.value)==null?void 0:o.exp_folder_id});!i&&(c==null?void 0:c.status)===0&&(b(),m.refreshExpList=!0)},a=X(()=>{const i=JSON.parse(JSON.stringify(m.tree||[]));return Ge(i),i});return(i,c)=>{const o=ae,l=Vt,h=Te,u=Pt,x=Le,F=Ee,U=ye,H=ct,P=we,G=ke;return f(),B(G,{show:e(d),"onUpdate:show":c[3]||(c[3]=A=>le(d)?d.value=A:null)},{default:n(()=>[t(P,{style:{width:"1000px"}},{default:n(()=>[_("div",wo,p(e(v)("groupDetail.exps.batchMove")),1),t(o,{class:"!my-3"}),_("div",Eo,[_("div",Co,[_("div",null,[t(l,{checked:e(q),"onUpdate:checked":c[0]||(c[0]=A=>le(q)?q.value=A:null)},{default:n(()=>[E(p(e(v)("groupDetail.exps.selectedCurPage")),1)]),_:1},8,["checked"]),t(l,{checked:e(w),"onUpdate:checked":c[1]||(c[1]=A=>le(w)?w.value=A:null)},{default:n(()=>[E(p(e(v)("groupDetail.exps.selectedAllExps")),1)]),_:1},8,["checked"])]),_("div",{style:J({backgroundColor:e(s).baseColor}),class:"rounded-xl p-2"},[t(F,{show:e($)},{default:n(()=>[t(x,{style:{height:"500px"}},{default:n(()=>[t(u,{value:e(N),"onUpdate:value":c[2]||(c[2]=A=>le(N)?N.value=A:null)},{default:n(()=>[(f(!0),I(_e,null,fe(e(O),A=>(f(),I("div",{key:A.exp_id},[t(l,{value:A.exp_id},{default:n(()=>[t(h,{"line-clamp":1},{default:n(()=>[E(p(A.exp_id)+" "+p(A.description),1)]),_:2},1024)]),_:2},1032,["value"])]))),128))]),_:1},8,["value"])]),_:1})]),_:1},8,["show"])],4)]),_("div",$o,[t(U,{disabled:e(Y)(e(k)),type:"primary",onClick:S},{icon:n(()=>[t(e(co))]),_:1},8,["disabled"])]),_("div",So,[_("div",null,p(e(v)("groupDetail.exps.selecteTargetFolder")),1),_("div",{style:J({backgroundColor:e(s).baseColor}),class:"rounded-xl p-2"},[t(x,{style:{"max-height":"500px"}},{default:n(()=>[t(H,{"block-line":"","show-line":"",selectable:"",disabled:e(R),"render-label":j,"expanded-keys":e(L),data:e(a),onUpdateExpandedKeys:M,"onUpdate:selectedKeys":T},null,8,["disabled","expanded-keys","data"])]),_:1})],4)])])]),_:1})]),_:1},8,["show"])}}}),Do={class:"text-xl text-center mb-4 font-bold"},Fo={key:0},Io={key:1},xt=W({__name:"FolderEdit",props:{type:{}},setup(z,{expose:y}){const r=z,s=ee(),v=ie(),{t:d}=Z(),m=C(!1),b=C(),k=C({exp_folder_name:void 0,exp_folder_description:void 0,exp_folder_id:void 0}),R={exp_folder_name:{required:!0,message:d("groupDetail.exps.folderNameTips"),trigger:"blur"}},L=C(!1),j=g=>{g||T()},T=()=>{L.value=!1,k.value={exp_folder_description:void 0,exp_folder_name:void 0,exp_folder_id:void 0}},M=async()=>{var g;m.value||(m.value=!0,(g=b.value)==null||g.validate(async D=>{var S;if(D){m.value=!1;return}const[O,N]=await jt({task_id:Number(v.query.task_id||""),...k.value,parent_exp_folder_id:(S=s.curNode)==null?void 0:S.exp_folder_id});m.value=!1,!O&&(N==null?void 0:N.status)===0&&(T(),s.refreshExpFolderTree=!0)}))},q=async()=>{var g;m.value||(m.value=!0,(g=b.value)==null||g.validate(async D=>{if(D||!k.value.exp_folder_id){m.value=!1;return}const[O,N]=await qt({exp_folder_id:k.value.exp_folder_id,new_exp_folder_name:k.value.exp_folder_name||"",new_exp_folder_description:k.value.exp_folder_description||""});m.value=!1,!O&&(N==null?void 0:N.status)===0&&(T(),s.refreshExpFolderTree=!0)}))},w=()=>{r.type==="create"?M():q()},$=X(()=>{var g;return Je(s.tree||[],((g=s.curNode)==null?void 0:g.exp_folder_id)||null)});return y({open:()=>L.value=!0,close:T,setData:(g={})=>k.value={...k.value||{},...g}}),(g,D)=>{const O=ae,N=pe,S=ut,a=dt,i=Xe,c=Qe,o=Ye,l=ye,h=Ie,u=we,x=ke;return f(),B(x,{show:e(L),"onUpdate:show":D[2]||(D[2]=F=>le(L)?L.value=F:null),"on-update:show":j},{default:n(()=>[t(u,{style:{width:"800px"},size:"huge",bordered:!1},{default:n(()=>[_("div",Do,[g.type==="create"?(f(),I("span",Fo,p(e(d)("groupDetail.exps.newFolder")),1)):(f(),I("span",Io,p(e(d)("groupDetail.exps.rename")),1))]),t(O),t(o,{ref_key:"formRef",ref:b,model:e(k),rules:R},{default:n(()=>[t(i,{label:e(d)("groupDetail.exps.targetPath")},{default:n(()=>[t(a,null,{default:n(()=>[(f(!0),I(_e,null,fe(e($),(F,U)=>(f(),B(S,{clickable:!1,separator:">",key:F.exp_folder_id},{default:n(()=>[U===0?(f(),B(N,{key:0,component:e(pt)},null,8,["component"])):(f(),B(N,{key:1,component:e(_t)},null,8,["component"])),E(" "+p(F.exp_folder_name),1)]),_:2},1024))),128))]),_:1})]),_:1},8,["label"]),t(i,{label:e(d)("groupDetail.exps.folderName"),path:"exp_folder_name"},{default:n(()=>[t(c,{value:e(k).exp_folder_name,"onUpdate:value":D[0]||(D[0]=F=>e(k).exp_folder_name=F)},null,8,["value"])]),_:1},8,["label"]),t(i,{label:e(d)("groupDetail.exps.folderDesc"),path:"description"},{default:n(()=>[t(c,{type:"textarea",value:e(k).exp_folder_description,"onUpdate:value":D[1]||(D[1]=F=>e(k).exp_folder_description=F)},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model"]),t(h,{justify:"end"},{default:n(()=>[t(l,{onClick:T},{default:n(()=>[E(p(e(d)("groupDetail.exps.cancel")),1)]),_:1}),t(l,{type:"primary",onClick:w,loading:e(m)},{default:n(()=>[E(p(e(d)("common.OK")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["show"])}}}),Lo={class:"flex justify-between items-center"},To={class:"flex gap-2 items-center"},Mo={class:"font-bold text-lg flex items-center gap-2"},Ro={class:"flex items-center gap-2"},jo=W({__name:"ExpTitleBar",setup(z){const y=ee(),{t:r}=Z(),s=ie(),v=Ze(),d=()=>{m.value&&m.value.length>1?b(m.value[m.value.length-2],!0):v.push({name:"taskList",query:{device_group_name:s.query.device_group_name}})},m=X(()=>{var w;return Je(y.tree||[],((w=y.curNode)==null?void 0:w.exp_folder_id)||null)}),b=({exp_folder_id:w},$)=>{if(!$)return;const g=Wt(s.query,"fid");w&&(g.fid=w),y.curNode=void 0,y.loadingCurNode=!0,y.curExpList=[],y.curExpNode=void 0,y.curFolderNode=void 0,se(()=>{v.push({name:"experimentList",query:g}).then(()=>{y.curNode={exp_folder_id:w}})})},k=C(),R=()=>{var w;(w=k.value)==null||w.open()},L=C(),j=C(),T=()=>{var w;(w=L.value)==null||w.open()},M=()=>{var w;(w=j.value)==null||w.open()},q=X(()=>!Y(y.curExpList));return(w,$)=>{var i;const g=pe,D=ye,O=Oe,N=ae,S=ut,a=dt;return f(),I("div",null,[_("div",Lo,[_("div",To,[t(D,{type:"primary",onClick:d,class:"!rotate-180 !mr-5",size:"small"},{icon:n(()=>[t(g,null,{default:n(()=>[t(e(Ht))]),_:1})]),_:1}),_("div",Mo,[t(O,{bordered:!1,color:{color:"#b63636",textColor:"#fff"},class:"!rounded"},{default:n(()=>[E(p(e(r)("groupDetail.exps.task"))+" "+p(e(s).query.task_id),1)]),_:1}),E(" "+p(e(s).query.task_title),1)]),t(N,{vertical:""}),t(a,null,{default:n(()=>[(f(!0),I(_e,null,fe(e(m),(c,o)=>(f(),B(S,{clickable:o<=e(m).length-1,onClick:()=>b(c,o<e(m).length-1),separator:">",key:c.exp_folder_id},{default:n(()=>[o===0?(f(),B(g,{key:0,component:e(pt)},null,8,["component"])):(f(),B(g,{key:1,component:e(_t)},null,8,["component"])),E(" "+p(c.exp_folder_name),1)]),_:2},1032,["clickable","onClick"]))),128))]),_:1})]),_("div",Ro,[t(D,{type:"primary",onClick:M,disabled:!e(q)},{icon:n(()=>[t(e(po))]),default:n(()=>[E(" "+p(e(r)("groupDetail.exps.move")),1)]),_:1},8,["disabled"]),t(D,{type:"primary",onClick:R},{icon:n(()=>[t(e(Gt))]),default:n(()=>[E(" "+p(e(r)("groupDetail.exps.newFolder")),1)]),_:1}),t(D,{type:"primary",onClick:T},{icon:n(()=>[t(e(Jt))]),default:n(()=>[E(" "+p(e(r)("groupDetail.exps.createFromTemplate")),1)]),_:1})])]),t(N,{class:"!mt-5 !mb-2"}),t(xt,{type:"create",ref_key:"folderEditRef",ref:k},null,512),t(ko,{ref_key:"expsTplRef",ref:L,fid:((i=e(y).curNode)==null?void 0:i.exp_folder_id)||"root"},null,8,["fid"]),t(No,{ref_key:"batchModalRef",ref:j},null,512)])}}}),qo={class:"text-center text-lg"},Oo={class:"flex-1 min-h-[300px]"},zo=W({__name:"FolderMove",setup(z,{expose:y}){const r=C(),s=Ce(),{t:v}=Z(),d=C(!1),m=ee(),b=()=>{d.value=!1,L.value=["root"]};y({open:()=>{d.value=!0},close:b,setData:$=>{r.value=$.id}});const k=C(),R=C(!1),L=C(["root"]),j=({option:$})=>Q("div",{className:$.keys==="root"?"font-extrabold w-full":"flex justify-between w-full"},Q("div",{className:"flex justify-between items-center gap-1 w-full"},[Q("span",$.label)])),T=($,g,D)=>{k.value=D.action==="unselect"||D==null?void 0:D.node},M=$=>{L.value=$};ue(d,$=>{$||b()});const q=async()=>{const[$,g]=await Ot({exp_folder_id:r.value,target_parent_exp_folder_id:k.value.exp_folder_id});!$&&(g==null?void 0:g.status)===0&&(b(),se(()=>{m.refreshExpFolderTree=!0}))},w=X(()=>{const $=JSON.parse(JSON.stringify(m.tree||[]));return Ge($),$});return($,g)=>{const D=ae,O=ct,N=Le,S=ye,a=Ie,i=we,c=ke;return f(),B(c,{show:e(d),"onUpdate:show":g[0]||(g[0]=o=>le(d)?d.value=o:null)},{default:n(()=>[t(i,{style:{width:"500px"}},{default:n(()=>[_("div",qo,p(e(v)("groupDetail.exps.moveFolder")),1),t(D,{class:"!my-3"}),_("div",Oo,[_("div",null,p(e(v)("groupDetail.exps.selecteTargetFolder")),1),_("div",{style:J({backgroundColor:e(s).baseColor}),class:"rounded-xl p-2"},[t(N,{style:{"max-height":"500px"}},{default:n(()=>[t(O,{"block-line":"","show-line":"",selectable:"",disabled:e(R),"render-label":j,"expanded-keys":e(L),data:e(w),onUpdateExpandedKeys:M,"onUpdate:selectedKeys":T},null,8,["disabled","expanded-keys","data"])]),_:1})],4)]),t(a,{justify:"end"},{default:n(()=>[t(S,{onClick:b},{default:n(()=>[E(p(e(v)("common.cancel")),1)]),_:1}),t(S,{disabled:e(Y)(e(k)),type:"primary",onClick:q},{default:n(()=>[E(p(e(v)("common.OK")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["show"])}}}),Uo={class:"folder-icon"},Bo=W({__name:"FolderItem",props:{count:{}},setup(z){return(y,r)=>(f(),I("div",Uo))}}),Ao=ce(Bo,[["__scopeId","data-v-98d54097"]]),Vo=["onDblclick","onClick","onContextmenu"],Po=W({__name:"ExpFolders",setup(z){et(o=>({e4594578:e(r).cardColor}));const{t:y}=Z(),r=Ce(),s=ee(),v=Ze(),d=ie(),m=C(!1),b=async()=>{var u,x;if(!+(((u=d.query)==null?void 0:u.task_id)||"")||m.value||(m.value=!0,!d.query.device_group_name))return;const[l,h]=await zt({task_id:+(((x=d.query)==null?void 0:x.task_id)||""),include_experiments:!1});m.value=!1,!l&&h&&h.status===0&&(Array.isArray(h.data.folder_tree)||(h.data.folder_tree=[h.data.folder_tree]),s.tree=h.data.folder_tree,s.refreshExpFolderTree&&(s.refreshExpFolderTree=!1),d.query.fid&&se(()=>{s.curNode=Ae(s.tree||[],+(d.query.fid||""),"exp_folder_id")}))};je(()=>{b()}),ue(()=>s.refreshExpFolderTree,o=>{o&&b()});const k=X(()=>{var o,l;return(l=Ae(s.tree||[],(o=s.curNode)==null?void 0:o.exp_folder_id,"exp_folder_id"))==null?void 0:l.children}),R=o=>{s.curNode=void 0,s.loadingCurNode=!0,s.curExpList=[],s.curExpNode=void 0,s.curFolderNode=void 0,se(()=>{v.push({name:"experimentList",query:{...d.query,fid:o.exp_folder_id}}).then(()=>{s.curNode=o})})},L=X(()=>Y(k.value)&&Y(s.curExpList)),j=o=>()=>Q(pe,null,{default:()=>Q(o)}),T=[{label:y("groupDetail.exps.delete"),key:"delete",icon:j(Xt)},{label:y("groupDetail.exps.rename"),key:"rename",icon:j(fo)},{label:y("groupDetail.exps.moveFolder"),key:"move",icon:j(ro)}],M=C(),q=C(!1),w=C(),$=C(),g=async()=>{var o,l;if((o=$.value)!=null&&o.exp_folder_id){const[h,u]=await Ut({exp_folder_id:$.value.exp_folder_id});!h&&(u==null?void 0:u.status)===0&&((l=w.value)==null||l.close(),$.value=void 0,s.refreshExpFolderTree=!0)}},D=(o,l)=>{o.preventDefault(),$.value=l,M.value={x:o.clientX,y:o.clientY},q.value=!0},O=()=>{q.value=!1,M.value=void 0},N=C(),S=C(),a=o=>{var l,h,u,x,F;o==="delete"?(l=w.value)==null||l.open():o=="rename"?((h=N.value)==null||h.open(),(u=N.value)==null||u.setData({exp_folder_id:$.value.exp_folder_id,exp_folder_name:$.value.exp_folder_name,exp_folder_description:$.value.exp_folder_description})):o==="move"&&((x=S.value)==null||x.open(),(F=S.value)==null||F.setData({id:$.value.exp_folder_id}))},i=o=>{o||($.value=void 0)},c=o=>{s.curFolderNode=o,s.curExpNode=void 0};return(o,l)=>{var H,P;const h=tt,u=Te,x=ot,F=st,U=lt;return f(),I("div",null,[e(L)?(f(),B(h,{key:0,class:"mt-40"})):K("",!0),t(F,{"x-gap":16,"y-gap":16,cols:"6 1200:8 1600:8",class:"mb-4"},{default:n(()=>[(f(!0),I(_e,null,fe(e(k),G=>(f(),B(x,{key:G.exp_folder_id,class:"rounded cursor-pointer"},{default:n(()=>[_("div",{class:"flex justify-center flex-col items-center exp-folder-card",onDblclick:()=>R(G),onClick:()=>c(G),onContextmenu:nt(A=>D(A,G),["prevent"])},[t(Ao,{count:G.experiment_count},null,8,["count"]),_("div",null,[t(u,{"line-clamp":1},{default:n(()=>[E(p(G.exp_folder_name),1)]),_:2},1024)])],40,Vo)]),_:2},1024))),128))]),_:1}),t(xt,{type:"edit",ref_key:"folderEditRef",ref:N},null,512),t(zo,{ref_key:"folderMoveRef",ref:S},null,512),e(q)?(f(),B(U,{key:1,placement:"bottom-start",show:!0,options:T,x:(H=e(M))==null?void 0:H.x,y:(P=e(M))==null?void 0:P.y,onClickoutside:O,onSelect:a},{default:n(()=>l[0]||(l[0]=[_("div",null,null,-1)])),_:1},8,["x","y"])):K("",!0),t(Yt,{ref_key:"confirmRef",ref:w,onOk:g,onChange:i},null,512)])}}}),Ko=ce(Po,[["__scopeId","data-v-e5b120cf"]]);var Re,Ke;function Wo(){if(Ke)return Re;Ke=1;var z="Expected a function",y=NaN,r="[object Symbol]",s=/^\s+|\s+$/g,v=/^[-+]0x[0-9a-f]+$/i,d=/^0b[01]+$/i,m=/^0o[0-7]+$/i,b=parseInt,k=typeof Ne=="object"&&Ne&&Ne.Object===Object&&Ne,R=typeof self=="object"&&self&&self.Object===Object&&self,L=k||R||Function("return this")(),j=Object.prototype,T=j.toString,M=Math.max,q=Math.min,w=function(){return L.Date.now()};function $(a,i,c){var o,l,h,u,x,F,U=0,H=!1,P=!1,G=!0;if(typeof a!="function")throw new TypeError(z);i=S(i)||0,D(c)&&(H=!!c.leading,P="maxWait"in c,h=P?M(S(c.maxWait)||0,i):h,G="trailing"in c?!!c.trailing:G);function A(V){var re=o,be=l;return o=l=void 0,U=V,u=a.apply(be,re),u}function me(V){return U=V,x=setTimeout(xe,i),H?A(V):u}function te(V){var re=V-F,be=V-U,ze=i-re;return P?q(ze,h-be):ze}function de(V){var re=V-F,be=V-U;return F===void 0||re>=i||re<0||P&&be>=h}function xe(){var V=w();if(de(V))return $e(V);x=setTimeout(xe,te(V))}function $e(V){return x=void 0,G&&o?A(V):(o=l=void 0,u)}function Me(){x!==void 0&&clearTimeout(x),U=0,o=F=l=x=void 0}function Se(){return x===void 0?u:$e(w())}function ve(){var V=w(),re=de(V);if(o=arguments,l=this,F=V,re){if(x===void 0)return me(F);if(P)return x=setTimeout(xe,i),A(F)}return x===void 0&&(x=setTimeout(xe,i)),u}return ve.cancel=Me,ve.flush=Se,ve}function g(a,i,c){var o=!0,l=!0;if(typeof a!="function")throw new TypeError(z);return D(c)&&(o="leading"in c?!!c.leading:o,l="trailing"in c?!!c.trailing:l),$(a,i,{leading:o,maxWait:i,trailing:l})}function D(a){var i=typeof a;return!!a&&(i=="object"||i=="function")}function O(a){return!!a&&typeof a=="object"}function N(a){return typeof a=="symbol"||O(a)&&T.call(a)==r}function S(a){if(typeof a=="number")return a;if(N(a))return y;if(D(a)){var i=typeof a.valueOf=="function"?a.valueOf():a;a=D(i)?i+"":i}if(typeof a!="string")return a===0?a:+a;a=a.replace(s,"");var c=d.test(a);return c||m.test(a)?b(a.slice(2),c?2:8):v.test(a)?y:+a}return Re=g,Re}var Ho=Wo();const Go=yt(Ho),Jo={key:0,class:"absolute right-1 top-0.5 z-10"},Yo={key:1,class:"file-triangle"},Xo={class:"flex justify-center absolute left-[2px] top-[2px] rounded z-10"},Qo={class:"file-title"},Zo=["src"],en={key:3,class:"mt-10 text-center opacity-40"},tn={key:4,class:"absolute text-center whitespace-pre-line file-text flex flex-col gap-1 items-center opacity-40 text-xs"},on={key:5,class:"absolute right-1 bottom-2 !w-5 !h-5 rounded-full"},nn={class:"mt-1 text-xs text-center"},sn={class:"text-xl mb-4 font-bold"},ln=W({__name:"ExpFile",props:{exp:{}},setup(z){et(u=>({"382be4ad":e(m).cardColor,"23969f2c":e(ge)[u.exp.status].color}));const y={STOP:"stop",DUPLICATE:"duplicate",PREVIEW:"preview",FAVORITY:"favority"},r=z,s=He(),v=bt(),d=ee(),m=Ce(),{t:b}=Z(),k=ie(),R=X(()=>{var F;if(r.exp.progress==="0%")return 0;const[u,x]=(F=r.exp.progress)==null?void 0:F.split("/");return+x==0?0:+u/+x}),L=X(()=>[oe.SERVICE_QUEUING,oe.RUNNING,oe.HOST_DOWNLOADED].includes(r.exp.status)),j=()=>{d.curFolderNode=void 0,d.curExpNode=r.exp},T=u=>()=>Q(pe,null,{default:()=>Q(u)}),M=C(!1),q=X(()=>mt([{label:b("groupDetail.exps.stop"),key:"stop",icon:T(Bt),disabled:![oe.SERVICE_QUEUING,oe.RUNNING,oe.HOST_DOWNLOADED].includes(r.exp.status)},{label:b("expInfo.duplicate"),key:"duplicate",icon:T(Kt)},{label:b("groupDetail.exps.preview"),key:"preview",icon:T(lo)},r.exp.is_marked?{label:b("groupDetail.exps.unfavority"),key:"favority",icon:T(Nt)}:{label:b("groupDetail.exps.favority"),key:"favority",icon:T(he)}])),w=C(),$=u=>{u.preventDefault(),w.value={x:u.clientX+5,y:u.clientY+5},M.value=!0},g=()=>{M.value=!1,w.value=void 0},D=(u={})=>{var F;const x=new URLSearchParams({device_group_name:k.query.device_group_name,task_id:k.query.task_id,task_title:k.query.task_title,space_id:k.query.space_id,exp_id:String(r.exp.exp_id),...u,fid:String(((F=d.curNode)==null?void 0:F.exp_folder_id)||"root")});window.open(`/experiment/expSettings?${x.toString()}`,s.expOpenForm)},O=C(!1),N=async()=>{O.value=!0;const[u,x]=await Ft({exp_id:r.exp.exp_id});O.value=!1,!u&&(x==null?void 0:x.status)===0&&(v.success(b("groupDetail.exps.stopSuccess")),d.refreshExpList=!0)},S=async()=>{const[u,x]=await At({exp_id:r.exp.exp_id,is_marked:!r.exp.is_marked,mark_note:c.value.mark_note});!u&&(x==null?void 0:x.status)===0&&(d.refreshExpList=!0,l())},a=u=>{u===y.STOP?N():u===y.DUPLICATE?D({dup:"1"}):u===y.PREVIEW?D():u===y.FAVORITY&&(r.exp.is_marked?S():o.value=!0),g()},i=C(),c=C({mark_note:void 0}),o=C(!1),l=()=>{o.value=!1,c.value={mark_note:void 0}},h=u=>{u||l()};return(u,x)=>{const F=ft,U=Te,H=lt,P=ae,G=Qe,A=Xe,me=Ye,te=ye,de=Ie,xe=we,$e=ke,Me=Ee;return f(),B(Me,{show:e(O)},{default:n(()=>{var Se,ve;return[_("div",{class:"flex items-center flex-col file-wraper px-0 py-4 rounded-xl box-border",onClick:j,onDblclick:x[0]||(x[0]=()=>D()),onContextmenu:nt($,["prevent"])},[_("div",{class:"rounded file-card shadow-2xl relative",style:J({borderColor:e(m).dividerColor,backgroundColor:e(m).cardColor})},[u.exp.is_marked?(f(),I("div",Jo,[t(e(pe),{component:e(he),color:"#fadb14",size:"16"},null,8,["component"])])):(f(),I("div",Yo,x[3]||(x[3]=[_("div",null,null,-1)]))),_("div",Xo,[_("div",Qo,"#"+p(u.exp.exp_id),1)]),u.exp.img?(f(),I("img",{key:2,src:u.exp.img,class:"w-[120px] h-[120px] absolute top-0 left-0",alt:""},null,8,Zo)):u.exp.img===void 0?(f(),I("div",en,p(e(b)("common.loading")),1)):u.exp.img===null?(f(),I("div",tn,[t(e(pe),{component:e(it),size:"30"},null,8,["component"]),E(" "+p(e(b)("groupDetail.exps.expNoResult")),1)])):K("",!0),_("div",{class:"text-center absolute bottom-0 w-full left-0 text-xs",style:J({background:"rgba(255, 255, 255, 0.5 )",borderBottom:`4px solid ${e(ge)[u.exp.status].color}`})},[_("div",{style:J({background:`rgba(255, 255, 255, ${e(R)} )`}),class:"h-full opacity-60"},null,4)],4),e(R)!==1?(f(),I("div",on,[t(F,{type:"circle",processing:e(L),percentage:e(R)*100,"show-indicator":!1,class:"!w-5 !h-5","stroke-width":16},null,8,["processing","percentage"])])):K("",!0)],4),_("div",nn,[t(U,{"line-clamp":2},{default:n(()=>[E(p(u.exp.title),1)]),_:1})]),e(M)?(f(),B(H,{key:0,placement:"bottom-start",show:!0,options:e(q),x:(Se=e(w))==null?void 0:Se.x,y:(ve=e(w))==null?void 0:ve.y,onClickoutside:g,onSelect:a},{default:n(()=>x[4]||(x[4]=[_("div",null,null,-1)])),_:1},8,["options","x","y"])):K("",!0)],32),t($e,{show:e(o),"onUpdate:show":x[2]||(x[2]=V=>le(o)?o.value=V:null),onUpdateShow:h},{default:n(()=>[t(xe,{style:{width:"500px"}},{default:n(()=>[_("div",sn,[E(p(e(b)("groupDetail.exps.favorityTitle"))+" Exp-"+p(u.exp.exp_id)+" :: ",1),_("span",null,'"'+p(u.exp.title)+'"',1)]),t(P),t(me,{ref_key:"formRef",ref:i,model:e(c)},{default:n(()=>[t(A,{label:e(b)("groupDetail.exps.favorityNote"),path:"exp_folder_name"},{default:n(()=>[t(G,{type:"textarea",value:e(c).mark_note,"onUpdate:value":x[1]||(x[1]=V=>e(c).mark_note=V)},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model"]),t(de,{justify:"end"},{default:n(()=>[t(te,{onClick:l},{default:n(()=>[E(p(e(b)("common.cancel")),1)]),_:1}),t(te,{type:"primary",onClick:S,loading:e(O)},{default:n(()=>[E(p(e(b)("common.OK")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["show"])]}),_:1},8,["show"])}}}),an=ce(ln,[["__scopeId","data-v-e5064830"]]),rn=W({__name:"ExpFiles",setup(z,{expose:y}){const r=at({per_page:48,total:0}),s=ie(),v=ee(),d=Qt(),m=C(!1),b=C({}),k=C([]),R=C(!1),L=S=>[oe.COMPLETE,oe.ERROR,oe.CANCELED,oe.HOST_DOWNLOADED].includes(S),j=async(S,a)=>{var o;const[i,c]=await It({exp_ids:S,group_name:s.query.device_group_name,create_timestamps:a,org_id:(o=d.groupInfo)==null?void 0:o.organization_id});!i&&(c==null?void 0:c.status)===0&&wt(c.data,(l,h)=>{var x;const u=(x=v.curExpList)==null?void 0:x.find(F=>h===String(F.exp_id));u&&(L(u==null?void 0:u.status)?(u.img=l,b.value={...b.value,[h]:l||null}):k.value.push({exp_id:h,create_timestamp:u.create_timestamp}))})},T=async()=>{var S,a,i,c;Y(k.value)||(await j((a=(S=k.value)==null?void 0:S.map(o=>o.exp_id))==null?void 0:a.join(","),(c=(i=k.value)==null?void 0:i.map(o=>o.create_timestamp))==null?void 0:c.join(",")),se(()=>{D()}))},M=async()=>{var i;if(!+(s.query.task_id||""))return;const[S,a]=await qe({device_group_name:s.query.device_group_name,task_id:+(s.query.task_id||""),exp_folder_id:(i=v.curNode)==null?void 0:i.exp_folder_id,limit:r.per_page,before_exp_id:null});if(!S&&(a==null?void 0:a.status)===0){const c=JSON.parse(JSON.stringify(v.curExpList));a.data.list.reverse().forEach(o=>{const l=c.findIndex(h=>h.exp_id===o.exp_id);l<0?c.unshift(o):c.splice(l,1,{...o,img:c[l].img})}),v.curExpList=c,v.curExpCounts=a.data.count,se(()=>{var h,u;const o=v.curExpList.find(x=>{var F;return x.exp_id==((F=v.curExpNode)==null?void 0:F.exp_id)});o&&(v.curExpNode=o);const l=g(a.data.list||[]);Y(l)||j((h=l==null?void 0:l.map(x=>x.exp_id))==null?void 0:h.join(","),(u=l==null?void 0:l.map(x=>x.create_timestamp))==null?void 0:u.join(","))})}},{start:q,stop:w,runing:$}=Zt(()=>{T(),M()},{delay:!0,isManual:!0});je(()=>{$.value?w():q()}),kt(()=>{w()});const g=S=>mt(S.map(a=>b.value[a.exp_id]===void 0?a:void 0)),D=()=>{const S=[];k.value.forEach(a=>{b.value[a.exp_id]===void 0&&S.push(a)}),k.value=S},O=async()=>{var c,o;if(!+(s.query.task_id||"")||m.value)return;m.value=!0;const S=v.curExpList,[a,i]=await qe({device_group_name:s.query.device_group_name,task_id:+(s.query.task_id||""),exp_folder_id:(c=v.curNode)==null?void 0:c.exp_folder_id,limit:r.per_page,before_exp_id:((o=S[S.length-1])==null?void 0:o.exp_id)||null});m.value=!1,v.loadingCurNode&&(v.loadingCurNode=!1),!a&&(i==null?void 0:i.status)===0&&(se(()=>{var h,u;const l=g(i.data.list||[]);Y(l)||j((h=l==null?void 0:l.map(x=>x.exp_id))==null?void 0:h.join(","),(u=l==null?void 0:l.map(x=>x.create_timestamp))==null?void 0:u.join(","))}),v.curExpList=eo([...v.curExpList||[],...i.data.list],"exp_id"),r.total=i.data.count,v.curExpCounts=i.data.count,se(()=>{var l;R.value=r.total===((l=v.curExpList)==null?void 0:l.length)}),v.refreshExpList&&(v.refreshExpList=!1))};je(()=>{r.total=0,v.curExpCounts=0,v.curExpList=[],b.value={},k.value=[],s.query.fid&&(v.curNode={exp_folder_id:+s.query.fid}),se(()=>{O()})}),ue(()=>v.refreshExpList,S=>{S&&(v.curExpList=[],b.value={},O())},{immediate:!0});const N=Go(()=>{R.value||O()},500);return y({loadMore:N}),(S,a)=>{const i=ot,c=st;return f(),B(c,{class:"!max-[1600px]","x-gap":"8",cols:"6 1200:8 1600:8"},{default:n(()=>[(f(!0),I(_e,null,fe(e(v).curExpList,o=>(f(),B(i,{key:o.exp_id},{default:n(()=>[t(an,{exp:o},null,8,["exp"])]),_:2},1024))),128))]),_:1})}}}),cn={key:0,class:"flex items-center flex-col w-full"},dn={key:0,class:"relative flex-none"},un=["src"],pn={key:0,class:"absolute right-1 top-6 z-10"},_n={class:"flex justify-center absolute left-[2px] top-[2px] rounded z-10"},fn={class:"file-title"},mn={key:0,class:"absolute right-1 top-1 z-10"},xn={key:1,class:"file-triangle",style:{background:"rgba(255, 255, 255, 0.25)"}},vn={key:2,class:"absolute right-1 bottom-2 !w-5 !h-5 rounded-full"},gn={class:"inline-flex flex-col items-center gap-1 opacity-40"},hn={class:"flex justify-center absolute left-[2px] top-[2px] rounded z-10"},yn={class:"file-title"},bn={key:0,class:"absolute right-1 top-1 z-10"},kn={key:2,class:"absolute right-1 bottom-2 !w-5 !h-5 rounded-full"},wn={class:"opacity-40"},En={class:"text-lg font-bold w-full"},Cn={class:"mt-4 opacity-70 text-xs text-left w-full"},$n={class:"w-full flex flex-col"},Sn={class:"break-all inline-block whitespace-pre-line"},Nn={class:"text-xs opacity-70 min-w-18 flex items-center gap-1"},Dn={class:"italic"},Fn={class:"text-xs"},In=W({__name:"ExpInfo",setup(z){const y=ie(),r=ee(),{curExpNode:s}=rt(r),v=Ce(),{t:d}=Z(),m=C(),b=at({}),k=async L=>{if(b[String(L.exp_id)]){Pe([b[String(L.exp_id)]],0);return}m.value=L.exp_id;const[j,T]=await Lt({exp_id:L.exp_id,device_group_name:y.query.device_group_name,space_id:y.query.space_id});m.value=void 0,!j&&(T==null?void 0:T.status)===0&&(Pe([T.data.big_picture_url],0),b[String(L.exp_id)]=T.data.big_picture_url)},R=X(()=>{var T,M;if(!s.value||s.value.progress==="0%")return 0;const[L,j]=(M=(T=s.value)==null?void 0:T.progress)==null?void 0:M.split("/");return+j==0?0:+L/+j});return(L,j)=>{var O,N,S;const T=Ee,M=pe,q=ft,w=ae,$=Oe,g=Te,D=Le;return e(s)?(f(),I("div",cn,[e(s).img?(f(),I("div",dn,[t(T,{show:e(m)===e(s).exp_id},{default:n(()=>[_("img",{class:"w-[160px] h-[160px] my-5 cursor-pointer",src:e(s).img,alt:"",onClick:j[0]||(j[0]=()=>k(e(s)))},null,8,un)]),_:1},8,["show"]),(O=e(s))!=null&&O.is_marked?(f(),I("div",pn,[t(M,{component:e(he),color:"#fadb14",size:"20"},null,8,["component"])])):K("",!0)])):e(s).img===null?(f(),I("div",{key:1,class:"!w-[160px] file-card relative shadow-2xl flex-none whitespace-pre-line !h-[160px] my-5 rounded text-center leading-4 text-xs flex items-center justify-center text-white",style:J({borderColor:e(v).dividerColor,backgroundColor:e(v).cardColor})},[_("div",_n,[_("div",fn,"#"+p(e(s).exp_id),1)]),(N=e(s))!=null&&N.is_marked?(f(),I("div",mn,[t(M,{component:e(he),color:"#fadb14",size:"20"},null,8,["component"])])):(f(),I("div",xn)),_("div",{class:"text-center absolute bottom-0 w-full left-0 text-xs",style:J({background:"rgba(255, 255, 255, 0.5 )",borderBottom:`4px solid ${e(ge)[e(s).status].color}`})},[_("div",{style:J({background:`rgba(255, 255, 255, ${e(R)} )`}),class:"h-full opacity-60"},null,4)],4),e(R)!==1?(f(),I("div",vn,[t(q,{type:"circle",percentage:e(R)*100,"show-indicator":!1,class:"!w-5 !h-5","stroke-width":16},null,8,["percentage"])])):K("",!0),_("span",gn,[t(M,{component:e(it),size:"40"},null,8,["component"]),E(" "+p(e(d)("groupDetail.exps.expNoResult")),1)])],4)):(f(),I("div",{key:2,class:"!w-[160px] flex-none file-card relative shadow-2xl whitespace-pre-line !h-[160px] my-5 rounded text-center leading-4 text-xs flex items-center justify-center text-white",style:J({borderColor:e(v).dividerColor,backgroundColor:e(v).cardColor})},[_("div",hn,[_("div",yn,"#"+p(e(s).exp_id),1)]),(S=e(s))!=null&&S.is_marked?(f(),I("div",bn,[t(M,{component:e(he),color:"#fadb14",size:"20"},null,8,["component"])])):(f(),I("div",{key:1,class:"file-triangle",style:J({background:e(s).is_marked?"#fadb14":"rgba(255, 255, 255, 0.25)"})},null,4)),_("div",{class:"text-center absolute bottom-0 w-full left-0 text-xs",style:J({background:"rgba(255, 255, 255, 0.5 )",borderBottom:`4px solid ${e(ge)[e(s).status].color}`})},[_("div",{style:J({background:`rgba(255, 255, 255, ${e(R)} )`}),class:"h-full opacity-60"},null,4)],4),e(R)!==1?(f(),I("div",kn,[t(q,{type:"circle",percentage:e(R)*100,"show-indicator":!1,class:"!w-5 !h-5","stroke-width":16},null,8,["percentage"])])):K("",!0),_("span",wn,p(e(d)("common.loading")),1)],4)),_("div",En,[_("span",null," Exp "+p(e(s).exp_id)+"  -  ",1),_("span",null,p(e(s).title),1)]),_("div",Cn,p(e(s).description),1),t(w),t(D,{style:{"max-height":"calc(100vh - 300px)"}},{default:n(()=>[_("div",$n,[t(ne,null,{label:n(()=>[E(p(e(d)("groupDetail.exps.status")),1)]),default:n(()=>{var a;return[(a=e(s))!=null&&a.status?(f(),B($,{key:0,color:{color:e(ge)[e(s).status].color,textColor:"#fff"},bordered:!1,size:"small",class:"min-w-[100px] flex justify-center"},{default:n(()=>[E(p(e(d)(e(ge)[e(s).status].text)),1)]),_:1},8,["color"])):K("",!0)]}),_:1}),t(ne,null,{label:n(()=>[E(p(e(d)("groupDetail.exps.progress")),1)]),default:n(()=>[t($,{size:"small",type:"info",class:"flex justify-center items-center min-w-[100px]"},{default:n(()=>{var a;return[E(p((a=e(s))==null?void 0:a.progress),1)]}),_:1})]),_:1}),t(ne,null,{label:n(()=>[E(p(e(d)("groupDetail.exps.source")),1)]),default:n(()=>[t($,{size:"small",type:"info",class:"flex justify-center items-center min-w-[100px]"},{default:n(()=>{var a;return[E(p((a=e(s))==null?void 0:a.source),1)]}),_:1})]),_:1}),t(ne,null,{label:n(()=>[E(p(e(d)("groupDetail.exps.tpl")),1)]),default:n(()=>[t($,{type:"warning",size:"small",class:"!break-all flex justify-center items-center min-w-[100px]"},{default:n(()=>{var a,i;return[_("span",Sn,p(((a=e(s))==null?void 0:a.template_name)==="-"?"No Template":(i=e(s))==null?void 0:i.template_name),1)]}),_:1})]),_:1}),t(ne,null,{label:n(()=>[E(p(e(d)("groupDetail.exps.createTime")),1)]),default:n(()=>{var a;return[E(" "+p((a=e(s))==null?void 0:a.create_time),1)]}),_:1}),t(ne,null,{label:n(()=>[E(p(e(d)("groupDetail.exps.creator")),1)]),default:n(()=>{var a;return[E(" "+p((a=e(s))==null?void 0:a.user_name),1)]}),_:1}),e(s).is_marked?(f(),I("div",{key:0,class:"flex justify-between items-center py-2 border-b",style:J({borderColor:e(v).dividerColor})},[_("div",Nn,[t(M,{size:"18",color:"#fadb14",component:e(he)},null,8,["component"]),_("span",Dn,p(e(d)("groupDetail.exps.markNote")),1)]),_("div",Fn,[t(g,{"line-clamp":2},{default:n(()=>[E(p(e(s).mark_note||"-"),1)]),_:1})])],4)):K("",!0)])]),_:1})])):K("",!0)}}}),Ln=ce(In,[["__scopeId","data-v-adddf89b"]]),Tn={key:0,class:"flex items-center flex-col w-full"},Mn={class:"text-lg font-bold w-full text-center"},Rn={key:0,class:"mt-4 opacity-70 text-xs text-left w-full"},jn={class:"w-full flex flex-col"},qn=W({__name:"FolderInfo",setup(z){const y=ee(),{curFolderNode:r}=rt(y),{t:s}=Z();return(v,d)=>{const m=ae;return e(r)?(f(),I("div",Tn,[d[0]||(d[0]=_("div",{class:"folder-icon"},null,-1)),_("div",Mn,p(e(r).exp_folder_name),1),e(r).exp_folder_description?(f(),I("div",Rn,p(e(r).exp_folder_description),1)):K("",!0),t(m),_("div",jn,[t(ne,null,{label:n(()=>[E(p(e(s)("groupDetail.exps.expFolderId")),1)]),default:n(()=>[E(" "+p(e(r).exp_folder_id),1)]),_:1}),t(ne,null,{label:n(()=>[E(p(e(s)("groupDetail.exps.createTime")),1)]),default:n(()=>[E(" "+p(e(Fe)(e(r).create_time)),1)]),_:1}),t(ne,null,{label:n(()=>[E(p(e(s)("groupDetail.exps.updateTime")),1)]),default:n(()=>[E(" "+p(e(Fe)(e(r).update_time)||"-"),1)]),_:1}),t(ne,null,{label:n(()=>[E(p(e(s)("groupDetail.exps.creator")),1)]),default:n(()=>[E(" "+p(e(r).create_user_name),1)]),_:1})])])):K("",!0)}}}),On=ce(qn,[["__scopeId","data-v-1dcd9b41"]]),zn={},Un={class:"flex items-center gap-1"},Bn={class:"opacity-70"};function An(z,y){return f(),I("div",Un,[_("span",Bn,[Ve(z.$slots,"label"),y[0]||(y[0]=E(":  "))]),_("span",null,[Ve(z.$slots,"default")])])}const De=ce(zn,[["render",An]]),Vn={key:0},Pn={class:"flex justify-between items-center text-xs px-2"},Kn={class:"flex items-center gap-10"},Wn={key:0},Hn=W({__name:"InfoBar",setup(z){const y=ee(),{t:r}=Z(),s=X(()=>y.curNode);return(v,d)=>{const m=ae,b=Oe;return e(Y)(e(s))?K("",!0):(f(),I("div",Vn,[t(m,{class:"!mt-0 !mb-2"}),_("div",Pn,[_("div",Kn,[e(s).create_time?(f(),B(De,{key:0},{label:n(()=>[E(p(e(r)("groupDetail.exps.createTime")),1)]),default:n(()=>[E(" "+p(e(Fe)(e(s).create_time)),1)]),_:1})):K("",!0),e(s).update_time?(f(),B(De,{key:1},{label:n(()=>[E(p(e(r)("groupDetail.exps.updateTime")),1)]),default:n(()=>[E(" "+p(e(Fe)(e(s).update_time)),1)]),_:1})):K("",!0),e(s).create_user_name?(f(),B(De,{key:2},{label:n(()=>[E(p(e(r)("groupDetail.exps.creator")),1)]),default:n(()=>[E(" "+p(e(s).create_user_name||"-"),1)]),_:1})):K("",!0)]),e(y).curExpCounts?(f(),I("div",Wn,[t(De,null,{label:n(()=>[E(p(e(r)("groupDetail.exps.expCount")),1)]),default:n(()=>[t(b,{type:"primary",round:"",size:"tiny"},{default:n(()=>[E(p(e(y).curExpCounts),1)]),_:1})]),_:1})])):K("",!0)])]))}}}),Gn={class:"flex"},Jn={class:"flex-1"},Yn={class:"flex w-[320px]",style:{height:"calc(100vh - 245px)"}},Xn={key:2,class:"w-full flex justify-center items-center"},Qn=W({__name:"ExperimentList",setup(z){const{t:y}=Z(),r=ee(),s=C(),v=()=>{var m;(m=s.value)==null||m.loadMore()},d=X(()=>{var m;return Y(r.curNode)||!((m=r==null?void 0:r.curNode)!=null&&m.exp_folder_id)});return(m,b)=>{const k=to,R=ae,L=tt,j=Ee;return f(),B(j,{show:e(r).loadingCurNode},{default:n(()=>[t(jo),_("div",Gn,[_("div",Jn,[t(k,{style:J({height:`calc(100vh - ${e(d)?245:268}px)`}),distance:50,onLoad:v},{default:n(()=>[t(Ko),t(rn,{ref_key:"expFilesRef",ref:s},null,512)]),_:1},8,["style"]),e(d)?K("",!0):(f(),B(Hn,{key:0}))]),_("div",Yn,[t(R,{vertical:"",class:"!h-full !mr-5 !ml-0"}),e(r).curExpNode?(f(),B(Ln,{key:0})):e(r).curFolderNode?(f(),B(On,{key:1})):(f(),I("div",Xn,[t(L,{description:e(y)("groupDetail.exps.expInfoEmpty")},null,8,["description"])]))])])]),_:1},8,["show"])}}}),Cs=ce(Qn,[["__scopeId","data-v-4fc9c075"]]);export{Cs as default};
