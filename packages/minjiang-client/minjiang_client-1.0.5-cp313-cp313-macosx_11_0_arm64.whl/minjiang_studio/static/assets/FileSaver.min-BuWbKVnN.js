import{P as ne,u as J,G as oe,d as Z,e as A,f as z,h as B,bF as ce,bG as Le,i as p,as as Pe,w,aa as ke,ah as Ne,a8 as Y,aA as Ee,s as D,a9 as Q,t as ee,B as F,l as n,a2 as Ke,aO as Ge,A as we,b as me,a6 as xe,K as be,C as ve,r as M,Q as qe,I as o,N as X,ac as te,aK as de,ap as Je,aQ as Qe,a3 as pe,au as We,V as ae,W as ye,v as _e,bH as N,L as Oe,k as Xe,m as Ze,p as Ye,bI as Ce,n as $e,b9 as De,S as et,ao as Ve,F as Te,bJ as Ue,bK as tt,o as nt,E as at,b5 as ot,b6 as st,aZ as ie}from"./index-BwlMlHGj.js";import{m as rt}from"./exp-BFwh7v1l.js";import{c as fe}from"./index-C1C63wPC.js";import{H as je}from"./HandRight24Filled-COWVKNGi.js";import{_ as Ie}from"./Popconfirm-GYskt_Un.js";import{_ as Me}from"./DataTable-CfoqEf8t.js";import{i as lt}from"./json-editor-vue-CSlvxqm5.js";import{_ as it}from"./PaginationView.vue_vue_type_script_setup_true_lang-IR55gl3R.js";import{N as ut}from"./Switch-B5yYo9Bh.js";function ct(m){return ne(J.getParamsByTree,m)}function Be(m){return ne(J.submitParams,m)}function Fe(m){return ne(J.removeParams,m)}function dt(m){return oe(J.getHistoryParams,m)}function pt(m){return oe(J.searchSpaceParameters,m)}function jt(){return oe(J.getSpaceInitializerList)}function Bt(m){return oe(J.getSpaceInitializerSetup,m)}function Ft(m){return ne(J.spaceInitializerPreview,m)}function At(m){return ne(J.submitInitializerPreview,m)}function Nt(m){return ne(J.insertSpace,m)}function Kt(m){return oe(J.getSpaceAbstract,m)}const ft={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},he=Z({name:"RefreshCircle",render:function(E,_){return z(),A("svg",ft,_[0]||(_[0]=[B("path",{d:"M256 48C141.31 48 48 141.32 48 256c0 114.86 93.14 208 208 208c114.69 0 208-93.31 208-208c0-114.87-93.13-208-208-208zm0 313a94 94 0 0 1 0-188h4.21l-14.11-14.1a14 14 0 0 1 19.8-19.8l40 40a14 14 0 0 1 0 19.8l-40 40a14 14 0 0 1-19.8-19.8l18-18c-2.38-.1-5.1-.1-8.1-.1a66 66 0 1 0 66 66a14 14 0 0 1 28 0a94.11 94.11 0 0 1-94 94z",fill:"currentColor"},null,-1)]))}}),mt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},vt=Z({name:"Reload",render:function(E,_){return z(),A("svg",mt,_[0]||(_[0]=[B("path",{d:"M400 148l-21.12-24.57A191.43 191.43 0 0 0 240 64C134 64 48 150 48 256s86 192 192 192a192.09 192.09 0 0 0 181.07-128",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-miterlimit":"10","stroke-width":"32"},null,-1),B("path",{d:"M464 97.42V208a16 16 0 0 1-16 16H337.42c-14.26 0-21.4-17.23-11.32-27.31L436.69 86.1C446.77 76 464 83.16 464 97.42z",fill:"currentColor"},null,-1)]))}}),yt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 16 16"},ge=Z({name:"AddCircle16Filled",render:function(E,_){return z(),A("svg",yt,_[0]||(_[0]=[B("g",{fill:"none"},[B("path",{d:"M2 8a6 6 0 1 1 12 0A6 6 0 0 1 2 8zm6-3a.5.5 0 0 0-.5.5v2h-2a.5.5 0 0 0 0 1h2v2a.5.5 0 0 0 1 0v-2h2a.5.5 0 0 0 0-1h-2v-2A.5.5 0 0 0 8 5z",fill:"currentColor"})],-1)]))}}),_t={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Gt=Z({name:"ArrowDownload24Filled",render:function(E,_){return z(),A("svg",_t,_[0]||(_[0]=[B("g",{fill:"none"},[B("path",{d:"M5.25 20.5h13.498a.75.75 0 0 1 .101 1.494l-.101.006H5.25a.75.75 0 0 1-.102-1.493l.102-.007h13.498H5.25zm6.633-18.497L12 1.996a1 1 0 0 1 .993.883l.007.117v12.59l3.294-3.293a1 1 0 0 1 1.32-.083l.094.083a1 1 0 0 1 .083 1.32l-.083.095l-4.997 4.996a1 1 0 0 1-1.32.084l-.094-.083l-5.004-4.997a1 1 0 0 1 1.32-1.498l.094.083L11 15.58V2.996a1 1 0 0 1 .883-.993L12 1.996l-.117.007z",fill:"currentColor"})],-1)]))}}),ht={class:"flex justify-between items-center gap-2"},gt={key:0},kt={key:0,class:"flex justify-center w-full"},wt=Z({__name:"CategoryTabs",props:ce({readOnly:{type:Boolean},tabs:{}},{modelValue:{},modelModifiers:{}}),emits:ce(["insert","refresh"],["update:modelValue"]),setup(m,{emit:E}){const _=E,g=Le(m,"modelValue"),b=(d="")=>{_("insert",{full_key:d})},T=()=>{_("refresh")};return(d,v)=>{const C=F,l=Ee,i=Pe;return z(),A("div",null,[p(i,{type:"card",placement:"left",value:g.value,"onUpdate:value":v[1]||(v[1]=a=>g.value=a),class:"tabs",style:{"max-height":"calc(100vh - 340px)"}},{suffix:w(()=>[d.readOnly?Q("",!0):(z(),A("div",kt,[p(C,{type:"info",quaternary:"",onClick:v[0]||(v[0]=()=>b()),size:"small"},{icon:w(()=>[p(n(ge))]),_:1}),p(C,{type:"info",quaternary:"",onClick:T,size:"small"},{icon:w(()=>[p(n(he))]),_:1})]))]),default:w(()=>[(z(!0),A(ke,null,Ne(d.tabs,(a,u)=>(z(),Y(l,{name:a.node_name,class:"!flex-1 w-full",key:u},{default:w(()=>[B("div",ht,[D(ee(a.node_name)+" ",1),d.readOnly?Q("",!0):(z(),A("div",gt,[p(C,{type:"info",quaternary:"",onClick:()=>b(a.full_key),size:"small"},{icon:w(()=>[p(n(ge))]),_:2},1032,["onClick"]),p(C,{type:"info",quaternary:"",onClick:T,size:"small"},{icon:w(()=>[p(n(he))]),_:1})]))])]),_:2},1032,["name"]))),128))]),_:1},8,["value"])])}}}),xt=Ke(wt,[["__scopeId","data-v-6fd4e427"]]),bt={class:"flex justify-end w-full"},Ct={class:"flex gap-2 items-center"},Se=Z({__name:"ParamsHistory",props:{spaceId:{},hkey:{},maxHeight:{},hideHistoryOption:{type:Boolean},hideRevertOption:{type:Boolean}},emits:["update:success","close:modal"],setup(m,{expose:E,emit:_}){const g=m,b=_,T=Ge(),d=we(),{t:v}=me(),{copy:C,isSupported:l}=xe({legacy:!0}),i=be(),a=ve(),u=M(!1),k=M("globalOverview"),P=M(),I=M({show:!1,info:{k_full:void 0}}),$=async t=>{C(t),i.success(v("common.copied"))},H=qe(async t=>{const[x,e]=await Be({keys:[t.k_full],values:[t.v],types:[t.t],device_group_name:a.query.device_group_name,space_id:g.spaceId});if(!x&&(e==null?void 0:e.status)===0){i.success(v("groupDetail.parameterManager.revertSuccess"));const r=t.k_full.replace(/(.*)\/.*$/,"$1").split("/");b("update:success",fe(r),!1),L()}},300),K=qe(t=>{I.value={show:!0,info:t}},300),U=[{title:v("groupDetail.parameterManager.keyPath"),key:"k_full",width:280,render:t=>o("div",{class:"inline-flex gap-2"},[o("div",t.k_full),l.value?o(X,{class:"cursor-pointer transition-transform hover:translate-y-[1px]",size:20,onClick:()=>{$(t.k_full)}},{default:()=>o(te)}):void 0])},{title:v("groupDetail.parameterManager.dataType"),key:"t",width:100},{title:v("groupDetail.parameterManager.value"),key:"v",render:t=>{if(t.v)return o("div",{class:"flex gap-2"},[o(de,{tooltip:{show:!1}},{default:()=>t.v}),l.value?o(X,{class:"cursor-pointer transition-transform hover:translate-y-[1px]",size:20,onClick:()=>{$(t.v)}},{default:()=>o(te)}):void 0])}},{title:v("groupDetail.parameterManager.time"),key:"timestamp",width:180},{title:v("createuser"),key:"user_name",width:140,render(t){return o(de,null,{default:()=>t.user_name})}},{title:v("groupDetail.parameterManager.expId"),key:"experiment_id",width:100,render:t=>o("span",{onClick:()=>c(t),className:t.experiment_id?"cursor-pointer hover:underline":"",style:{color:t.experiment_id?d.value.infoColor:d.value.textColorBase}},t.experiment_id||"-")},{title:v("groupDetail.parameterManager.session"),key:"session_id",width:100,render:t=>o("div",{onClick:()=>s(t),className:"w-full h-full "+(t.session_id?"cursor-pointer hover:underline":""),style:{color:t.session_id?d.value.infoColor:d.value.textColorBase}},t.session_id||"-")},{title:v("groupDetail.parameterManager.nodeId"),key:"node_id",width:100,render:t=>o("span",{onClick:()=>R(t),className:t.node_id?"cursor-pointer hover:underline":"",style:{color:t.node_id?d.value.infoColor:d.value.textColorBase}},t.node_id||"-")},{title:v("groupDetail.parameterManager.options"),key:"options",width:!g.hideHistoryOption&&!g.hideRevertOption?140:90,align:"center",render:t=>o("div",{class:"flex justify-center"},fe([g.hideRevertOption?null:o(Ie,{onPositiveClick:()=>H(t),placement:"left"},{default:()=>v("groupDetail.parameterManager.revertConfirm"),trigger:()=>o(F,{quaternary:!0,type:"info",size:"small"},{default:()=>v("groupDetail.parameterManager.optionRevert")})}),g.hideHistoryOption?void 0:o(F,{size:"small",type:"info",quaternary:!0,onClick:()=>K(t)},{default:()=>v("groupDetail.parameterManager.optionHistory")})]))}],W=t=>({class:t.deleted_flag?"removed":""}),O=Je({page:1,per_page:Qe,total:0}),L=async()=>{if(u.value)return;u.value=!0;const t=a.query.device_group_name;if(!g.spaceId||!t)return;const[x,e]=await dt({device_group_name:t,space_id:g.spaceId,key:g.hkey,page:O.page,per_page:O.per_page});u.value=!1,!x&&(e==null?void 0:e.status)===0&&(P.value=e.data.list,O.total=e.data.total)};pe(()=>g.spaceId,t=>{t&&L()},{immediate:!0}),E({refresh:L});const f=t=>{t||(I.value={show:!1,info:{k_full:void 0}},b("close:modal"))},s=t=>{if(!t.session_id)return;const x=new URLSearchParams({session_id:t.session_id,device_group_name:String(a.query.device_group_name||"")});window.open(`/groupDetail/autoCaliDetail/config?${x.toString()}`,T.expOpenForm)},c=(t,x={})=>{if(!t.experiment_id||!a.query.task_id||!a.query.space_id)return;const e=new URLSearchParams({device_group_name:a.query.device_group_name,task_id:a.query.task_id,task_title:a.query.task_title,space_id:a.query.space_id,exp_id:String(t.experiment_id),...x});window.open(`/experiment/plotter?${e.toString()}`,T.expOpenForm)},R=(t,x={})=>{if(!t.session_id)return;const e=new URLSearchParams({device_group_name:a.query.device_group_name,space_id:a.query.space_id,session_id:String(t.session_id||""),node_id:t.node_id,...x});window.open(`/groupDetail/autoCaliDetail/process?${e.toString()}`,T.expOpenForm)};return(t,x)=>{const e=Ee,r=Pe,h=Me,q=We("params-history",!0),V=_e,y=ye;return z(),A("div",null,[p(r,{value:n(k),"onUpdate:value":x[1]||(x[1]=S=>ae(k)?k.value=S:null),class:"!h-full",disabled:n(u)},{suffix:w(()=>[B("div",bt,[p(n(F),{type:"primary",onClick:x[0]||(x[0]=()=>L())},{icon:w(()=>[p(n(vt))]),default:w(()=>[D(" "+ee(n(v)("groupDetail.parameterManager.refresh")),1)]),_:1})])]),default:w(()=>[p(e,{name:"globalOverview"},{default:w(()=>[B("div",Ct,[D(ee(n(v)("groupDetail.parameterManager.globalHistory"))+" ",1),t.hkey?(z(),A(ke,{key:0},[D(" -  [  "+ee(t.hkey)+"  ] ",1)],64)):Q("",!0)])]),_:1})]),_:1},8,["value","disabled"]),p(h,{columns:U,data:n(P),pagination:!1,"row-props":W,loading:n(u),"max-height":t.maxHeight||"calc(100vh - 420px)",class:"mt-5"},null,8,["data","loading","max-height"]),p(it,{"page-info":n(O),"onUpdate:pageInfo":x[2]||(x[2]=S=>ae(O)?O.value=S:null),onUpdateList:L},null,8,["page-info"]),p(y,{show:n(I).show,"onUpdate:show":x[3]||(x[3]=S=>n(I).show=S),size:"huge",onUpdateShow:f},{default:w(()=>[p(V,{style:{"min-height":"400px",overflow:"auto",width:"1300px","min-width":"500px"}},{default:w(()=>{var S;return[p(q,{"max-height":t.maxHeight,"space-id":t.spaceId,hkey:(S=n(I).info)==null?void 0:S.k_full,"hide-history-option":!0,"hide-revert-option":t.hideRevertOption,"onUpdate:success":L},null,8,["max-height","space-id","hkey","hide-revert-option"])]}),_:1})]),_:1},8,["show"])])}}}),It={class:"flex gap-5"},Mt={class:"float-right"},Ae=Z({__name:"ParamsAction",props:{info:{},spaceId:{},actionTye:{},hideParentTree:{type:Boolean},showHistoryEntry:{type:Boolean}},emits:["update:success","ok","update:hisotry:success"],setup(m,{expose:E,emit:_}){const{t:g}=me(),b=ve(),T=we(),d=M(!1),v=M(!1),C=m,l=_,i=M(null),a=M({types:N.str,keys:void 0,values:void 0}),u=M({keys:{required:!0},values:{required:!0},types:{required:!0}}),k=[N.float,N.str,N.int,N.complex],P=[N.list,N.tuple,N.dict,N.ndarray],I=()=>{v.value=!1,a.value={types:N.str,keys:void 0,values:void 0}},$=s=>{s||(a.value={types:N.str,keys:void 0,values:void 0})},H=Oe(()=>{var s,c;if((s=a.value)!=null&&s.types)return(c=a.value)==null?void 0:c.types}),K=()=>{var s;d.value||(d.value=!0,(s=i.value)==null||s.validate(async c=>{var h;if(c){d.value=!1;return}if(C.actionTye==="custom"){l("ok",a.value),I(),d.value=!1;return}const{keys:R,values:t,types:x}=a.value,[e,r]=await Be({keys:[`${W.value}/${R}`],values:[t||""],types:[x],device_group_name:b.query.device_group_name,space_id:C.spaceId});d.value=!1,!e&&(r==null?void 0:r.status)===0&&(I(),l("update:success",((h=W.value)==null?void 0:h.split("/"))||[]))}))},U=s=>{a.value=s},W=Oe(()=>{var s,c,R,t;return((s=C.info)==null?void 0:s.type)==="add"?(c=C.info)==null?void 0:c.full_key:(t=(R=C.info)==null?void 0:R.full_key)==null?void 0:t.replace(/(.*)\/.*$/,"$1")}),O=M(!1),L=()=>{O.value=!0},f=()=>{l("update:success")};return pe(O,s=>{s&&I()}),E({open:()=>v.value=!0,close:I,setFormValue:U}),(s,c)=>{const R=Ye,t=Ze,x=$e,e=ut,r=F,h=Xe,q=_e,V=ye;return z(),A(ke,null,[p(V,{show:n(v),"onUpdate:show":c[5]||(c[5]=y=>ae(v)?v.value=y:null),size:"huge",onUpdateShow:$},{default:w(()=>[p(q,{style:{"min-height":"400px",overflow:"auto",width:"800px","min-width":"500px"}},{default:w(()=>[p(h,{model:n(a),rules:n(u),ref_key:"formRef",ref:i},{default:w(()=>[B("div",It,[p(t,{label:"Type",path:"types",class:"w-40"},{default:w(()=>[p(R,{options:n(Ce),value:n(a).types,"onUpdate:value":c[0]||(c[0]=y=>n(a).types=y)},null,8,["options","value"])]),_:1}),p(t,{label:"Key",path:"keys",class:"flex-1"},{default:w(()=>{var y;return[p(x,{value:n(a).keys,"onUpdate:value":c[1]||(c[1]=S=>n(a).keys=S),disabled:((y=s.info)==null?void 0:y.type)==="edit"},De({_:2},[s.hideParentTree?void 0:{name:"prefix",fn:w(()=>[D(ee(n(W))+"/ ",1)]),key:"0"}]),1032,["value","disabled"])]}),_:1})]),p(t,{label:"Value",path:"values"},{default:w(()=>[n(H)&&k.includes(n(H))?(z(),Y(x,{key:0,value:n(a).values,"onUpdate:value":c[2]||(c[2]=y=>n(a).values=y)},null,8,["value"])):Q("",!0),n(H)&&n(H)===n(N).bool?(z(),Y(e,{key:1,value:n(a).values,"onUpdate:value":c[3]||(c[3]=y=>n(a).values=y)},null,8,["value"])):Q("",!0),n(H)&&P.includes(n(H))?(z(),Y(n(lt),{key:2,class:et(["w-full max-h-[65vh] overflow-auto",[n(T).baseColor==="#000"?"jse-theme-dark":""]]),modelValue:n(a).values,"onUpdate:modelValue":c[4]||(c[4]=y=>n(a).values=y),mode:"text"},null,8,["class","modelValue"])):Q("",!0)]),_:1}),B("div",Mt,[s.showHistoryEntry?(z(),Y(r,{key:0,type:"info",class:"!mr-2",onClick:L},{default:w(()=>[D(ee(n(g)("groupDetail.parameterManager.history")),1)]),_:1})):Q("",!0),p(r,{type:"primary",loading:n(d),onClick:K},{default:w(()=>[D(ee(n(g)("common.OK")),1)]),_:1},8,["loading"])])]),_:1},8,["model","rules"])]),_:1})]),_:1},8,["show"]),p(V,{show:n(O),"onUpdate:show":c[7]||(c[7]=y=>ae(O)?O.value=y:null),size:"huge"},{default:w(()=>[p(q,{style:{"min-height":"400px",overflow:"auto",width:"1300px","min-width":"500px"}},{default:w(()=>{var y;return[p(Se,{"max-height":"auto","space-id":s.spaceId?Number(s.spaceId):void 0,hkey:(y=s.info)==null?void 0:y.full_key,"hide-history-option":"","onClose:modal":c[6]||(c[6]=()=>O.value=!1),"onUpdate:success":f},null,8,["space-id","hkey"])]}),_:1})]),_:1},8,["show"])],64)}}}),St={class:"flex gap-5"},Jt=Z({__name:"ParamsLatest",props:{spaceId:{},maxHeight:{},readOnly:{type:Boolean},version:{}},setup(m,{expose:E}){const _=m,g=ve(),{t:b}=me(),{copy:T,isSupported:d}=xe({legacy:!0}),v=be(),C=M(),l=M(!1),i=M(),a=M(),u=M({show:!1,info:void 0}),k=M(),P=M(),I=M(),$=e=>{T(e),v.success(b("common.copied"))},H=e=>{var r;(r=k.value)==null||r.open(),P.value={...e,type:"add"}},K=e=>{var r,h;(r=k.value)==null||r.open(),(h=k.value)==null||h.setFormValue({types:e.t,keys:e.node_name,values:e.v}),P.value={...e,type:"edit"}},U=(e,r,h)=>{const q=JSON.parse(JSON.stringify(a.value));let V=!1;const y=(S,se)=>{Ue(S,(j,re)=>{var G;if(V)return!1;if(j.full_key===e){switch(r){case"rchildren":delete j.children;break;case"rself":(G=se.children)==null||G.splice(re,1);break;case"update":h&&(j.children=h);break;case"insert":j.children=h}return V=!0,!1}j.children&&y(j.children,j)})};y(q,{children:q}),a.value=q},W=async e=>{const[r,h]=await Fe({key:e.full_key,device_group_name:g.query.device_group_name,space_id:_.spaceId});!r&&(h==null?void 0:h.status)===0&&U(e.full_key,"rself")},O=(e,r)=>{var h;R(e,void 0,r!==void 0?r:((h=P.value)==null?void 0:h.type)==="add")},L=e=>{u.value={show:!0,info:e}},f=()=>{R([i.value])},s=e=>{R(e.full_key.split("/"));const r=(I.value||[]).concat(e.full_key);I.value=[...new Set(r)]},c=[{title:b("groupDetail.parameterManager.key"),key:"node_name",render:e=>e.expandable?o("div",{class:"inline-flex items-center gap-1"},fe([o("span",e.node_name),_.readOnly?null:o(F,{quaternary:!0,type:"info",size:"small",onClick:()=>H(e)},{icon:()=>o(ge)}),_.readOnly?null:o(F,{quaternary:!0,type:"info",size:"small",onClick:()=>s(e)},{icon:()=>o(he)})])):o("div",{class:"inline-flex gap-2"},[o("div",e.node_name),d.value?o(X,{class:"cursor-pointer transition-transform hover:translate-y-[1px]",size:20,onClick:()=>$(e.full_key)},{default:()=>o(te)}):void 0])},{title:b("groupDetail.parameterManager.dataType"),key:"t",width:100,render:e=>{if(e.expandable)return;const r=Ce.find(h=>h.value===e.t);return o(Ve,{size:"small",bordered:!1,color:{textColor:"#fff",color:(r==null?void 0:r.color)||"#2080f0"},class:"min-w-16 text-center inline-flex justify-center"},{default:()=>e.t})}},{title:b("groupDetail.parameterManager.value"),key:"v",render:e=>e.expandable?e.v:o("div",{class:"flex gap-2"},[o(de,{tooltip:{show:!1}},{default:()=>e.v}),d.value?o(X,{class:"cursor-pointer transition-transform hover:translate-y-[1px]",size:20,onClick:()=>$(e.v)},{default:()=>o(te)}):void 0])},{title:b("groupDetail.parameterManager.paramsDesc"),key:"desc",render:e=>e.expandable?e.v:o("div",{class:"flex gap-2"},[o(de,{class:"opacity-80"},{default:()=>e.desc})])}];_.readOnly||c.push({title:b("groupDetail.parameterManager.options"),key:"options",width:260,align:"center",render:e=>{if(!(e!=null&&e.isLeaf))return;const r={quaternary:!0,type:"info",size:"small"},h=o(F,{...r,onClick:()=>{K(e)}},{default:()=>b("groupDetail.parameterManager.optionEdit")}),q=o(F,{...r,onClick:()=>L(e)},{default:()=>b("groupDetail.parameterManager.optionHistory")}),V=o(Ie,{onPositiveClick:()=>W(e)},{default:()=>b("groupDetail.parameterManager.removeConfirm"),icon:()=>o(X,{color:"#e88080",size:22},o(je)),trigger:()=>o(F,{...r,type:"error"},{default:()=>b("groupDetail.parameterManager.optionRemove")})});return o("div",{class:"flex justify-end"},[h,q,V])}});const R=async(e=[],r,h)=>{var V;if(!_.spaceId||l.value||!g.query.device_group_name)return;l.value=!0;const q=fe(e);try{const[y,S]=await ct({device_group_name:g.query.device_group_name,space_id:_.spaceId,parent_tree:q,version:_.version});if(l.value=!1,y||(S==null?void 0:S.status)!==0)return;if(q.length===0){C.value=S.data,S.data&&S.data.length>0&&R([S.data[0].node_name]),Te(S.data)&&(a.value=[]);return}const se="/"+q.join("/"),j=S.data.map(G=>({...G,isLeaf:!G.expandable})),re=(V=j.filter(G=>G.isLeaf))==null?void 0:V.map(G=>G.full_key);if(!Te(re)){const[G,le]=await rt({full_key_list:re.join(","),language:localStorage.getItem("lang")||"en"});!G&&(le==null?void 0:le.status)===0&&Ue(j,Re=>{const ze=le.data[Re.full_key];ze&&(Re.desc=ze)})}if(r)return r.resolve(),j;q.length===1?a.value=j:h?U(se,"insert",j):U(se,"update",j)}catch{r&&r.reject(),l.value=!1}},t=e=>new Promise(async(r,h)=>{const q=await R(e.full_key.split("/"),{resolve:r,reject:h});e.children=q}),x=e=>{const[r]=tt(I.value,e);r&&U(r,"rchildren"),I.value=e};return pe(()=>_.spaceId,e=>{e&&R()},{immediate:!0}),pe(i,e=>{e&&(I.value=[],a.value=[],R([e]))}),E({refresh:R}),(e,r)=>{const h=Me,q=_e,V=ye;return z(),A("div",St,[n(C)?(z(),Y(xt,{key:0,tabs:n(C),modelValue:n(i),"onUpdate:modelValue":r[0]||(r[0]=y=>ae(i)?i.value=y:null),onInsert:H,onRefresh:f,"read-only":e.readOnly},null,8,["tabs","modelValue","read-only"])):Q("",!0),p(h,{size:"small","max-height":e.maxHeight?e.maxHeight:"calc(100vh - 340px)",columns:c,data:n(a),loading:n(l),"row-key":y=>y.full_key,"expanded-row-keys":n(I),onLoad:t,onUpdateExpandedRowKeys:x},null,8,["max-height","data","loading","row-key","expanded-row-keys"]),e.spaceId?(z(),Y(Ae,{key:1,info:n(P),ref_key:"actionInfoRef",ref:k,"space-id":e.spaceId,"onUpdate:success":O},null,8,["info","space-id"])):Q("",!0),p(V,{show:n(u).show,"onUpdate:show":r[1]||(r[1]=y=>n(u).show=y),size:"huge"},{default:w(()=>[p(q,{style:{"min-height":"400px",overflow:"auto",width:"1300px","min-width":"500px"}},{default:w(()=>{var y;return[p(Se,{"max-height":"auto","space-id":e.spaceId,hkey:(y=n(u).info)==null?void 0:y.full_key,"hide-history-option":"","onUpdate:success":O},null,8,["space-id","hkey"])]}),_:1})]),_:1},8,["show"])])}}}),Rt={class:"relative mb-2 w-[450px]"},Qt=Z({__name:"ParamsSearch",props:ce({spaceId:{}},{modelValue:{},modelModifiers:{}}),emits:ce(["refresh"],["update:modelValue"]),setup(m,{emit:E}){const _=E,g=m,b=ve(),T=we(),{t:d}=me(),{copy:v,isSupported:C}=xe({legacy:!0}),l=be(),i=M(!1),a=M(),u=Le(m,"modelValue"),k=M({show:!1,info:void 0}),P=M(),I=M(),$=f=>{v(f),l.success(d("common.copied"))},H=f=>{var s,c;(s=P.value)==null||s.open(),(c=P.value)==null||c.setFormValue({types:f.t,keys:f.full_key.replace(/^.*\/([^\/]*)$/,"$1"),values:f.v}),I.value={...f,type:"edit"}},K=async f=>{const[s,c]=await Fe({key:f.full_key,device_group_name:b.query.device_group_name,space_id:g.spaceId});!s&&(c==null?void 0:c.status)===0&&(L(),_("refresh"))},U=()=>{L(),_("refresh")},W=f=>{k.value={show:!0,info:f}},O=[{title:d("groupDetail.parameterManager.key"),key:"full_key",render:f=>o("div",{class:"inline-flex gap-2"},[o("div",f.full_key),o(X,{class:"cursor-pointer transition-transform hover:translate-y-[1px]",size:20,onClick:()=>$(f.full_key)},{default:()=>o(te)})])},{title:d("groupDetail.parameterManager.dataType"),key:"t",width:100,render:f=>{if(f.expandable)return;const s=Ce.find(c=>c.value===f.t);return o(Ve,{size:"small",bordered:!1,color:{textColor:"#fff",color:(s==null?void 0:s.color)||"#2080f0"},class:"min-w-16 text-center inline-flex justify-center"},{default:()=>f.t})}},{title:d("groupDetail.parameterManager.value"),key:"v",ellipsis:{tooltip:!0},render:f=>f.expandable?f.v:o("div",{class:"flex gap-2"},[o("div",f.v),C.value?o(X,{class:"cursor-pointer transition-transform hover:translate-y-[1px]",size:20,onClick:()=>$(f.v)},{default:()=>o(te)}):void 0])},{title:d("groupDetail.parameterManager.options"),key:"options",width:260,align:"center",render:f=>{const s={quaternary:!0,type:"info",size:"small"},c=o(F,{...s,onClick:()=>{H(f)}},{default:()=>d("groupDetail.parameterManager.optionEdit")}),R=o(F,{...s,onClick:()=>W(f)},{default:()=>d("groupDetail.parameterManager.optionHistory")}),t=o(Ie,{onPositiveClick:()=>K(f),placement:"left-start"},{default:()=>d("groupDetail.parameterManager.removeConfirm"),icon:()=>o(X,{color:"#e88080",size:22},o(je)),trigger:()=>o(F,{...s,type:"error"},{default:()=>d("groupDetail.parameterManager.optionRemove")})});return o("div",{class:"flex justify-end"},[c,R,t])}}],L=async()=>{var c;if(!((c=u.value)!=null&&c.trim())||!g.spaceId||i.value)return;i.value=!0;const[f,s]=await pt({device_group_name:b.query.device_group_name,space_id:g.spaceId,search_word:u.value});i.value=!1,(f||(s==null?void 0:s.status)==0)&&(a.value=s==null?void 0:s.data)};return nt(()=>{at(()=>{setTimeout(()=>{L()},200)})}),(f,s)=>{const c=$e,R=Me,t=_e,x=ye;return z(),A("div",null,[B("div",Rt,[p(c,{style:{width:"450px","padding-right":"20px"},value:u.value,"onUpdate:value":s[0]||(s[0]=e=>u.value=e),valueModifiers:{trim:!0},placeholder:n(d)("groupDetail.parameterManager.searchPlaceholder"),onKeyup:ot(L,["enter"])},null,8,["value","placeholder"]),B("div",{class:"absolute -right-4 top-1/2 -translate-1/2 h-full w-8 flex items-center justify-center cursor-pointer",onClick:L},[p(n(X),{color:n(T).primaryColor,component:n(st)},null,8,["color","component"])])]),p(R,{size:"small","max-height":"calc(100vh - 340px)",columns:O,data:n(a),loading:n(i),"row-key":e=>e.full_key},null,8,["data","loading","row-key"]),f.spaceId?(z(),Y(Ae,{key:0,info:n(I),ref_key:"actionInfoRef",ref:P,"space-id":f.spaceId,"onUpdate:success":U},null,8,["info","space-id"])):Q("",!0),p(x,{show:n(k).show,"onUpdate:show":s[1]||(s[1]=e=>n(k).show=e),size:"huge"},{default:w(()=>[p(t,{style:{"min-height":"400px",overflow:"auto",width:"1300px","min-width":"500px"}},{default:w(()=>{var e;return[p(Se,{"max-height":"auto","space-id":f.spaceId,hkey:(e=n(k).info)==null?void 0:e.full_key,"hide-history-option":"","onUpdate:success":U},null,8,["space-id","hkey"])]}),_:1})]),_:1},8,["show"])])}}});var ue={exports:{}},zt=ue.exports,He;function qt(){return He||(He=1,function(m,E){(function(_,g){g()})(zt,function(){function _(l,i){return typeof i>"u"?i={autoBom:!1}:typeof i!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(l.type)?new Blob(["\uFEFF",l],{type:l.type}):l}function g(l,i,a){var u=new XMLHttpRequest;u.open("GET",l),u.responseType="blob",u.onload=function(){C(u.response,i,a)},u.onerror=function(){console.error("could not download file")},u.send()}function b(l){var i=new XMLHttpRequest;i.open("HEAD",l,!1);try{i.send()}catch{}return 200<=i.status&&299>=i.status}function T(l){try{l.dispatchEvent(new MouseEvent("click"))}catch{var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),l.dispatchEvent(i)}}var d=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof ie=="object"&&ie.global===ie?ie:void 0,v=d.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),C=d.saveAs||(typeof window!="object"||window!==d?function(){}:"download"in HTMLAnchorElement.prototype&&!v?function(l,i,a){var u=d.URL||d.webkitURL,k=document.createElement("a");i=i||l.name||"download",k.download=i,k.rel="noopener",typeof l=="string"?(k.href=l,k.origin===location.origin?T(k):b(k.href)?g(l,i,a):T(k,k.target="_blank")):(k.href=u.createObjectURL(l),setTimeout(function(){u.revokeObjectURL(k.href)},4e4),setTimeout(function(){T(k)},0))}:"msSaveOrOpenBlob"in navigator?function(l,i,a){if(i=i||l.name||"download",typeof l!="string")navigator.msSaveOrOpenBlob(_(l,a),i);else if(b(l))g(l,i,a);else{var u=document.createElement("a");u.href=l,u.target="_blank",setTimeout(function(){T(u)})}}:function(l,i,a,u){if(u=u||open("","_blank"),u&&(u.document.title=u.document.body.innerText="downloading..."),typeof l=="string")return g(l,i,a);var k=l.type==="application/octet-stream",P=/constructor/i.test(d.HTMLElement)||d.safari,I=/CriOS\/[\d]+/.test(navigator.userAgent);if((I||k&&P||v)&&typeof FileReader<"u"){var $=new FileReader;$.onloadend=function(){var U=$.result;U=I?U:U.replace(/^data:[^;]*;/,"data:attachment/file;"),u?u.location.href=U:location=U,u=null},$.readAsDataURL(l)}else{var H=d.URL||d.webkitURL,K=H.createObjectURL(l);u?u.location=K:location.href=K,u=null,setTimeout(function(){H.revokeObjectURL(K)},4e4)}});d.saveAs=C.saveAs=C,m.exports=C})}(ue)),ue.exports}var Wt=qt();export{Gt as A,Wt as F,vt as R,Ae as _,jt as a,Bt as b,At as c,Jt as d,Se as e,Qt as f,Kt as g,Nt as i,Ft as s};
