import{G as E,u as U,P as J,d as R,e as k,f as _,h as o,b as j,r as x,o as Q,a8 as S,W as ae,l as e,V as q,w as n,i as t,v as Y,k as me,m as ve,n as he,p as Se,B as H,t as v,D as Ue,A as Ae,eb as He,aa as D,a7 as pe,N as Z,s as P,aw as Te,al as le,ec as Be,I as ne,aK as ie,E as se,bY as De,a2 as Oe,a as we,K as xe,a9 as G,T as ye,ai as je,ap as Ce,aQ as qe,a3 as re,c$ as be,aq as ke,aI as ue,ah as W,am as Fe,ao as K,j as Le,R as ge,aJ as ce,aF as $e,L as Ne,F as oe,aH as Ee,ba as fe,av as Ke,ed as Ze,ar as Ge,as as We}from"./index-BwlMlHGj.js";import{C as Je}from"./CommingSoon-DLAzaSwV.js";import{D as Qe}from"./Delete24Regular-5CFfOF6G.js";import{_ as Ye}from"./Split-Cgc73l-5.js";import{_ as Xe}from"./PaginationView.vue_vue_type_script_setup_true_lang-IR55gl3R.js";import{_ as et,C as tt,V as nt}from"./Version-LVoUP0aR.js";import{_ as lt}from"./DataTable-CfoqEf8t.js";import"./index-C1C63wPC.js";import{A as st}from"./Add-CvJqOuqG.js";import"./Image-B_0rm4XX.js";import"./download-C2161hUv.js";import"./Pagination-Do-f8cxW.js";import"./Checkbox-UFZekRDE.js";import"./RadioGroup-BB1a5vev.js";function ot(p){return E(U.getPluginList,p)}function at(){return E(U.getLocalPluginList)}function it(p){return J(U.createPlugin,p)}function rt(p){return E(U.getPluginVersions,p)}function ut(p){return J(U.packagePlugin,p)}function ct(p){return E(U.installPlugin,p)}function dt(p){return E(U.unInstallPlugin,p)}function _t(p){return J(U.globalVisible,p)}function pt(p){return J(U.updatePlugin,p)}function gt(p){return E(U.getPluginConfig,p)}const ft={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},mt=R({name:"Close",render:function(h,l){return _(),k("svg",ft,l[0]||(l[0]=[o("path",{d:"M289.94 256l95-95A24 24 0 0 0 351 127l-95 95l-95-95a24 24 0 0 0-34 34l95 95l-95 95a24 24 0 1 0 34 34l95-95l95 95a24 24 0 0 0 34-34z",fill:"currentColor"},null,-1)]))}}),vt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ht=R({name:"Play",render:function(h,l){return _(),k("svg",vt,l[0]||(l[0]=[o("path",{d:"M133 440a35.37 35.37 0 0 1-17.5-4.67c-12-6.8-19.46-20-19.46-34.33V111c0-14.37 7.46-27.53 19.46-34.33a35.13 35.13 0 0 1 35.77.45l247.85 148.36a36 36 0 0 1 0 61l-247.89 148.4A35.5 35.5 0 0 1 133 440z",fill:"currentColor"},null,-1)]))}}),wt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32"},xt=R({name:"Map",render:function(h,l){return _(),k("svg",wt,l[0]||(l[0]=[o("path",{d:"M16 24l-6.09-8.6A8.14 8.14 0 0 1 16 2a8.08 8.08 0 0 1 8 8.13a8.2 8.2 0 0 1-1.8 5.13zm0-20a6.07 6.07 0 0 0-6 6.13a6.19 6.19 0 0 0 1.49 4L16 20.52L20.63 14A6.24 6.24 0 0 0 22 10.13A6.07 6.07 0 0 0 16 4z",fill:"currentColor"},null,-1),o("circle",{cx:"16",cy:"9",r:"2",fill:"currentColor"},null,-1),o("path",{d:"M28 12h-2v2h2v14H4V14h2v-2H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h24a2 2 0 0 0 2-2V14a2 2 0 0 0-2-2z",fill:"currentColor"},null,-1)]))}}),yt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32"},Ct=R({name:"Package",render:function(h,l){return _(),k("svg",yt,l[0]||(l[0]=[o("path",{d:"M26 30H6a2 2 0 0 1-2-2V16a2 2 0 0 1 2-2h3v2H6v12h20V16h-3v-2h3a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2z",fill:"currentColor"},null,-1),o("path",{d:"M13 20h6v2h-6z",fill:"currentColor"},null,-1),o("path",{d:"M20.59 8.59L17 12.17V2h-2v10.17l-3.59-3.58L10 10l6 6l6-6l-1.41-1.41z",fill:"currentColor"},null,-1)]))}}),bt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},kt=R({name:"SwapOutlined",render:function(h,l){return _(),k("svg",bt,l[0]||(l[0]=[o("path",{d:"M847.9 592H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h605.2L612.9 851c-4.1 5.2-.4 13 6.3 13h72.5c4.9 0 9.5-2.2 12.6-6.1l168.8-214.1c16.5-21 1.6-51.8-25.2-51.8zM872 356H266.8l144.3-183c4.1-5.2.4-13-6.3-13h-72.5c-4.9 0-9.5 2.2-12.6 6.1L150.9 380.2c-16.5 21-1.6 51.8 25.1 51.8h696c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z",fill:"currentColor"},null,-1)]))}}),Lt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 12 12"},$t=R({name:"Add12Regular",render:function(h,l){return _(),k("svg",Lt,l[0]||(l[0]=[o("g",{fill:"none"},[o("path",{d:"M6 1.5a.5.5 0 0 0-1 0V5H1.5a.5.5 0 0 0 0 1H5v3.5a.5.5 0 0 0 1 0V6h3.5a.5.5 0 0 0 0-1H6V1.5z",fill:"currentColor"})],-1)]))}}),Pt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Vt=R({name:"UninstallApp24Regular",render:function(h,l){return _(),k("svg",Pt,l[0]||(l[0]=[o("g",{fill:"none"},[o("path",{d:"M21.695 15.147l.084.072a.75.75 0 0 1 .072.977l-.072.084l-2.22 2.219l2.22 2.22a.75.75 0 0 1 .072.976l-.072.084a.75.75 0 0 1-.977.072l-.084-.072l-2.22-2.22l-2.218 2.22a.75.75 0 0 1-.976.072l-.085-.072a.75.75 0 0 1-.072-.977l.072-.084l2.219-2.22l-2.218-2.218a.75.75 0 0 1-.073-.976l.072-.085a.75.75 0 0 1 .977-.072l.084.072l2.219 2.219l2.22-2.218a.75.75 0 0 1 .976-.073zM18.75 3A2.25 2.25 0 0 1 21 5.25v5.25a2.25 2.25 0 0 1-2.25 2.25h-6v6A2.25 2.25 0 0 1 10.5 21H5.25A2.25 2.25 0 0 1 3 18.75V5.25A2.25 2.25 0 0 1 5.25 3h13.5zm-7.5 9.749H4.5v6.001c0 .414.336.75.75.75h5.25a.75.75 0 0 0 .75-.75v-6.001zm7.5-8.249h-6v6.75h6a.75.75 0 0 0 .75-.75V5.25a.75.75 0 0 0-.75-.75zm-7.5 0h-6a.75.75 0 0 0-.75.75v5.999l6.75.001V4.5z",fill:"currentColor"})],-1)]))}}),zt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Mt=R({name:"InsertDriveFileOutlined",render:function(h,l){return _(),k("svg",zt,l[0]||(l[0]=[o("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zM6 20V4h7v5h5v11H6z",fill:"currentColor"},null,-1)]))}}),It={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Pe=R({name:"InstallDesktopFilled",render:function(h,l){return _(),k("svg",It,l[0]||(l[0]=[o("path",{d:"M20 17H4V5h8V3H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h4v2h8v-2h4c1.1 0 2-.9 2-2v-3h-2v3z",fill:"currentColor"},null,-1),o("path",{d:"M17 14l5-5l-1.41-1.41L18 10.17V3h-2v7.17l-2.59-2.58L12 9z",fill:"currentColor"},null,-1)]))}}),Rt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},St=R({name:"UpgradeFilled",render:function(h,l){return _(),k("svg",Rt,l[0]||(l[0]=[o("path",{d:"M16 18v2H8v-2h8zM11 7.99V16h2V7.99h3L12 4L8 7.99h3z",fill:"currentColor"},null,-1)]))}}),Ut={class:"flex justify-end"},At={key:0},Ht={key:1},Ve=R({__name:"CreatePlugin",emits:["success"],setup(p,{expose:h,emit:l}){const m=l,{t:g}=j(),w=x(),c=x(!1),d=x(),u=x({plugin_name:void 0,description:void 0,must_be_installed:!1,auto_upgrade:!1,manager_user_ids:void 0,org_ids:void 0}),y={plugin_name:{required:!0,message:"common.required"},description:{required:!0,message:"common.required"},must_be_installed:{required:!0,message:"common.required"},auto_upgrade:{required:!0,message:"common.required"}},$=x(!1),C=()=>{$.value=!1,u.value={plugin_name:void 0,description:void 0,must_be_installed:!1,auto_upgrade:!1,manager_user_ids:void 0,org_ids:void 0}},a=I=>{I||C()},i=async()=>{const[I,b]=await it({...u.value,manager_user_ids:[],org_ids:u.value.org_ids||[]});c.value=!1,!I&&b&&b.status===0&&setTimeout(()=>{C(),m("success")},100)},r=async()=>{const[I,b]=await pt({...u.value,manager_user_ids:[],org_ids:u.value.org_ids||[]});c.value=!1,!I&&b&&b.status===0&&setTimeout(()=>{C(),m("success")},100)},f=()=>{var I;c.value||(c.value=!0,(I=d.value)==null||I.validate(async b=>{if(b){c.value=!1;return}w.value==="update"?r():i()}))},z=x(),M=async()=>{var T,L;const[I,b]=await Ue();!I&&(b==null?void 0:b.status)===0&&(z.value=(L=(T=b==null?void 0:b.data)==null?void 0:T.organizations)==null?void 0:L.map(s=>({...s,label:s.organization_name,value:s.organization_id})))};return Q(()=>{M()}),h({open:()=>$.value=!0,close:C,setValues:(I={})=>{u.value={...u.value,...I}},setType:I=>{w.value=I}}),(I,b)=>{const T=he,L=ve,s=Se,A=H,F=me,N=Y,ee=ae;return _(),S(ee,{show:e($),"onUpdate:show":b[3]||(b[3]=B=>q($)?$.value=B:null),"on-update:show":a},{default:n(()=>[t(N,{style:{width:"600px"},size:"huge",bordered:!1,role:"dialog","aria-modal":"true"},{default:n(()=>[t(F,{ref_key:"formRef",ref:d,model:e(u),rules:y},{default:n(()=>[t(L,{label:e(g)("pluginCenter.pluginName"),path:"plugin_name"},{default:n(()=>[t(T,{disabled:e(w)==="update",value:e(u).plugin_name,"onUpdate:value":b[0]||(b[0]=B=>e(u).plugin_name=B),placeholder:e(g)("pluginCenter.pluginName")},null,8,["disabled","value","placeholder"])]),_:1},8,["label"]),t(L,{label:e(g)("pluginCenter.description"),path:"description"},{default:n(()=>[t(T,{type:"textarea",value:e(u).description,"onUpdate:value":b[1]||(b[1]=B=>e(u).description=B),placeholder:e(g)("pluginCenter.description")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(L,{label:e(g)("pluginCenter.visibleRange"),path:"org_ids"},{default:n(()=>[t(s,{filterable:"",multiple:"",clearable:"",placeholder:e(g)("pluginCenter.rangeTips"),value:e(u).org_ids,"onUpdate:value":b[2]||(b[2]=B=>e(u).org_ids=B),options:e(z)},null,8,["placeholder","value","options"])]),_:1},8,["label"]),o("div",Ut,[t(A,{type:"primary",loading:e(c),onClick:f},{default:n(()=>[e(w)==="update"?(_(),k("span",At,v(e(g)("pluginCenter.update")),1)):(_(),k("span",Ht,v(e(g)("pluginCenter.create")),1))]),_:1},8,["loading"])])]),_:1},8,["model"])]),_:1})]),_:1},8,["show"])}}}),Tt={class:"font-bold flex justify-between mt-1.5 pr-2"},Bt={class:"h-full flex flex-col"},Dt={class:"flex-1 flex items-center pl-2"},Ot={class:"flex-1 py-3 pl-3"},jt={class:"whitespace-pre-line"},qt={key:1,class:"h-full flex justify-center items-center"},Ft={class:"flex justify-end gap-2"},Nt=R({__name:"PackageView",emits:["success"],setup(p,{expose:h,emit:l}){const m=l,{t:g}=j(),w=Ae(),c=He("pathops",[]),d=x(),u=x(),y=x(!1),$=x(),C=x({plugin_dir:void 0}),a={plugin_dir:{required:!0,message:"common.required"}},i=x(!1),r=x(!1),f=()=>{r.value=!1,u.value=void 0},z=()=>{i.value=!1,u.value=void 0,C.value={plugin_dir:void 0}},M=()=>{const L=c.value||[];L.unshift(C.value.plugin_dir),c.value=[...new Set(L)]},V=async()=>{if(u.value=void 0,y.value||(y.value=!0,!d.value))return;const[L,s]=await ut({plugin_dir:d.value});y.value=!1,!L&&(s==null?void 0:s.status)===1&&(u.value={type:"error",text:s.msg}),!L&&s&&s.status===0&&(u.value={type:"success",text:s==null?void 0:s.data},m("success"))},X=()=>{var L;M(),d.value=(L=C.value)==null?void 0:L.plugin_dir,z()};Q(()=>{Array.isArray(c.value)||(c.value=[])}),h({open:()=>{r.value=!0},close:f});const I=L=>{d.value===L.key&&se(()=>{setTimeout(()=>{d.value=void 0},200)}),c.value=De(c.value,L.label)},b=()=>{i.value=!0},T=L=>ne("div",{className:"flex items-center gap-2"},[ne(Z,{onClick:()=>I(L),component:Mt}),ne(ie,null,{default:()=>L.label}),ne(Z,{color:"#f00",style:"display: none",onClick:()=>I(L),component:Qe})]);return(L,s)=>{const A=H,F=Be,N=le,ee=Te,B=Ye,de=Y,_e=ae,Me=he,Ie=ve,Re=me;return _(),k(D,null,[t(_e,{show:e(r),"onUpdate:show":s[1]||(s[1]=O=>q(r)?r.value=O:null),"mask-closable":!1},{default:n(()=>[t(de,{style:{width:"1200px"},size:"huge",bordered:!1,role:"dialog","aria-modal":"true","content-class":"!p-4"},{default:n(()=>[t(B,{min:.1,max:.75,"default-size":"200px"},{1:n(()=>[o("div",Tt,[P(v(e(g)("pluginCenter.plugin"))+" ",1),t(A,{type:"primary",size:"tiny",onClick:b},{icon:n(()=>[t(e($t))]),_:1})]),t(N,{style:{"max-height":"80vh","min-height":"500px"}},{default:n(()=>{var O;return[t(F,{indent:0,"collapsed-width":64,"collapsed-icon-size":22,options:(O=e(c))==null?void 0:O.map(te=>({label:te,key:te})),"render-label":T,value:e(d),"onUpdate:value":s[0]||(s[0]=te=>q(d)?d.value=te:null)},null,8,["options","value"])]}),_:1})]),2:n(()=>[o("div",Bt,[o("div",{class:"flex justify-end gap-2 pb-2 border-b",style:pe({borderColor:e(w).dividerColor})},[o("div",Dt,v(e(d)),1),t(A,{disabled:!e(d),type:"primary",loading:e(y),onClick:V},{icon:n(()=>[t(e(ht))]),default:n(()=>[P(" "+v(e(g)("pluginCenter.package")),1)]),_:1},8,["disabled","loading"]),t(A,{type:"primary",onClick:f},{icon:n(()=>[t(e(mt))]),_:1})],4),o("div",Ot,[e(u)?(_(),S(ee,{key:0,"show-icon":!1,type:e(u).type,class:"mb-5 max-h-48 overflow-y-auto"},{default:n(()=>[s[4]||(s[4]=o("div",null,"Result:",-1)),o("div",jt,v(e(u).text),1)]),_:1},8,["type"])):(_(),k("div",qt,[t(Je,{class:"h-full"})]))])])]),"resize-trigger":n(()=>[o("div",{style:pe({height:"100%",backgroundColor:e(w).dividerColor,display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"8px"})},[t(e(Z),{color:"white",size:16},{default:n(()=>[t(e(kt))]),_:1})],4)]),_:1})]),_:1})]),_:1},8,["show"]),t(_e,{show:e(i),"onUpdate:show":s[3]||(s[3]=O=>q(i)?i.value=O:null),"mask-closable":!1,"auto-focus":!1},{default:n(()=>[t(de,{style:{width:"600px"},size:"huge",bordered:!1,role:"dialog","aria-modal":"true","content-class":"!p-4"},{default:n(()=>[t(Re,{ref_key:"formRef",ref:$,model:e(C),rules:a},{default:n(()=>[t(ee,{class:"w-full mb-5",type:"info"},{default:n(()=>[P(v(e(g)("pluginCenter.packagePathPlaceholder")),1)]),_:1}),t(Ie,{label:e(g)("pluginCenter.packagePath"),path:"plugin_dir"},{default:n(()=>[t(Me,{value:e(C).plugin_dir,"onUpdate:value":s[2]||(s[2]=O=>e(C).plugin_dir=O),clearable:""},null,8,["value"])]),_:1},8,["label"]),o("div",Ft,[t(A,{type:"default",onClick:z},{default:n(()=>[P(v(e(g)("common.cancel")),1)]),_:1}),t(A,{type:"primary",loading:e(y),onClick:X},{default:n(()=>[P(v(e(g)("common.OK")),1)]),_:1},8,["loading"])])]),_:1},8,["model"])]),_:1})]),_:1},8,["show"])],64)}}}),Et=Oe(Nt,[["__scopeId","data-v-56486782"]]),Kt="data:image/svg+xml,%3csvg%20viewBox='0%200%2024%2024'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='24.000000'%20height='24.000000'%20fill='none'%3e%3crect%20id='swap-box-fill'%20width='24.000000'%20height='24.000000'%20x='0.000000'%20y='0.000000'%20fill='rgb(255,255,255)'%20fill-opacity='0'%20/%3e%3cpath%20id='矢量%20100'%20d='M3%203L21%203C21.2652%203%2021.5196%203.10536%2021.7071%203.29289C21.8946%203.48043%2022%203.73478%2022%204L22%2020C22%2020.2652%2021.8946%2020.5196%2021.7071%2020.7071C21.5196%2020.8946%2021.2652%2021%2021%2021L3%2021C2.73478%2021%202.48043%2020.8946%202.29289%2020.7071C2.10536%2020.5196%202%2020.2652%202%2020L2%204C2%203.73478%202.10536%203.48043%202.29289%203.29289C2.48043%203.10536%202.73478%203%203%203L3%203ZM15%207L15%209L11%209L11%2011L15%2011L15%2013L18.5%2010L15%207ZM9%2017L9%2015L13%2015L13%2013L9%2013L9%2011L5.5%2014L9%2017Z'%20fill='rgb(99,226,183)'%20fill-rule='evenodd'%20/%3e%3c/svg%3e",Zt="data:image/svg+xml,%3csvg%20viewBox='0%200%2024%2024'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='24.000000'%20height='24.000000'%20fill='none'%3e%3crect%20id='file-edit-fill'%20width='24.000000'%20height='24.000000'%20x='0.000000'%20y='0.000000'%20fill='rgb(255,255,255)'%20fill-opacity='0'%20/%3e%3cpath%20id='矢量%2044'%20d='M21%2015.243L21%2021.008C20.9997%2021.2712%2020.895%2021.5235%2020.7088%2021.7095C20.5226%2021.8955%2020.2702%2022%2020.007%2022L3.99302%2022C3.8617%2021.9991%203.73184%2021.9723%203.61087%2021.9212C3.48989%2021.8701%203.38017%2021.7957%203.28796%2021.7022C3.19575%2021.6087%203.12286%2021.4979%203.07346%2021.3762C3.02405%2021.2545%202.9991%2021.1243%203.00002%2020.993L3.00002%209L9.00002%209C9.26524%209%209.51959%208.89464%209.70713%208.70711C9.89467%208.51957%2010%208.26522%2010%208L10%202L20.002%202C20.553%202%2021%202.455%2021%202.992L21%206.757L12.001%2015.757L11.995%2019.995L16.241%2020.001L21%2015.243ZM21.778%208.808L23.192%2010.222L15.414%2018L13.998%2017.998L14%2016.586L21.778%208.808L21.778%208.808ZM3.00002%207L8.00002%202.003L8.00002%207L3.00002%207Z'%20fill='rgb(99,226,183)'%20fill-rule='evenodd'%20/%3e%3c/svg%3e",Gt={class:"absolute top-0 right-0 inline-flex items-center gap-1"},Wt=["src"],Jt=["src"],Qt=R({__name:"ActionView",props:{cfg:{},uid:{},id:{},visible:{type:Boolean}},emits:["visible:success","refresh"],setup(p,{emit:h}){const l=we(),m=xe(),{t:g}=j(),w=x(),c=h,d=p,u=x(!1),y=async()=>{const[r,f]=await _t({plugin_id:d.id,visible:!d.visible});!r&&(f==null?void 0:f.status)===0&&(m.success(g("pluginCenter.setupSuccess")),c("visible:success"))},$=x(!1),C=async()=>{const[r,f]=await gt({plugin_id:d.id});if(!r&&(f==null?void 0:f.status)===0)return f.data.org_list},a=async()=>{const r=await C();$.value=!0,se(()=>{setTimeout(()=>{var f,z,M;(f=w.value)==null||f.open(),(z=w.value)==null||z.setValues({plugin_name:d.cfg.plugin_name,plugin_id:d.cfg.plugin_id,description:d.cfg.description,must_be_installed:d.cfg.must_be_installed,auto_upgrade:d.cfg.auto_upgrade,manager_user_ids:void 0,org_ids:r==null?void 0:r.map(V=>V.organization_id)}),(M=w.value)==null||M.setType("update")},100)})},i=()=>{c("refresh")};return(r,f)=>{var M,V;const z=ye;return _(),k(D,null,[o("div",Gt,[e(u)?(_(),S(z,{key:0,placement:"top-start",trigger:"hover"},{trigger:n(()=>[o("img",{class:"w-5 cursor-pointer",src:e(Kt),alt:"",onClick:y},null,8,Wt)]),default:n(()=>[P(" "+v(e(g)("pluginCenter.visibleTips")),1)]),_:1})):G("",!0),((M=e(l).info)==null?void 0:M.user_id)===r.uid||(V=e(l).info)!=null&&V.is_sys_admin?(_(),S(z,{key:1,placement:"top-start",trigger:"hover"},{trigger:n(()=>[o("img",{class:"w-5 cursor-pointer",src:e(Zt),alt:"",onClick:a},null,8,Jt)]),default:n(()=>[P(" "+v(e(g)("pluginCenter.edit")),1)]),_:1})):G("",!0)]),e($)?(_(),S(Ve,{key:0,ref_key:"createPluginRef",ref:w,onSuccess:i},null,512)):G("",!0)],64)}}}),ze=R({__name:"UploadFile",props:{url:{}},emits:["success"],setup(p,{emit:h}){const{t:l}=j(),m=p,g=h,w=xe(),c=async({file:d,data:u,onFinish:y,onError:$,onProgress:C})=>{const a=new FormData;u&&Object.keys(u).forEach(f=>{a.append(f,u[f])}),a.append("plugin_file",d.file);const[i,r]=await J(m.url,a,{headers:{"Content-Type":"multipart/form-data"}});!i&&(r==null?void 0:r.status)===0?(y(),g("success"),w.success(l("pluginCenter.uploadSuccessfully"))):$()};return(d,u)=>{const y=et;return _(),S(y,{"custom-request":c,"show-file-list":!1},{default:n(()=>[je(d.$slots,"default")]),_:3})}}}),Yt=R({__name:"VersionList",props:{pluginId:{}},setup(p,{expose:h}){const{t:l}=j(),m=p,g=x(!1),w=[{title:l("pluginCenter.version"),key:"full_version_code"},{title:l("pluginCenter.updateDesc"),key:"update_description"},{title:l("pluginCenter.hooks"),key:"hook",render:a=>a.hook||"-"},{title:l("pluginCenter.createTime"),key:"create_time",minWidth:100,render:a=>a.create_time?new Date(a.create_time).toLocaleString():"-"}],c=Ce({page:1,per_page:qe,total:0}),d=x(),u=async()=>{if(!m.pluginId||!g.value)return;const[a,i]=await rt({...ke(c),plugin_id:m.pluginId});!a&&i&&i.status===0&&(d.value=i.data.list,c.total=i.data.total)},y=a=>{a||$()},$=()=>{g.value=!1};re(()=>m.pluginId,a=>{a&&u()});const C=()=>{c.page=1,se(()=>{u()})};return h({open:()=>g.value=!0,close:$,fetchList:u}),(a,i)=>{const r=H,f=lt,z=Y,M=ae;return _(),S(M,{show:e(g),"onUpdate:show":i[1]||(i[1]=V=>q(g)?g.value=V:null),"on-update:show":y},{default:n(()=>[t(z,{style:{width:"80vw"},size:"huge",bordered:!1,role:"dialog","aria-modal":"true",class:"!pt-0"},{default:n(()=>[t(be,{title:e(l)("pluginCenter.versions")},{extra:n(()=>[o("div",null,[t(ze,{url:e(U).uploadVersion,data:{plugin_id:a.pluginId},onSuccess:C},{default:n(()=>[t(r,{type:"primary"},{icon:n(()=>[t(e(tt))]),default:n(()=>[P(" "+v(e(l)("pluginCenter.upload")),1)]),_:1})]),_:1},8,["url","data"])])]),_:1},8,["title"]),t(f,{columns:w,data:e(d),pagination:!1,"scroll-x":1e3},null,8,["data"]),t(Xe,{"page-info":e(c),"onUpdate:pageInfo":i[0]||(i[0]=V=>q(c)?c.value=V:null),onUpdateList:u},null,8,["page-info"])]),_:1})]),_:1},8,["show"])}}}),Xt={class:"relative"},en={class:"break-keep text-xl"},tn={class:"inline-block ml-2"},nn={class:"opacity-75 text-xs mt-2"},ln={class:"flex"},sn={class:"break-keep pr-2"},on={class:"flex flex-col gap-2 mt-2 min-h-[62px]"},an={class:"mt-2"},rn={class:""},un={class:"flex justify-around items-center gap-1"},cn=R({__name:"OnlinePlugin",setup(p,{expose:h}){const l=we(),{t:m}=j(),g=x(),w=x(),c=i=>{var r;w.value=i,(r=g.value)==null||r.open()},d=x({loading:!1,id:void 0}),u=async(i,r,f)=>{var z;if(!((z=d.value)!=null&&z.loading)){if(d.value={loading:!0,id:f},r==="install"){const[M,V]=await ct({plugin_id:i.plugin_id});!M&&(V==null?void 0:V.status)===0&&C()}else if(r==="unInstall"){const[M,V]=await dt({plugin_name:i.plugin_name});!M&&(V==null?void 0:V.status)===0&&C()}d.value={loading:!1}}},y=Ce({page:1,per_page:999999999,total:0}),$=x(),C=async(i={})=>{const[r,f]=await ot({...i,...ke(y)});!r&&f&&f.status===0&&($.value=f.data.list,y.total=f.data.total)};Q(()=>{C()});const a=()=>{y.page=1,se(C)};return h({refresh:a}),(i,r)=>{const f=Z,z=ye,M=ie,V=Le,X=Y,I=Fe,b=ce,T=ue,L=le;return _(),k("div",null,[t(L,{style:{maxHeight:"calc(100vh - 160px)"}},{default:n(()=>[t(T,{cols:"4","x-gap":"20","y-gap":"20",class:"py-1 px-1.5"},{default:n(()=>[(_(!0),k(D,null,W(e($),s=>(_(),S(b,{key:s.plugin_id},{default:n(()=>{var A,F;return[t(I,{show:((A=e(d))==null?void 0:A.loading)&&((F=e(d))==null?void 0:F.id)==s.plugin_id},{default:n(()=>[t(X,{rounded:"",style:{width:"100%"},"content-class":"!mb-0 !p-2",class:"hover:scale-103 hover:transform-gpu"},{default:n(()=>{var N;return[o("div",Xt,[o("div",en,[P(v(s.plugin_name)+" ",1),t(e(K),{class:"ml-2",size:"small",type:s.installed?"success":"info",bordered:!1},{default:n(()=>[P(v(s.installed?e(m)("pluginCenter.INSTALLED"):e(m)("pluginCenter.UNINSTALLED")),1)]),_:2},1032,["type"]),s.full_path?(_(),S(z,{key:0,placement:"top-start",trigger:"hover"},{trigger:n(()=>[o("div",tn,[t(e(H),{type:"primary",size:"tiny",class:"relative top-0.5"},{default:n(()=>[t(f,{component:e(xt)},null,8,["component"])]),_:1})])]),default:n(()=>[o("span",null,v(s.full_path),1)]),_:2},1024)):G("",!0),t(Qt,{id:s.plugin_id,visible:s.is_globally_visible,uid:s.create_uid,cfg:s,"onVisible:success":a,onRefresh:a},null,8,["id","visible","uid","cfg"])]),o("div",nn,[t(M,{"line-clamp":1},{default:n(()=>[P(v(s.description),1)]),_:2},1024)])]),t(V,{class:"!my-3"}),o("div",ln,[o("span",sn,v(e(m)("pluginCenter.hooks"))+": ",1),t(M,{"line-clamp":1},{default:n(()=>[P(v(s.latest_version_hook),1)]),_:2},1024)]),o("div",on,[o("div",null,[t(e(K),{type:"warning",size:"small"},{default:n(()=>[P(v(e(m)("pluginCenter.localVersion"))+": "+v(s.local_version),1)]),_:2},1024),t(e(K),{type:"warning",size:"small",class:"ml-2"},{default:n(()=>[P(v(e(m)("pluginCenter.latestVersionCode"))+": "+v(s.latest_version_code),1)]),_:2},1024)]),o("div",an,[(N=e(l).info)!=null&&N.is_sys_admin?(_(),k(D,{key:0},[o("span",rn,v(e(m)("pluginCenter.visible"))+": ",1),t(e(K),{type:"error",size:"small"},{default:n(()=>[P(v(s.is_globally_visible?e(m)("pluginCenter.yes"):e(m)("pluginCenter.no")),1)]),_:2},1024)],64)):G("",!0)])]),t(V,{class:"!my-3"}),o("div",un,[t(e(H),{type:"info",size:"small",class:"flex-1 !px-0.5",onClick:ge(()=>c(s.plugin_id),["stop"])},{icon:n(()=>[t(e(nt))]),default:n(()=>[P(" "+v(e(m)("pluginCenter.versions")),1)]),_:2},1032,["onClick"]),t(e(H),{type:"info",size:"small",class:"flex-1",disabled:s.installed?!s.uninstall_enable:!1,onClick:ge(()=>u(s,s.installed?"unInstall":"install",s.plugin_id),["stop"])},{icon:n(()=>[s.installed?(_(),S(e(Vt),{key:0})):(_(),S(e(Pe),{key:1}))]),default:n(()=>[P(v(s!=null&&s.installed?e(m)("pluginCenter.unInstall"):e(m)("pluginCenter.install"))+" ",1)]),_:2},1032,["disabled","onClick"]),t(e(H),{type:"info",size:"small",class:"flex-1",onClick:()=>u(s,"install",s.plugin_id),disabled:!s.need_update},{icon:n(()=>[t(e(St))]),default:n(()=>[P(v(e(m)("pluginCenter.update"))+" ",1)]),_:2},1032,["onClick","disabled"])])]}),_:2},1024)]),_:2},1032,["show"])]}),_:2},1024))),128))]),_:1})]),_:1}),t(Yt,{"plugin-id":e(w),ref_key:"versionModalRef",ref:g},null,8,["plugin-id"])])}}}),dn={class:"relative"},_n={class:"break-keep text-xl flex justify-between"},pn={class:"opacity-75 text-xs mt-2"},gn={class:"flex"},fn={class:"break-keep pr-2"},mn={class:"flex mt-2 pb-3"},vn={class:"pr-2"},hn={class:"flex gap-2 flex-wrap"},wn=R({__name:"LocalPlugin",setup(p,{expose:h}){const{t:l}=j(),m=x(),g=async()=>{const[w,c]=await at();!w&&c&&c.status===0&&(m.value=c.data)};return h({refresh:g}),Q(()=>{g()}),(w,c)=>{const d=ie,u=Le,y=Y,$=ce,C=ue,a=le;return _(),k("div",null,[t(a,{style:{maxHeight:"calc(100vh - 160px)"}},{default:n(()=>[t(C,{cols:"4","x-gap":"20","y-gap":"20",class:"py-1 px-1.5"},{default:n(()=>[(_(!0),k(D,null,W(e(m),(i,r)=>(_(),S($,{key:r},{default:n(()=>[t(y,{rounded:"",style:{width:"100%"},"content-class":"!mb-0 !p-2",class:"hover:scale-103 hover:transform-gpu"},{default:n(()=>[o("div",dn,[o("div",_n,[o("div",null,v(i.plugin_name),1)]),o("div",pn,[t(d,{"line-clamp":1},{default:n(()=>[P(v(i.desc),1)]),_:2},1024)])]),t(u,{class:"!my-3"}),o("div",gn,[o("span",fn,v(e(l)("pluginCenter.hooks"))+": ",1),t(d,{"line-clamp":1},{default:n(()=>{var f;return[P(v((f=i.hook)==null?void 0:f.join(", ")),1)]}),_:2},1024)]),o("div",mn,[o("span",vn,v(e(l)("pluginCenter.localVersion"))+": ",1),o("div",hn,[t(e(K),{type:"warning",size:"small"},{default:n(()=>[P(v(i.version),1)]),_:2},1024)])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])}}}),xn={class:"text-lg font-bold"},yn=R({__name:"UtilityGroups",setup(p){const h=$e(),l=x(),m=async()=>{const[w,c]=await Ze();!w&&(c==null?void 0:c.status)===0&&(l.value=c.data),h.refreshPluginUtilities&&(h.refreshPluginUtilities=!1)},g=Ne(()=>oe(l.value)||oe(l.value.by_group)&&oe(l.value.without_group));return Q(()=>{m()}),re(()=>h.refreshPluginUtilities,w=>{w&&m()}),(w,c)=>{const d=Ee,u=ce,y=ue,$=le;return _(),k("div",null,[e(g)?(_(),S(d,{key:0,class:"mt-40"})):(_(),S($,{key:1,style:{maxHeight:"calc(100vh - 160px)"}},{default:n(()=>{var C;return[t(y,{cols:4,"x-gap":20},{default:n(()=>{var a,i;return[(_(!0),k(D,null,W((i=(a=e(l))==null?void 0:a.without_group)==null?void 0:i.map(r=>({...r,is_running:!0})),r=>(_(),S(u,{key:r.server_id},{default:n(()=>[t(fe,{info:r,onRefresh:m},null,8,["info"])]),_:2},1024))),128))]}),_:1}),(_(!0),k(D,null,W((C=e(l))==null?void 0:C.by_group,(a,i)=>(_(),k(D,{key:i},[o("div",xn,[t(be,{title:i,icon:e(Ke)},null,8,["title","icon"])]),t(y,{cols:4,"x-gap":20},{default:n(()=>[(_(!0),k(D,null,W(a==null?void 0:a.map(r=>({...r,is_running:!0})),r=>(_(),S(u,{key:r.server_id},{default:n(()=>[t(fe,{info:r,onRefresh:m},null,8,["info"])]),_:2},1024))),128))]),_:2},1024)],64))),128))]}),_:1}))])}}}),Cn={class:"flex justify-between items-center gap-5"},bn={class:"flex justify-end gap-2"},Bn=R({__name:"PluginCenter",setup(p){const h=$e(),{t:l}=j(),m=x(),g=x(),w=x(),c=x(),d=()=>{var a;(a=w.value)==null||a.open()},u=()=>{var a;(a=c.value)==null||a.open()},y=x(),$=x(),C=()=>{setTimeout(()=>{var a,i;(a=m.value)==null||a.refresh(),(i=g.value)==null||i.refresh()},500)};return re(()=>h.pluginCenterActiveTab,a=>{a&&(y.value=a,h.pluginCenterActiveTab=void 0)},{immediate:!0}),(a,i)=>{const r=Z,f=Ge,z=We;return _(),k("div",null,[t(z,{type:"card",animated:"",class:"!h-full !w-auto",value:e(y),"onUpdate:value":i[0]||(i[0]=M=>q(y)?y.value=M:null),onUpdateValue:e($)},{suffix:n(()=>[o("div",Cn,[o("div",bn,[t(e(H),{type:"primary",onClick:u},{icon:n(()=>[t(e(Ct))]),default:n(()=>[P(" "+v(e(l)("pluginCenter.package")),1)]),_:1}),t(ze,{url:e(U).installFromLocal},{default:n(()=>[t(e(H),{type:"primary"},{icon:n(()=>[t(e(Pe))]),default:n(()=>[P(" "+v(e(l)("pluginCenter.installFromLocale")),1)]),_:1})]),_:1},8,["url"]),t(e(H),{type:"primary",onClick:d},{icon:n(()=>[t(r,null,{default:n(()=>[t(e(st))]),_:1})]),default:n(()=>[P(" "+v(e(l)("pluginCenter.create")),1)]),_:1})])])]),default:n(()=>[t(f,{name:"online",tab:e(l)("pluginCenter.onlinePlugins")},{default:n(()=>[t(cn,{ref_key:"onlinePluginRef",ref:g},null,512)]),_:1},8,["tab"]),t(f,{name:"local",tab:e(l)("pluginCenter.localPlugins")},{default:n(()=>[t(wn,{ref_key:"localPluginRef",ref:m},null,512)]),_:1},8,["tab"]),t(f,{name:"utility",tab:e(l)("pluginCenter.utility")},{default:n(()=>[t(yn)]),_:1},8,["tab"])]),_:1},8,["value","onUpdateValue"]),t(Ve,{ref_key:"createPluginRef",ref:w,onSuccess:C},null,512),t(Et,{ref_key:"packageViewRef",ref:c},null,512)])}}});export{Bn as default};
