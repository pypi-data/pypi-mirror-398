import{d as se,I as g,bA as gn,bE as me,r as B,cR as Xe,cS as Vn,c6 as Wn,bL as Gn,L as $,bD as Xn,c9 as j,o as Yn,bS as Qn,ca as Pe,bn as Zn,bU as vn,bh as D,bf as Z,bj as P,cT as ke,bk as ce,cU as an,cV as Jn,cW as Ye,b2 as rn,b3 as dn,aH as cn,cc as et,cd as Ce,bs as nt,bw as tt,bt as bn,cX as lt,ck as sn,aj as Ke,af as C,ct as Oe,a3 as Be,E as Ie,cY as un,cZ as ot,cz as z,bC as it,by as at}from"./index-BwlMlHGj.js";import{_ as rt}from"./Checkbox-UFZekRDE.js";function yn(e){return typeof e=="string"?`s-${e}`:`n-${e}`}const dt=se({name:"Switcher",render(){return g("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},g("path",{d:"M12 8l10 8l-10 8z"}))}}),kn=gn("n-tree-select");function fn({position:e,offsetLevel:l,indent:s,el:u}){const c={position:"absolute",boxSizing:"border-box",right:0};if(e==="inside")c.left=0,c.top=0,c.bottom=0,c.borderRadius="inherit",c.boxShadow="inset 0 0 0 2px var(--n-drop-mark-color)";else{const r=e==="before"?"top":"bottom";c[r]=0,c.left=`${u.offsetLeft+6-l*s}px`,c.height="2px",c.backgroundColor="var(--n-drop-mark-color)",c.transformOrigin=r,c.borderRadius="1px",c.transform=e==="before"?"translateY(-4px)":"translateY(4px)"}return g("div",{style:c})}function ct({dropPosition:e,node:l}){return l.isLeaf===!1||l.children?!0:e!=="inside"}const De=gn("n-tree");function st({props:e,fNodesRef:l,mergedExpandedKeysRef:s,mergedSelectedKeysRef:u,mergedCheckedKeysRef:c,handleCheck:r,handleSelect:b,handleSwitcherClick:y}){const{value:v}=u,m=me(kn,null),k=m?m.pendingNodeKeyRef:B(v.length?v[v.length-1]:null);function A(w){var L;if(!e.keyboard)return{enterBehavior:null};const{value:T}=k;let x=null;if(T===null){if((w.key==="ArrowDown"||w.key==="ArrowUp")&&w.preventDefault(),["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"].includes(w.key)&&T===null){const{value:h}=l;let f=0;for(;f<h.length;){if(!h[f].disabled){k.value=h[f].key;break}f+=1}}}else{const{value:h}=l;let f=h.findIndex(R=>R.key===T);if(!~f)return{enterBehavior:null};if(w.key==="Enter"){const R=h[f];switch(x=((L=e.overrideDefaultNodeClickBehavior)===null||L===void 0?void 0:L.call(e,{option:R.rawNode}))||null,x){case"toggleCheck":r(R,!c.value.includes(R.key));break;case"toggleSelect":b(R);break;case"toggleExpand":y(R);break;case"none":break;case"default":default:x="default",b(R)}}else if(w.key==="ArrowDown")for(w.preventDefault(),f+=1;f<h.length;){if(!h[f].disabled){k.value=h[f].key;break}f+=1}else if(w.key==="ArrowUp")for(w.preventDefault(),f-=1;f>=0;){if(!h[f].disabled){k.value=h[f].key;break}f-=1}else if(w.key==="ArrowLeft"){const R=h[f];if(R.isLeaf||!s.value.includes(T)){const I=R.getParent();I&&(k.value=I.key)}else y(R)}else if(w.key==="ArrowRight"){const R=h[f];if(R.isLeaf)return{enterBehavior:null};if(!s.value.includes(T))y(R);else for(f+=1;f<h.length;){if(!h[f].disabled){k.value=h[f].key;break}f+=1}}}return{enterBehavior:x}}return{pendingNodeKeyRef:k,handleKeydown:A}}const ut=se({name:"NTreeNodeCheckbox",props:{clsPrefix:{type:String,required:!0},indent:{type:Number,required:!0},right:Boolean,focusable:Boolean,disabled:Boolean,checked:Boolean,indeterminate:Boolean,onCheck:Function},setup(e){const l=me(De);function s(c){const{onCheck:r}=e;r&&r(c)}function u(c){s(c)}return{handleUpdateValue:u,mergedTheme:l.mergedThemeRef}},render(){const{clsPrefix:e,mergedTheme:l,checked:s,indeterminate:u,disabled:c,focusable:r,indent:b,handleUpdateValue:y}=this;return g("span",{class:[`${e}-tree-node-checkbox`,this.right&&`${e}-tree-node-checkbox--right`],style:{width:`${b}px`},"data-checkbox":!0},g(rt,{focusable:r,disabled:c,theme:l.peers.Checkbox,themeOverrides:l.peerOverrides.Checkbox,checked:s,indeterminate:u,onUpdateChecked:y}))}}),ft=se({name:"TreeNodeContent",props:{clsPrefix:{type:String,required:!0},disabled:Boolean,checked:Boolean,selected:Boolean,onClick:Function,onDragstart:Function,tmNode:{type:Object,required:!0},nodeProps:Object},setup(e){const{renderLabelRef:l,renderPrefixRef:s,renderSuffixRef:u,labelFieldRef:c}=me(De),r=B(null);function b(v){const{onClick:m}=e;m&&m(v)}function y(v){b(v)}return{selfRef:r,renderLabel:l,renderPrefix:s,renderSuffix:u,labelField:c,handleClick:y}},render(){const{clsPrefix:e,labelField:l,nodeProps:s,checked:u=!1,selected:c=!1,renderLabel:r,renderPrefix:b,renderSuffix:y,handleClick:v,onDragstart:m,tmNode:{rawNode:k,rawNode:{prefix:A,suffix:w,[l]:L}}}=this;return g("span",Object.assign({},s,{ref:"selfRef",class:[`${e}-tree-node-content`,s==null?void 0:s.class],onClick:v,draggable:m===void 0?void 0:!0,onDragstart:m}),b||A?g("div",{class:`${e}-tree-node-content__prefix`},b?b({option:k,selected:c,checked:u}):Xe(A)):null,g("div",{class:`${e}-tree-node-content__text`},r?r({option:k,selected:c,checked:u}):Xe(L)),y||w?g("div",{class:`${e}-tree-node-content__suffix`},y?y({option:k,selected:c,checked:u}):Xe(w)):null)}}),ht=se({name:"NTreeSwitcher",props:{clsPrefix:{type:String,required:!0},indent:{type:Number,required:!0},expanded:Boolean,selected:Boolean,hide:Boolean,loading:Boolean,onClick:Function,tmNode:{type:Object,required:!0}},setup(e){const{renderSwitcherIconRef:l}=me(De,null);return()=>{const{clsPrefix:s,expanded:u,hide:c,indent:r,onClick:b}=e;return g("span",{"data-switcher":!0,class:[`${s}-tree-node-switcher`,u&&`${s}-tree-node-switcher--expanded`,c&&`${s}-tree-node-switcher--hide`],style:{width:`${r}px`},onClick:b},g("div",{class:`${s}-tree-node-switcher__icon`},g(Vn,null,{default:()=>{if(e.loading)return g(Wn,{clsPrefix:s,key:"loading",radius:85,strokeWidth:20});const{value:y}=l;return y?y({expanded:e.expanded,selected:e.selected,option:e.tmNode.rawNode}):g(Gn,{clsPrefix:s,key:"switcher"},{default:()=>g(dt,null)})}})))}}});function gt(e){return $(()=>e.leafOnly?"child":e.checkStrategy)}function ie(e,l){return!!e.rawNode[l]}function mn(e,l,s,u){e==null||e.forEach(c=>{s(c),mn(c[l],l,s,u),u(c)})}function vt(e,l,s,u,c){const r=new Set,b=new Set,y=[];return mn(e,u,v=>{if(y.push(v),c(l,v)){b.add(v[s]);for(let m=y.length-2;m>=0;--m)if(!r.has(y[m][s]))r.add(y[m][s]);else return}},()=>{y.pop()}),{expandedKeys:Array.from(r),highlightKeySet:b}}if(Xn&&Image){const e=new Image;e.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="}function bt(e,l,s,u,c){const r=new Set,b=new Set,y=new Set,v=[],m=[],k=[];function A(L){L.forEach(T=>{if(k.push(T),l(s,T)){r.add(T[u]),y.add(T[u]);for(let h=k.length-2;h>=0;--h){const f=k[h][u];if(!b.has(f))b.add(f),r.has(f)&&r.delete(f);else break}}const x=T[c];x&&A(x),k.pop()})}A(e);function w(L,T){L.forEach(x=>{const h=x[u],f=r.has(h),R=b.has(h);if(!f&&!R)return;const I=x[c];if(I)if(f)T.push(x);else{v.push(h);const K=Object.assign(Object.assign({},x),{[c]:[]});T.push(K),w(I,K[c])}else T.push(x)})}return w(e,m),{filteredTree:m,highlightKeySet:y,expandedKeys:v}}const xn=se({name:"TreeNode",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(e){const l=me(De),{droppingNodeParentRef:s,droppingMouseNodeRef:u,draggingNodeRef:c,droppingPositionRef:r,droppingOffsetLevelRef:b,nodePropsRef:y,indentRef:v,blockLineRef:m,checkboxPlacementRef:k,checkOnClickRef:A,disabledFieldRef:w,showLineRef:L,renderSwitcherIconRef:T,overrideDefaultNodeClickBehaviorRef:x}=l,h=j(()=>!!e.tmNode.rawNode.checkboxDisabled),f=j(()=>ie(e.tmNode,w.value)),R=j(()=>l.disabledRef.value||f.value),I=$(()=>{const{value:i}=y;if(i)return i({option:e.tmNode.rawNode})}),K=B(null),ae={value:null};Yn(()=>{ae.value=K.value.$el});function X(){const i=()=>{const{tmNode:N}=e;if(!N.isLeaf&&!N.shallowLoaded){if(!l.loadingKeysRef.value.has(N.key))l.loadingKeysRef.value.add(N.key);else return;const{onLoadRef:{value:E}}=l;E&&E(N.rawNode).then(O=>{O!==!1&&l.handleSwitcherClick(N)}).finally(()=>{l.loadingKeysRef.value.delete(N.key)})}else l.handleSwitcherClick(N)};T.value?setTimeout(i,0):i()}const ne=j(()=>!f.value&&l.selectableRef.value&&(l.internalTreeSelect?l.mergedCheckStrategyRef.value!=="child"||l.multipleRef.value&&l.cascadeRef.value||e.tmNode.isLeaf:!0)),ee=j(()=>l.checkableRef.value&&(l.cascadeRef.value||l.mergedCheckStrategyRef.value!=="child"||e.tmNode.isLeaf)),xe=j(()=>l.displayedCheckedKeysRef.value.includes(e.tmNode.key)),re=j(()=>{const{value:i}=ee;if(!i)return!1;const{value:N}=A,{tmNode:E}=e;return typeof N=="boolean"?!E.disabled&&N:N(e.tmNode.rawNode)});function we(i){const{value:N}=l.expandOnClickRef,{value:E}=ne,{value:O}=re;if(!E&&!N&&!O||Pe(i,"checkbox")||Pe(i,"switcher"))return;const{tmNode:U}=e;E&&l.handleSelect(U),N&&!U.isLeaf&&X(),O&&J(!xe.value)}function Ne(i){var N,E;if(!(Pe(i,"checkbox")||Pe(i,"switcher"))){if(!R.value){const O=x.value;let U=!1;if(O)switch(O({option:e.tmNode.rawNode})){case"toggleCheck":U=!0,J(!xe.value);break;case"toggleSelect":U=!0,l.handleSelect(e.tmNode);break;case"toggleExpand":U=!0,X(),U=!0;break;case"none":U=!0,U=!0;return}U||we(i)}(E=(N=I.value)===null||N===void 0?void 0:N.onClick)===null||E===void 0||E.call(N,i)}}function _e(i){m.value||Ne(i)}function V(i){m.value&&Ne(i)}function J(i){l.handleCheck(e.tmNode,i)}function te(i){l.handleDragStart({event:i,node:e.tmNode})}function $e(i){i.currentTarget===i.target&&l.handleDragEnter({event:i,node:e.tmNode})}function Y(i){i.preventDefault(),l.handleDragOver({event:i,node:e.tmNode})}function le(i){l.handleDragEnd({event:i,node:e.tmNode})}function Re(i){i.currentTarget===i.target&&l.handleDragLeave({event:i,node:e.tmNode})}function Ue(i){i.preventDefault(),r.value!==null&&l.handleDrop({event:i,node:e.tmNode,dropPosition:r.value})}const je=$(()=>{const{clsPrefix:i}=e,{value:N}=v;if(L.value){const E=[];let O=e.tmNode.parent;for(;O;)O.isLastChild?E.push(g("div",{class:`${i}-tree-node-indent`},g("div",{style:{width:`${N}px`}}))):E.push(g("div",{class:[`${i}-tree-node-indent`,`${i}-tree-node-indent--show-line`]},g("div",{style:{width:`${N}px`}}))),O=O.parent;return E.reverse()}else return Qn(e.tmNode.level,g("div",{class:`${e.clsPrefix}-tree-node-indent`},g("div",{style:{width:`${N}px`}})))});return{showDropMark:j(()=>{const{value:i}=c;if(!i)return;const{value:N}=r;if(!N)return;const{value:E}=u;if(!E)return;const{tmNode:O}=e;return O.key===E.key}),showDropMarkAsParent:j(()=>{const{value:i}=s;if(!i)return!1;const{tmNode:N}=e,{value:E}=r;return E==="before"||E==="after"?i.key===N.key:!1}),pending:j(()=>l.pendingNodeKeyRef.value===e.tmNode.key),loading:j(()=>l.loadingKeysRef.value.has(e.tmNode.key)),highlight:j(()=>{var i;return(i=l.highlightKeySetRef.value)===null||i===void 0?void 0:i.has(e.tmNode.key)}),checked:xe,indeterminate:j(()=>l.displayedIndeterminateKeysRef.value.includes(e.tmNode.key)),selected:j(()=>l.mergedSelectedKeysRef.value.includes(e.tmNode.key)),expanded:j(()=>l.mergedExpandedKeysRef.value.includes(e.tmNode.key)),disabled:R,checkable:ee,mergedCheckOnClick:re,checkboxDisabled:h,selectable:ne,expandOnClick:l.expandOnClickRef,internalScrollable:l.internalScrollableRef,draggable:l.draggableRef,blockLine:m,nodeProps:I,checkboxFocusable:l.internalCheckboxFocusableRef,droppingPosition:r,droppingOffsetLevel:b,indent:v,checkboxPlacement:k,showLine:L,contentInstRef:K,contentElRef:ae,indentNodes:je,handleCheck:J,handleDrop:Ue,handleDragStart:te,handleDragEnter:$e,handleDragOver:Y,handleDragEnd:le,handleDragLeave:Re,handleLineClick:V,handleContentClick:_e,handleSwitcherClick:X}},render(){const{tmNode:e,clsPrefix:l,checkable:s,expandOnClick:u,selectable:c,selected:r,checked:b,highlight:y,draggable:v,blockLine:m,indent:k,indentNodes:A,disabled:w,pending:L,internalScrollable:T,nodeProps:x,checkboxPlacement:h}=this,f=v&&!w?{onDragenter:this.handleDragEnter,onDragleave:this.handleDragLeave,onDragend:this.handleDragEnd,onDrop:this.handleDrop,onDragover:this.handleDragOver}:void 0,R=T?yn(e.key):void 0,I=h==="right",K=s?g(ut,{indent:k,right:I,focusable:this.checkboxFocusable,disabled:w||this.checkboxDisabled,clsPrefix:l,checked:this.checked,indeterminate:this.indeterminate,onCheck:this.handleCheck}):null;return g("div",Object.assign({class:`${l}-tree-node-wrapper`},f),g("div",Object.assign({},m?x:void 0,{class:[`${l}-tree-node`,{[`${l}-tree-node--selected`]:r,[`${l}-tree-node--checkable`]:s,[`${l}-tree-node--highlight`]:y,[`${l}-tree-node--pending`]:L,[`${l}-tree-node--disabled`]:w,[`${l}-tree-node--selectable`]:c,[`${l}-tree-node--clickable`]:c||u||this.mergedCheckOnClick},x==null?void 0:x.class],"data-key":R,draggable:v&&m,onClick:this.handleLineClick,onDragstart:v&&m&&!w?this.handleDragStart:void 0}),A,e.isLeaf&&this.showLine?g("div",{class:[`${l}-tree-node-indent`,`${l}-tree-node-indent--show-line`,e.isLeaf&&`${l}-tree-node-indent--is-leaf`,e.isLastChild&&`${l}-tree-node-indent--last-child`]},g("div",{style:{width:`${k}px`}})):g(ht,{clsPrefix:l,expanded:this.expanded,selected:r,loading:this.loading,hide:e.isLeaf,tmNode:this.tmNode,indent:k,onClick:this.handleSwitcherClick}),I?null:K,g(ft,{ref:"contentInstRef",clsPrefix:l,checked:b,selected:r,onClick:this.handleContentClick,nodeProps:m?void 0:x,onDragstart:v&&!m&&!w?this.handleDragStart:void 0,tmNode:e}),v?this.showDropMark?fn({el:this.contentElRef.value,position:this.droppingPosition,offsetLevel:this.droppingOffsetLevel,indent:k}):this.showDropMarkAsParent?fn({el:this.contentElRef.value,position:"inside",offsetLevel:this.droppingOffsetLevel,indent:k}):null:null,I?K:null))}}),yt=se({name:"TreeMotionWrapper",props:{clsPrefix:{type:String,required:!0},height:Number,nodes:{type:Array,required:!0},mode:{type:String,required:!0},onAfterEnter:{type:Function,required:!0}},render(){const{clsPrefix:e}=this;return g(Zn,{onAfterEnter:this.onAfterEnter,appear:!0,reverse:this.mode==="collapse"},{default:()=>g("div",{class:[`${e}-tree-motion-wrapper`,`${e}-tree-motion-wrapper--${this.mode}`],style:{height:vn(this.height)}},this.nodes.map(l=>g(xn,{clsPrefix:e,tmNode:l})))})}}),Qe=Jn(),kt=D("tree",`
 font-size: var(--n-font-size);
 outline: none;
`,[Z("ul, li",`
 margin: 0;
 padding: 0;
 list-style: none;
 `),Z(">",[D("tree-node",[Z("&:first-child","margin-top: 0;")])]),D("tree-motion-wrapper",[P("expand",[an({duration:"0.2s"})]),P("collapse",[an({duration:"0.2s",reverse:!0})])]),D("tree-node-wrapper",`
 box-sizing: border-box;
 padding: var(--n-node-wrapper-padding);
 `),D("tree-node",`
 position: relative;
 display: flex;
 border-radius: var(--n-node-border-radius);
 transition: background-color .3s var(--n-bezier);
 `,[P("highlight",[D("tree-node-content",[ce("text","border-bottom-color: var(--n-node-text-color-disabled);")])]),P("disabled",[D("tree-node-content",`
 color: var(--n-node-text-color-disabled);
 cursor: not-allowed;
 `)]),ke("disabled",[P("clickable",[D("tree-node-content",`
 cursor: pointer;
 `)])])]),P("block-node",[D("tree-node-content",`
 flex: 1;
 min-width: 0;
 `)]),ke("block-line",[D("tree-node",[ke("disabled",[D("tree-node-content",[Z("&:hover","background: var(--n-node-color-hover);")]),P("selectable",[D("tree-node-content",[Z("&:active","background: var(--n-node-color-pressed);")])]),P("pending",[D("tree-node-content",`
 background: var(--n-node-color-hover);
 `)]),P("selected",[D("tree-node-content","background: var(--n-node-color-active);")])]),P("selected",[D("tree-node-content","background: var(--n-node-color-active);")])])]),P("block-line",[D("tree-node",[ke("disabled",[Z("&:hover","background: var(--n-node-color-hover);"),P("pending",`
 background: var(--n-node-color-hover);
 `),P("selectable",[ke("selected",[Z("&:active","background: var(--n-node-color-pressed);")])]),P("selected","background: var(--n-node-color-active);")]),P("selected","background: var(--n-node-color-active);"),P("disabled",`
 cursor: not-allowed;
 `)])]),P("ellipsis",[D("tree-node",[D("tree-node-content",`
 overflow: hidden;
 `,[ce("text",`
 text-overflow: ellipsis;
 white-space: nowrap;
 overflow: hidden;
 `)])])]),D("tree-node-indent",`
 flex-grow: 0;
 flex-shrink: 0;
 `,[P("show-line","position: relative",[Z("&::before",`
 position: absolute;
 left: 50%;
 border-left: 1px solid var(--n-line-color);
 transition: border-color .3s var(--n-bezier);
 transform: translate(-50%);
 content: "";
 top: var(--n-line-offset-top);
 bottom: var(--n-line-offset-bottom);
 `),P("last-child",[Z("&::before",`
 bottom: 50%;
 `)]),P("is-leaf",[Z("&::after",`
 position: absolute;
 content: "";
 left: calc(50% + 0.5px);
 right: 0;
 bottom: 50%;
 transition: border-color .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-line-color);
 `)])]),ke("show-line","height: 0;")]),D("tree-node-switcher",`
 cursor: pointer;
 display: inline-flex;
 flex-shrink: 0;
 height: var(--n-node-content-height);
 align-items: center;
 justify-content: center;
 transition: transform .15s var(--n-bezier);
 vertical-align: bottom;
 `,[ce("icon",`
 position: relative;
 height: 14px;
 width: 14px;
 display: flex;
 color: var(--n-arrow-color);
 transition: color .3s var(--n-bezier);
 font-size: 14px;
 `,[D("icon",[Qe]),D("base-loading",`
 color: var(--n-loading-color);
 position: absolute;
 left: 0;
 top: 0;
 right: 0;
 bottom: 0;
 `,[Qe]),D("base-icon",[Qe])]),P("hide","visibility: hidden;"),P("expanded","transform: rotate(90deg);")]),D("tree-node-checkbox",`
 display: inline-flex;
 height: var(--n-node-content-height);
 vertical-align: bottom;
 align-items: center;
 justify-content: center;
 `),D("tree-node-content",`
 user-select: none;
 position: relative;
 display: inline-flex;
 align-items: center;
 min-height: var(--n-node-content-height);
 box-sizing: border-box;
 line-height: var(--n-line-height);
 vertical-align: bottom;
 padding: 0 6px 0 4px;
 cursor: default;
 border-radius: var(--n-node-border-radius);
 color: var(--n-node-text-color);
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `,[Z("&:last-child","margin-bottom: 0;"),ce("prefix",`
 display: inline-flex;
 margin-right: 8px;
 `),ce("text",`
 border-bottom: 1px solid #0000;
 transition: border-color .3s var(--n-bezier);
 flex-grow: 1;
 max-width: 100%;
 `),ce("suffix",`
 display: inline-flex;
 `)]),ce("empty","margin: auto;")]);var mt=function(e,l,s,u){function c(r){return r instanceof s?r:new s(function(b){b(r)})}return new(s||(s=Promise))(function(r,b){function y(k){try{m(u.next(k))}catch(A){b(A)}}function v(k){try{m(u.throw(k))}catch(A){b(A)}}function m(k){k.done?r(k.value):c(k.value).then(y,v)}m((u=u.apply(e,[])).next())})};function hn(e,l,s,u){return{getIsGroup(){return!1},getKey(r){return r[e]},getChildren:u||(r=>r[l]),getDisabled(r){return!!(r[s]||r.checkboxDisabled)}}}const xt={allowCheckingNotLoaded:Boolean,filter:Function,defaultExpandAll:Boolean,expandedKeys:Array,keyField:{type:String,default:"key"},labelField:{type:String,default:"label"},childrenField:{type:String,default:"children"},disabledField:{type:String,default:"disabled"},defaultExpandedKeys:{type:Array,default:()=>[]},indent:{type:Number,default:24},indeterminateKeys:Array,renderSwitcherIcon:Function,onUpdateIndeterminateKeys:[Function,Array],"onUpdate:indeterminateKeys":[Function,Array],onUpdateExpandedKeys:[Function,Array],"onUpdate:expandedKeys":[Function,Array],overrideDefaultNodeClickBehavior:Function},wt=Object.assign(Object.assign(Object.assign(Object.assign({},bn.props),{accordion:Boolean,showIrrelevantNodes:{type:Boolean,default:!0},data:{type:Array,default:()=>[]},expandOnDragenter:{type:Boolean,default:!0},expandOnClick:Boolean,checkOnClick:{type:[Boolean,Function],default:!1},cancelable:{type:Boolean,default:!0},checkable:Boolean,draggable:Boolean,blockNode:Boolean,blockLine:Boolean,showLine:Boolean,disabled:Boolean,checkedKeys:Array,defaultCheckedKeys:{type:Array,default:()=>[]},selectedKeys:Array,defaultSelectedKeys:{type:Array,default:()=>[]},multiple:Boolean,pattern:{type:String,default:""},onLoad:Function,cascade:Boolean,selectable:{type:Boolean,default:!0},scrollbarProps:Object,allowDrop:{type:Function,default:ct},animated:{type:Boolean,default:!0},ellipsis:Boolean,checkboxPlacement:{type:String,default:"left"},virtualScroll:Boolean,watchProps:Array,renderLabel:Function,renderPrefix:Function,renderSuffix:Function,nodeProps:Function,keyboard:{type:Boolean,default:!0},getChildren:Function,onDragenter:[Function,Array],onDragleave:[Function,Array],onDragend:[Function,Array],onDragstart:[Function,Array],onDragover:[Function,Array],onDrop:[Function,Array],onUpdateCheckedKeys:[Function,Array],"onUpdate:checkedKeys":[Function,Array],onUpdateSelectedKeys:[Function,Array],"onUpdate:selectedKeys":[Function,Array]}),xt),{internalTreeSelect:Boolean,internalScrollable:Boolean,internalScrollablePadding:String,internalRenderEmpty:Function,internalHighlightKeySet:Object,internalUnifySelectCheck:Boolean,internalCheckboxFocusable:{type:Boolean,default:!0},internalFocusable:{type:Boolean,default:!0},checkStrategy:{type:String,default:"all"},leafOnly:Boolean}),pt=se({name:"Tree",props:wt,slots:Object,setup(e){const{mergedClsPrefixRef:l,inlineThemeDisabled:s,mergedRtlRef:u}=nt(e),c=tt("Tree",u,l),r=bn("Tree","-tree",kt,lt,e,l),b=B(null),y=B(null),v=B(null);function m(){var n;return(n=v.value)===null||n===void 0?void 0:n.listElRef}function k(){var n;return(n=v.value)===null||n===void 0?void 0:n.itemsElRef}const A=$(()=>{const{filter:n}=e;if(n)return n;const{labelField:t}=e;return(o,a)=>{if(!o.length)return!0;const d=a[t];return typeof d=="string"?d.toLowerCase().includes(o.toLowerCase()):!1}}),w=$(()=>{const{pattern:n}=e;return n?!n.length||!A.value?{filteredTree:e.data,highlightKeySet:null,expandedKeys:void 0}:bt(e.data,A.value,n,e.keyField,e.childrenField):{filteredTree:e.data,highlightKeySet:null,expandedKeys:void 0}}),L=$(()=>sn(e.showIrrelevantNodes?e.data:w.value.filteredTree,hn(e.keyField,e.childrenField,e.disabledField,e.getChildren))),T=me(kn,null),x=e.internalTreeSelect?T.dataTreeMate:$(()=>e.showIrrelevantNodes?L.value:sn(e.data,hn(e.keyField,e.childrenField,e.disabledField,e.getChildren))),{watchProps:h}=e,f=B([]);h!=null&&h.includes("defaultCheckedKeys")?Ke(()=>{f.value=e.defaultCheckedKeys}):f.value=e.defaultCheckedKeys;const R=C(e,"checkedKeys"),I=Oe(R,f),K=$(()=>x.value.getCheckedKeys(I.value,{cascade:e.cascade,allowNotLoaded:e.allowCheckingNotLoaded})),ae=gt(e),X=$(()=>K.value.checkedKeys),ne=$(()=>{const{indeterminateKeys:n}=e;return n!==void 0?n:K.value.indeterminateKeys}),ee=B([]);h!=null&&h.includes("defaultSelectedKeys")?Ke(()=>{ee.value=e.defaultSelectedKeys}):ee.value=e.defaultSelectedKeys;const xe=C(e,"selectedKeys"),re=Oe(xe,ee),we=B([]),Ne=n=>{we.value=e.defaultExpandAll?x.value.getNonLeafKeys():n===void 0?e.defaultExpandedKeys:n};h!=null&&h.includes("defaultExpandedKeys")?Ke(()=>{Ne(void 0)}):Ke(()=>{Ne(e.defaultExpandedKeys)});const _e=C(e,"expandedKeys"),V=Oe(_e,we),J=$(()=>L.value.getFlattenedNodes(V.value)),{pendingNodeKeyRef:te,handleKeydown:$e}=st({props:e,mergedCheckedKeysRef:I,mergedSelectedKeysRef:re,fNodesRef:J,mergedExpandedKeysRef:V,handleCheck:Ve,handleSelect:We,handleSwitcherClick:en});let Y=null,le=null;const Re=B(new Set),Ue=$(()=>e.internalHighlightKeySet||w.value.highlightKeySet),je=Oe(Ue,Re),i=B(new Set),N=$(()=>V.value.filter(n=>!i.value.has(n)));let E=0;const O=B(null),U=B(null),Le=B(null),Te=B(null),Ee=B(0),wn=$(()=>{const{value:n}=U;return n?n.parent:null});let Me=!1;Be(C(e,"data"),()=>{Me=!0,Ie(()=>{Me=!1}),i.value.clear(),te.value=null,Se()},{deep:!1});let ze=!1;const He=()=>{ze=!0,Ie(()=>{ze=!1})};let pe;Be(C(e,"pattern"),(n,t)=>{if(e.showIrrelevantNodes)if(pe=void 0,n){const{expandedKeys:o,highlightKeySet:a}=vt(e.data,e.pattern,e.keyField,e.childrenField,A.value);Re.value=a,He(),fe(o,H(o),{node:null,action:"filter"})}else Re.value=new Set;else if(!n.length)pe!==void 0&&(He(),fe(pe,H(pe),{node:null,action:"filter"}));else{t.length||(pe=V.value);const{expandedKeys:o}=w.value;o!==void 0&&(He(),fe(o,H(o),{node:null,action:"filter"}))}});function Ze(n){return mt(this,void 0,void 0,function*(){const{onLoad:t}=e;if(!t){yield Promise.resolve();return}const{value:o}=i;if(!o.has(n.key)){o.add(n.key);try{(yield t(n.rawNode))===!1&&he()}catch(a){console.error(a),he()}o.delete(n.key)}})}Ke(()=>{var n;const{value:t}=L;if(!t)return;const{getNode:o}=t;(n=V.value)===null||n===void 0||n.forEach(a=>{const d=o(a);d&&!d.shallowLoaded&&Ze(d)})});const ue=B(!1),oe=B([]);Be(N,(n,t)=>{if(!e.animated||ze){Ie(Ae);return}if(Me)return;const o=Ce(r.value.self.nodeHeight),a=new Set(t);let d=null,F=null;for(const S of n)if(!a.has(S)){if(d!==null)return;d=S}const M=new Set(n);for(const S of t)if(!M.has(S)){if(F!==null)return;F=S}if(d===null&&F===null)return;const{virtualScroll:q}=e,ve=(q?v.value.listElRef:b.value).offsetHeight,be=Math.ceil(ve/o)+1;let W;if(d!==null&&(W=t),F!==null&&(W===void 0?W=n:W=W.filter(S=>S!==F)),ue.value=!0,oe.value=L.value.getFlattenedNodes(W),d!==null){const S=oe.value.findIndex(G=>G.key===d);if(~S){const G=oe.value[S].children;if(G){const Q=un(G,n);oe.value.splice(S+1,0,{__motion:!0,mode:"expand",height:q?Q.length*o:void 0,nodes:q?Q.slice(0,be):Q})}}}if(F!==null){const S=oe.value.findIndex(G=>G.key===F);if(~S){const G=oe.value[S].children;if(!G)return;ue.value=!0;const Q=un(G,n);oe.value.splice(S+1,0,{__motion:!0,mode:"collapse",height:q?Q.length*o:void 0,nodes:q?Q.slice(0,be):Q})}}});const Nn=$(()=>ot(J.value)),Rn=$(()=>ue.value?oe.value:J.value);function Ae(){const{value:n}=y;n&&n.sync()}function pn(){ue.value=!1,e.virtualScroll&&Ie(Ae)}function H(n){const{getNode:t}=x.value;return n.map(o=>{var a;return((a=t(o))===null||a===void 0?void 0:a.rawNode)||null})}function fe(n,t,o){const{"onUpdate:expandedKeys":a,onUpdateExpandedKeys:d}=e;we.value=n,a&&z(a,n,t,o),d&&z(d,n,t,o)}function Je(n,t,o){const{"onUpdate:checkedKeys":a,onUpdateCheckedKeys:d}=e;f.value=n,d&&z(d,n,t,o),a&&z(a,n,t,o)}function Sn(n,t){const{"onUpdate:indeterminateKeys":o,onUpdateIndeterminateKeys:a}=e;o&&z(o,n,t),a&&z(a,n,t)}function qe(n,t,o){const{"onUpdate:selectedKeys":a,onUpdateSelectedKeys:d}=e;ee.value=n,d&&z(d,n,t,o),a&&z(a,n,t,o)}function Cn(n){const{onDragenter:t}=e;t&&z(t,n)}function Kn(n){const{onDragleave:t}=e;t&&z(t,n)}function Dn(n){const{onDragend:t}=e;t&&z(t,n)}function Ln(n){const{onDragstart:t}=e;t&&z(t,n)}function Tn(n){const{onDragover:t}=e;t&&z(t,n)}function En(n){const{onDrop:t}=e;t&&z(t,n)}function Se(){An(),de()}function An(){O.value=null}function de(){Ee.value=0,U.value=null,Le.value=null,Te.value=null,he()}function he(){Y&&(window.clearTimeout(Y),Y=null),le=null}function Ve(n,t){if(e.disabled||ie(n,e.disabledField))return;if(e.internalUnifySelectCheck&&!e.multiple){We(n);return}const o=t?"check":"uncheck",{checkedKeys:a,indeterminateKeys:d}=x.value[o](n.key,X.value,{cascade:e.cascade,checkStrategy:ae.value,allowNotLoaded:e.allowCheckingNotLoaded});Je(a,H(a),{node:n.rawNode,action:o}),Sn(d,H(d))}function Fn(n){if(e.disabled)return;const{key:t}=n,{value:o}=V,a=o.findIndex(d=>d===t);if(~a){const d=Array.from(o);d.splice(a,1),fe(d,H(d),{node:n.rawNode,action:"collapse"})}else{const d=L.value.getNode(t);if(!d||d.isLeaf)return;let F;if(e.accordion){const M=new Set(n.siblings.map(({key:q})=>q));F=o.filter(q=>!M.has(q)),F.push(t)}else F=o.concat(t);fe(F,H(F),{node:n.rawNode,action:"expand"})}}function en(n){e.disabled||ue.value||Fn(n)}function We(n){if(!(e.disabled||!e.selectable)){if(te.value=n.key,e.internalUnifySelectCheck){const{value:{checkedKeys:t,indeterminateKeys:o}}=K;e.multiple?Ve(n,!(t.includes(n.key)||o.includes(n.key))):Je([n.key],H([n.key]),{node:n.rawNode,action:"check"})}if(e.multiple){const t=Array.from(re.value),o=t.findIndex(a=>a===n.key);~o?e.cancelable&&t.splice(o,1):~o||t.push(n.key),qe(t,H(t),{node:n.rawNode,action:~o?"unselect":"select"})}else re.value.includes(n.key)?e.cancelable&&qe([],[],{node:n.rawNode,action:"unselect"}):qe([n.key],H([n.key]),{node:n.rawNode,action:"select"})}}function Pn(n){if(Y&&(window.clearTimeout(Y),Y=null),n.isLeaf)return;le=n.key;const t=()=>{if(le!==n.key)return;const{value:o}=Le;if(o&&o.key===n.key&&!V.value.includes(n.key)){const a=V.value.concat(n.key);fe(a,H(a),{node:n.rawNode,action:"expand"})}Y=null,le=null};n.shallowLoaded?Y=window.setTimeout(()=>{t()},1e3):Y=window.setTimeout(()=>{Ze(n).then(()=>{t()})},1e3)}function On({event:n,node:t}){!e.draggable||e.disabled||ie(t,e.disabledField)||(nn({event:n,node:t},!1),Cn({event:n,node:t.rawNode}))}function Bn({event:n,node:t}){!e.draggable||e.disabled||ie(t,e.disabledField)||Kn({event:n,node:t.rawNode})}function In(n){n.target===n.currentTarget&&de()}function _n({event:n,node:t}){Se(),!(!e.draggable||e.disabled||ie(t,e.disabledField))&&Dn({event:n,node:t.rawNode})}function $n({event:n,node:t}){!e.draggable||e.disabled||ie(t,e.disabledField)||(E=n.clientX,O.value=t,Ln({event:n,node:t.rawNode}))}function nn({event:n,node:t},o=!0){var a;if(!e.draggable||e.disabled||ie(t,e.disabledField))return;const{value:d}=O;if(!d)return;const{allowDrop:F,indent:M}=e;o&&Tn({event:n,node:t.rawNode});const q=n.currentTarget,{height:ve,top:be}=q.getBoundingClientRect(),W=n.clientY-be;let S;F({node:t.rawNode,dropPosition:"inside",phase:"drag"})?W<=8?S="before":W>=ve-8?S="after":S="inside":W<=ve/2?S="before":S="after";const{value:Q}=Nn;let p,_;const ye=Q(t.key);if(ye===null){de();return}let Fe=!1;S==="inside"?(p=t,_="inside"):S==="before"?t.isFirstChild?(p=t,_="before"):(p=J.value[ye-1],_="after"):(p=t,_="after"),!p.isLeaf&&V.value.includes(p.key)&&(Fe=!0,_==="after"&&(p=J.value[ye+1],p?_="before":(p=t,_="inside")));const ln=p;if(Le.value=ln,!Fe&&d.isLastChild&&d.key===p.key&&(_="after"),_==="after"){let on=E-n.clientX,Ge=0;for(;on>=M/2&&p.parent!==null&&p.isLastChild&&Ge<1;)on-=M,Ge+=1,p=p.parent;Ee.value=Ge}else Ee.value=0;if((d.contains(p)||_==="inside"&&((a=d.parent)===null||a===void 0?void 0:a.key)===p.key)&&!(d.key===ln.key&&d.key===p.key)){de();return}if(!F({node:p.rawNode,dropPosition:_,phase:"drag"})){de();return}if(d.key===p.key)he();else if(le!==p.key)if(_==="inside"){if(e.expandOnDragenter){if(Pn(p),!p.shallowLoaded&&le!==p.key){Se();return}}else if(!p.shallowLoaded){Se();return}}else he();else _!=="inside"&&he();Te.value=_,U.value=p}function Un({event:n,node:t,dropPosition:o}){if(!e.draggable||e.disabled||ie(t,e.disabledField))return;const{value:a}=O,{value:d}=U,{value:F}=Te;if(!(!a||!d||!F)&&e.allowDrop({node:d.rawNode,dropPosition:F,phase:"drag"})&&a.key!==d.key){if(F==="before"){const M=a.getNext({includeDisabled:!0});if(M&&M.key===d.key){de();return}}if(F==="after"){const M=a.getPrev({includeDisabled:!0});if(M&&M.key===d.key){de();return}}En({event:n,node:d.rawNode,dragNode:a.rawNode,dropPosition:o}),Se()}}function jn(){Ae()}function Mn(){Ae()}function zn(n){var t;if(e.virtualScroll||e.internalScrollable){const{value:o}=y;if(!((t=o==null?void 0:o.containerRef)===null||t===void 0)&&t.contains(n.relatedTarget))return;te.value=null}else{const{value:o}=b;if(o!=null&&o.contains(n.relatedTarget))return;te.value=null}}Be(te,n=>{var t,o;if(n!==null){if(e.virtualScroll)(t=v.value)===null||t===void 0||t.scrollTo({key:n});else if(e.internalScrollable){const{value:a}=y;if(a===null)return;const d=(o=a.contentRef)===null||o===void 0?void 0:o.querySelector(`[data-key="${yn(n)}"]`);if(!d)return;a.scrollTo({el:d})}}}),it(De,{loadingKeysRef:i,highlightKeySetRef:je,displayedCheckedKeysRef:X,displayedIndeterminateKeysRef:ne,mergedSelectedKeysRef:re,mergedExpandedKeysRef:V,mergedThemeRef:r,mergedCheckStrategyRef:ae,nodePropsRef:C(e,"nodeProps"),disabledRef:C(e,"disabled"),checkableRef:C(e,"checkable"),selectableRef:C(e,"selectable"),expandOnClickRef:C(e,"expandOnClick"),onLoadRef:C(e,"onLoad"),draggableRef:C(e,"draggable"),blockLineRef:C(e,"blockLine"),indentRef:C(e,"indent"),cascadeRef:C(e,"cascade"),checkOnClickRef:C(e,"checkOnClick"),checkboxPlacementRef:e.checkboxPlacement,droppingMouseNodeRef:Le,droppingNodeParentRef:wn,draggingNodeRef:O,droppingPositionRef:Te,droppingOffsetLevelRef:Ee,fNodesRef:J,pendingNodeKeyRef:te,showLineRef:C(e,"showLine"),disabledFieldRef:C(e,"disabledField"),internalScrollableRef:C(e,"internalScrollable"),internalCheckboxFocusableRef:C(e,"internalCheckboxFocusable"),internalTreeSelect:e.internalTreeSelect,renderLabelRef:C(e,"renderLabel"),renderPrefixRef:C(e,"renderPrefix"),renderSuffixRef:C(e,"renderSuffix"),renderSwitcherIconRef:C(e,"renderSwitcherIcon"),labelFieldRef:C(e,"labelField"),multipleRef:C(e,"multiple"),overrideDefaultNodeClickBehaviorRef:C(e,"overrideDefaultNodeClickBehavior"),handleSwitcherClick:en,handleDragEnd:_n,handleDragEnter:On,handleDragLeave:Bn,handleDragStart:$n,handleDrop:Un,handleDragOver:nn,handleSelect:We,handleCheck:Ve});function Hn(n,t){var o,a;typeof n=="number"?(o=v.value)===null||o===void 0||o.scrollTo(n,t||0):(a=v.value)===null||a===void 0||a.scrollTo(n)}const qn={handleKeydown:$e,scrollTo:Hn,getCheckedData:()=>{if(!e.checkable)return{keys:[],options:[]};const{checkedKeys:n}=K.value;return{keys:n,options:H(n)}},getIndeterminateData:()=>{if(!e.checkable)return{keys:[],options:[]};const{indeterminateKeys:n}=K.value;return{keys:n,options:H(n)}}},tn=$(()=>{const{common:{cubicBezierEaseInOut:n},self:{fontSize:t,nodeBorderRadius:o,nodeColorHover:a,nodeColorPressed:d,nodeColorActive:F,arrowColor:M,loadingColor:q,nodeTextColor:ve,nodeTextColorDisabled:be,dropMarkColor:W,nodeWrapperPadding:S,nodeHeight:G,lineHeight:Q,lineColor:p}}=r.value,_=Ye(S,"top"),ye=Ye(S,"bottom"),Fe=vn(Ce(G)-Ce(_)-Ce(ye));return{"--n-arrow-color":M,"--n-loading-color":q,"--n-bezier":n,"--n-font-size":t,"--n-node-border-radius":o,"--n-node-color-active":F,"--n-node-color-hover":a,"--n-node-color-pressed":d,"--n-node-text-color":ve,"--n-node-text-color-disabled":be,"--n-drop-mark-color":W,"--n-node-wrapper-padding":S,"--n-line-offset-top":`-${_}`,"--n-line-offset-bottom":`-${ye}`,"--n-node-content-height":Fe,"--n-line-height":Q,"--n-line-color":p}}),ge=s?at("tree",void 0,tn,e):void 0;return Object.assign(Object.assign({},qn),{mergedClsPrefix:l,mergedTheme:r,rtlEnabled:c,fNodes:Rn,aip:ue,selfElRef:b,virtualListInstRef:v,scrollbarInstRef:y,handleFocusout:zn,handleDragLeaveTree:In,handleScroll:jn,getScrollContainer:m,getScrollContent:k,handleAfterEnter:pn,handleResize:Mn,cssVars:s?void 0:tn,themeClass:ge==null?void 0:ge.themeClass,onRender:ge==null?void 0:ge.onRender})},render(){var e;const{fNodes:l,internalRenderEmpty:s}=this;if(!l.length&&s)return s();const{mergedClsPrefix:u,blockNode:c,blockLine:r,draggable:b,disabled:y,ellipsis:v,internalFocusable:m,checkable:k,handleKeydown:A,rtlEnabled:w,handleFocusout:L,scrollbarProps:T}=this,x=m&&!y,h=x?"0":void 0,f=[`${u}-tree`,w&&`${u}-tree--rtl`,k&&`${u}-tree--checkable`,(r||c)&&`${u}-tree--block-node`,r&&`${u}-tree--block-line`,v&&`${u}-tree--ellipsis`],R=K=>"__motion"in K?g(yt,{height:K.height,nodes:K.nodes,clsPrefix:u,mode:K.mode,onAfterEnter:this.handleAfterEnter}):g(xn,{key:K.key,tmNode:K,clsPrefix:u});if(this.virtualScroll){const{mergedTheme:K,internalScrollablePadding:ae}=this,X=Ye(ae||"0");return g(rn,Object.assign({},T,{ref:"scrollbarInstRef",onDragleave:b?this.handleDragLeaveTree:void 0,container:this.getScrollContainer,content:this.getScrollContent,class:f,theme:K.peers.Scrollbar,themeOverrides:K.peerOverrides.Scrollbar,tabindex:h,onKeydown:x?A:void 0,onFocusout:x?L:void 0}),{default:()=>{var ne;return(ne=this.onRender)===null||ne===void 0||ne.call(this),l.length?g(et,{ref:"virtualListInstRef",items:this.fNodes,itemSize:Ce(K.self.nodeHeight),ignoreItemResize:this.aip,paddingTop:X.top,paddingBottom:X.bottom,class:this.themeClass,style:[this.cssVars,{paddingLeft:X.left,paddingRight:X.right}],onScroll:this.handleScroll,onResize:this.handleResize,showScrollbar:!1,itemResizable:!0},{default:({item:ee})=>R(ee)}):dn(this.$slots.empty,()=>[g(cn,{class:`${u}-tree__empty`,theme:this.mergedTheme.peers.Empty,themeOverrides:this.mergedTheme.peerOverrides.Empty})])}})}const{internalScrollable:I}=this;return f.push(this.themeClass),(e=this.onRender)===null||e===void 0||e.call(this),I?g(rn,Object.assign({},T,{class:f,tabindex:h,onKeydown:x?A:void 0,onFocusout:x?L:void 0,style:this.cssVars,contentStyle:{padding:this.internalScrollablePadding}}),{default:()=>g("div",{onDragleave:b?this.handleDragLeaveTree:void 0,ref:"selfElRef"},this.fNodes.map(R))}):g("div",{class:f,tabindex:h,ref:"selfElRef",style:this.cssVars,onKeydown:x?A:void 0,onFocusout:x?L:void 0,onDragleave:b?this.handleDragLeaveTree:void 0},l.length?l.map(R):dn(this.$slots.empty,()=>[g(cn,{class:`${u}-tree__empty`,theme:this.mergedTheme.peers.Empty,themeOverrides:this.mergedTheme.peerOverrides.Empty})]))}});export{pt as _};
