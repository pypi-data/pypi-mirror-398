import{d as ee,b as oe,c as ae,C as te,r as p,ap as ne,aQ as se,o as ie,I as $,at as R,ao as re,L as le,e as V,f as L,h as y,i as n,s as h,l as o,O as ue,N as de,t as m,w as r,aa as _e,ah as ce,a8 as pe,aA as me,c_ as E,V as C,as as ge,B as ve,c$ as fe,v as ye,aw as he,k as be,m as Ge,bZ as xe,n as ke,W as ze,d0 as we,d1 as Ne,aq as $e,d2 as Le,D as Ce,E as Ie,a2 as qe}from"./index-BwlMlHGj.js";import{_ as Ue}from"./PaginationView.vue_vue_type_script_setup_true_lang-IR55gl3R.js";import{A as Be}from"./Add-CvJqOuqG.js";import{N as Me}from"./Switch-B5yYo9Bh.js";import{_ as Pe}from"./DataTable-CfoqEf8t.js";import{_ as Re}from"./InputGroupLabel-Du6jGNXn.js";import"./Pagination-Do-f8cxW.js";import"./Checkbox-UFZekRDE.js";import"./RadioGroup-BB1a5vev.js";import"./download-C2161hUv.js";const Ve={class:"flex"},Ee={class:"text-xl mt-[26px] flex items-center gap-1"},Oe={class:"flex justify-between items-center w-full"},Se={class:"flex-1"},Te={class:"text-xl"},Ae={class:"flex justify-end"},je=ee({__name:"DeviceGroup",setup(De){const{t:s}=oe(),O=ae(),k=te(),g=p(!1),I=p(),_=p({description:void 0,device_group_name:void 0}),S={description:{required:!0,message:s("deviceGroup.descriptionErrMsg")},device_group_name:{required:!0,message:s("deviceGroup.groupNameErrMsg")}},q=()=>{g.value=!1,_.value={description:void 0,device_group_name:void 0}},T=()=>{var a;d.value||(d.value=!0,(a=I.value)==null||a.validate(async e=>{if(e){d.value=!1;return}const[i,u]=await we({..._.value,device_group_name:`${U.value}_${_.value.device_group_name}`,organization_id:l.value});d.value=!1,!i&&u&&u.status===0&&v()}))},A=a=>{a||q()},z=p(),b=ne({page:1,per_page:se,total:0}),d=p(!1),l=p(),v=async a=>{d.value=!0,z.value=void 0;const[e,i]=await Ne({...$e(b),org_id:a||l.value});d.value=!1,!e&&i&&i.status===0&&(z.value=i.data.list,b.total=i.data.total),g.value&&q()},j=async(a,e)=>{const[i,u]=await Le({device_id:e,hidden:!a});!i&&(u==null?void 0:u.status)===0&&v()},f=p(),D=async()=>{var i,u;const[a,e]=await Ce();if(!a&&(e==null?void 0:e.status)===0){f.value=(i=e.data)==null?void 0:i.organizations;const G=(u=e.data)==null?void 0:u.organizations;if(k.query.org&&e.data.organizations.some(c=>c.organization_id===+(k.query.org||"")))l.value=+k.query.org,Ie(()=>{v()});else if(G&&G.length>0){const c=G[0].organization_id;c&&(l.value=c,v(c))}}};ie(()=>{D()});const F=[{title:s("deviceGroup.groupId"),key:"device_group_id"},{title:s("deviceGroup.groupName"),key:"device_group_name"},{title:s("deviceGroup.description"),key:"description"},{title:s("deviceGroup.createTime"),key:"create_time"},{title:s("createuser"),key:"user_name"},{title:s("deviceGroup.status"),key:"status",render:a=>{var e;if(a.status)return $(re,{type:((e=R[a.status])==null?void 0:e.type)||"default",bordered:!1},{default:()=>{var i;return s((i=R[a.status])==null?void 0:i.text)}})}},{title:s("deviceGroup.show2desktop"),key:"status",render:a=>{if(a.status)return $("div",{onClick:e=>e.stopPropagation()},$(Me,{value:!a.hidden,onUpdateValue:e=>j(e,a.device_group_id)}))}}],H=({device_group_name:a})=>({class:"cursor-pointer",onClick:()=>{O.push({name:"overview",query:{device_group_name:a}})}}),U=le(()=>{var a,e;return(e=(a=f.value)==null?void 0:a.find(i=>i.organization_id==l.value))==null?void 0:e.organization_name});return(a,e)=>{var M,P;const i=de,u=me,G=ge,c=ve,K=Pe,Q=he,w=Ge,W=Re,B=ke,Z=xe,J=be,X=ye,Y=ze;return L(),V("div",Ve,[y("div",null,[y("div",Ee,[n(i,{component:o(ue)},null,8,["component"]),h(" "+m(o(s)("org.orgList")),1)]),n(G,{placement:"left","bar-width":300,type:"card",value:o(l),"onUpdate:value":[e[0]||(e[0]=t=>C(l)?l.value=t:null),v],class:"pr-5 mt-7"},{default:r(()=>[(L(!0),V(_e,null,ce(o(f),t=>(L(),pe(u,{key:t.organization_id,name:t.organization_id,disabled:o(d),class:"min-w-[200px]"},{default:r(()=>[y("div",Oe,[h(m(t.organization_name)+" ",1),n(E,{role:t.user_role},null,8,["role"])])]),_:2},1032,["name","disabled"]))),128))]),_:1},8,["value"])]),y("div",Se,[n(fe,{title:(P=(M=o(f))==null?void 0:M.find(t=>t.organization_id==o(l)))==null?void 0:P.organization_name},{tag:r(()=>{var t,x;return[n(E,{role:(x=(t=o(f))==null?void 0:t.find(N=>N.organization_id==o(l)))==null?void 0:x.user_role},null,8,["role"])]}),extra:r(()=>[n(c,{type:"primary",onClick:e[1]||(e[1]=t=>g.value=!0)},{icon:r(()=>[n(o(Be))]),default:r(()=>[h(" "+m(o(s)("deviceGroup.create")),1)]),_:1})]),_:1},8,["title"]),n(K,{columns:F,data:o(z),pagination:!1,loading:o(d),"row-props":H},null,8,["data","loading"]),n(Ue,{"page-info":o(b),"onUpdate:pageInfo":e[2]||(e[2]=t=>C(b)?b.value=t:null),onUpdateList:v},null,8,["page-info"]),n(Y,{show:o(g),"onUpdate:show":e[5]||(e[5]=t=>C(g)?g.value=t:null),"on-update:show":A},{default:r(()=>[n(X,{style:{width:"600px"},size:"huge",bordered:!1,role:"dialog","aria-modal":"true"},{default:r(()=>[n(Q,{type:"info",class:"mb-5",bordered:!1},{default:r(()=>[h(m(o(s)("deviceGroup.tips")),1)]),_:1}),n(J,{ref_key:"formRef",ref:I,model:o(_),rules:S},{default:r(()=>[n(w,{label:o(s)("deviceGroup.orgName"),path:"orgName"},{default:r(()=>{var t,x;return[y("div",Te,m((x=(t=o(f))==null?void 0:t.find(N=>N.organization_id==o(l)))==null?void 0:x.organization_name),1)]}),_:1},8,["label"]),n(w,{label:o(s)("deviceGroup.groupNameLabel"),path:"device_group_name"},{default:r(()=>[n(Z,null,{default:r(()=>[n(W,null,{default:r(()=>[h(m(o(U))+"_ ",1)]),_:1}),n(B,{value:o(_).device_group_name,"onUpdate:value":e[3]||(e[3]=t=>o(_).device_group_name=t),placeholder:o(s)("deviceGroup.groupNamePlaceholder")},null,8,["value","placeholder"])]),_:1})]),_:1},8,["label"]),n(w,{label:o(s)("deviceGroup.descriptionLabel"),path:"description"},{default:r(()=>[n(B,{value:o(_).description,"onUpdate:value":e[4]||(e[4]=t=>o(_).description=t),placeholder:o(s)("deviceGroup.descriptionPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),y("div",Ae,[n(c,{type:"primary",loading:o(d),onClick:T},{default:r(()=>[h(m(o(s)("deviceGroup.create")),1)]),_:1},8,["loading"])])]),_:1},8,["model"])]),_:1})]),_:1},8,["show"])])])}}}),oo=qe(je,[["__scopeId","data-v-5dc093ef"]]);export{oo as default};
