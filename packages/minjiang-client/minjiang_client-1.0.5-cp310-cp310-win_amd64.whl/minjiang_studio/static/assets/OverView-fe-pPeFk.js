import{d as j,e as S,f as c,h as a,b as R,t as l,l as e,aF as ie,r as D,C as U,c as Z,o as A,a8 as k,s as r,i as o,N as B,aG as W,F as I,aH as O,w as n,aI as Y,aJ as H,v as ce,aK as N,aa as G,ah as K,am as re,al as ee,aL as _e,aM as pe,a2 as Q,A as J,a7 as E,a9 as te,ao as V,aN as ue,K as de,aO as se,ay as fe,az as me,I as T,aP as X,B as oe,ap as ge,E as xe,ad as ve}from"./index-BwlMlHGj.js";import{A as ye,F as he,C as be}from"./FlashAuto24Filled-DKJdUFaY.js";import{g as ke,S as we}from"./StarOutline-DlU6FzvB.js";import{s as Ce}from"./exp-BFwh7v1l.js";import{R as $e,g as De,a as Se,t as Le}from"./RecordStop24Regular-A3Huc0_U.js";import{u as Me}from"./useInterval-C0oJbCEJ.js";import{_ as ze}from"./DataTable-CfoqEf8t.js";import{_ as qe}from"./ConfirmModal.vue_vue_type_script_setup_true_lang-DPOFDHZH.js";import{S as Te,_ as Fe,u as Ne}from"./index-BC7X5_Ah.js";import"./Checkbox-UFZekRDE.js";import"./RadioGroup-BB1a5vev.js";import"./Pagination-Do-f8cxW.js";import"./download-C2161hUv.js";const je={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 25 24"},Pe=j({name:"PeopleQueue24Filled",render:function(v,u){return c(),S("svg",je,u[0]||(u[0]=[a("g",{fill:"none"},[a("path",{d:"M10.916 6a3 3 0 1 1-6 0a3 3 0 0 1 6 0zm-5.75 4a1.75 1.75 0 0 0-1.75 1.75v4.75a4.5 4.5 0 1 0 9 0v-4.75a1.75 1.75 0 0 0-1.75-1.75h-5.5zm6.11 10.854a5.49 5.49 0 0 0 2.14-4.354v-4.75c0-.665-.236-1.274-.629-1.75h2.379c.966 0 1.75.784 1.75 1.75v4.75a4.5 4.5 0 0 1-5.64 4.354zM11.916 6c0 1-.367 1.913-.973 2.614a3 3 0 1 0 0-5.229c.606.702.973 1.616.973 2.615zm3.86 14.854a5.49 5.49 0 0 0 2.14-4.354v-4.75c0-.665-.236-1.274-.629-1.75h2.379c.966 0 1.75.784 1.75 1.75v4.75a4.5 4.5 0 0 1-5.64 4.354zM16.416 6c0 1-.367 1.913-.973 2.614a3 3 0 1 0 0-5.229c.606.702.973 1.616.973 2.615z",fill:"currentColor"})],-1)]))}}),ae=j({__name:"CheckMore",emits:["more"],setup(P,{emit:v}){const u=v,{t:f}=R(),i=()=>{u("more")};return(x,M)=>(c(),S("div",{onClick:i,class:"underline more-primary-link flex items-center justify-center h-full text-xs"},l(e(f)("common.seeMore")),1))}}),Ee={class:"card-root h-full pr-5"},Ve={class:"flex justify-between mb-4 color-bar"},Ie={class:"flex items-center gap-2 font-bold"},Re={class:"flex justify-center items-center"},Ue={class:"font-bold mb-0.5 flex items-center gap-1"},Ae={class:"font-bold mb-0.5 flex items-center gap-1"},Be={class:"font-bold mb-0.5 flex items-center gap-1"},Oe=j({__name:"UtilityList",setup(P){const v=ie(),u=D(),{t:f}=R(),i=U(),x=Z(),M=async()=>{const[y,p]=await _e({group_name:i.query.device_group_name});return!y&&(p==null?void 0:p.status)===0?(u.value=p.data.utilities,!0):!1};A(()=>{M()});const d=D(),w=async y=>{var s;if(d.value)return;d.value=y.utility_name;const p=y.utility_name;await M();const _=(s=u.value)==null?void 0:s.find(t=>t.utility_name===p);if(!_)return;if(_!=null&&_.is_running){d.value=void 0,v.refreshPluginUtilities=!0,window.open(_.full_url,"_blank");return}const[z,b]=await pe({group_name:i.query.device_group_name,utility_name:_.utility_name,config:{}});d.value=void 0,!z&&(b==null?void 0:b.status)===0&&(window.open(`${b.data.url}${_==null?void 0:_.default_route}`,"_blank"),v.refreshPluginUtilities=!0)},m=()=>{x.push({name:"utilities",query:i.query})},L=()=>{x.push({name:"parameterManager",query:{device_group_name:i.query.device_group_name}})},C=()=>{x.push({name:"autoCaliList",query:{device_group_name:i.query.device_group_name}})};return(y,p)=>{const _=B,z=O,b=N,s=ce,t=H,h=re,g=Y,q=ee;return c(),S("div",Ee,[a("div",Ve,[a("div",Ie,[a("div",Re,[o(_,{component:e(W)},null,8,["component"])]),r(" "+l(e(f)("groupDetail.utilities.tabName")),1)]),a("div",null,[o(ae,{onMore:m})])]),e(I)(e(u))?(c(),k(z,{key:0,class:"!mt-20"})):(c(),k(q,{key:1,style:{height:"calc(50vh - 160px)"}},{default:n(()=>[o(g,{cols:2,"x-gap":12,"y-gap":12},{default:n(()=>[o(t,null,{default:n(()=>[o(s,{class:"utility-item gradient-border-boxshadow","content-class":"!p-0 flex gap-2 flex-col",bordered:!1,onClick:L},{default:n(()=>[a("div",Ue,[o(_,{component:e(ye),size:"20"},null,8,["component"]),r(" "+l(e(f)("groupDetail.parameterManager.tabName")),1)]),o(b,{"line-clamp":1,class:"opacity-70 text-xs font-light"},{default:n(()=>[r(l(e(f)("groupDetail.overview.paramsDesc")),1)]),_:1})]),_:1})]),_:1}),o(t,null,{default:n(()=>[o(s,{class:"utility-item gradient-border-boxshadow","content-class":"!p-0 flex gap-2 flex-col",bordered:!1,onClick:C},{default:n(()=>[a("div",Ae,[o(_,{component:e(he),size:"20"},null,8,["component"]),r(" "+l(e(f)("groupDetail.autoCali.tabName")),1)]),o(b,{"line-clamp":1,class:"opacity-70 text-xs font-light"},{default:n(()=>[r(l(e(f)("groupDetail.overview.autoCaliDesc")),1)]),_:1})]),_:1})]),_:1}),(c(!0),S(G,null,K(e(u),F=>(c(),k(t,{key:F.utility_name},{default:n(()=>[o(h,{show:!!(e(d)&&e(d)===F.utility_name)},{default:n(()=>[o(s,{class:"utility-item gradient-border-boxshadow","content-class":"!p-0 flex gap-2 flex-col",bordered:!1,onClick:()=>w(F)},{default:n(()=>[a("div",Be,[o(_,{component:e(W),size:"20"},null,8,["component"]),r(" "+l(F.title),1)]),o(b,{"line-clamp":1,class:"opacity-70 text-xs font-light"},{default:n(()=>[r(l(F.description),1)]),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1032,["show"])]),_:2},1024))),128))]),_:1})]),_:1}))])}}}),Qe=Q(Oe,[["__scopeId","data-v-d94d8d21"]]),Ye={class:"card-root h-full pl-5"},He={class:"flex justify-between mb-4 color-bar"},Ge={class:"flex items-center gap-2 font-bold"},Ke={class:"flex justify-center items-center"},Je=["onClick"],We={class:"flex justify-between items-center"},Xe={class:"flex gap-1 items-center"},Ze={class:"opacity-70"},et={class:"flex-1 flex items-center gap-2 mt-1"},tt=j({__name:"TaskView",setup(P){const v=J(),u=D(),{t:f}=R(),i=U(),x=Z(),M=async()=>{const m=i.query.device_group_name;if(!m)return;const[L,C]=await ke({page:1,per_page:10,device_group_name:m});!L&&C&&C.status===0&&(u.value=C.data.list)};A(()=>{M()});const d=()=>{x.push({name:"taskList",query:i.query})},w=m=>{x.push({name:"experimentList",query:{...i.query,task_id:m.task_id,task_title:m.title,space_id:m.space_id}})};return(m,L)=>{const C=B,y=O,p=V,_=N,z=H,b=Y,s=ee;return c(),S("div",Ye,[a("div",He,[a("div",Ge,[a("div",Ke,[o(C,{component:e(be)},null,8,["component"])]),r(" "+l(e(f)("groupDetail.taskList.tabTitle")),1)]),a("div",null,[o(ae,{onMore:d})])]),e(I)(e(u))?(c(),k(y,{key:0,class:"!mt-20"})):(c(),k(s,{key:1,style:{height:"calc(50vh - 160px)"}},{default:n(()=>[o(b,{cols:1,"x-gap":12,"y-gap":12},{default:n(()=>[(c(!0),S(G,null,K(e(u),t=>(c(),k(z,{key:t.task_id},{default:n(()=>[a("div",{class:"utility-item border rounded-lg",style:E({borderColor:e(v).dividerColor}),onClick:()=>w(t)},[a("div",We,[a("div",Xe,[o(p,{type:"success",size:"small",color:{color:"#b63636",textColor:"#fff"}},{default:n(()=>[r(l(e(f)("expInfo.task"))+" "+l(t==null?void 0:t.task_id),1)]),_:2},1024),o(_,{class:"font-bold"},{default:n(()=>[r(l(t.title),1)]),_:2},1024),t.description?(c(),k(_,{key:0,"line-clamp":1,class:"opacity-70"},{default:n(()=>[r("  ( "+l(t.description)+" ) ",1)]),_:2},1024)):te("",!0)]),a("div",Ze,[o(p,{size:"tiny",bordered:!1},{default:n(()=>[r(l(t.create_time),1)]),_:2},1024)])]),a("div",et,[o(p,{size:"tiny",bordered:!1},{default:n(()=>[r(l(e(f)("groupDetail.taskList.progress"))+": "+l(t.progress),1)]),_:2},1024),o(p,{size:"tiny",bordered:!1},{default:n(()=>[r(l(e(f)("groupDetail.taskList.spaceName"))+": "+l(t.space_name),1)]),_:2},1024),o(p,{size:"tiny",bordered:!1},{default:n(()=>[o(C,{component:e(ue)},null,8,["component"]),r(" "+l(t.user_name),1)]),_:2},1024)])],12,Je)]),_:2},1024))),128))]),_:1})]),_:1}))])}}}),st=Q(tt,[["__scopeId","data-v-7b9921ba"]]),ot={class:"pr-5 pt-5"},at={class:"flex justify-between mb-4 color-bar"},nt={class:"flex items-center gap-2 font-bold"},lt={class:"flex justify-center items-center"},it=j({__name:"ExpQueue",setup(P,{expose:v}){const u=de(),f=se(),{t:i}=R(),x=D(!1),M=D(!1),d=D(),w=U(),m=async()=>{if(x.value)return;x.value=!0;const[s,t]=await De({device_group_name:w.query.device_group_name});x.value=!1,!s&&(t==null?void 0:t.status)==0&&(d.value=t.data.list||[])},{stop:L,start:C,runing:y}=Me(m,{isManual:!0,duration:2*1e3});A(()=>{y.value||(m(),C())}),fe(()=>{y.value||(m(),C())}),me(()=>{L()});const p=s=>{const t=new URLSearchParams({device_group_name:w.query.device_group_name,task_id:s.task_id,task_title:s.task_title,space_id:s.space_id,exp_id:String(s.exp_id)});window.open(`/experiment/plotter?${t.toString()}`,f.expOpenForm)};v({open:()=>M.value=!0}),D();const _=async(s,t)=>{t.stopPropagation();const[h,g]=await Ce({exp_id:s.exp_id});!h&&(g==null?void 0:g.status)===0&&(u.success("实验终止成功"),m())},z=[{title:i("groupDetail.exps.expTableId"),key:"exp_id",width:80},{title:i("groupDetail.exps.expTableTitle"),key:"exp_name",render(s){return T(N,{lineClamp:1},{default:()=>s.exp_name})}},{title:i("groupDetail.exps.expTableDesc"),key:"description",render(s){return T(N,{lineClamp:1},{default:()=>s.description})}},{title:i("groupDetail.exps.expTableSpaceName"),key:"space_name",width:120},{title:i("groupDetail.exps.expTableStatus"),key:"status",width:180,render(s){return T("div",{class:"flex items-center"},[T(V,{color:{color:X[s.status].color,textColor:"#fff"},bordered:!1,class:"w-[180px] flex items-center justify-center text-xs"},{default:()=>{var t;return[T("span",i((t=X[s.status])==null?void 0:t.text)),T("span",s.process)]}})])}},{title:i("groupDetail.exps.expTableAction"),key:"actions",align:"center",width:80,render(s){return T(oe,{size:"small",quaternary:!0,type:"primary",onClick:t=>_(s,t)},{icon:()=>T($e),default:()=>i("groupDetail.exps.stop")})}}],b=s=>({class:"cursor-pointer",onClick:()=>{p(s)}});return(s,t)=>{const h=B,g=O,q=ze;return c(),S("div",ot,[a("div",at,[a("div",nt,[a("div",lt,[o(h,{component:e(Pe)},null,8,["component"])]),r(" "+l(e(i)("groupDetail.exps.expQueue")),1)])]),e(I)(e(d))?(c(),k(g,{key:0,class:"!mt-20"})):(c(),k(q,{key:1,columns:z,data:e(d),pagination:!1,"row-props":b,"max-height":"calc(50vh - 200px)",size:"small"},null,8,["data"]))])}}}),ct=Q(it,[["__scopeId","data-v-2e251dba"]]),rt={class:"pl-5 pt-5"},_t={class:"flex justify-between mb-4 color-bar"},pt={class:"flex items-center gap-2 font-bold"},ut={class:"flex justify-center items-center"},dt=["onClick"],ft={class:"flex justify-between items-center"},mt={class:"flex gap-1 items-center"},gt={class:"opacity-70"},xt={class:"flex-1 flex items-center justify-between gap-2 mt-1"},vt={class:"flex items-center gap-2"},yt={key:1,class:"italic opacity-70 text-xs"},ht=j({__name:"FavorityList",setup(P,{expose:v}){const u=J(),f=se(),{t:i}=R(),x=D(!1),M=D(!1),d=D(),w=ge({page:1,per_page:20,total:0}),m=U(),L=async s=>{var q;if(x.value)return;x.value=!0;let t=w.page;s&&(t+=1);const[h,g]=await Se({device_group_name:m.query.device_group_name,page:t,per_page:w.per_page});x.value=!1,!h&&(g==null?void 0:g.status)==0&&(I((q=g.data)==null?void 0:q.list)||(w.page=t),w.total=g.data.total,s?d.value=Ne([...d.value||[],...g.data.list],"sub_process_id"):d.value=g.data.list||[])};A(()=>{w.page=1,w.total=0,xe(()=>{L()})});const C=s=>{const t=new URLSearchParams({device_group_name:m.query.device_group_name,task_id:s.task_id,task_title:s.task_title,space_id:s.space_id,exp_id:String(s.sub_process_id)});window.open(`/experiment/plotter?${t.toString()}`,f.expOpenForm)};v({open:()=>M.value=!0});const y=D(),p=D(),_=(s,t)=>{var h;t.stopPropagation(),y.value=s,(h=p.value)==null||h.open()},z=async()=>{var h;if(!y.value)return;const[s,t]=await Le({exp_id:y.value.sub_process_id,is_marked:!y.value.is_marked});!s&&(t==null?void 0:t.status)===0&&(L(),(h=p.value)==null||h.close())},b=()=>{x.value||L(!0)};return(s,t)=>{const h=B,g=O,q=H,F=Y,ne=Fe;return c(),S("div",rt,[a("div",_t,[a("div",pt,[a("div",ut,[o(h,{component:e(Te)},null,8,["component"])]),r(" "+l(e(i)("groupDetail.exps.favorites")),1)])]),e(I)(e(d))?(c(),k(g,{key:0,class:"!mt-20"})):(c(),k(ne,{key:1,distance:50,onLoad:b,style:{height:"calc(50vh - 160px)"}},{default:n(()=>[o(F,{cols:1,"x-gap":12,"y-gap":12},{default:n(()=>[(c(!0),S(G,null,K(e(d),$=>(c(),k(q,{key:$.task_id},{default:n(()=>[a("div",{class:"utility-item border-b",style:E({borderColor:e(u).dividerColor}),onClick:()=>C($)},[a("div",ft,[a("div",mt,[o(e(V),{color:{color:"#7816ff",textColor:"#fff"},size:"small"},{default:n(()=>[r(" Exp "+l($==null?void 0:$.sub_process_id),1)]),_:2},1024),o(e(N),{"line-clamp":1,class:"font-bold"},{default:n(()=>[r(l($.title),1)]),_:2},1024),$.description?(c(),k(e(N),{key:0,"line-clamp":1,class:"opacity-70 max-w-1/2"},{default:n(()=>[r("  ( "+l($.description)+" ) ",1)]),_:2},1024)):te("",!0)]),a("div",gt,[o(e(V),{size:"tiny",bordered:!1},{default:n(()=>[r(l(e(ve)($.create_timestamp*1e3).format("YYYY-MM-DD HH:mm:ss")),1)]),_:2},1024)])]),a("div",xt,[a("div",vt,[o(e(V),{size:"tiny",bordered:!1},{default:n(()=>[r(l(e(i)("groupDetail.exps.progress"))+": "+l($.progress),1)]),_:2},1024),$.mark_note?(c(),k(e(N),{key:0,"line-clamp":1,class:"opacity-70 text-xs italic"},{default:n(()=>[r(l(e(i)("groupDetail.exps.expTableMarkNote"))+": "+l($.mark_note),1)]),_:2},1024)):(c(),S("span",yt,l(e(i)("groupDetail.exps.noNote")),1))]),a("div",null,[o(e(oe),{type:"primary",onClick:le=>_($,le),size:"tiny"},{icon:n(()=>[o(e(we))]),default:n(()=>[r(" "+l(e(i)("groupDetail.exps.unfavority")),1)]),_:2},1032,["onClick"])])])],12,dt)]),_:2},1024))),128))]),_:1})]),_:1})),o(qe,{ref_key:"confirmModalRef",ref:p,contentTips:e(i)("groupDetail.exps.unfavorityTips"),onOk:z},null,8,["contentTips"])])}}}),bt=Q(ht,[["__scopeId","data-v-5921944a"]]),kt={class:"flex flex-col",style:{height:"calc(100vh - 180px)"}},wt={class:"flex-1 h-full"},Ct={class:"flex items-center flex-1"},$t={class:"flex-1 h-full"},It=j({__name:"OverView",setup(P){const v=J();return(u,f)=>(c(),S("div",kt,[a("div",{class:"flex items-center flex-1 border-b",style:E({borderColor:e(v).dividerColor})},[a("div",{class:"flex-1 border-r h-full",style:E({borderColor:e(v).dividerColor})},[o(Qe)],4),a("div",wt,[o(st)])],4),a("div",Ct,[a("div",{class:"flex-1 border-r h-full",style:E({borderColor:e(v).dividerColor})},[o(ct)],4),a("div",$t,[o(bt)])])]))}});export{It as default};
