name: Chips_vs_Oil_MatrixEffects_v1
version: 0.1.0
min_foodspec_version: null
description: RQ3–RQ4 matrix effects; divergent markers between chips and pure oils.
when_to_use: "Compare chips vs pure oils to identify matrix-driven divergences."
expected_columns:
  oil_col: oil_type
  matrix_col: matrix
  heating_col: heating_stage
report_templates:
  intro: "This protocol highlights matrix effects (chips vs oil) and divergent markers (RQ3–RQ4)."
  note: "Looks at mean shifts, trend differences, and CV deltas with effect sizes."
seed: 0
steps:
  - type: preprocess
    params:
      baseline_lambda: 100000
      baseline_p: 0.01
      smooth_window: 9
      smooth_polyorder: 3
      normalization: reference
      reference_wavenumber: 2720.0
      peaks:
        - {name: I_1742, wavenumber: 1742}
        - {name: I_1652, wavenumber: 1652}
        - {name: I_1434, wavenumber: 1434}
        - {name: I_1296, wavenumber: 1296}
        - {name: I_1259, wavenumber: 1259}
        - {name: I_2720, wavenumber: 2720}
  - type: rq_analysis
    params:
      oil_col: oil_type
      matrix_col: matrix
      heating_col: heating_stage
      random_state: 0
      n_splits: 5
      normalization_modes: [reference, vector, area]
      minimal_panel_target_accuracy: 0.9
      adjust_p_values: true
      enable_clustering: true
      ratios:
        - {name: 1742/2720, numerator: I_1742, denominator: I_2720}
        - {name: 1652/2720, numerator: I_1652, denominator: I_2720}
        - {name: 1434/2720, numerator: I_1434, denominator: I_2720}
        - {name: 1259/2720, numerator: I_1259, denominator: I_2720}
        - {name: 1296/2720, numerator: I_1296, denominator: I_2720}
  - type: qc_checks
    params:
      required_columns: ["oil_type", "matrix", "heating_stage"]
      class_col: "oil_type"
  - type: output
    params:
      output_dir: protocol_runs
