{
    "wstl": {
        "title": "HEA Keychain",
        "actions": [
            {
                "name": "heaserver-keychain-credentials-duplicate",
                "type": "unsafe",
                "action": "append",
                "target": "item read cj",
                "prompt": "Duplicate"
            },
            {
                "name": "heaserver-keychain-credentials-open-choices",
                "description": "Open this credential",
                "type": "safe",
                "action": "read",
                "target": "item read cj",
                "prompt": "Open"
            },
            {
                "name": "heaserver-keychain-generate-awscredentials-file",
                "description": "Generate credentials and retrieve them in the AWS CLI credentials file format. If credentials with the same lifespan are found, they will be extended.",
                "type": "unsafe",
                "action": "update",
                "target": "item read cj",
                "prompt": "Generate managed credentials"
            },
            {
                "name": "heaserver-keychain-generate-awscredentials-file-managed",
                "description": "Retrieve the credentials in the AWS CLI credentials file format",
                "type": "unsafe",
                "action": "update",
                "target": "item read cj",
                "prompt": "Retrieve credentials file"
            },
            {
                "name": "heaserver-keychain-update-awscredentials-file",
                "description": "Extend the credentials' expiration",
                "type": "unsafe",
                "action": "update",
                "target": "item read cj",
                "prompt": "Extend credentials expiration"
            },
            {
                "name": "heaserver-keychain-generate-awscredentials-file-form",
                "description": "Generate credentials and retrieve them in the AWS CLI credentials file format. If credentials for the same account and with the same lifespan are found, they will be extended.",
                "type": "safe",
                "action": "read",
                "target": "item cj-template",
                "prompt": "Generate managed credentials",
                "inputs": [
                    {
                        "name": "OIDC_CLAIM_sub",
                        "prompt": "Requesting user id",
                        "required": true,
                        "readOnly": true,
                        "hea": {
                            "display": false
                        }
                    },
                    {
                        "name": "account_id",
                        "prompt": "AWS Account ID",
                        "required": true,
                        "readOnly": true,
                        "hea": {
                            "display": false
                        }
                    },
                    {
                        "name": "key_lifespan",
                        "prompt": "Credential Duration",
                        "type": "select",
                        "required": true,
                        "suggest": [
                            {"value": "24", "text": "24 hours"},
                            {"value": "48", "text": "48 hours"},
                            {"value": "72", "text": "72 hours"}
                        ],
                        "value":  "24"
                    }
                ]
            },
            {
                "name": "heaserver-keychain-generate-awscredentials-file-form-managed",
                "description": "Retrieve credentials in the AWS CLI credentials file format",
                "type": "safe",
                "action": "read",
                "target": "item cj-template",
                "prompt": "Retrieve credentials file",
                "inputs": []
            },
            {
                "name": "heaserver-keychain-extend-expiration-form",
                "description": "Extend the expiration of these credentials",
                "type": "safe",
                "action": "read",
                "target": "item cj-template",
                "prompt": "Extend credentials expiration",
                "inputs": []
            },
            {
                "name": "heaserver-keychain-credentials-get-properties",
                "description": "View and edit these credentials' properties",
                "type": "unsafe",
                "target": "item cj-template",
                "action": "update",
                "prompt": "Properties",
                "inputs": [
                    {
                        "name": "id",
                        "prompt": "Id",
                        "readOnly": true,
                        "hea": {
                            "display": false
                        }
                    },
                    {
                        "name": "display_name",
                        "prompt": "Name",
                        "required": true
                    },
                    {
                        "name": "type",
                        "readOnly": true,
                        "required": true,
                        "hea": {
                            "display": false
                        }
                    },
                    {
                        "name": "type_display_name",
                        "prompt": "Type",
                        "readOnly": true,
                        "required": true,
                        "value": "Credentials"
                    },
                    {
                        "name": "description",
                        "prompt": "Description",
                        "type": "textarea"
                    },
                    {
                        "name": "account",
                        "prompt": "Account",
                        "required": true
                    },
                    {
                        "name": "where",
                        "prompt": "Where"
                    },
                    {
                        "name": "password",
                        "prompt": "Secret",
                        "hea": {
                            "type": "password"
                        }
                    },
                    {
                        "name": "owner",
                        "prompt": "Owner",
                        "required": true,
                        "readOnly": true,
                        "type": "select",
                        "hea": {
                            "optionsFromUrl": {
                                "path": "people/",
                                "value": "id",
                                "text": "display_name"
                            }
                        }
                    },
                    {
                        "name": "created",
                        "prompt": "Created",
                        "readOnly": true,
                        "hea": {
                            "type": "datetime"
                        }
                    },
                    {
                        "name": "modified",
                        "prompt": "Modified",
                        "readOnly": true,
                        "hea": {
                            "type": "datetime"
                        }
                    },
                    {
                        "name": "source",
                        "prompt": "Source",
                        "hea": {
                            "display": false
                        }
                    },
                    {
                        "hea": {
                            "display": false,
                            "section": "user_shares",
                            "sectionPrompt": "User permissions",
                            "optionsFromUrl": {
                                "path": "people/",
                                "value": "id",
                                "text": "display_name"
                            }
                        },
                        "name": "user",
                        "prompt": "User",
                        "required": true,
                        "type": "select"
                    },
                    {
                        "hea": {
                            "display": false,
                            "section": "user_shares",
                            "cardinality": "multiple"
                        },
                        "name": "permissions",
                        "prompt": "Permissions",
                        "type": "select",
                        "suggest": [
                            {"value":  "COOWNER", "text":  "Co-owner"},
                            {"value":  "DELETER", "text":  "Deleter"},
                            {"value":  "EDITOR", "text":  "Editor"},
                            {"value":  "SHARER", "text":  "Sharer"},
                            {"value":  "VIEWER", "text":  "Viewer"}
                        ]
                    },
                    {
                        "name": "type",
                        "prompt": "Type",
                        "required": true,
                        "readOnly": true,
                        "value": "heaobject.root.ShareImpl",
                        "hea": {
                            "display": false,
                            "section": "user_shares"
                        }
                    },
                    {
                        "hea": {
                            "display": false,
                            "section": "group_shares",
                            "sectionPrompt": "Group permissions",
                            "optionsFromUrl": {
                                "path": "groups/",
                                "value": "id",
                                "text": "display_name"
                            }
                        },
                        "name": "group",
                        "prompt": "Group",
                        "required": true,
                        "type": "select"
                    },
                    {
                        "hea": {
                            "display": false,
                            "section": "group_shares",
                            "cardinality": "multiple"
                        },
                        "name": "permissions",
                        "prompt": "Permissions",
                        "type": "select",
                        "suggest": [
                            {"value":  "COOWNER", "text":  "Co-owner"},
                            {"value":  "DELETER", "text":  "Deleter"},
                            {"value":  "EDITOR", "text":  "Editor"},
                            {"value":  "SHARER", "text":  "Sharer"},
                            {"value":  "VIEWER", "text":  "Viewer"}
                        ]
                    },
                    {
                        "name": "type",
                        "prompt": "Type",
                        "required": true,
                        "readOnly": true,
                        "value": "heaobject.root.ShareImpl",
                        "hea": {
                            "display": false,
                            "section": "group_shares"
                        }
                    },
                    {
                        "hea": {
                            "cardinality": "multiple"
                        },
                        "name": "super_admin_default_permissions",
                        "prompt": "Super admin default permissions",
                        "type": "select",
                        "suggest": [
                            {"value":  "COOWNER", "text":  "Co-owner"},
                            {"value":  "DELETER", "text":  "Deleter"},
                            {"value":  "EDITOR", "text":  "Editor"},
                            {"value":  "SHARER", "text":  "Sharer"},
                            {"value":  "VIEWER", "text":  "Viewer"}
                        ],
                        "readOnly": true
                    }
                ]
            },
            {
                "name": "heaserver-keychain-awscredentials-get-properties",
                "description": "View and edit these AWS credentials' properties",
                "type": "safe",
                "target": "item cj-template",
                "action": "read",
                "prompt": "Properties",
                "inputs": [
                    {
                        "name": "id",
                        "prompt": "Id",
                        "readOnly": true,
                        "hea": {
                            "display": false
                        }
                    },
                    {
                        "name": "display_name",
                        "prompt": "Name",
                        "required": true
                    },
                    {
                        "name": "type",
                        "readOnly": true,
                        "required": true,
                        "hea": {
                            "display": false
                        }
                    },
                    {
                        "name": "type_display_name",
                        "prompt": "Type",
                        "readOnly": true,
                        "required": true,
                        "value": "AWS Credentials"
                    },
                    {
                        "name": "description",
                        "prompt": "Description",
                        "type": "textarea"
                    },
                    {
                        "name": "account",
                        "prompt": "Access id",
                        "readOnly": true,
                        "required": true
                    },
                    {
                        "name": "password",
                        "prompt": "Secret",
                        "readOnly": true
                    },
                    {
                        "name": "session_token",
                        "prompt": "Session token",
                        "type": "textarea",
                        "readOnly": true
                    },
                    {
                        "name": "where",
                        "prompt": "Region",
                        "type": "select",
                        "readOnly": true,
                        "suggest": [
                            {"value": "us-east-2", "text": "US East (Ohio)"},
                            {"value": "us-east-1", "text": "US East (N. Virginia)"},
                            {"value": "us-west-1", "text": "US West (N. California)"},
                            {"value": "us-west-2", "text": "US West (Oregon)"},
                            {"value": "af-south-1", "text": "Africa (Cape Town)"},
                            {"value": "ap-east-1", "text": "Asia Pacific (Hong Kong)"},
                            {"value": "ap-southeast-3", "text": "Asia Pacific (Jakarta)"},
                            {"value": "ap-south-1", "text": "Asia Pacific (Mumbai)"},
                            {"value": "ap-northeast-3", "text": "Asia Pacific (Osaka)"},
                            {"value": "ap-northeast-2", "text": "Asia Pacific (Seoul)"},
                            {"value": "ap-southeast-1", "text": "Asia Pacific (Singapore)"},
                            {"value": "ap-southeast-2", "text": "Asia Pacific (Sydney)"},
                            {"value": "ap-northeast-1", "text": "Asia Pacific (Tokyo)"},
                            {"value": "ca-central-1", "text": "Canada (Central)"},
                            {"value": "eu-central-1", "text": "Europe (Frankfurt)"},
                            {"value": "eu-west-1", "text": "Europe (Ireland)"},
                            {"value": "eu-west-2", "text": "Europe (London)"},
                            {"value": "eu-south-1", "text": "Europe (Milan)"},
                            {"value": "eu-west-3", "text": "Europe (Paris)"},
                            {"value": "eu-north-1", "text": "Europe (Stockholm)"},
                            {"value": "me-south-1", "text": "Middle East (Bahrain)"},
                            {"value": "sa-east-1", "text": "South America (SÃ£o Paulo)"}
                        ]
                    },
                    {
                        "name": "role",
                        "prompt": "Role",
                        "required": true
                    },
                    {
                        "name": "expiration",
                        "prompt": "Expiration",
                        "readOnly": true,
                        "hea": {
                            "type": "datetime"
                        }
                    },
                    {
                        "name": "owner",
                        "prompt": "Owner",
                        "required": true,
                        "readOnly": true,
                        "type": "select",
                        "hea": {
                            "optionsFromUrl": {
                                "path": "people/",
                                "value": "id",
                                "text": "display_name"
                            }
                        }
                    },
                    {
                        "name": "created",
                        "prompt": "Created",
                        "readOnly": true,
                        "hea": {
                            "type": "datetime"
                        }
                    },
                    {
                        "name": "modified",
                        "prompt": "Modified",
                        "readOnly": true,
                        "hea": {
                            "type": "datetime"
                        }
                    },
                    {
                        "name": "temporary",
                        "prompt": "Temporary",
                        "readOnly": true,
                        "type": "select",
                        "suggest": [
                            {"value":  "true", "text":  "True"},
                            {"value":  "false", "text":  "False"}
                        ],
                        "hea": {
                            "display": false
                        }
                    },
                    {
                        "name": "source",
                        "prompt": "Source",
                        "hea": {
                            "display": false
                        }
                    },
                    {
                        "hea": {
                            "section": "user_shares",
                            "sectionPrompt": "User permissions",
                            "optionsFromUrl": {
                                "path": "people/",
                                "value": "id",
                                "text": "display_name"
                            }
                        },
                        "name": "user",
                        "prompt": "User",
                        "required": true,
                        "type": "select"
                    },
                    {
                        "hea": {
                            "section": "user_shares",
                            "cardinality": "multiple"
                        },
                        "name": "permissions",
                        "prompt": "Permissions",
                        "type": "select",
                        "suggest": [
                            {"value":  "COOWNER", "text":  "Co-owner"},
                            {"value":  "DELETER", "text":  "Deleter"},
                            {"value":  "EDITOR", "text":  "Editor"},
                            {"value":  "SHARER", "text":  "Sharer"},
                            {"value":  "VIEWER", "text":  "Viewer"}
                        ]
                    },
                    {
                        "name": "type",
                        "prompt": "Type",
                        "required": true,
                        "readOnly": true,
                        "value": "heaobject.root.ShareImpl",
                        "hea": {
                            "display": false,
                            "section": "user_shares"
                        }
                    },
                    {
                        "hea": {
                            "section": "group_shares",
                            "sectionPrompt": "Group permissions",
                            "optionsFromUrl": {
                                "path": "groups/",
                                "value": "id",
                                "text": "display_name"
                            }
                        },
                        "name": "group",
                        "prompt": "Group",
                        "required": true,
                        "type": "select"
                    },
                    {
                        "hea": {
                            "section": "group_shares",
                            "cardinality": "multiple"
                        },
                        "name": "permissions",
                        "prompt": "Permissions",
                        "type": "select",
                        "suggest": [
                            {"value":  "COOWNER", "text":  "Co-owner"},
                            {"value":  "DELETER", "text":  "Deleter"},
                            {"value":  "EDITOR", "text":  "Editor"},
                            {"value":  "SHARER", "text":  "Sharer"},
                            {"value":  "VIEWER", "text":  "Viewer"}
                        ]
                    },
                    {
                        "name": "type",
                        "prompt": "Type",
                        "required": true,
                        "readOnly": true,
                        "value": "heaobject.root.ShareImpl",
                        "hea": {
                            "display": false,
                            "section": "group_shares"
                        }
                    },
                    {
                        "hea": {
                            "cardinality": "multiple"
                        },
                        "name": "super_admin_default_permissions",
                        "prompt": "Super admin default permissions",
                        "type": "select",
                        "suggest": [
                            {"value":  "COOWNER", "text":  "Co-owner"},
                            {"value":  "DELETER", "text":  "Deleter"},
                            {"value":  "EDITOR", "text":  "Editor"},
                            {"value":  "SHARER", "text":  "Sharer"},
                            {"value":  "VIEWER", "text":  "Viewer"}
                        ],
                        "readOnly": true
                    }
                ]
            },
            {
                "name": "heaserver-keychain-credentials-duplicate-form",
                "description": "Duplicate these credentials",
                "type": "unsafe",
                "target": "item cj-template",
                "action": "update",
                "prompt": "Duplicate",
                "inputs": [
                    {
                        "name": "display_name",
                        "prompt": "Name",
                        "required": true
                    },
                    {
                        "name": "description",
                        "hea": {
                            "display": false
                        }
                    },
                    {
                        "name": "account",
                        "hea": {
                            "display": false
                        }
                    },
                    {
                        "name": "where",
                        "hea": {
                            "display": false
                        }
                    },
                    {
                        "name": "password",
                        "hea": {
                            "display": false
                        }
                    },
                    {
                        "name": "session_token",
                        "hea": {
                            "display": false
                        }
                    },
                    {
                        "name": "owner",
                        "hea": {
                            "display": false
                        }
                    },
                    {
                        "name": "created",
                        "hea": {
                            "display": false
                        }
                    },
                    {
                        "name": "modified",
                        "hea": {
                            "display": false
                        }
                    },
                    {
                        "name": "source",
                        "hea": {
                            "display": false
                        }
                    },
                    {
                        "hea": {
                            "section": "shares",
                            "display": false
                        },
                        "name": "user"
                    },
                    {
                        "hea": {
                            "section": "shares",
                            "display": false
                        },
                        "name": "permissions"
                    }
                ]
            },
            {
                "name": "heaserver-keychain-credentials-get-self",
                "description": "View these credentials",
                "type": "safe",
                "action": "read",
                "target": "item read cj",
                "prompt": "View"
            },
            {
                "name": "heaserver-keychain-credentialsviews-get-actual",
                "description": "Get the actual credentials object",
                "type": "safe",
                "action": "read",
                "target": "item read cj",
                "prompt": "Get actual"
            }
        ]
    }
}
