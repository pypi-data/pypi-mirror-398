name: nginx
format: plain
pattern: |
  $ip - - [$ts] "$method $path HTTP/1.1" $code $size "$referrer" "$user_agent"

fields:
  ts:
    type: timestamp
    step: 100ms
    jitter: 50ms
    format: "%d/%b/%Y:%H:%M:%S %z"
    tz: UTC

  ip:
    type: ip
    cidr: 10.0.0.0/8

  method:
    type: choice
    values: ["GET", "POST", "PUT", "DELETE", "HEAD", "OPTIONS"]
    weights: [0.75, 0.15, 0.04, 0.02, 0.02, 0.02]

  path:
    type: choice
    values:
      - /
      - /index.html
      - /api/users
      - /api/posts
      - /api/comments
      - /api/auth/login
      - /api/auth/logout
      - /static/css/main.css
      - /static/js/app.js
      - /favicon.ico
      - /robots.txt
      - /health
      - /metrics
    weights: [0.15, 0.10, 0.12, 0.12, 0.08, 0.08, 0.05, 0.08, 0.08, 0.05, 0.03, 0.04, 0.02]

  code:
    type: choice
    values: [200, 201, 204, 301, 302, 304, 400, 401, 403, 404, 500, 502, 503]
    weights: [0.70, 0.05, 0.03, 0.02, 0.02, 0.05, 0.02, 0.02, 0.01, 0.04, 0.02, 0.01, 0.01]

  size:
    type: int
    min: 0
    max: 50000

  referrer:
    type: choice
    values:
      - "-"
      - "https://www.google.com/"
      - "https://example.com/"
      - "https://example.com/page"
    weights: [0.5, 0.2, 0.2, 0.1]

  user_agent:
    type: choice
    values:
      - "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 Chrome/120.0.0.0 Safari/537.36"
      - "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 Safari/537.36"
      - "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 Chrome/120.0.0.0 Safari/537.36"
      - "Mozilla/5.0 (iPhone; CPU iPhone OS 17_0 like Mac OS X) AppleWebKit/605.1.15 Safari/604.1"
      - "curl/8.4.0"
      - "python-requests/2.31.0"
    weights: [0.35, 0.25, 0.15, 0.15, 0.05, 0.05]
