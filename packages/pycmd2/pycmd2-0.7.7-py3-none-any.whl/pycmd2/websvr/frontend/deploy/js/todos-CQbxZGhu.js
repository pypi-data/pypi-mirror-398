import{D as d}from"./vue-vendor-CVtHwYAS.js";const s="pycmd2-todos",l="pycmd2-todos-filter",r={getTodos(){try{const t=localStorage.getItem(s);return t?JSON.parse(t).map(o=>({...o,created_at:new Date(o.created_at)})):(console.log("没有待办事项数据"),null)}catch(t){return console.error("获取待办事项失败:",t),null}},saveTodos(t){try{localStorage.setItem(s,JSON.stringify(t))}catch(e){console.error("保存待办事项失败:",e)}},getFilter(){try{return localStorage.getItem(l)||null}catch(t){return console.error("获取过滤器设置失败:",t),null}},saveFilter(t){try{localStorage.setItem(l,t)}catch(e){console.error("保存过滤器设置失败:",e)}},clearAll(){try{localStorage.removeItem(s),localStorage.removeItem(l)}catch(t){console.error("清除数据失败:",t)}}},c=d("todos",{state:()=>({todos:[],filter:"all",loading:!1,error:null}),getters:{filteredTodos:t=>{switch(t.filter){case"completed":return t.todos.filter(e=>e.completed);case"pending":return t.todos.filter(e=>!e.completed);default:return t.todos}},completedCount:t=>t.todos.filter(e=>e.completed).length,pendingCount:t=>t.todos.filter(e=>!e.completed).length,totalCount:t=>t.todos.length,completionPercentage:t=>{const e=t.todos.length;return e===0?0:Math.round(t.todos.filter(o=>o.completed).length/e*100)}},actions:{async fetchTodos(){this.loading=!0,this.error=null;try{const t=r.getTodos();if(t)this.todos=t;else{const o=[{id:1,text:"学习 Pinia 基础",completed:!0,created_at:new Date},{id:2,text:"创建第一个 Store",completed:!0,created_at:new Date},{id:3,text:"实现 Getters 计算属性",completed:!1,created_at:new Date},{id:4,text:"添加 Actions 操作",completed:!1,created_at:new Date}];this.todos=o}const e=r.getFilter();e&&(this.filter=e)}catch(t){this.error="获取待办事项失败",console.error("Error fetching todos:",t)}finally{this.loading=!1}},async addTodo(t){if(t.trim()==="")return;const e={id:Date.now(),text:t.trim(),completed:!1,created_at:new Date};this.todos.push(e),r.saveTodos(this.todos)},async toggleTodo(t){const e=this.todos.find(o=>o.id===t);e&&(e.completed=!e.completed,r.saveTodos(this.todos))},async removeTodo(t){const e=this.todos.findIndex(o=>o.id===t);e!==-1&&(this.todos.splice(e,1),r.saveTodos(this.todos))},async clearCompleted(){this.todos=this.todos.filter(t=>!t.completed),r.saveTodos(this.todos)},setFilter(t){this.filter=t,r.saveFilter(t)},clearAllData(){this.todos=[],this.filter="all",r.clearAll()}}});export{c as u};
