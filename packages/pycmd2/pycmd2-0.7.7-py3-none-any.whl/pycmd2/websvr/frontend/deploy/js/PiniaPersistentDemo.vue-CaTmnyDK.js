import{b7 as pe,bO as K,aY as C,aZ as $,bg as me,bi as j,bj as t,bk as o,bl as r,cq as n,a_ as f,df as ce,bC as u,bD as b,cg as fe,bE as P,b_ as F,cW as ge,dw as _e,dx as ve,dn as be,cX as Se,dy as ye,bK as Ve,ba as h,b9 as W,dz as we}from"./vendor-p_a8ePKq.js";import{a as p,d as xe}from"./ui-vendor-CYJCTWKH.js";import{_ as Ce}from"../assets/index-CozMeroQ.js";import"./utils-vendor-qrLihgeT.js";import"./vue-vendor-CVtHwYAS.js";import"./charts-vendor-ZJQ0DAqP.js";const he={class:"pinia-persistent-demo"},De={class:"persistent-section"},Ne={class:"card-header"},Oe={class:"card-header"},Ue={class:"user-profile"},ke={class:"notes-section"},Ie={class:"notes-list"},ze={class:"card-header"},Be={class:"storage-info"},Je={class:"storage-actions"},Me={class:"card-header"},$e={class:"content-viewer"},je=pe({__name:"PiniaPersistentDemo",setup(Te){const d=K({theme:"light",language:"zh-CN",fontSize:16,autoSave:!0}),m=K({name:"",email:"",bio:""}),c=C([]),S=C(""),v=C(!1),D=C(""),N=C(""),y=$(()=>{const l=[];for(let e=0;e<localStorage.length;e++){const s=localStorage.key(e);s&&s.startsWith("pinia-demo-")&&l.push(s)}return l}),q=$(()=>{let l=0;for(const e of y.value){const s=localStorage.getItem(e);s&&(l+=s.length)}return l}),T=$(()=>{const l={};for(const e of y.value){const s=localStorage.getItem(e);if(s)try{l[e]=JSON.parse(s)}catch{l[e]=s}}return l});me(()=>{I()});const I=()=>{try{const l=localStorage.getItem("pinia-demo-settings");l&&Object.assign(d,JSON.parse(l));const e=localStorage.getItem("pinia-demo-user");e&&Object.assign(m,JSON.parse(e));const s=localStorage.getItem("pinia-demo-notes");s&&(c.value=JSON.parse(s));const i=localStorage.getItem("pinia-demo-lastUpdated");i&&(N.value=new Date(i).toLocaleString())}catch(l){p.error("加载数据失败: "+l)}},_=(l,e)=>{try{localStorage.setItem(l,JSON.stringify(e)),A()}catch(s){p.error("保存数据失败"+s)}},A=()=>{const l=new Date().toISOString();localStorage.setItem("pinia-demo-lastUpdated",l),N.value=new Date(l).toLocaleString()},O=l=>{_("pinia-demo-settings",d),p.success(`设置已保存: ${l}`)},z=()=>{_("pinia-demo-user",m)},L=()=>{S.value.trim()&&(c.value.push(S.value.trim()),S.value="",_("pinia-demo-notes",c.value),p.success("便签已添加"))},H=l=>{c.value.splice(l,1),_("pinia-demo-notes",c.value)},X=()=>{const l={settings:d,user:m,notes:c.value,exportTime:new Date().toISOString()},e=JSON.stringify(l,null,2);navigator.clipboard.writeText(e).then(()=>{p.success("数据已复制到剪贴板")}).catch(()=>{p.error("复制失败，请手动复制"),v.value=!0,D.value=e})},Y=()=>{try{const l=JSON.parse(D.value);l.settings&&(Object.assign(d,l.settings),_("pinia-demo-settings",d)),l.user&&(Object.assign(m,l.user),_("pinia-demo-user",m)),l.notes&&(c.value=l.notes,_("pinia-demo-notes",c.value)),p.success("数据导入成功"),v.value=!1,I()}catch(l){p.error("数据格式错误，导入失败: "+l)}},Z=()=>{I(),p.success("数据已刷新")},G=()=>{xe.confirm("确定要清除所有数据吗？此操作不可恢复。","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{for(const l of y.value)localStorage.removeItem(l);Object.assign(d,{theme:"light",language:"zh-CN",fontSize:16,autoSave:!0}),Object.assign(m,{name:"",email:"",bio:""}),c.value=[],N.value="",p.success("所有数据已清除")}).catch(()=>{p.info("操作已取消")})},Q=l=>{navigator.clipboard.writeText(JSON.stringify(l,null,2)).then(()=>{p.success("已复制到剪贴板")}).catch(()=>{p.error("复制失败")})},R=l=>{if(l===0)return"0 Bytes";const e=1024,s=["Bytes","KB","MB"],i=Math.floor(Math.log(l)/Math.log(e));return parseFloat((l/Math.pow(e,i)).toFixed(2))+" "+s[i]},ee=l=>JSON.stringify(l,null,2),te=l=>({"pinia-demo-settings":"应用设置","pinia-demo-user":"用户数据","pinia-demo-notes":"便签","pinia-demo-lastUpdated":"最后更新"})[l]||l;return(l,e)=>{const s=n("el-alert"),i=n("el-icon"),V=n("el-option"),E=n("el-select"),U=n("el-form-item"),oe=n("el-slider"),le=n("el-switch"),ae=n("el-form"),w=n("el-card"),k=n("el-col"),x=n("el-input"),ne=n("el-divider"),g=n("el-button"),se=n("el-tag"),B=n("el-row"),J=n("el-descriptions-item"),re=n("el-descriptions"),de=n("el-tab-pane"),ie=n("el-tabs"),ue=n("el-dialog");return h(),j("div",he,[t(w,{header:"持久化存储示例 - LocalStorage 集成"},{default:o(()=>[r("div",De,[t(s,{title:"持久化说明",type:"info",closable:!1,description:"此示例展示了如何将 Pinia 状态与 LocalStorage 集成，实现数据持久化。刷新页面后数据仍然保留。",style:{"margin-bottom":"20px"}}),t(B,{gutter:20},{default:o(()=>[t(k,{span:24,md:12},{default:o(()=>[t(w,{shadow:"hover",class:"settings-card"},{header:o(()=>[r("div",Ne,[t(i,null,{default:o(()=>[t(f(ce))]),_:1}),e[16]||(e[16]=r("span",null,"应用设置",-1))])]),default:o(()=>[t(ae,{model:d,"label-width":"100px"},{default:o(()=>[t(U,{label:"应用主题"},{default:o(()=>[t(E,{modelValue:d.theme,"onUpdate:modelValue":e[0]||(e[0]=a=>d.theme=a),onChange:e[1]||(e[1]=a=>O("theme"))},{default:o(()=>[t(V,{label:"浅色",value:"light"}),t(V,{label:"深色",value:"dark"}),t(V,{label:"自动",value:"auto"})]),_:1},8,["modelValue"])]),_:1}),t(U,{label:"语言"},{default:o(()=>[t(E,{modelValue:d.language,"onUpdate:modelValue":e[2]||(e[2]=a=>d.language=a),onChange:e[3]||(e[3]=a=>O("language"))},{default:o(()=>[t(V,{label:"中文",value:"zh-CN"}),t(V,{label:"English",value:"en-US"})]),_:1},8,["modelValue"])]),_:1}),t(U,{label:"字体大小"},{default:o(()=>[t(oe,{modelValue:d.fontSize,"onUpdate:modelValue":e[4]||(e[4]=a=>d.fontSize=a),min:12,max:24,onChange:e[5]||(e[5]=a=>O("fontSize"))},null,8,["modelValue"])]),_:1}),t(U,{label:"自动保存"},{default:o(()=>[t(le,{modelValue:d.autoSave,"onUpdate:modelValue":e[6]||(e[6]=a=>d.autoSave=a),onChange:e[7]||(e[7]=a=>O("autoSave"))},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),t(k,{span:24,md:12},{default:o(()=>[t(w,{shadow:"hover",class:"data-card"},{header:o(()=>[r("div",Oe,[t(i,null,{default:o(()=>[t(f(ge))]),_:1}),e[17]||(e[17]=r("span",null,"用户数据",-1))])]),default:o(()=>[r("div",Ue,[t(x,{modelValue:m.name,"onUpdate:modelValue":e[8]||(e[8]=a=>m.name=a),placeholder:"用户名",onInput:z},{prepend:o(()=>[...e[18]||(e[18]=[u("用户名",-1)])]),_:1},8,["modelValue"]),t(x,{modelValue:m.email,"onUpdate:modelValue":e[9]||(e[9]=a=>m.email=a),placeholder:"邮箱",style:{"margin-top":"10px"},onInput:z},{prepend:o(()=>[...e[19]||(e[19]=[u("邮箱",-1)])]),_:1},8,["modelValue"]),t(x,{modelValue:m.bio,"onUpdate:modelValue":e[10]||(e[10]=a=>m.bio=a),type:"textarea",rows:3,placeholder:"个人简介",style:{"margin-top":"10px"},onInput:z},null,8,["modelValue"])]),t(ne),r("div",ke,[r("h4",null,"便签 ("+b(c.value.length)+")",1),t(x,{modelValue:S.value,"onUpdate:modelValue":e[11]||(e[11]=a=>S.value=a),placeholder:"添加新便签...",onKeyup:fe(L,["enter"])},{append:o(()=>[t(g,{onClick:L},{default:o(()=>[...e[20]||(e[20]=[u("添加",-1)])]),_:1})]),_:1},8,["modelValue"]),r("div",Ie,[(h(!0),j(P,null,F(c.value,(a,M)=>(h(),W(se,{key:M,closable:"",onClose:Le=>H(M),style:{margin:"5px"}},{default:o(()=>[u(b(a),1)]),_:2},1032,["onClose"]))),128))])])]),_:1})]),_:1})]),_:1}),t(B,{style:{"margin-top":"20px"}},{default:o(()=>[t(k,{span:24},{default:o(()=>[t(w,{shadow:"hover",class:"storage-card"},{header:o(()=>[r("div",ze,[t(i,null,{default:o(()=>[t(f(ye))]),_:1}),e[21]||(e[21]=r("span",null,"存储管理",-1))])]),default:o(()=>[r("div",Be,[t(re,{column:3,border:""},{default:o(()=>[t(J,{label:"存储大小"},{default:o(()=>[u(b(R(q.value)),1)]),_:1}),t(J,{label:"数据项数量"},{default:o(()=>[u(b(y.value.length),1)]),_:1}),t(J,{label:"最后更新"},{default:o(()=>[u(b(N.value||"从未"),1)]),_:1})]),_:1}),r("div",Je,[t(g,{type:"primary",onClick:X},{default:o(()=>[t(i,null,{default:o(()=>[t(f(_e))]),_:1}),e[22]||(e[22]=u(" 导出数据 ",-1))]),_:1}),t(g,{type:"success",onClick:e[12]||(e[12]=a=>v.value=!0)},{default:o(()=>[t(i,null,{default:o(()=>[t(f(ve))]),_:1}),e[23]||(e[23]=u(" 导入数据 ",-1))]),_:1}),t(g,{type:"warning",onClick:Z},{default:o(()=>[t(i,null,{default:o(()=>[t(f(be))]),_:1}),e[24]||(e[24]=u(" 刷新数据 ",-1))]),_:1}),t(g,{type:"danger",onClick:G},{default:o(()=>[t(i,null,{default:o(()=>[t(f(Se))]),_:1}),e[25]||(e[25]=u(" 清除所有数据 ",-1))]),_:1})])])]),_:1})]),_:1})]),_:1}),t(B,{style:{"margin-top":"20px"}},{default:o(()=>[t(k,{span:24},{default:o(()=>[t(w,{shadow:"hover",class:"preview-card"},{header:o(()=>[r("div",Me,[t(i,null,{default:o(()=>[t(f(Ve))]),_:1}),e[26]||(e[26]=r("span",null,"存储内容预览",-1))])]),default:o(()=>[t(ie,null,{default:o(()=>[(h(!0),j(P,null,F(y.value,a=>(h(),W(de,{key:a,label:te(a),name:a},{default:o(()=>[r("div",$e,[t(g,{size:"small",onClick:M=>Q(T.value[a]),style:{"margin-bottom":"10px"}},{default:o(()=>[t(i,null,{default:o(()=>[t(f(we))]),_:1}),e[27]||(e[27]=u(" 复制 ",-1))]),_:1},8,["onClick"]),r("pre",null,b(ee(T.value[a])),1)])]),_:2},1032,["label","name"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1}),t(ue,{modelValue:v.value,"onUpdate:modelValue":e[15]||(e[15]=a=>v.value=a),title:"导入数据",width:"500px"},{footer:o(()=>[t(g,{onClick:e[14]||(e[14]=a=>v.value=!1)},{default:o(()=>[...e[28]||(e[28]=[u("取消",-1)])]),_:1}),t(g,{type:"primary",onClick:Y},{default:o(()=>[...e[29]||(e[29]=[u("导入",-1)])]),_:1})]),default:o(()=>[t(x,{modelValue:D.value,"onUpdate:modelValue":e[13]||(e[13]=a=>D.value=a),type:"textarea",rows:10,placeholder:"粘贴导出的 JSON 数据..."},null,8,["modelValue"])]),_:1},8,["modelValue"])])}}}),Ae=Ce(je,[["__scopeId","data-v-5e5514c8"]]);export{Ae as default};
