[project]
name = "powerchord"
version = "0.4.14"
description = "Concurrent CLI task runner"
authors = [{ name = "Huib Piguillet", email = "huib@proton.me" }]
requires-python = ">=3.14"
readme = "README.md"
license = "MIT"
keywords = [
  "task runner",
  "cli utility",
  "concurrency",
]
classifiers = [
  "Intended Audience :: Developers",
  "Topic :: Utilities",
  "Topic :: Software Development :: Build Tools",
  "Programming Language :: Python :: 3",
  "Programming Language :: Python :: 3.14",
  "Programming Language :: Python :: 3 :: Only",
]
dependencies = [
  "based-utils",
  "chili",
  "gaffe",
  "kleur",
]

[dependency-groups]
dev = [
  "mypy",
  "pre-commit",
  "pytest",
  "pytest-asyncio",
  "ruff",
]

#[tool.uv.sources]
#based-utils = { path = "../based-utils", editable = true }
#kleur = { path = "../kleur", editable = true }

[project.urls]
PyPI = "https://pypi.org/project/powerchord/"
Github = "https://github.com/githuib/powerchord"

[project.scripts]
powerchord = "powerchord.cli:main"

[build-system]
requires = ["uv_build>=0.9.3,<0.10.0"]
build-backend = "uv_build"

[tool.powerchord]
tasks = ["ruff check .", "pytest", "mypy"]

[tool.mypy]
files = ["src", "tests"]
#color_output = true
implicit_optional = true
warn_redundant_casts = true
warn_unused_ignores = true
plugins = "gaffe.mypy:plugin"

[tool.pytest.ini_options]
addopts = "-ra -q --doctest-modules"
asyncio_mode = "auto"
testpaths = [
  "src/powerchord",
  "tests/test_powerchord",
]

[tool.ruff.format]
docstring-code-format = true
skip-magic-trailing-comma = true

[tool.ruff.lint]
# Allow fix for all enabled rules (when `--fix`) is provided.
fixable = ["ALL"]
unfixable = []

# Enable Pyflakes (`F`) and a subset of the pycodestyle (`E`)  codes by default.
# Unlike Flake8, Ruff doesn't enable pycodestyle warnings (`W`) or
# McCabe complexity (`C901`) by default.
select = ["ALL"]
ignore = [
#  "COM812", # may cause conflicts when used with the formatter
#  "RUF013", # PEP 484 prohibits implicit `Optional`
#  "G004",  # Logging statement uses f-string
#  "TRY003", # Avoid specifying long messages outside the exception class
#  "EM101", "EM102", # Exception must not use a string literal, assign to variable first

  # pydocstyle (D)
  "D100", # https://docs.astral.sh/ruff/rules/undocumented-public-module/	Missing docstring in public module
  "D101", # https://docs.astral.sh/ruff/rules/undocumented-public-class/	Missing docstring in public class
  "D102", # https://docs.astral.sh/ruff/rules/undocumented-public-method/	Missing docstring in public method
  "D103", # https://docs.astral.sh/ruff/rules/undocumented-public-function/	Missing docstring in public function
  "D104", # https://docs.astral.sh/ruff/rules/undocumented-public-package/	Missing docstring in public package
  "D105", # https://docs.astral.sh/ruff/rules/undocumented-magic-method/	Missing docstring in magic method
  "D106", # https://docs.astral.sh/ruff/rules/undocumented-public-nested-class/	Missing docstring in public nested class
  "D107", # https://docs.astral.sh/ruff/rules/undocumented-public-init/	Missing docstring in __init__
  # warning: The following rule may cause conflicts when used with the formatter: `D203`. To avoid unexpected behavior, we recommend disabling this rule
  "D203", # https://docs.astral.sh/ruff/rules/incorrect-blank-line-before-class/	1 blank line required before class docstring
  "D211", # https://docs.astral.sh/ruff/rules/blank-line-before-class/	No blank lines allowed before class docstring
  "D212", # https://docs.astral.sh/ruff/rules/multi-line-summary-first-line/	Multi-line docstring summary should start at the first line

  # flake8-commas (COM)
  # warning: The following rule may cause conflicts when used with the formatter: `COM812`
  "COM812", # https://docs.astral.sh/ruff/rules/missing-trailing-comma/	Trailing comma missing

  # flake8-logging-format (G)
  "G004", # https://docs.astral.sh/ruff/rules/logging-f-string/	Logging statement uses f-string

  # Ruff-specific rules (RUF)
  "RUF013", # https://docs.astral.sh/ruff/rules/implicit-optional/	PEP 484 prohibits implicit Optional
]

[tool.ruff.lint.per-file-ignores]
"tests/**/*" = [
#  "ANN", # flake8-annotations
  "S", # flake8-bandit
]

[tool.ruff.lint.isort]
split-on-trailing-comma = false
