---
scanner: grype

# Aggregation mode
mode: highest-score

# Logging level
logLevel: DEBUG

# ============================================================================
# Mixed Local and Remote Packages - Example Configuration
# ============================================================================
#
# This configuration demonstrates using BOTH local packages (from ./packages/)
# and remote packages (downloaded from registry) in a single configuration.
#
# Local packages you have available:
#   - core-base (0.55.0-unicorn)
#   - core-identity-authorization (0.55.0-unicorn)
#   - core-logging (0.55.0-unicorn)
#   - headlamp (0.35.0-uds.0-registry1)
#
# ============================================================================

# Registry configuration (required only for remote packages)
registry: registry.defenseunicorns.com
organization: sld-45

# Maximum number of concurrent workers
# Default: auto-detect (min(32, cpu_count + 4))
maxWorkers: 8

# List of packages to scan with mixed sources
packages:
  # ========================================================================
  # LOCAL PACKAGES (from ./packages/ directory)
  # ========================================================================
  # These packages are processed from local archives - fast, no network I/O

  - name: core-base
    version: 0.55.0-unicorn
    architecture: amd64
    source: local  # Uses: ./packages/zarf-package-core-base-amd64-0.55.0-unicorn.tar.zst

  - name: core-identity-authorization
    version: 0.55.0-unicorn
    architecture: amd64
    source: local  # Uses: ./packages/zarf-package-core-identity-authorization-amd64-0.55.0-unicorn.tar.zst

  - name: core-logging
    version: 0.55.0-unicorn
    architecture: amd64
    source: local  # Uses: ./packages/zarf-package-core-logging-amd64-0.55.0-unicorn.tar.zst

  - name: headlamp
    version: 0.35.0-uds.0-registry1
    architecture: amd64
    source: local  # Uses: ./packages/zarf-package-headlamp-amd64-0.35.0-uds.0-registry1.tar.zst

# ========================================================================
# REMOTE PACKAGES (downloaded from registry)
# ========================================================================
# Uncomment these if you want to download additional packages from registry
#
# - name: gitlab
#   version: 18.4.2-uds.0-unicorn
#   architecture: amd64
#   source: remote  # Downloaded from: registry.defenseunicorns.com/sld-45/
#
# - name: gitlab-runner
#   version: 18.4.0-uds.0-unicorn
#   architecture: amd64
#   source: remote

# ============================================================================
# CVE Enrichment with OpenRouter (Optional)
# ============================================================================
enrich:
  enabled: false
  provider: openrouter
  model: x-ai/grok-code-fast-1
  # apiKey: YOUR_API_KEY_HERE # or set via OPENROUTER_API_KEY env var
  reasoningEffort: medium
  verbosity: medium
  maxWorkers: 5
  severities:
    - Critical
    - High
