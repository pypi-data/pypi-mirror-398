[package]
name = "cfsem"
version = "3.1.0"
edition = "2024"
authors = ["Commonwealth Fusion Systems <jlogan@cfs.energy>"]
license = "MIT"
repository = "https://github.com/cfs-energy/cfsem-py"
homepage = "https://github.com/cfs-energy/cfsem-py"
description = "Quasi-steady electromagnetics including filamentized approximations, Biot-Savart, and Grad-Shafranov."
readme = "README.md"

# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html
[lib]
name = "cfsem"
crate-type = ["cdylib", "rlib"]

[dependencies]
pyo3 = { version="0.27.1", features=["extension-module"], optional=true }
numpy = { version="0.27.0", optional=true }  # This must match pyo3 version!

nalgebra = "^0.34.1"
rayon = "^1.11.0"
libm = "^0.2"
num-traits = { version = "0.2.19", features = ["libm"] }

[dev-dependencies]
criterion = "0.7.0"
itertools = "0.14.0"

[profile.release]
opt-level = 3
lto = true
codegen-units = 1
overflow-checks = true

[profile.dev]
# Nearly full optimizations for debug builds to test for perf regressions
# when using maturin develop
opt-level = 3
#lto = true
codegen-units = 16

[features]
default = []
python = ["pyo3", "numpy"]

[[bench]]
name = "linear_filament"
harness = false

[[bench]]
name = "circular_filament"
harness = false

[[bench]]
name = "point_source"
harness = false

[package.metadata.docs.rs]
rustdoc-args = [ "--html-in-header", "katex-header.html" ]
