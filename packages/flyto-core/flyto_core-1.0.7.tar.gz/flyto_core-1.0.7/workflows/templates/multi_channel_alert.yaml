# Level 1 Workflow Template: Multi-Channel Alert
# Ready-to-use workflow for beginners
#
# Usage:
#   python -m cli.main workflows/templates/multi_channel_alert.yaml \
#     --param.title="Production Alert" \
#     --param.message="Server CPU usage exceeded 90%"
#
# Required Environment Variables (at least one):
#   - SLACK_WEBHOOK_URL: Slack webhook URL
#   - DISCORD_WEBHOOK_URL: Discord webhook URL
#   - TELEGRAM_BOT_TOKEN + TELEGRAM_CHAT_ID: Telegram credentials

id: multi_channel_alert
name: Multi-Channel Alert
version: 1.0.0
description: Send alert notifications to multiple channels (Slack, Discord, Telegram)
author: Flyto Core Team
license: MIT
level: 1  # Beginner-friendly template

tags:
  - notification
  - alert
  - slack
  - discord
  - telegram
  - multi-channel

params:
  - name: title
    type: string
    required: true
    label: Alert Title
    description: Title of the alert notification
    placeholder: Production Alert

  - name: message
    type: string
    required: true
    label: Alert Message
    description: The alert message content
    placeholder: Server CPU usage exceeded 90%

  - name: severity
    type: string
    required: false
    default: warning
    label: Severity Level
    description: Alert severity (critical, warning, info)
    options:
      - critical
      - warning
      - info

steps:
  - id: slack_alert
    module: notification.slack.send_message
    params:
      text: |
        ðŸš¨ *${params.title}*

        *Severity:* ${params.severity}
        *Message:* ${params.message}

        _Alert generated by Flyto Core_
    on_error: continue

  - id: discord_alert
    module: notification.discord.send_message
    params:
      content: |
        ðŸš¨ **${params.title}**

        **Severity:** ${params.severity}
        **Message:** ${params.message}

        _Alert generated by Flyto Core_
    on_error: continue

  - id: telegram_alert
    module: notification.telegram.send_message
    params:
      chat_id: ${env.TELEGRAM_CHAT_ID}
      text: |
        ðŸš¨ *${params.title}*

        *Severity:* ${params.severity}
        *Message:* ${params.message}

        _Alert generated by Flyto Core_
      parse_mode: Markdown
    on_error: continue

output:
  title: ${params.title}
  severity: ${params.severity}
  channels:
    slack: ${slack_alert.sent}
    discord: ${discord_alert.sent}
    telegram: ${telegram_alert.sent}
