Metadata-Version: 2.4
Name: kryten-playlist
Version: 0.3.2
Summary: Kryten playlist management service - handles video queue, playlist operations, and catalog enrichment with LLM
License: MIT
License-File: LICENSE
Keywords: cytube,moderation,chat,nats,microservices,catalog,llm,enrichment
Author: Kryten Robot Team
Requires-Python: >=3.10,<4.0
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Programming Language :: Python :: 3.13
Classifier: Programming Language :: Python :: 3.14
Classifier: Topic :: Communications :: Chat
Classifier: Topic :: Multimedia :: Video
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Requires-Dist: aiosqlite (>=0.20.0,<0.21.0)
Requires-Dist: click (>=8.1.0,<9.0.0)
Requires-Dist: fastapi (>=0.115.0,<0.116.0)
Requires-Dist: httpx (>=0.27.0,<0.28.0)
Requires-Dist: jinja2 (>=3.1.4,<4.0.0)
Requires-Dist: json_repair (>=0.54.3,<0.55.0)
Requires-Dist: kryten-py (>=0.9.13)
Requires-Dist: uvicorn (>=0.30.0,<0.31.0)
Project-URL: Documentation, https://github.com/grobertson/kryten-playlist/blob/main/README.md
Project-URL: Homepage, https://github.com/grobertson/kryten-playlist
Project-URL: Repository, https://github.com/grobertson/kryten-playlist
Description-Content-Type: text/markdown

"# Kryten Playlist

Kryten playlist management service - handles video queue and playlist operations for CyTube.

## Features

- Real-time playlist management
- Video queue operations
- Event-driven architecture using NATS
- Playlist synchronization
- **Catalog Management**: Ingest and enrich media catalogs with LLM-powered metadata

## Installation

### Prerequisites

- Python 3.10 or higher
- Poetry
- NATS server running
- kryten-py library

### Setup

1. Install dependencies:
```bash
poetry install
```

2. Copy the example configuration:
```bash
cp config.example.json config.json
```

3. Edit `config.json` with your settings:
```json
{
  "nats_url": "nats://localhost:4222",
  "nats_subject_prefix": "kryten",
  "service_name": "playlist"
}
```

## Usage

### Running the Service

Using Poetry:
```bash
poetry run kryten-playlist --config config.json
```

Using the startup script (PowerShell):
```powershell
.\start-playlist.ps1
```

Using the startup script (Bash):
```bash
./start-playlist.sh
```

### Catalog Management

Kryten Playlist includes tools to manage and enrich your media catalog.

#### Ingest
Ingest catalog from a MediaCMS instance:

```bash
# Using config file (recommended)
poetry run kryten-ingest --config config.json

# Or with manual arguments
poetry run kryten-ingest --base-url https://mediacms.example.com --db data/catalog.db
```

#### Enrich
Enrich metadata using LLM (OpenAI, Anthropic, OpenRouter, etc.):

```bash
# Enrich all unenriched items (recommended)
poetry run kryten-enrich --config config.json

# Manual enrichment with specific model
export LLM_API_KEY="your-key-here"
poetry run kryten-enrich --model gpt-4o --limit 100 --verify
```

**Options:**
- `--verify`: Enable 2-pass verification (double-checks facts with LLM)
- `--tv-only` / `--movies-only`: Filter by type
- `--dry-run`: Preview changes without saving
- `--force-all`: Re-process items even if already enriched

### Command Line Options

- `--config PATH`: Path to configuration file (default: `/etc/kryten/playlist/config.json`)
- `--log-level LEVEL`: Set logging level (DEBUG, INFO, WARNING, ERROR)

## Event Handling

The service currently listens for:

- **queue**: Video queue events
- **delete**: Video deletion events
- **moveVideo**: Video position changes
- **setTemp**: Temporary video status changes

## Development

### Running Tests

```bash
poetry run pytest
```

### Linting

```bash
poetry run ruff check .
```

### Formatting

```bash
poetry run black .
```

## License

MIT License - see LICENSE file for details
" 

