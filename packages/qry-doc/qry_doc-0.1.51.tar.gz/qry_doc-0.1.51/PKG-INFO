Metadata-Version: 2.3
Name: qry-doc
Version: 0.1.51
Summary: Motor de an√°lisis generativo que transforma el lenguaje natural en c√≥digo ejecutable, visualizaciones y reportes PDF profesionales.
Author: danro-dev
Author-email: danro-dev <drgrassnk445@gmail.com>
Requires-Dist: matplotlib>=3.7.5
Requires-Dist: pandasai>=3.0.0
Requires-Dist: pillow>=10.4.0
Requires-Dist: reportlab>=4.4.7
Requires-Dist: sqlalchemy>=2.0.0
Requires-Dist: pandasai-openai>=0.1.0 ; extra == 'all'
Requires-Dist: pandasai-litellm>=0.0.1 ; extra == 'all'
Requires-Dist: psycopg2-binary>=2.9.0 ; extra == 'all'
Requires-Dist: langchain>=0.3.0 ; extra == 'all'
Requires-Dist: langchain-core>=0.3.0 ; extra == 'all'
Requires-Dist: hypothesis>=6.148.8 ; extra == 'dev'
Requires-Dist: pytest>=9.0.2 ; extra == 'dev'
Requires-Dist: pytest-cov>=7.0.0 ; extra == 'dev'
Requires-Dist: langchain>=0.3.0 ; extra == 'langchain'
Requires-Dist: langchain-core>=0.3.0 ; extra == 'langchain'
Requires-Dist: pandasai-litellm>=0.0.1 ; extra == 'litellm'
Requires-Dist: pymysql>=1.0.0 ; extra == 'mysql'
Requires-Dist: pandasai-openai>=0.1.0 ; extra == 'openai'
Requires-Dist: psycopg2-binary>=2.9.0 ; extra == 'postgres'
Requires-Python: >=3.11
Provides-Extra: all
Provides-Extra: dev
Provides-Extra: langchain
Provides-Extra: litellm
Provides-Extra: mysql
Provides-Extra: openai
Provides-Extra: postgres
Description-Content-Type: text/markdown

<p align="center">
  <img src="https://raw.githubusercontent.com/danro-dev/qry-proyect-examples/refs/heads/master/public/logo_op.png" alt="qry-doc" width="600" heigt="200">
</p>

<h1 align="center">qry-doc</h1>


<p align="center">
  <strong>Motor de an√°lisis generativo para consultas en lenguaje natural</strong>
</p>

  <a href="#instalaci√≥n">Instalaci√≥n</a> 
  
  <a href="#inicio-r√°pido">Inicio R√°pido</a>

  <a href="#caracter√≠sticas">Caracter√≠sticas</a>

  <a href="#ejemplos">Ejemplos</a> 

  <a href="#api">API</a> 

  <a href="#contribuir">Contribuir</a>


---

**qry-doc** transforma el lenguaje natural en c√≥digo ejecutable, visualizaciones y reportes PDF profesionales. Simplifica radicalmente la interacci√≥n con archivos CSV y bases de datos SQL.

```python
from qry_doc import QryDoc, ReportTemplate
import pandasai as pai
from pandasai_openai import OpenAI

# Configurar LLM
llm = OpenAI()
pai.config.set({"llm": llm})

qry = QryDoc("ventas.csv", llm=llm)

# Pregunta en espa√±ol
respuesta = qry.ask("¬øCu√°l fue el producto m√°s vendido en 2024?")
print(respuesta)  # "El producto m√°s vendido fue 'Laptop Pro' con 1,234 unidades"

# Exporta resultados a CSV
qry.extract_to_csv("Top 10 clientes por ingresos", "top_clientes.csv")

# Genera reporte PDF profesional
qry.generate_report("An√°lisis trimestral de ventas", "reporte_q4.pdf")
```

## Caracter√≠sticas

- üó£Ô∏è **Consultas en lenguaje natural** - Pregunta sobre tus datos como si hablaras con un analista
- üìä **Visualizaciones autom√°ticas** - Genera gr√°ficos relevantes sin escribir c√≥digo
- üìÑ **Reportes PDF profesionales** - Crea documentos con tablas, gr√°ficos y res√∫menes
- üìÅ **Exportaci√≥n CSV** - Extrae resultados tabulares con encoding Excel-compatible
- üé® **Templates personalizables** - Adapta el estilo de reportes a tu marca
- üñºÔ∏è **Portadas personalizadas** - A√±ade im√°genes de portada a tus reportes
- üè∑Ô∏è **Logo en pie de p√°gina** - Logo por defecto o personalizado con posici√≥n configurable
- ‚úèÔ∏è **Fuentes personalizadas** - Soporte para fuentes TTF/OTF
- üìë **Sistema de secciones** - Controla el orden y contenido de las secciones del reporte
- üîí **Sanitizaci√≥n de errores** - Protege informaci√≥n sensible en mensajes de error
- üêç **Python 3.11+** - Type hints completos y c√≥digo moderno

### Nuevas funcionalidades v0.1.5

- ü§ñ **AIBuilder** - Agente inteligente con LangChain para preparaci√≥n de datos y sugerencias de gr√°ficas
- üéØ **CoverBuilder** - API fluida para crear portadas din√°micas con posicionamiento preciso
- üèóÔ∏è **TemplateBuilder** - Constructor fluido para templates personalizados
- üìä **Multi-gr√°ficas** - Soporte para hasta 10 gr√°ficas por reporte con ChartConfig
- üè≠ **ReportPresets** - Presets predefinidos por industria (Financial, Healthcare, Technology, etc.)

## Instalaci√≥n

### Con uv (recomendado)

```bash
# Instalaci√≥n b√°sica
uv add qry-doc

# Con soporte para OpenAI
uv add "qry-doc[openai]"

# Con soporte para m√∫ltiples proveedores
uv add "qry-doc[litellm]"

# Con soporte para AIBuilder (LangChain)
uv add "qry-doc[langchain]"

# Con todos los proveedores
uv add "qry-doc[all]"
```

### Con pip

```bash
# Instalaci√≥n b√°sica
pip install qry-doc

# Con soporte para OpenAI
pip install "qry-doc[openai]"

# Con soporte para m√∫ltiples proveedores
pip install "qry-doc[litellm]"

# Con soporte para AIBuilder (LangChain)
pip install "qry-doc[langchain]"

# Con todos los proveedores
pip install "qry-doc[all]"
```

### Desde c√≥digo fuente

```bash
git clone https://github.com/danro-dev/qry-doc.git
cd qry-doc
uv sync
```

## Inicio R√°pido

### 1. Configura tu LLM

qry-doc utiliza [PandasAI](https://pandas-ai.com/) como motor de IA. Instala con el extra que necesites:

```bash
# Para OpenAI
pip install "qry-doc[openai]"

# Para m√∫ltiples proveedores
pip install "qry-doc[litellm]"
```

```python
import pandasai as pai
from pandasai_openai import OpenAI

# Opci√≥n 1: API key como variable de entorno OPENAI_API_KEY
llm = OpenAI()

# Opci√≥n 2: Pasar el API key directamente
llm = OpenAI(api_token="sk-...")

# Configurar PandasAI
pai.config.set({"llm": llm})
```

**Proveedores soportados v√≠a LiteLLM:**
- OpenAI (GPT-4, GPT-3.5)
- Anthropic (Claude)
- Google (Gemini)
- Azure OpenAI
- Ollama (modelos locales)
- Y muchos m√°s...

### 2. Carga tus datos

```python
from qry_doc import QryDoc
import pandas as pd

# Desde archivo CSV
qry = QryDoc("datos.csv", llm=llm)

# Desde DataFrame
df = pd.read_excel("datos.xlsx")
qry = QryDoc(df, llm=llm)

# Desde SQL (pr√≥ximamente)
# qry = QryDoc("postgresql://user:pass@host/db", llm=llm)
```

### 3. Haz preguntas

```python
# Preguntas simples
total = qry.ask("¬øCu√°l es el total de ventas?")

# An√°lisis complejos
tendencia = qry.ask("¬øC√≥mo han evolucionado las ventas mes a mes en 2024?")

# Comparaciones
comparacion = qry.ask("Compara las ventas de Q1 vs Q2 por regi√≥n")
```

## Ejemplos

### Exportar datos a CSV

```python
from qry_doc import QryDoc
import pandasai as pai
from pandasai_openai import OpenAI

llm = OpenAI()
pai.config.set({"llm": llm})
qry = QryDoc("clientes.csv", llm=llm)

# Extrae datos filtrados
qry.extract_to_csv(
    "Clientes con m√°s de 10 compras en el √∫ltimo a√±o",
    "clientes_frecuentes.csv"
)

# Extrae agregaciones
qry.extract_to_csv(
    "Ventas totales por categor√≠a de producto",
    "ventas_por_categoria.csv"
)

# Incluir √≠ndice si es necesario
qry.extract_to_csv(
    "Ranking de vendedores por comisi√≥n",
    "ranking.csv",
    include_index=True
)
```

### Generar reportes PDF

```python
from qry_doc import QryDoc, ReportTemplate
import pandasai as pai
from pandasai_openai import OpenAI

llm = OpenAI()
pai.config.set({"llm": llm})
qry = QryDoc("ventas_2024.csv", llm=llm)

# Reporte con template por defecto
qry.generate_report(
    "An√°lisis de rendimiento del equipo de ventas",
    "reporte_ventas.pdf"
)

# Reporte con template personalizado
template = ReportTemplate(
    logo_path="mi_logo.png",
    primary_color="#003366",
    title_font="Helvetica-Bold",
    body_font="Helvetica"
)

qry.generate_report(
    "Resumen ejecutivo Q4 2024",
    "resumen_q4.pdf",
    title="Informe Trimestral de Ventas",
    template=template
)
```

### Reportes con portada personalizada

```python
from qry_doc import ReportTemplate
from pathlib import Path

# Template con imagen de portada
template = ReportTemplate(
    cover_image_path=Path("mi_portada.png"),  # Imagen a p√°gina completa
    logo_path="mi_logo.png",
    primary_color="#003366"
)

qry.generate_report(
    "An√°lisis anual de ventas",
    "reporte_anual.pdf",
    title="Informe Anual 2024",
    template=template
)
```

### Personalizaci√≥n del logo en pie de p√°gina

```python
from qry_doc import ReportTemplate, LogoPosition

# Logo personalizado en posici√≥n espec√≠fica
template = ReportTemplate(
    footer_logo_path=Path("mi_marca.png"),     # Logo personalizado (None = logo por defecto)
    footer_logo_enabled=True,                   # Activar/desactivar logo
    footer_logo_position=LogoPosition.BOTTOM_LEFT,  # BOTTOM_RIGHT, BOTTOM_LEFT, BOTTOM_CENTER
    footer_logo_width=50.0,                     # Ancho en puntos
    footer_logo_height=25.0                     # Alto en puntos
)

# Desactivar el logo del pie de p√°gina
template_sin_logo = ReportTemplate(
    footer_logo_enabled=False
)
```

### Fuentes personalizadas (TTF/OTF)

```python
from qry_doc import ReportTemplate
from pathlib import Path

# Usar fuentes personalizadas
template = ReportTemplate(
    custom_title_font_path=Path("fonts/Montserrat-Bold.ttf"),
    custom_body_font_path=Path("fonts/OpenSans-Regular.ttf"),
    primary_color="#1a1a2e"
)

# Si la fuente no existe o es inv√°lida, se usa Helvetica autom√°ticamente
```

### Sistema de secciones personalizadas

```python
from qry_doc import ReportTemplate, SectionType, SectionConfig

# Definir orden y contenido de secciones
sections = [
    SectionConfig(SectionType.COVER),           # Portada
    SectionConfig(SectionType.SUMMARY),         # Resumen ejecutivo
    SectionConfig(SectionType.CHART),           # Gr√°ficos
    SectionConfig(SectionType.DATA),            # Tabla de datos
    SectionConfig(                              # Secci√≥n personalizada
        SectionType.CUSTOM,
        custom_content="Este es contenido adicional personalizado."
    ),
]

template = ReportTemplate(
    cover_image_path=Path("portada.png"),
    sections=sections
)

# Desactivar una secci√≥n espec√≠fica
sections_sin_datos = [
    SectionConfig(SectionType.SUMMARY),
    SectionConfig(SectionType.CHART),
    SectionConfig(SectionType.DATA, enabled=False),  # No mostrar tabla
]
```

### Templates predefinidos

```python
from qry_doc import (
    DEFAULT_TEMPLATE,    # Estilo profesional est√°ndar
    CORPORATE_TEMPLATE,  # Azul corporativo
    MINIMAL_TEMPLATE,    # Minimalista
    A4_TEMPLATE,         # Tama√±o A4 (europeo)
)

qry.generate_report(
    "An√°lisis de mercado",
    "analisis.pdf",
    template=CORPORATE_TEMPLATE
)
```

### CoverBuilder - Portadas din√°micas (v0.1.5)

```python
from qry_doc import QryDoc, CoverBuilder, TextAlignment
from datetime import datetime

qry = QryDoc("ventas.csv", llm=llm)

# Crear portada con API fluida
cover = (
    qry.create_cover()
    .set_title("Reporte Anual 2024", font_size=48, color="#003366")
    .set_subtitle("An√°lisis de Ventas", font_size=24)
    .set_date(datetime.now())
    .set_author("Equipo de Datos")
    .set_background_color("#F5F5F5")
)

# Generar reporte con portada personalizada
qry.generate_report_with_builder(
    "reporte_anual.pdf",
    cover=cover,
    title="Informe Anual"
)
```

### TemplateBuilder - Templates personalizados (v0.1.5)

```python
from qry_doc import QryDoc, TemplateBuilder, SectionConfig, SectionType, LogoPosition

qry = QryDoc("ventas.csv", llm=llm)

# Crear template con API fluida
template = (
    qry.create_template()
    .with_colors(primary="#003366", secondary="#0066CC")
    .with_fonts(title_font="Helvetica-Bold", body_font="Helvetica")
    .with_margins(top=72, bottom=72, left=72, right=72)
    .with_header(logo_path="mi_logo.png", height=50)
    .with_footer(logo_position=LogoPosition.BOTTOM_RIGHT)
    .with_sections([
        SectionConfig(SectionType.COVER),
        SectionConfig(SectionType.SUMMARY),
        SectionConfig(SectionType.CHART),
        SectionConfig(SectionType.DATA),
    ])
)

qry.generate_report_with_builder(
    "reporte.pdf",
    template=template,
    title="Mi Reporte"
)
```

### ReportPresets - Presets por industria (v0.1.5)

```python
from qry_doc import TemplateBuilder, ReportPresetType, ReportPreset

# Usar preset predefinido
template = TemplateBuilder.from_preset(ReportPresetType.FINANCIAL).build()

# Presets disponibles:
# - FINANCIAL: Azul corporativo para banca e inversiones
# - HEALTHCARE: Verde/teal para salud y farmac√©utica
# - TECHNOLOGY: P√∫rpura moderno para software y TI
# - RETAIL: Naranja vibrante para comercio y ventas
# - MANUFACTURING: Gris industrial para producci√≥n
# - CONSULTING: Azul marino/dorado para consultor√≠a

# Listar todos los presets
for name, description in ReportPreset.list_all():
    print(f"{name}: {description}")

# Personalizar un preset
template = (
    TemplateBuilder.from_preset(ReportPresetType.TECHNOLOGY)
    .with_margins(top=100)  # Override solo el margen superior
    .build()
)
```

### Multi-gr√°ficas con ChartConfig (v0.1.5)

```python
from qry_doc import QryDoc, TemplateBuilder, ChartConfig

qry = QryDoc("ventas.csv", llm=llm)

# Definir m√∫ltiples gr√°ficas (m√°ximo 10)
charts = [
    ChartConfig(
        chart_type='bar',
        title='Ventas por Regi√≥n',
        group_by='region',
        value_column='total',
        color='#003366'
    ),
    ChartConfig(
        chart_type='pie',
        title='Distribuci√≥n por Categor√≠a',
        group_by='categoria',
        value_column='cantidad'
    ),
    ChartConfig(
        chart_type='line',
        title='Tendencia Mensual',
        group_by='mes',
        value_column='ventas'
    ),
]

# Crear template con m√∫ltiples gr√°ficas
template = (
    qry.create_template()
    .with_colors("#003366")
    .with_charts(charts)
)

qry.generate_report_with_builder(
    "reporte_completo.pdf",
    template=template,
    title="An√°lisis Completo de Ventas"
)
```

### AIBuilder - Preparaci√≥n inteligente de datos (v0.1.5)

```python
from qry_doc import QryDoc

qry = QryDoc("ventas.csv", llm=llm)

# Obtener el AIBuilder
ai = qry.ai_builder

# Obtener resumen estructurado de los datos
summary = ai.get_data_summary()
print(f"Columnas: {summary.columns}")
print(f"Columnas num√©ricas: {summary.numeric_columns}")
print(f"Columnas categ√≥ricas: {summary.categorical_columns}")

# Obtener sugerencias de gr√°ficas basadas en los datos
suggestions = ai.suggest_charts("Quiero analizar tendencias de ventas")
for suggestion in suggestions:
    print(f"Tipo: {suggestion.config.chart_type}")
    print(f"Raz√≥n: {suggestion.reasoning}")
    print(f"Confianza: {suggestion.confidence}")

# Preparar datos estructurados para un reporte
report_data = ai.prepare_report_data("Crear reporte trimestral de ventas")
print(f"T√≠tulo sugerido: {report_data['title']}")
print(f"Puntos clave: {report_data['summary_points']}")
print(f"Gr√°ficas sugeridas: {len(report_data['charts'])}")

# Validar si una consulta es factible
is_valid, error = ai.validate_query("Total de ventas por regi√≥n")
if not is_valid:
    print(f"Consulta inv√°lida: {error}")

# Preguntar sobre los datos (requiere LangChain)
if ai.has_langchain:
    response = ai.ask("¬øCu√°les son las columnas disponibles?")
    print(response)
```

### Uso como context manager

```python
from qry_doc import QryDoc
import pandasai as pai
from pandasai_openai import OpenAI

llm = OpenAI()
pai.config.set({"llm": llm})

# Limpieza autom√°tica de archivos temporales
with QryDoc("datos.csv", llm=llm) as qry:
    respuesta = qry.ask("¬øCu√°ntos registros hay?")
    qry.generate_report("Resumen de datos", "resumen.pdf")
# Los archivos temporales se eliminan autom√°ticamente
```

### Acceso a datos subyacentes

```python
import pandasai as pai
from pandasai_openai import OpenAI

llm = OpenAI()
pai.config.set({"llm": llm})
qry = QryDoc("datos.csv", llm=llm)

# Obtener el DataFrame
df = qry.dataframe

# Ver columnas disponibles
print(qry.columns)  # ['fecha', 'producto', 'cantidad', 'precio']

# Ver dimensiones
print(qry.shape)  # (1000, 4)
```

## API

### QryDoc

Clase principal que act√∫a como punto de entrada (Facade) para toda la funcionalidad.

```python
QryDoc(
    data_source: str | Path | DataFrame,  # Fuente de datos
    llm: Any,                              # Proveedor LLM
    api_key: str | None = None             # API key opcional
)
```

**M√©todos:**

| M√©todo | Descripci√≥n | Retorno |
|--------|-------------|---------|
| `ask(query)` | Pregunta en lenguaje natural | `str` |
| `extract_to_csv(query, path, include_index=False)` | Exporta resultado a CSV | `str` |
| `generate_report(query, path, title, template)` | Genera reporte PDF | `str` |
| `generate_report_with_builder(path, cover, template, title)` | Genera reporte con builders (v0.1.5) | `str` |
| `create_cover()` | Crea un CoverBuilder (v0.1.5) | `CoverBuilder` |
| `create_template()` | Crea un TemplateBuilder (v0.1.5) | `TemplateBuilder` |

**Propiedades:**

| Propiedad | Descripci√≥n | Tipo |
|-----------|-------------|------|
| `dataframe` | DataFrame subyacente | `pd.DataFrame` |
| `columns` | Nombres de columnas | `list[str]` |
| `shape` | Dimensiones (filas, columnas) | `tuple[int, int]` |
| `ai_builder` | AIBuilder configurado (v0.1.5) | `AIBuilder` |

### ReportTemplate

Configuraci√≥n para personalizar el estilo de reportes PDF.

```python
ReportTemplate(
    # Configuraci√≥n b√°sica
    logo_path: Path | None = None,      # Ruta al logo del header
    primary_color: str = "#1a1a2e",     # Color principal (hex)
    title_font: str = "Helvetica-Bold", # Fuente de t√≠tulos
    body_font: str = "Helvetica",       # Fuente de cuerpo
    page_size: tuple = letter,          # Tama√±o de p√°gina
    margin_top: float = 72.0,           # Margen superior (puntos)
    margin_bottom: float = 72.0,        # Margen inferior
    margin_left: float = 72.0,          # Margen izquierdo
    margin_right: float = 72.0,         # Margen derecho
    
    # Portada (v0.2.3+)
    cover_image_path: Path | None = None,  # Imagen de portada a p√°gina completa
    
    # Logo en pie de p√°gina (v0.2.3+)
    footer_logo_path: Path | None = None,  # Logo personalizado (None = default)
    footer_logo_enabled: bool = True,      # Activar/desactivar logo
    footer_logo_position: LogoPosition = LogoPosition.BOTTOM_RIGHT,
    footer_logo_width: float = 40.0,       # Ancho en puntos
    footer_logo_height: float = 20.0,      # Alto en puntos
    
    # Fuentes personalizadas (v0.2.3+)
    custom_title_font_path: Path | None = None,  # Fuente TTF/OTF para t√≠tulos
    custom_body_font_path: Path | None = None,   # Fuente TTF/OTF para cuerpo
    
    # Secciones (v0.2.3+)
    sections: list[SectionConfig] = [],    # Lista de secciones del reporte
)
```

### SectionType (v0.2.3+)

Enum para tipos de secciones disponibles en un reporte.

| Valor | Descripci√≥n |
|-------|-------------|
| `COVER` | Portada con imagen a p√°gina completa |
| `SUMMARY` | Secci√≥n de resumen ejecutivo |
| `DATA` | DataFrame renderizado como tabla |
| `CHART` | Imagen de gr√°fico/visualizaci√≥n |
| `CUSTOM` | Contenido personalizado arbitrario |

### SectionConfig (v0.2.3+)

Configuraci√≥n para una secci√≥n del reporte.

```python
SectionConfig(
    section_type: SectionType,           # Tipo de secci√≥n
    enabled: bool = True,                # Si la secci√≥n est√° activa
    custom_content: str | None = None,   # Contenido para secciones CUSTOM
)
```

### LogoPosition (v0.2.3+)

Enum para posiciones del logo en el pie de p√°gina.

| Valor | Descripci√≥n |
|-------|-------------|
| `BOTTOM_RIGHT` | Esquina inferior derecha (default) |
| `BOTTOM_LEFT` | Esquina inferior izquierda |
| `BOTTOM_CENTER` | Centro inferior |

### AssetManager (v0.2.3+)

Clase para gesti√≥n de assets del paquete (uso avanzado).

```python
from qry_doc import AssetManager

# Obtener ruta al logo por defecto del paquete
default_logo = AssetManager.get_default_logo_path()

# Validar rutas de im√°genes
is_valid, error = AssetManager.validate_image_path(Path("imagen.png"))

# Validar rutas de fuentes
is_valid, error = AssetManager.validate_font_path(Path("fuente.ttf"))
```

### CoverBuilder (v0.1.5)

Constructor fluido para portadas din√°micas.

```python
CoverBuilder(page_size: tuple = letter)
```

**M√©todos:**

| M√©todo | Descripci√≥n | Retorno |
|--------|-------------|---------|
| `set_title(text, font_size, x, y, color, font_family, alignment)` | Configura el t√≠tulo | `CoverBuilder` |
| `set_subtitle(text, ...)` | Configura el subt√≠tulo | `CoverBuilder` |
| `set_date(date, format, ...)` | Configura la fecha | `CoverBuilder` |
| `set_author(name, ...)` | Configura el autor | `CoverBuilder` |
| `add_custom_text(text, x, y, ...)` | A√±ade texto personalizado | `CoverBuilder` |
| `set_background_image(path, opacity)` | Configura imagen de fondo | `CoverBuilder` |
| `set_background_color(color)` | Configura color de fondo | `CoverBuilder` |
| `build()` | Construye CoverConfig | `CoverConfig` |

### TemplateBuilder (v0.1.5)

Constructor fluido para templates de reportes.

```python
TemplateBuilder()
TemplateBuilder.from_preset(preset_type: ReportPresetType)  # Desde preset
```

**M√©todos:**

| M√©todo | Descripci√≥n | Retorno |
|--------|-------------|---------|
| `with_colors(primary, secondary)` | Configura colores | `TemplateBuilder` |
| `with_fonts(title_font, body_font)` | Configura fuentes | `TemplateBuilder` |
| `with_margins(top, bottom, left, right)` | Configura m√°rgenes | `TemplateBuilder` |
| `with_page_size(page_size)` | Configura tama√±o de p√°gina | `TemplateBuilder` |
| `with_header(logo_path, height)` | Configura encabezado | `TemplateBuilder` |
| `with_footer(logo_path, logo_position, ...)` | Configura pie de p√°gina | `TemplateBuilder` |
| `with_sections(sections)` | Configura secciones | `TemplateBuilder` |
| `with_cover(cover_image_path)` | Configura imagen de portada | `TemplateBuilder` |
| `with_charts(charts)` | Configura gr√°ficas (m√°x 10) | `TemplateBuilder` |
| `build()` | Construye ReportTemplate | `ReportTemplate` |

### ChartConfig (v0.1.5)

Configuraci√≥n para gr√°ficas individuales en reportes.

```python
ChartConfig(
    chart_type: str,           # 'bar', 'barh', 'line', 'pie', 'scatter', 'area'
    title: str,                # T√≠tulo de la gr√°fica
    data_query: str = None,    # Query opcional para datos
    group_by: str = None,      # Columna para agrupar
    value_column: str = None,  # Columna de valores
    color: str = None,         # Color hex (ej: "#003366")
    figsize: tuple = (10, 6),  # Tama√±o en pulgadas
)
```

**Tipos de gr√°fica soportados:** `bar`, `barh`, `line`, `pie`, `scatter`, `area`

### ReportPreset (v0.1.5)

Presets predefinidos por industria.

```python
ReportPreset.get(preset_type: ReportPresetType)  # Obtener preset
ReportPreset.list_all()  # Listar todos los presets
preset.to_template(**overrides)  # Convertir a ReportTemplate
```

**Tipos de preset:**

| Tipo | Descripci√≥n | Colores |
|------|-------------|---------|
| `FINANCIAL` | Banca e inversiones | Azul (#003366) |
| `HEALTHCARE` | Salud y farmac√©utica | Verde/Teal (#006666) |
| `TECHNOLOGY` | Software y TI | P√∫rpura (#5C2D91) |
| `RETAIL` | Comercio y ventas | Naranja (#E65100) |
| `MANUFACTURING` | Producci√≥n e industria | Gris (#455A64) |
| `CONSULTING` | Consultor√≠a y servicios | Azul marino (#1A237E) |

### AIBuilder (v0.1.5)

Agente inteligente para preparaci√≥n de datos con LangChain.

```python
AIBuilder(df: DataFrame, llm: Any, verbose: bool = False)
```

**M√©todos:**

| M√©todo | Descripci√≥n | Retorno |
|--------|-------------|---------|
| `get_data_summary()` | Resumen estructurado de datos | `DataSummary` |
| `suggest_charts(context)` | Sugiere gr√°ficas apropiadas | `list[ChartSuggestion]` |
| `prepare_report_data(description)` | Prepara datos para reporte | `dict` |
| `validate_query(query)` | Valida factibilidad de query | `tuple[bool, str]` |
| `ask(query)` | Pregunta sobre los datos | `str` |
| `clear_context()` | Limpia contexto de conversaci√≥n | `None` |

**Propiedades:**

| Propiedad | Descripci√≥n | Tipo |
|-----------|-------------|------|
| `dataframe` | DataFrame subyacente | `pd.DataFrame` |
| `has_langchain` | Si LangChain est√° disponible | `bool` |

### DataSummary (v0.1.5)

Resumen estructurado de un DataFrame.

```python
@dataclass
class DataSummary:
    columns: list[str]           # Nombres de columnas
    dtypes: dict[str, str]       # Tipos de datos
    shape: tuple[int, int]       # (filas, columnas)
    sample: dict[str, Any]       # Muestra de datos
    numeric_columns: list[str]   # Columnas num√©ricas
    categorical_columns: list[str]  # Columnas categ√≥ricas
    null_counts: dict[str, int]  # Conteo de nulos
```

### ChartSuggestion (v0.1.5)

Sugerencia de gr√°fica con razonamiento.

```python
@dataclass
class ChartSuggestion:
    config: ChartConfig    # Configuraci√≥n de la gr√°fica
    reasoning: str         # Raz√≥n de la sugerencia
    confidence: float      # Nivel de confianza (0.0 a 1.0)
```

### TextElement (v0.1.5)

Elemento de texto configurable para portadas.

```python
TextElement(
    content: str,                    # Contenido del texto
    x: float = 0.0,                  # Posici√≥n X en puntos
    y: float = 0.0,                  # Posici√≥n Y en puntos
    font_size: float = 12.0,         # Tama√±o de fuente
    font_family: str = "Helvetica",  # Familia de fuente
    color: str = "#000000",          # Color hex
    alignment: TextAlignment = LEFT, # Alineaci√≥n
    element_type: str = "custom",    # Tipo de elemento
)
```

### TextAlignment (v0.1.5)

Enum para alineaci√≥n de texto.

| Valor | Descripci√≥n |
|-------|-------------|
| `LEFT` | Alineaci√≥n izquierda |
| `CENTER` | Centrado |
| `RIGHT` | Alineaci√≥n derecha |

### Excepciones

| Excepci√≥n | Descripci√≥n |
|-----------|-------------|
| `QryDocError` | Excepci√≥n base para todos los errores |
| `QueryError` | Error al interpretar o ejecutar consulta |
| `ExportError` | Error al exportar datos |
| `ReportError` | Error al generar reporte PDF |
| `DataSourceError` | Error al cargar fuente de datos |
| `ValidationError` | Error de validaci√≥n de salidas |

Todas las excepciones incluyen:
- `user_message`: Mensaje amigable para mostrar al usuario
- `internal_error`: Excepci√≥n original para debugging

```python
from qry_doc import QryDoc, QueryError

try:
    respuesta = qry.ask("consulta ambigua")
except QueryError as e:
    print(f"Error: {e.user_message}")
    # Logging interno: e.internal_error
```

## Configuraci√≥n avanzada

### Variables de entorno

| Variable | Descripci√≥n |
|----------|-------------|
| `OPENAI_API_KEY` | API key de OpenAI (fallback) |

### Encoding de archivos

Por defecto, los CSV se exportan con encoding `utf-8-sig` (BOM) para compatibilidad con Excel. Esto asegura que caracteres especiales (√±, acentos, etc.) se muestren correctamente.

## Desarrollo

### Requisitos

- Python 3.11+
- [uv](https://docs.astral.sh/uv/) (gestor de paquetes)

### Setup

```bash
git clone https://github.com/danro-dev/qry-doc.git
cd qry-doc
uv sync --all-extras
```

### Tests

```bash
# Ejecutar todos los tests
uv run pytest

# Con cobertura
uv run pytest --cov=src/qry_doc --cov-report=html

# Tests espec√≠ficos
uv run pytest tests/property/test_qrydoc.py -v
```

### Estructura del proyecto

```
qry-doc/
‚îú‚îÄ‚îÄ src/qry_doc/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py          # Exports p√∫blicos
‚îÇ   ‚îú‚îÄ‚îÄ core.py              # QryDoc (Facade)
‚îÇ   ‚îú‚îÄ‚îÄ ai_adapter.py        # PandasAI adapter
‚îÇ   ‚îú‚îÄ‚îÄ ai_builder.py        # AIBuilder con LangChain (v0.1.5)
‚îÇ   ‚îú‚îÄ‚îÄ data_source.py       # Carga de datos
‚îÇ   ‚îú‚îÄ‚îÄ csv_exporter.py      # Exportaci√≥n CSV
‚îÇ   ‚îú‚îÄ‚îÄ report_generator.py  # Generaci√≥n PDF
‚îÇ   ‚îú‚îÄ‚îÄ report_template.py   # Templates de reportes
‚îÇ   ‚îú‚îÄ‚îÄ chart_manager.py     # Gesti√≥n de gr√°ficos
‚îÇ   ‚îú‚îÄ‚îÄ chart_config.py      # ChartConfig para multi-gr√°ficas (v0.1.5)
‚îÇ   ‚îú‚îÄ‚îÄ cover_builder.py     # CoverBuilder para portadas (v0.1.5)
‚îÇ   ‚îú‚îÄ‚îÄ template_builder.py  # TemplateBuilder fluido (v0.1.5)
‚îÇ   ‚îú‚îÄ‚îÄ report_preset.py     # ReportPresets por industria (v0.1.5)
‚îÇ   ‚îú‚îÄ‚îÄ text_element.py      # TextElement para portadas (v0.1.5)
‚îÇ   ‚îú‚îÄ‚îÄ asset_manager.py     # Gesti√≥n de assets (v0.2.3+)
‚îÇ   ‚îú‚îÄ‚îÄ validators.py        # Validaci√≥n y sanitizaci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ exceptions.py        # Jerarqu√≠a de excepciones
‚îÇ   ‚îî‚îÄ‚îÄ assets/              # Assets del paquete (v0.2.3+)
‚îÇ       ‚îî‚îÄ‚îÄ default_logo.png # Logo por defecto
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îú‚îÄ‚îÄ conftest.py          # Fixtures compartidos
‚îÇ   ‚îî‚îÄ‚îÄ property/            # Property-based tests
‚îú‚îÄ‚îÄ docs/                    # Documentaci√≥n adicional
‚îú‚îÄ‚îÄ pyproject.toml
‚îî‚îÄ‚îÄ README.md
```

## Roadmap

- [ ] Soporte para conexiones SQL (PostgreSQL, MySQL, SQLite)
- [ ] Cach√© de consultas para mejorar rendimiento
- [ ] Exportaci√≥n a Excel (.xlsx)
- [ ] M√°s templates predefinidos
- [ ] CLI para uso desde terminal
- [ ] Integraci√≥n con Jupyter notebooks

## Contribuir

¬°Las contribuciones son bienvenidas! Por favor:

1. Fork el repositorio
2. Crea una rama para tu feature (`git checkout -b feature/nueva-funcionalidad`)
3. Commit tus cambios (`git commit -m 'feat: agregar nueva funcionalidad'`)
4. Push a la rama (`git push origin feature/nueva-funcionalidad`)
5. Abre un Pull Request

## Licencia

GPL-3.0 License - ver [LICENSE](LICENSE) para m√°s detalles.

---

<p align="center">
  Hecho con ‚ù§Ô∏è por <a href="https://github.com/danro-dev">danro-dev</a>
</p>
