"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[472],{1603:(e,t,a)=>{a.d(t,{A:()=>w});var s=a(8629),n=a(5557),l=a(9854),r=a(4586),i=a(5961),o=a(5702),d=a(5329),c=a(2959),u=a(4001),m=a(2499),x=a(8396),g=a(2262),h=a(1573);function p(e){let{className:t,...a}=e;return(0,s.jsx)("textarea",{"data-slot":"textarea",className:(0,h.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...a})}var f=a(6076),v=a(8642),j=a(6009),b=a(5144),y=a(1200);function w(e){var t,a;let{config:h,field:w,onFileUploaded:N}=e,[C,k]=(0,d.useState)([]),[_,L]=(0,d.useState)([]),[E,H]=(0,d.useState)([]),[V,T]=(0,d.useState)([]),[P,S]=(0,d.useState)(!1),[O,R]=(0,d.useState)(!1),[z,M]=(0,d.useState)([]),[B,Z]=(0,d.useState)(null),{t:A}=(0,x.Bd)(),I=async e=>{if(e.size>0xa00000)return u.oR.error(A("plugins.fileUpload.tooLarge")),null;try{S(!0);let t=await c.ok.uploadPluginConfigFile(e);return u.oR.success(A("plugins.fileUpload.success")),null==N||N(t.file_key),{file_key:t.file_key,mimetype:e.type}}catch(e){return u.oR.error(A("plugins.fileUpload.failed")+": "+e.message),null}finally{S(!1)}};switch((0,d.useEffect)(()=>{h.type===n.P.LLM_MODEL_SELECTOR&&c.ok.getProviderLLMModels().then(e=>{k(e.models)}).catch(e=>{u.oR.error("Failed to get LLM model list: "+e.message)})},[h.type]),(0,d.useEffect)(()=>{(h.type===n.P.KNOWLEDGE_BASE_SELECTOR||h.type===n.P.KNOWLEDGE_BASE_MULTI_SELECTOR)&&(c.ok.getKnowledgeBases().then(e=>{L(e.bases)}).catch(e=>{u.oR.error("Failed to get knowledge base list: "+e.message)}),c.ok.getPluginSystemStatus().then(e=>{Z(e)}).catch(e=>{console.error("Failed to get plugin system status:",e)}))},[h.type]),(0,d.useEffect)(()=>{(h.type===n.P.KNOWLEDGE_BASE_SELECTOR||h.type===n.P.KNOWLEDGE_BASE_MULTI_SELECTOR)&&(null==B?void 0:B.is_enable)&&(null==B?void 0:B.is_connected)&&c.ok.getExternalKnowledgeBases().then(e=>{H(e.bases)}).catch(e=>{console.error("Failed to get external knowledge base list:",e)})},[h.type,B]),(0,d.useEffect)(()=>{h.type===n.P.BOT_SELECTOR&&c.ok.getBots().then(e=>{T(e.bots)}).catch(e=>{u.oR.error("Failed to get bot list: "+e.message)})},[h.type]),h.type){case n.P.INT:case n.P.FLOAT:return(0,s.jsx)(l.p,{type:"number",...w,onChange:e=>w.onChange(Number(e.target.value))});case n.P.STRING:return(0,s.jsx)(l.p,{...w});case n.P.TEXT:return(0,s.jsx)(p,{...w,className:"min-h-[120px]"});case n.P.BOOLEAN:return(0,s.jsx)(i.d,{checked:w.value,onCheckedChange:w.onChange});case n.P.STRING_ARRAY:return(0,s.jsxs)("div",{className:"space-y-2",children:[w.value.map((e,t)=>(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,s.jsx)(l.p,{className:"w-[200px]",value:e,onChange:e=>{let a=[...w.value];a[t]=e.target.value,w.onChange(a)}}),(0,s.jsx)("button",{type:"button",className:"p-2 hover:bg-gray-100 rounded",onClick:()=>{let e=w.value.filter((e,a)=>a!==t);w.onChange(e)},children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-5 h-5 text-red-500",children:(0,s.jsx)("path",{d:"M7 4V2H17V4H22V6H20V21C20 21.5523 19.5523 22 19 22H5C4.44772 22 4 21.5523 4 21V6H2V4H7ZM6 6V20H18V6H6ZM9 9H11V17H9V9ZM13 9H15V17H13V9Z"})})})]},t)),(0,s.jsx)(o.$,{type:"button",variant:"outline",onClick:()=>{w.onChange([...w.value,""])},children:A("common.add")})]});case n.P.SELECT:return(0,s.jsxs)(r.l6,{value:w.value,onValueChange:w.onChange,children:[(0,s.jsx)(r.bq,{className:"bg-[#ffffff] dark:bg-[#2a2a2e]",children:(0,s.jsx)(r.yv,{placeholder:A("common.select")})}),(0,s.jsx)(r.gC,{children:(0,s.jsx)(r.s3,{children:null==(t=h.options)?void 0:t.map(e=>(0,s.jsx)(r.eb,{value:e.name,children:(0,g.Z)(e.label)},e.name))})})]});case n.P.LLM_MODEL_SELECTOR:return(0,s.jsxs)(r.l6,{value:w.value,onValueChange:w.onChange,children:[(0,s.jsx)(r.bq,{className:"bg-[#ffffff] dark:bg-[#2a2a2e]",children:(0,s.jsx)(r.yv,{placeholder:A("models.selectModel")})}),(0,s.jsx)(r.gC,{children:(0,s.jsx)(r.s3,{children:C.map(e=>(0,s.jsxs)(m.jc,{openDelay:0,closeDelay:0,children:[(0,s.jsx)(m.d0,{asChild:!0,children:(0,s.jsx)(r.eb,{value:e.uuid,children:e.name})}),(0,s.jsx)(m.Et,{className:"w-80 data-[state=open]:animate-none data-[state=closed]:animate-none",align:"end",side:"right",sideOffset:10,children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("img",{src:c.ok.getProviderRequesterIconURL(e.requester),alt:"icon",className:"w-8 h-8 rounded-[8%]"}),(0,s.jsx)("h4",{className:"font-medium",children:e.name})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:e.description}),e.requester_config&&(0,s.jsxs)("div",{className:"flex items-center gap-1 text-xs",children:[(0,s.jsx)("svg",{className:"w-4 h-4 text-gray-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:(0,s.jsx)("path",{d:"M13.0607 8.11097L14.4749 9.52518C17.2086 12.2589 17.2086 16.691 14.4749 19.4247L14.1214 19.7782C11.3877 22.5119 6.95555 22.5119 4.22188 19.7782C1.48821 17.0446 1.48821 12.6124 4.22188 9.87874L5.6361 11.293C3.68348 13.2456 3.68348 16.4114 5.6361 18.364C7.58872 20.3166 10.7545 20.3166 12.7072 18.364L13.0607 18.0105C15.0133 16.0578 15.0133 12.892 13.0607 10.9394L11.6465 9.52518L13.0607 8.11097ZM19.7782 14.1214L18.364 12.7072C20.3166 10.7545 20.3166 7.58872 18.364 5.6361C16.4114 3.68348 13.2456 3.68348 11.293 5.6361L10.9394 5.98965C8.98678 7.94227 8.98678 11.1081 10.9394 13.0607L12.3536 14.4749L10.9394 15.8891L9.52518 14.4749C6.79151 11.7413 6.79151 7.30911 9.52518 4.57544L9.87874 4.22188C12.6124 1.48821 17.0446 1.48821 19.7782 4.22188C22.5119 6.95555 22.5119 11.3877 19.7782 14.1214Z"})}),(0,s.jsx)("span",{className:"font-semibold",children:"Base URL："}),e.requester_config.base_url]}),e.abilities&&e.abilities.length>0&&(0,s.jsx)("div",{className:"flex flex-wrap gap-1",children:e.abilities.map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-1 px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-600",children:["vision"===e&&(0,s.jsx)("svg",{className:"w-3 h-3",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:(0,s.jsx)("path",{d:"M12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2ZM12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM12 7C14.7614 7 17 9.23858 17 12C17 14.7614 14.7614 17 12 17C9.23858 17 7 14.7614 7 12C7 11.4872 7.07719 10.9925 7.22057 10.5268C7.61175 11.3954 8.48527 12 9.5 12C10.8807 12 12 10.8807 12 9.5C12 8.48527 11.3954 7.61175 10.5269 7.21995C10.9925 7.07719 11.4872 7 12 7Z"})}),"func_call"===e&&(0,s.jsx)("svg",{className:"w-3 h-3",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:(0,s.jsx)("path",{d:"M5.32943 3.27158C6.56252 2.8332 7.9923 3.10749 8.97927 4.09446C10.1002 5.21537 10.3019 6.90741 9.5843 8.23385L20.293 18.9437L18.8788 20.3579L8.16982 9.64875C6.84325 10.3669 5.15069 10.1654 4.02952 9.04421C3.04227 8.05696 2.7681 6.62665 3.20701 5.39332L5.44373 7.63C6.02952 8.21578 6.97927 8.21578 7.56505 7.63C8.15084 7.04421 8.15084 6.09446 7.56505 5.50868L5.32943 3.27158ZM15.6968 5.15512L18.8788 3.38736L20.293 4.80157L18.5252 7.98355L16.7574 8.3371L14.6361 10.4584L13.2219 9.04421L15.3432 6.92289L15.6968 5.15512ZM8.97927 13.2868L10.3935 14.7011L5.09018 20.0044C4.69966 20.3949 4.06649 20.3949 3.67597 20.0044C3.31334 19.6417 3.28744 19.0699 3.59826 18.6774L3.67597 18.5902L8.97927 13.2868Z"})}),(0,s.jsx)("span",{children:"vision"===e?A("models.visionAbility"):"func_call"===e?A("models.functionCallAbility"):e})]},e))}),e.extra_args&&Object.keys(e.extra_args).length>0&&(0,s.jsxs)("div",{className:"text-xs",children:[(0,s.jsx)("div",{className:"font-semibold mb-1",children:A("models.extraParameters")}),(0,s.jsx)("div",{className:"space-y-1",children:Object.entries(e.extra_args).map(e=>{let[t,a]=e;return(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsxs)("span",{className:"text-gray-500",children:[t,"："]}),(0,s.jsx)("span",{className:"break-all",children:JSON.stringify(a)})]},t)})})]})]})})]},e.uuid))})})]});case n.P.KNOWLEDGE_BASE_SELECTOR:return(0,s.jsxs)(r.l6,{value:w.value,onValueChange:w.onChange,children:[(0,s.jsx)(r.bq,{className:"bg-[#ffffff] dark:bg-[#2a2a2e]",children:(0,s.jsx)(r.yv,{placeholder:A("knowledge.selectKnowledgeBase")})}),(0,s.jsxs)(r.gC,{children:[(0,s.jsx)(r.s3,{children:(0,s.jsx)(r.eb,{value:"__none__",children:A("knowledge.empty")})}),_.length>0&&(0,s.jsxs)(r.s3,{children:[(0,s.jsx)(r.TR,{children:A("knowledge.builtIn")}),_.map(e=>{var t;return(0,s.jsx)(r.eb,{value:null!=(t=e.uuid)?t:"",children:e.name},e.uuid)})]}),E.length>0&&(0,s.jsxs)(r.s3,{children:[(0,s.jsx)(r.TR,{children:A("knowledge.external")}),E.map(e=>{var t;return(0,s.jsx)(r.eb,{value:null!=(t=e.uuid)?t:"",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("img",{src:c.ok.getPluginIconURL(e.plugin_author,e.plugin_name),alt:"plugin icon",className:"w-4 h-4 rounded-[8%] flex-shrink-0"}),(0,s.jsx)("span",{children:e.name})]})},e.uuid)})]})]})]});case n.P.KNOWLEDGE_BASE_MULTI_SELECTOR:return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"space-y-2",children:w.value&&w.value.length>0?(0,s.jsx)("div",{className:"space-y-2",children:w.value.map(e=>{let t=_.find(t=>t.uuid===e),a=E.find(t=>t.uuid===e),n=t||a;return n?(0,s.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-3 hover:bg-accent",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-1",children:[a&&(0,s.jsx)("img",{src:c.ok.getPluginIconURL(a.plugin_author,a.plugin_name),alt:"plugin icon",className:"w-8 h-8 rounded-[8%] flex-shrink-0"}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("div",{className:"font-medium",children:n.name}),n.description&&(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:n.description})]})]}),(0,s.jsx)(o.$,{type:"button",variant:"ghost",size:"icon",onClick:()=>{let t=w.value.filter(t=>t!==e);w.onChange(t)},children:(0,s.jsx)(b.A,{className:"h-4 w-4"})})]},e):null})}):(0,s.jsx)("div",{className:"flex h-32 items-center justify-center rounded-lg border-2 border-dashed border-border",children:(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:A("knowledge.noKnowledgeBaseSelected")})})}),(0,s.jsxs)(o.$,{type:"button",onClick:()=>{M(w.value||[]),R(!0)},variant:"outline",className:"w-full",children:[(0,s.jsx)(y.A,{className:"mr-2 h-4 w-4"}),A("knowledge.addKnowledgeBase")]}),(0,s.jsx)(v.lG,{open:O,onOpenChange:R,children:(0,s.jsxs)(v.Cf,{className:"max-w-2xl max-h-[80vh] overflow-hidden flex flex-col",children:[(0,s.jsx)(v.c7,{children:(0,s.jsx)(v.L3,{children:A("knowledge.selectKnowledgeBases")})}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto space-y-4 pr-2",children:[_.length>0&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"text-sm font-semibold text-muted-foreground px-2",children:A("knowledge.builtIn")}),_.map(e=>{var t;let a=z.includes(null!=(t=e.uuid)?t:"");return(0,s.jsxs)("div",{className:"flex items-center gap-3 rounded-lg border p-3 hover:bg-accent cursor-pointer",onClick:()=>{var t;let a=null!=(t=e.uuid)?t:"";M(e=>e.includes(a)?e.filter(e=>e!==a):[...e,a])},children:[(0,s.jsx)(j.S,{checked:a,"aria-label":"Select ".concat(e.name)}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"font-medium",children:e.name}),e.description&&(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:e.description})]})]},e.uuid)})]}),E.length>0&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"text-sm font-semibold text-muted-foreground px-2",children:A("knowledge.external")}),E.map(e=>{var t;let a=z.includes(null!=(t=e.uuid)?t:"");return(0,s.jsxs)("div",{className:"flex items-center gap-3 rounded-lg border p-3 hover:bg-accent cursor-pointer",onClick:()=>{var t;let a=null!=(t=e.uuid)?t:"";M(e=>e.includes(a)?e.filter(e=>e!==a):[...e,a])},children:[(0,s.jsx)(j.S,{checked:a,"aria-label":"Select ".concat(e.name)}),(0,s.jsx)("img",{src:c.ok.getPluginIconURL(e.plugin_author,e.plugin_name),alt:"plugin icon",className:"w-8 h-8 rounded-[8%] flex-shrink-0"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"font-medium",children:e.name}),e.description&&(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:e.description})]})]},e.uuid)})]})]}),(0,s.jsxs)(v.Es,{children:[(0,s.jsx)(o.$,{variant:"outline",onClick:()=>R(!1),children:A("common.cancel")}),(0,s.jsx)(o.$,{onClick:()=>{w.onChange(z),R(!1)},children:A("common.confirm")})]})]})})]});case n.P.BOT_SELECTOR:return(0,s.jsxs)(r.l6,{value:w.value,onValueChange:w.onChange,children:[(0,s.jsx)(r.bq,{className:"bg-[#ffffff] dark:bg-[#2a2a2e]",children:(0,s.jsx)(r.yv,{placeholder:A("bots.selectBot")})}),(0,s.jsx)(r.gC,{children:(0,s.jsx)(r.s3,{children:V.map(e=>{var t;return(0,s.jsx)(r.eb,{value:null!=(t=e.uuid)?t:"",children:e.name},e.uuid)})})})]});case n.P.PROMPT_EDITOR:return(0,s.jsxs)("div",{className:"space-y-2",children:[w.value.map((e,t)=>(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[0===t?(0,s.jsx)("div",{className:"w-[120px] px-3 py-2 border rounded bg-gray-50 dark:bg-[#2a292e] text-gray-500 dark:text-white dark:border-gray-600",children:"system"}):(0,s.jsxs)(r.l6,{value:e.role,onValueChange:e=>{let a=[...w.value];a[t]={...a[t],role:e},w.onChange(a)},children:[(0,s.jsx)(r.bq,{className:"w-[120px] bg-[#ffffff] dark:bg-[#2a2a2e]",children:(0,s.jsx)(r.yv,{})}),(0,s.jsx)(r.gC,{children:(0,s.jsxs)(r.s3,{children:[(0,s.jsx)(r.eb,{value:"user",children:"user"}),(0,s.jsx)(r.eb,{value:"assistant",children:"assistant"})]})})]}),(0,s.jsx)(p,{className:"w-[300px]",value:e.content,onChange:e=>{let a=[...w.value];a[t]={...a[t],content:e.target.value},w.onChange(a)}}),0!==t&&(0,s.jsx)("button",{type:"button",className:"p-2 hover:bg-gray-100 rounded",onClick:()=>{let e=w.value.filter((e,a)=>a!==t);w.onChange(e)},children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-5 h-5 text-red-500",children:(0,s.jsx)("path",{d:"M7 4V2H17V4H22V6H20V21C20 21.5523 19.5523 22 19 22H5C4.44772 22 4 21.5523 4 21V6H2V4H7ZM6 6V20H18V6H6ZM9 9H11V17H9V9ZM13 9H15V17H13V9Z"})})})]},t)),(0,s.jsx)(o.$,{type:"button",variant:"outline",onClick:()=>{w.onChange([...w.value,{role:"user",content:""}])},children:A("common.addRound")})]});case n.P.FILE:return(0,s.jsx)("div",{className:"space-y-2",children:w.value&&w.value.file_key?(0,s.jsx)(f.Zp,{className:"py-3 max-w-full overflow-hidden bg-gray-900",children:(0,s.jsxs)(f.Wu,{className:"flex items-center gap-3 p-0 px-4 min-w-0",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0 overflow-hidden",children:[(0,s.jsx)("div",{className:"text-sm font-medium truncate",title:w.value.file_key,children:w.value.file_key}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground truncate",children:w.value.mimetype})]}),(0,s.jsx)(o.$,{type:"button",variant:"ghost",size:"sm",className:"flex-shrink-0 h-8 w-8 p-0",onClick:e=>{e.preventDefault(),e.stopPropagation(),w.onChange(null)},title:A("common.delete"),children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-4 h-4 text-destructive",children:(0,s.jsx)("path",{d:"M7 4V2H17V4H22V6H20V21C20 21.5523 19.5523 22 19 22H5C4.44772 22 4 21.5523 4 21V6H2V4H7ZM6 6V20H18V6H6ZM9 9H11V17H9V9ZM13 9H15V17H13V9Z"})})})]})}):(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{type:"file",accept:h.accept,disabled:P,onChange:async e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];if(a){let e=await I(a);e&&w.onChange(e)}e.target.value=""},className:"hidden",id:"file-input-".concat(h.name)}),(0,s.jsxs)(o.$,{type:"button",variant:"outline",size:"sm",disabled:P,onClick:()=>{var e;return null==(e=document.getElementById("file-input-".concat(h.name)))?void 0:e.click()},children:[(0,s.jsx)("svg",{className:"w-4 h-4 mr-2",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:(0,s.jsx)("path",{d:"M11 11V5H13V11H19V13H13V19H11V13H5V11H11Z"})}),P?A("plugins.fileUpload.uploading"):A("plugins.fileUpload.chooseFile")]})]})});case n.P.FILE_ARRAY:return(0,s.jsxs)("div",{className:"space-y-2",children:[null==(a=w.value)?void 0:a.map((e,t)=>(0,s.jsx)(f.Zp,{className:"py-3 max-w-full overflow-hidden bg-gray-900",children:(0,s.jsxs)(f.Wu,{className:"flex items-center gap-3 p-0 px-4 min-w-0",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0 overflow-hidden",children:[(0,s.jsx)("div",{className:"text-sm font-medium truncate",title:e.file_key,children:e.file_key}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground truncate",children:e.mimetype})]}),(0,s.jsx)(o.$,{type:"button",variant:"ghost",size:"sm",className:"flex-shrink-0 h-8 w-8 p-0",onClick:e=>{e.preventDefault(),e.stopPropagation();let a=w.value.filter((e,a)=>a!==t);w.onChange(a)},title:A("common.delete"),children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-4 h-4 text-destructive",children:(0,s.jsx)("path",{d:"M7 4V2H17V4H22V6H20V21C20 21.5523 19.5523 22 19 22H5C4.44772 22 4 21.5523 4 21V6H2V4H7ZM6 6V20H18V6H6ZM9 9H11V17H9V9ZM13 9H15V17H13V9Z"})})})]})},t)),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{type:"file",accept:h.accept,disabled:P,onChange:async e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];if(a){let e=await I(a);e&&w.onChange([...w.value||[],e])}e.target.value=""},className:"hidden",id:"file-array-input-".concat(h.name)}),(0,s.jsxs)(o.$,{type:"button",variant:"outline",size:"sm",disabled:P,onClick:()=>{var e;return null==(e=document.getElementById("file-array-input-".concat(h.name)))?void 0:e.click()},children:[(0,s.jsx)("svg",{className:"w-4 h-4 mr-2",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:(0,s.jsx)("path",{d:"M11 11V5H13V11H19V13H13V19H11V13H5V11H11Z"})}),P?A("plugins.fileUpload.uploading"):A("plugins.fileUpload.addFile")]})]})]});default:return(0,s.jsx)(l.p,{...w})}}},2262:(e,t,a)=>{a.d(t,{W:()=>i,Z:()=>r,default:()=>l});var s=a(8629);a(7048);var n=a(9941);function l(e){let{children:t}=e;return(0,s.jsx)(s.Fragment,{children:t})}let r=e=>{let t=n.Ay.language.replace("-","_");return"en_US"===t&&e.en_US?e.en_US:"zh_Hans"===t&&e.zh_Hans?e.zh_Hans:"zh_Hant"===t&&e.zh_Hant?e.zh_Hant:"ja_JP"===t&&e.ja_JP?e.ja_JP:e.en_US||e.zh_Hans||e.zh_Hant||e.ja_JP||""},i=()=>{let e=n.Ay.language;return"zh-Hans"===e?"zh_Hans":"zh-Hant"===e?"zh_Hant":"en-US"===e?"en":"ja-JP"===e?"ja_JP":"en"}},2472:(e,t,a)=>{a.d(t,{A:()=>u});var s=a(8629),n=a(8893),l=a(3850),r=a(2985),i=a(4996),o=a(1603),d=a(5329),c=a(2262);function u(e){let{itemConfigList:t,onSubmit:a,initialValues:u,onFileUploaded:m}=e,x=(0,d.useRef)(!0),g=(0,d.useRef)(u),h=r.Ik(t.reduce((e,t)=>{let a;switch(t.type){case"integer":case"float":a=r.ai();break;case"boolean":a=r.zM();break;case"string":case"select":case"llm-model-selector":case"knowledge-base-selector":case"bot-selector":default:a=r.Yj();break;case"array[string]":case"knowledge-base-multi-selector":a=r.YO(r.Yj());break;case"prompt-editor":a=r.YO(r.Ik({content:r.Yj(),role:r.Yj()}))}return t.required&&(a instanceof r.ND||a instanceof r.n)&&(a=a.min(1,{message:"此字段为必填项"})),{...e,[t.name]:a}},{})),p=(0,n.mN)({resolver:(0,l.u)(h),defaultValues:t.reduce((e,t)=>{var a;let s=null!=(a=null==u?void 0:u[t.name])?a:t.default;return{...e,[t.name]:s}},{})});return(0,d.useEffect)(()=>{if(x.current){x.current=!1,g.current=u;return}let e=JSON.stringify(g.current)!==JSON.stringify(u);u&&e&&(Object.entries(t.reduce((e,t)=>{var a;return e[t.name]=null!=(a=u[t.name])?a:t.default,e},{})).forEach(e=>{let[t,a]=e;p.setValue(t,a)}),g.current=u)},[u,p,t]),(0,d.useEffect)(()=>{let e=p.watch(()=>{let e=p.getValues(),s=t.reduce((t,a)=>{var s;return t[a.name]=null!=(s=e[a.name])?s:a.default,t},{});null==a||a(s)});return()=>e.unsubscribe()},[p,a,t]),(0,s.jsx)(i.lV,{...p,children:(0,s.jsx)("div",{className:"space-y-4",children:t.map(e=>(0,s.jsx)(i.zB,{control:p.control,name:e.name,render:t=>{let{field:a}=t;return(0,s.jsxs)(i.eI,{children:[(0,s.jsxs)(i.lR,{children:[(0,c.Z)(e.label)," ",e.required&&(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)(i.MJ,{children:(0,s.jsx)(o.A,{config:e,field:a,onFileUploaded:m})}),e.description&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:(0,c.Z)(e.description)}),(0,s.jsx)(i.C5,{})]})}},e.id))})})}},2499:(e,t,a)=>{a.d(t,{Et:()=>o,d0:()=>i,jc:()=>r});var s=a(8629);a(5329);var n=a(5261),l=a(1573);function r(e){let{...t}=e;return(0,s.jsx)(n.bL,{"data-slot":"hover-card",...t})}function i(e){let{...t}=e;return(0,s.jsx)(n.l9,{"data-slot":"hover-card-trigger",...t})}function o(e){let{className:t,align:a="center",sideOffset:r=4,...i}=e;return(0,s.jsx)(n.ZL,{"data-slot":"hover-card-portal",children:(0,s.jsx)(n.UC,{"data-slot":"hover-card-content",align:a,sideOffset:r,className:(0,l.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-64 origin-(--radix-hover-card-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",t),...i})})}},4586:(e,t,a)=>{a.d(t,{TR:()=>g,bq:()=>m,eb:()=>h,gC:()=>x,l6:()=>d,s3:()=>c,yv:()=>u});var s=a(8629);a(5329);var n=a(5771),l=a(9490),r=a(7444),i=a(5407),o=a(1573);function d(e){let{...t}=e;return(0,s.jsx)(n.bL,{"data-slot":"select",...t})}function c(e){let{...t}=e;return(0,s.jsx)(n.YJ,{"data-slot":"select-group",...t})}function u(e){let{...t}=e;return(0,s.jsx)(n.WT,{"data-slot":"select-value",...t})}function m(e){let{className:t,size:a="default",children:r,...i}=e;return(0,s.jsxs)(n.l9,{"data-slot":"select-trigger","data-size":a,className:(0,o.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...i,children:[r,(0,s.jsx)(n.In,{asChild:!0,children:(0,s.jsx)(l.A,{className:"size-4 opacity-50"})})]})}function x(e){let{className:t,children:a,position:l="popper",...r}=e;return(0,s.jsx)(n.ZL,{children:(0,s.jsxs)(n.UC,{"data-slot":"select-content",className:(0,o.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:l,...r,children:[(0,s.jsx)(p,{}),(0,s.jsx)(n.LM,{className:(0,o.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:a}),(0,s.jsx)(f,{})]})})}function g(e){let{className:t,...a}=e;return(0,s.jsx)(n.JU,{"data-slot":"select-label",className:(0,o.cn)("text-muted-foreground px-2 py-1.5 text-xs",t),...a})}function h(e){let{className:t,children:a,...l}=e;return(0,s.jsxs)(n.q7,{"data-slot":"select-item",className:(0,o.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...l,children:[(0,s.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,s.jsx)(n.VF,{children:(0,s.jsx)(r.A,{className:"size-4"})})}),(0,s.jsx)(n.p4,{children:a})]})}function p(e){let{className:t,...a}=e;return(0,s.jsx)(n.PP,{"data-slot":"select-scroll-up-button",className:(0,o.cn)("flex cursor-default items-center justify-center py-1",t),...a,children:(0,s.jsx)(i.A,{className:"size-4"})})}function f(e){let{className:t,...a}=e;return(0,s.jsx)(n.wn,{"data-slot":"select-scroll-down-button",className:(0,o.cn)("flex cursor-default items-center justify-center py-1",t),...a,children:(0,s.jsx)(l.A,{className:"size-4"})})}},5557:(e,t,a)=>{a.d(t,{P:()=>s});var s=function(e){return e.INT="integer",e.FLOAT="float",e.BOOLEAN="boolean",e.STRING="string",e.TEXT="text",e.STRING_ARRAY="array[string]",e.FILE="file",e.FILE_ARRAY="array[file]",e.SELECT="select",e.LLM_MODEL_SELECTOR="llm-model-selector",e.PROMPT_EDITOR="prompt-editor",e.UNKNOWN="unknown",e.KNOWLEDGE_BASE_SELECTOR="knowledge-base-selector",e.KNOWLEDGE_BASE_MULTI_SELECTOR="knowledge-base-multi-selector",e.PLUGIN_SELECTOR="plugin-selector",e.BOT_SELECTOR="bot-selector",e}({})},5961:(e,t,a)=>{a.d(t,{d:()=>r});var s=a(8629);a(5329);var n=a(58),l=a(1573);function r(e){let{className:t,...a}=e;return(0,s.jsx)(n.bL,{"data-slot":"switch",className:(0,l.cn)("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...a,children:(0,s.jsx)(n.zi,{"data-slot":"switch-thumb",className:(0,l.cn)("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}},6009:(e,t,a)=>{a.d(t,{S:()=>i});var s=a(8629);a(5329);var n=a(5462),l=a(7444),r=a(1573);function i(e){let{className:t,...a}=e;return(0,s.jsx)(n.bL,{"data-slot":"checkbox",className:(0,r.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...a,children:(0,s.jsx)(n.C1,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:(0,s.jsx)(l.A,{className:"size-3.5"})})})}},6076:(e,t,a)=>{a.d(t,{BT:()=>o,Wu:()=>d,ZB:()=>i,Zp:()=>l,aR:()=>r});var s=a(8629);a(5329);var n=a(1573);function l(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card",className:(0,n.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...a})}function r(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-header",className:(0,n.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...a})}function i(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-title",className:(0,n.cn)("leading-none font-semibold",t),...a})}function o(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-description",className:(0,n.cn)("text-muted-foreground text-sm",t),...a})}function d(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-content",className:(0,n.cn)("px-6",t),...a})}},8642:(e,t,a)=>{a.d(t,{Cf:()=>u,Es:()=>x,L3:()=>g,c7:()=>m,lG:()=>o,rr:()=>h});var s=a(8629),n=a(5329),l=a(9455),r=a(5144),i=a(1573);function o(e){let{onOpenChange:t,open:a,...r}=e,i=n.useCallback(e=>{null==t||t(e),e||(document.body.style.removeProperty("pointer-events"),document.body.style.removeProperty("overflow"),setTimeout(()=>{document.body.style.removeProperty("pointer-events"),document.body.style.removeProperty("overflow")},0),setTimeout(()=>{document.body.style.removeProperty("pointer-events"),document.body.style.removeProperty("overflow")},50),setTimeout(()=>{document.body.style.removeProperty("pointer-events"),document.body.style.removeProperty("overflow")},150))},[t]);return n.useEffect(()=>{if(!1===a){let e=()=>{document.body.style.removeProperty("pointer-events"),document.body.style.removeProperty("overflow")};e();let t=setTimeout(e,0),a=setTimeout(e,50),s=setTimeout(e,150),n=setTimeout(e,300);return()=>{clearTimeout(t),clearTimeout(a),clearTimeout(s),clearTimeout(n)}}},[a]),(0,s.jsx)(l.bL,{"data-slot":"dialog",open:a,...r,onOpenChange:i})}function d(e){let{...t}=e;return(0,s.jsx)(l.ZL,{"data-slot":"dialog-portal",...t})}function c(e){let{className:t,...a}=e;return(0,s.jsx)(l.hJ,{"data-slot":"dialog-overlay",className:(0,i.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a})}function u(e){let{className:t,children:a,...n}=e;return(0,s.jsxs)(d,{"data-slot":"dialog-portal",children:[(0,s.jsx)(c,{}),(0,s.jsxs)(l.UC,{"data-slot":"dialog-content",className:(0,i.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...n,children:[a,(0,s.jsxs)(l.bm,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,s.jsx)(r.A,{}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function m(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"dialog-header",className:(0,i.cn)("flex flex-col gap-2 text-center sm:text-left",t),...a})}function x(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"dialog-footer",className:(0,i.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...a})}function g(e){let{className:t,...a}=e;return(0,s.jsx)(l.hE,{"data-slot":"dialog-title",className:(0,i.cn)("text-lg leading-none font-semibold",t),...a})}function h(e){let{className:t,...a}=e;return(0,s.jsx)(l.VY,{"data-slot":"dialog-description",className:(0,i.cn)("text-muted-foreground text-sm",t),...a})}}}]);