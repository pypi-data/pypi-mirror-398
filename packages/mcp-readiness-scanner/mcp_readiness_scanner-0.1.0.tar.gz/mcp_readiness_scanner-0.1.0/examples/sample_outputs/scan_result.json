{
  "target": "examples/sample_tool_definitions/bad_tool.json",
  "findings": [
    {
      "category": "missing_timeout_guard",
      "severity": "high",
      "title": "No timeout configuration",
      "description": "Tool 'do_everything' does not specify a timeout. Operations may hang indefinitely if external services become unresponsive.",
      "location": "tool.do_everything",
      "evidence": null,
      "provider": "heuristic",
      "remediation": "Add a 'timeout' or 'timeoutMs' field with a reasonable value (e.g., 30000 for 30 seconds)",
      "rule_id": "HEUR-001"
    },
    {
      "category": "unsafe_retry_loop",
      "severity": "medium",
      "title": "No retry limit configured",
      "description": "Tool 'do_everything' does not specify a retry limit. Without limits, retry logic may cause resource exhaustion or infinite loops.",
      "location": "tool.do_everything",
      "evidence": null,
      "provider": "heuristic",
      "remediation": "Add a 'maxRetries' or 'retryLimit' field with a reasonable value (e.g., 3)",
      "rule_id": "HEUR-003"
    },
    {
      "category": "overloaded_tool_scope",
      "severity": "medium",
      "title": "Excessive capabilities",
      "description": "Tool 'do_everything' has 12 capabilities, exceeding the recommended maximum of 10. Tools with many capabilities are harder to test, secure, and maintain.",
      "location": "tool.do_everything.capabilities",
      "evidence": {
        "count": 12,
        "threshold": 10
      },
      "provider": "heuristic",
      "remediation": "Consider splitting into multiple focused tools, each with a specific set of related capabilities",
      "rule_id": "HEUR-006"
    },
    {
      "category": "missing_error_schema",
      "severity": "medium",
      "title": "No error response schema",
      "description": "Tool 'do_everything' does not define an error response schema. Without structured error responses, agents cannot programmatically handle failures.",
      "location": "tool.do_everything",
      "evidence": null,
      "provider": "heuristic",
      "remediation": "Add an 'errorSchema' field defining the structure of error responses with error codes and messages",
      "rule_id": "HEUR-008"
    },
    {
      "category": "silent_failure_path",
      "severity": "low",
      "title": "No required fields specified",
      "description": "Tool 'do_everything' has an input schema but doesn't specify which fields are required. This may lead to missing input errors at runtime.",
      "location": "tool.do_everything.inputSchema.required",
      "evidence": null,
      "provider": "heuristic",
      "remediation": "Add a 'required' array listing mandatory input fields",
      "rule_id": "HEUR-012"
    },
    {
      "category": "unsafe_retry_loop",
      "severity": "low",
      "title": "No rate limit configuration",
      "description": "Tool 'do_everything' does not specify rate limits. Without rate limits, rapid repeated calls may overwhelm external services or exhaust resources.",
      "location": "tool.do_everything",
      "evidence": null,
      "provider": "heuristic",
      "remediation": "Add a 'rateLimit' field specifying maximum calls per time period",
      "rule_id": "HEUR-013"
    },
    {
      "category": "silent_failure_path",
      "severity": "medium",
      "title": "Dangerous phrase in description",
      "description": "Tool 'do_everything' description uses best-effort semantics. This suggests potential silent failure paths that may be difficult for agents to handle.",
      "location": "tool.do_everything.description",
      "evidence": {
        "pattern": "best\\s*effort",
        "meaning": "uses best-effort semantics"
      },
      "provider": "heuristic",
      "remediation": "Document specific failure modes and ensure errors are properly surfaced to callers",
      "rule_id": "HEUR-014"
    },
    {
      "category": "silent_failure_path",
      "severity": "medium",
      "title": "Dangerous phrase in description",
      "description": "Tool 'do_everything' description ignores errors. This suggests potential silent failure paths that may be difficult for agents to handle.",
      "location": "tool.do_everything.description",
      "evidence": {
        "pattern": "ignore\\s*error",
        "meaning": "ignores errors"
      },
      "provider": "heuristic",
      "remediation": "Document specific failure modes and ensure errors are properly surfaced to callers",
      "rule_id": "HEUR-014"
    }
  ],
  "readiness_score": 25,
  "timestamp": "2024-01-15T10:30:00.000000",
  "providers_used": ["heuristic"],
  "scan_duration_ms": 12,
  "metadata": {
    "scan_type": "tool"
  }
}
