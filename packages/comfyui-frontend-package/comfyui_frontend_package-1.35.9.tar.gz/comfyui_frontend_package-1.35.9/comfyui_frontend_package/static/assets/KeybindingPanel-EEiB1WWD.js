var L=Object.defineProperty;var l=(v,r)=>L(v,"name",{value:r,configurable:!0});import{bs as N,E as S,c as u,d as g,F as M,z as R,A as a,q as t,h as V,t as w,bq as n,s as U,r as b,dr as G,k as J,p as $,e as K,I as Q,l as W}from"./vendor-other-Dl5_1vG6.js";import{x as q,ag as X,u as Y,af as Z,ae as h,s as f,z as P,f as ee,a as ie}from"./vendor-primevue-B1C3YRTk.js";import{u as ne}from"./vendor-vue-CuB5mYeL.js";import{bp as ae,B as le,n as te,S as se,di as oe,cy as de,cz as re,d as ue}from"./index-azSeANjR.js";import{u as ce}from"./keybindingService-2uc1woEJ.js";import"./vendor-xterm-DV1MVhAx.js";import"./vendor-three-zdhtZbSm.js";import"./vendor-tiptap-BgsBtbxI.js";const be={key:0,class:"px-2"},ye=N({__name:"KeyComboDisplay",props:{keyCombo:{},isModified:{type:Boolean,default:!1}},setup(v){const r=S(()=>v.keyCombo.getKeySequences());return(s,y)=>(u(),g("span",null,[(u(!0),g(M,null,R(r.value,(C,k)=>(u(),g(M,{key:k},[a(n(q),{severity:s.isModified?"info":"secondary"},{default:t(()=>[V(w(C),1)]),_:2},1032,["severity"]),k<r.value.length-1?(u(),g("span",be,"+")):U("",!0)],64))),128))]))}}),pe={class:"actions invisible flex flex-row"},me=["title"],fe={key:1},ge={class:"overflow-hidden text-ellipsis"},ve=N({__name:"KeybindingPanel",setup(v){const r=b({global:{value:"",matchMode:X.CONTAINS}}),s=ae(),y=ce(),C=le(),{t:k}=ne(),F=S(()=>Object.values(C.commands).map(e=>({id:e.id,label:k(`commands.${te(e.id)}.label`,e.label??""),keybinding:s.getKeybindingByCommandId(e.id),source:e.source}))),x=b(null),p=b(!1),d=b(null),c=b(null),I=b(null),m=S(()=>!c.value||c.value.keybinding?.combo?.equals(d.value)||!d.value?null:s.getKeybinding(d.value));function B(e){c.value=e,d.value=e.keybinding?e.keybinding.combo:null,p.value=!0}l(B,"editKeybinding"),G(()=>{p.value&&setTimeout(()=>{I.value?.$el?.focus()},300)});async function O(e){e.keybinding&&(s.unsetKeybinding(e.keybinding),await y.persistUserKeybindings())}l(O,"removeKeybinding");async function T(e){if(!e.shiftKey&&!e.altKey&&!e.ctrlKey&&!e.metaKey)switch(e.key){case"Escape":_();return;case"Enter":await E();return}const o=de.fromEvent(e);d.value=o}l(T,"captureKeybinding");function _(){p.value=!1,c.value=null,d.value=null}l(_,"cancelEdit");async function E(){c.value&&d.value&&s.updateKeybindingOnCommand(new re({commandId:c.value.id,combo:d.value}))&&await y.persistUserKeybindings(),_()}l(E,"saveKeybinding");async function z(e){s.resetKeybindingForCommand(e.id)?await y.persistUserKeybindings():console.warn(`No changes made when resetting keybinding for command: ${e.id}`)}l(z,"resetKeybinding");const D=Y();async function j(){s.resetAllKeybindings(),await y.persistUserKeybindings(),D.add({severity:"info",summary:"Info",detail:"All keybindings reset",life:3e3})}return l(j,"resetAllKeybindings"),(e,o)=>{const H=J("tooltip");return u(),$(oe,{value:"Keybinding",class:"keybinding-panel"},{header:t(()=>[a(se,{modelValue:r.value.global.value,"onUpdate:modelValue":o[0]||(o[0]=i=>r.value.global.value=i),placeholder:e.$t("g.searchKeybindings")+"..."},null,8,["modelValue","placeholder"])]),default:t(()=>[a(n(Z),{selection:x.value,"onUpdate:selection":o[1]||(o[1]=i=>x.value=i),value:F.value,"global-filter-fields":["id","label"],filters:r.value,"selection-mode":"single","striped-rows":"",pt:{header:"px-0"},onRowDblclick:o[2]||(o[2]=i=>B(i.data))},{default:t(()=>[a(n(h),{field:"actions",header:""},{body:t(i=>[K("div",pe,[a(n(f),{icon:"pi pi-pencil",class:"p-button-text",onClick:l(A=>B(i.data),"onClick")},null,8,["onClick"]),a(n(f),{icon:"pi pi-replay",class:"p-button-text p-button-warn",disabled:!n(s).isCommandKeybindingModified(i.data.id),onClick:l(A=>z(i.data),"onClick")},null,8,["disabled","onClick"]),a(n(f),{icon:"pi pi-trash",class:"p-button-text p-button-danger",disabled:!i.data.keybinding,onClick:l(A=>O(i.data),"onClick")},null,8,["disabled","onClick"])])]),_:1}),a(n(h),{field:"id",header:e.$t("g.command"),sortable:"",class:"max-w-64 2xl:max-w-full"},{body:t(i=>[K("div",{class:"truncate",title:i.data.id},w(i.data.label),9,me)]),_:1},8,["header"]),a(n(h),{field:"keybinding",header:e.$t("g.keybinding")},{body:t(i=>[i.data.keybinding?(u(),$(ye,{key:0,"key-combo":i.data.keybinding.combo,"is-modified":n(s).isCommandKeybindingModified(i.data.id)},null,8,["key-combo","is-modified"])):(u(),g("span",fe,"-"))]),_:1},8,["header"]),a(n(h),{field:"source",header:e.$t("g.source")},{body:t(i=>[K("span",ge,w(i.data.source||"-"),1)]),_:1},8,["header"])]),_:1},8,["selection","value","filters"]),a(n(P),{visible:p.value,"onUpdate:visible":o[3]||(o[3]=i=>p.value=i),class:"min-w-96",modal:"",header:c.value?.label,onHide:_},{footer:t(()=>[a(n(f),{label:m.value?"Overwrite":"Save",icon:m.value?"pi pi-pencil":"pi pi-check",severity:m.value?"warn":void 0,autofocus:"",onClick:E},null,8,["label","icon","severity"])]),default:t(()=>[K("div",null,[a(n(ee),{ref_key:"keybindingInput",ref:I,class:"mb-2 text-center","model-value":d.value?.toString()??"",placeholder:e.$t("g.pressKeysForNewBinding"),autocomplete:"off",fluid:"",onKeydown:Q(T,["stop","prevent"])},null,8,["model-value","placeholder"]),m.value?(u(),$(n(ie),{key:0,severity:"warn"},{default:t(()=>[V(w(e.$t("g.keybindingAlreadyExists"))+" ",1),a(n(q),{severity:"secondary",value:m.value.commandId},null,8,["value"])]),_:1})):U("",!0)])]),_:1},8,["visible","header"]),W(a(n(f),{class:"mt-4",label:e.$t("g.resetAll"),icon:"pi pi-replay",severity:"danger",fluid:"",text:"",onClick:j},null,8,["label"]),[[H,e.$t("g.resetAllKeybindingsTooltip")]])]),_:1})}}}),Ie=ue(ve,[["__scopeId","data-v-04308f44"]]);export{Ie as default};
//# sourceMappingURL=KeybindingPanel-EEiB1WWD.js.map
