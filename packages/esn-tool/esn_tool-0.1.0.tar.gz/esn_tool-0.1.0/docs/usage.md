# ESN Tool ä½¿ç”¨æŒ‡å—

ESN Tool æ˜¯ä¸€ä¸ªç”¨äºç®¡ç†å¤šä¸ª Git é¡¹ç›®çš„ CLI å·¥å…·ï¼Œæ”¯æŒæ‰¹é‡ Git æ“ä½œå’Œ AI è‡ªåŠ¨ç”Ÿæˆæäº¤ä¿¡æ¯ã€‚

## ç›®å½•

- [å®‰è£…](#å®‰è£…)
- [é…ç½®](#é…ç½®)
- [å‘½ä»¤](#å‘½ä»¤)
  - [esntool acm - è‡ªåŠ¨æäº¤](#esntool-acm---è‡ªåŠ¨æäº¤)
  - [esntool git - æ‰¹é‡ Git æ“ä½œ](#esntool-git---æ‰¹é‡-git-æ“ä½œ)
  - [esntool config - é…ç½®ç®¡ç†](#esntool-config---é…ç½®ç®¡ç†)

---

## å®‰è£…

### å‰ææ¡ä»¶

- Python 3.12 æˆ–æ›´é«˜ç‰ˆæœ¬
- [uv](https://docs.astral.sh/uv/) åŒ…ç®¡ç†å™¨

#### å®‰è£… uv

```bash
# macOS / Linux
curl -LsSf https://astral.sh/uv/install.sh | sh

# Windows
powershell -ExecutionPolicy ByPass -c "irm https://astral.sh/uv/install.ps1 | iex"
```

### å®‰è£… esn-tool

```bash
uv tool install esn-tool
```

### éªŒè¯å®‰è£…

```bash
esntool --version
esntool --help
```

### å‡çº§

```bash
uv tool upgrade esn-tool
```

### å¸è½½

```bash
uv tool uninstall esn-tool
```

---

## é…ç½®

é¦–æ¬¡ä½¿ç”¨å‰ï¼Œéœ€è¦é…ç½® AI æ¥å£ã€‚è¿è¡Œä»¥ä¸‹å‘½ä»¤è¿›å…¥äº¤äº’å¼é…ç½®ï¼š

```bash
esntool config
```

åœ¨é…ç½®ç•Œé¢ä¸­ï¼š
- ä½¿ç”¨ **â†‘â†“** é€‰æ‹©é…ç½®é¡¹
- æŒ‰ **Enter** ç¼–è¾‘é€‰ä¸­é¡¹
- é€‰æ‹© **ä¿å­˜å¹¶é€€å‡º** å®Œæˆé…ç½®

### é…ç½®é¡¹è¯´æ˜

| é…ç½®é¡¹ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|
| API Key | AI æ¥å£çš„ API Key | `sk-xxxxxxxxxxxx` |
| Base URL | API åœ°å€ | `https://api.siliconflow.cn/v1` |
| Model | ä½¿ç”¨çš„æ¨¡å‹ | `Qwen/Qwen2.5-32B-Instruct` |

### é…ç½®æ–‡ä»¶ä½ç½®

é…ç½®ä¿å­˜åœ¨ `~/.esntool/config.json`

---

## å‘½ä»¤

### esntool acm - è‡ªåŠ¨æäº¤

**ACM (Auto Commit Message)** å‘½ä»¤ç”¨äºè‡ªåŠ¨ç”Ÿæˆ Git æäº¤ä¿¡æ¯å¹¶æäº¤ã€‚

#### å·¥ä½œæµç¨‹

1. æ‰«ææŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰ä¸€çº§ Git ä»“åº“
2. æ£€æµ‹æ¯ä¸ªä»“åº“çš„å¾…æäº¤æ–‡ä»¶
3. æ˜¾ç¤ºäº¤äº’å¼æ–‡ä»¶é€‰æ‹©å™¨ï¼Œé€‰æ‹©è¦æäº¤çš„æ–‡ä»¶
4. è°ƒç”¨ AI ç”Ÿæˆç¬¦åˆ Conventional Commits è§„èŒƒçš„æäº¤ä¿¡æ¯
5. ç¡®è®¤åæ‰§è¡Œ `git add` å’Œ `git commit`

#### åŸºæœ¬ç”¨æ³•

```bash
# åœ¨å½“å‰ç›®å½•ä¸‹æ‰«ææ‰€æœ‰ Git é¡¹ç›®
esntool acm

# æŒ‡å®šç›®å½•
esntool acm -d /path/to/projects

# è‡ªåŠ¨æš‚å­˜æ‰€æœ‰æ›´æ”¹
esntool acm -a

# è·³è¿‡æ–‡ä»¶é€‰æ‹©ï¼Œä½¿ç”¨æ‰€æœ‰æ›´æ”¹
esntool acm -y

# æŒ‡å®š AI æ¨¡å‹
esntool acm -m Qwen/Qwen2.5-72B-Instruct
```

#### é€‰é¡¹

| é€‰é¡¹ | è¯´æ˜ |
|------|------|
| `-d, --directory` | æŒ‡å®šè¦æœç´¢çš„ç›®å½•ï¼Œé»˜è®¤ä¸ºå½“å‰ç›®å½• |
| `-m, --model` | æŒ‡å®š AI æ¨¡å‹ |
| `-a, --auto-stage` | è‡ªåŠ¨æš‚å­˜æ‰€æœ‰æ›´æ”¹åå†ç”Ÿæˆæäº¤ä¿¡æ¯ |
| `-y, --yes` | è·³è¿‡ç¡®è®¤ç›´æ¥æäº¤ |

#### äº¤äº’å¼æ–‡ä»¶é€‰æ‹©å™¨

åœ¨æ–‡ä»¶é€‰æ‹©ç•Œé¢ä¸­ï¼š

| å¿«æ·é”® | åŠŸèƒ½ |
|--------|------|
| `ç©ºæ ¼` | é€‰æ‹©/å–æ¶ˆé€‰æ‹©å½“å‰æ–‡ä»¶ |
| `a` | å…¨é€‰ |
| `n` | å…¨ä¸é€‰ |
| `c` | ç¡®è®¤é€‰æ‹©ï¼Œè¿›å…¥ä¸‹ä¸€æ­¥ |
| `q` | å–æ¶ˆæ“ä½œ |
| `Tab` | åœ¨æ–‡ä»¶åˆ—è¡¨å’Œ Diff é¢„è§ˆä¹‹é—´åˆ‡æ¢ç„¦ç‚¹ |
| `â†` / `â†’` | åˆ‡æ¢ç„¦ç‚¹ |
| `j` / `k` | åœ¨ Diff é¢„è§ˆåŒºæ»šåŠ¨ |

#### ç”Ÿæˆçš„æäº¤ä¿¡æ¯æ ¼å¼

éµå¾ª [Conventional Commits](https://www.conventionalcommits.org/) è§„èŒƒï¼š

```
<type>(<scope>): <subject>

<body>
```

ç±»å‹åŒ…æ‹¬ï¼š
- `feat`: æ–°åŠŸèƒ½
- `fix`: ä¿®å¤ Bug
- `docs`: æ–‡æ¡£æ›´æ–°
- `style`: ä»£ç æ ¼å¼è°ƒæ•´
- `refactor`: é‡æ„
- `perf`: æ€§èƒ½ä¼˜åŒ–
- `test`: æµ‹è¯•ç›¸å…³
- `chore`: æ„å»ºæˆ–è¾…åŠ©å·¥å…·å˜åŠ¨

---

### esntool git - æ‰¹é‡ Git æ“ä½œ

å¯¹å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰ Git é¡¹ç›®æ‰¹é‡æ‰§è¡Œ Git å‘½ä»¤ã€‚

#### å·¥ä½œæµç¨‹

1. æ‰«ææŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰ä¸€çº§å­æ–‡ä»¶å¤¹
2. ç­›é€‰å‡ºåŒ…å« `.git` ç›®å½•çš„ Git ä»“åº“
3. å¯¹æ¯ä¸ªä»“åº“æ‰§è¡Œç›¸åŒçš„ Git å‘½ä»¤
4. æ±‡æ€»æ˜¾ç¤ºæ‰§è¡Œç»“æœ

#### åŸºæœ¬ç”¨æ³•

```bash
# æ‹‰å–æ‰€æœ‰é¡¹ç›®çš„æœ€æ–°ä»£ç 
esntool git pull

# æŸ¥çœ‹æ‰€æœ‰é¡¹ç›®çš„çŠ¶æ€
esntool git status

# åˆ‡æ¢æ‰€æœ‰é¡¹ç›®åˆ° main åˆ†æ”¯
esntool git checkout main

# åˆ›å»ºæ–°åˆ†æ”¯ï¼ˆæ‰€æœ‰é¡¹ç›®ï¼‰
esntool git checkout -b feature/new-branch

# è·å–æ‰€æœ‰è¿œç¨‹æ›´æ–°
esntool git fetch --all

# æŒ‡å®šç›®å½•
esntool git -d /path/to/projects pull

# æ˜¾ç¤ºè¯¦ç»†è¾“å‡º
esntool git -v status
```

#### é€‰é¡¹

| é€‰é¡¹ | è¯´æ˜ |
|------|------|
| `-d, --directory` | æŒ‡å®šè¦æœç´¢çš„ç›®å½•ï¼Œé»˜è®¤ä¸ºå½“å‰ç›®å½• |
| `-v, --verbose` | æ˜¾ç¤ºè¯¦ç»†è¾“å‡º |

#### è¾“å‡ºç¤ºä¾‹

```
ğŸ“‚ åœ¨ /path/to/projects ä¸‹æ‰¾åˆ° 5 ä¸ª Git é¡¹ç›®
æ‰§è¡Œå‘½ä»¤: git pull

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ é¡¹ç›®          â”ƒ çŠ¶æ€   â”ƒ ä¿¡æ¯                   â”ƒ
â”¡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”©
â”‚ project-1    â”‚ âœ“     â”‚ Already up to date.    â”‚
â”‚ project-2    â”‚ âœ“     â”‚ Fast-forward           â”‚
â”‚ project-3    â”‚ âœ—     â”‚ error: cannot pull...  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å®Œæˆ: 2 æˆåŠŸ, 1 å¤±è´¥
```

---

### esntool config - é…ç½®ç®¡ç†

ç®¡ç† ESN Tool çš„é…ç½®ï¼ŒåŒ…æ‹¬ AI æ¥å£è®¾ç½®ç­‰ã€‚

```bash
esntool config
```

è¿›å…¥äº¤äº’å¼é…ç½®ç•Œé¢ï¼Œå¯ä»¥è®¾ç½®ï¼š
- API Key
- Base URL  
- Model

é…ç½®ä¿å­˜åœ¨ `~/.esntool/config.json`

---

## å¸¸è§é—®é¢˜

### API è¯·æ±‚å¤±è´¥

ç¡®ä¿å·²æ­£ç¡®é…ç½® API Key å’Œ Base URLï¼š

```bash
esntool config show
```

å¦‚æœæŠ¥é”™ï¼Œä¼šæ˜¾ç¤ºè¯¦ç»†çš„é”™è¯¯ä¿¡æ¯ï¼ŒåŒ…æ‹¬ HTTP çŠ¶æ€ç å’Œ API è¿”å›çš„é”™è¯¯æ¶ˆæ¯ã€‚

### å‘½ä»¤æœªæ‰¾åˆ°

ç¡®ä¿å·²æ­£ç¡®å®‰è£…ï¼š

```bash
uv tool list
```

å¦‚æœ `esn-tool` ä¸åœ¨åˆ—è¡¨ä¸­ï¼Œæ‰§è¡Œï¼š

```bash
uv tool install esn-tool
```

### æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬

```bash
uv tool upgrade esn-tool
```

---

## ä¾èµ–

| åŒ… | ç”¨é€” |
|----|------|
| `click` | å‘½ä»¤è¡Œæ¡†æ¶ |
| `rich` | ç»ˆç«¯ç¾åŒ–è¾“å‡º |
| `httpx` | HTTP å®¢æˆ·ç«¯ |
| `questionary` | äº¤äº’å¼æç¤º |
| `textual` | TUI ç•Œé¢æ¡†æ¶ |

---

## å¼€å‘

### å®‰è£…å¼€å‘ä¾èµ–

```bash
uv sync
```

### è¿è¡Œæµ‹è¯•

```bash
uv run pytest
```

### ä»£ç æ ¼å¼åŒ–

```bash
uv run ruff format src/
uv run ruff check src/ --fix
```
