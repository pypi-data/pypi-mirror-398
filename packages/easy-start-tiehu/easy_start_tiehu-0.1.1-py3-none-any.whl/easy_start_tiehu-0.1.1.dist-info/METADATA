Metadata-Version: 2.4
Name: easy-start-tiehu
Version: 0.1.1
Summary: 一个用于铁虎停车系统集成的 Python 包，提供简洁易用的 API 接口。
Home-page: https://gitee.com/guolei19850528/easy_start_tiehu
Author: guolei
Author-email: 174000902@qq.com
Classifier: Programming Language :: Python :: 3
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Requires-Python: >=3.6
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: httpx
Requires-Dist: jsonschema
Dynamic: author
Dynamic: author-email
Dynamic: classifier
Dynamic: description
Dynamic: description-content-type
Dynamic: home-page
Dynamic: license-file
Dynamic: requires-dist
Dynamic: requires-python
Dynamic: summary

# easy_start_tiehu

## 项目简介

easy_start_tiehu 是一个停车系统API客户端模块，提供了与停车系统API交互的功能，支持同步和异步两种请求方式。该模块封装了请求签名生成、HTTP客户端创建、响应验证等功能，简化了与停车系统API的集成开发。

## 功能特性

- **签名生成**：自动生成符合停车系统API要求的MD5签名
- **同步/异步请求**：支持同步和异步两种请求模式
- **HTTP客户端管理**：提供配置好的同步和异步HTTP客户端
- **响应验证**：支持通过JSON Schema验证API响应格式
- **参数处理**：自动处理公共参数（如parkingId、timestamp、sign）

## 安装方法

### 使用pip安装

```bash
pip install easy_start_tiehu
```

### 从源码安装

```bash
git clone https://github.com/your-repo/easy_start_tiehu.git
cd easy_start_tiehu
pip install -r requirements.txt
pip install -e .
```

## 快速开始

### 同步请求示例

```python
from easy_start_tiehu.pklot import Pklot

# 初始化客户端
pklot_client = Pklot(
    base_url="http://ykt.test.cxyun.net.cn:7303",
    parking_id="your_parking_id",
    app_key="your_app_key"
)

# 发送同步请求
success, data, response = pklot_client.request(
    url="/api/parking/info",
    json={"carNumber": "京A12345"}
)

# 处理响应
if success:
    print("请求成功:", data)
else:
    print("请求失败:", data)
```

### 异步请求示例

```python
import asyncio
from easy_start_tiehu.pklot import Pklot

async def get_parking_info():
    # 初始化客户端
    pklot_client = Pklot(
        base_url="http://ykt.test.cxyun.net.cn:7303",
        parking_id="your_parking_id",
        app_key="your_app_key"
    )

    # 发送异步请求
    success, data, response = await pklot_client.async_request(
        url="/api/parking/info",
        json={"carNumber": "京A12345"}
    )

    # 处理响应
    if success:
        print("请求成功:", data)
    else:
        print("请求失败:", data)

# 运行异步函数
asyncio.run(get_parking_info())
```

## API文档

### Pklot类

#### 初始化参数

| 参数名 | 类型 | 说明 | 默认值 |
|--------|------|------|--------|
| base_url | str | API基础URL | "http://ykt.test.cxyun.net.cn:7303" |
| parking_id | str | 停车场ID | "" |
| app_key | str | API应用密钥 | "" |

#### 主要方法

##### client(**kwargs)

创建配置好的同步HTTP客户端。

**参数**:
- **kwargs: 传递给httpx.Client的额外参数

**返回**:
- httpx.Client: 配置好的同步HTTP客户端

##### async_client(**kwargs)

创建配置好的异步HTTP客户端。

**参数**:
- **kwargs: 传递给httpx.AsyncClient的额外参数

**返回**:
- httpx.AsyncClient: 配置好的异步HTTP客户端

##### signature(data: dict = dict())

生成请求签名。

**参数**:
- data: 需要签名的数据字典

**返回**:
- str: 生成的MD5签名字符串（大写）

##### request(client: httpx.Client = None, validate_json_schema: dict = {...}, **kwargs)

发送同步API请求。

**参数**:
- client: 可选的HTTP客户端，如果不提供则创建新客户端
- validate_json_schema: 可选的JSON schema验证规则
- **kwargs: 传递给client.request的额外参数

**返回**:
- tuple: (请求是否成功, 响应JSON数据, 原始响应对象)

##### async_request(client: httpx.AsyncClient = None, validate_json_schema: dict = {...}, **kwargs)

发送异步API请求。

**参数**:
- client: 可选的异步HTTP客户端，如果不提供则创建新客户端
- validate_json_schema: 可选的JSON schema验证规则
- **kwargs: 传递给client.request的额外参数

**返回**:
- tuple: (请求是否成功, 响应JSON数据, 原始响应对象)

## 依赖列表

- httpx: HTTP客户端库，用于发送HTTP请求
- hashlib: 用于生成MD5签名
- datetime: 用于生成时间戳
- jsonschema: 用于验证API响应格式

## 作者
- 作者: 郭磊(174000902@qq.com)
- 项目地址: [https://gitee.com/guolei19850528/easy_start_tiehu](https://gitee.com/guolei19850528/easy_start_tiehu)

