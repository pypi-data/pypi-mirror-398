import pytest

from mima.standalone.multicolumn_list import compute_visible_area


@pytest.mark.parametrize(
    "prev,cursor,dim,list_sizes,expected",
    [
        # Single colum; increasing size
        ((0, 0), 0, (3, 1), (0, 1), (0, 1)),
        ((0, 0), 0, (3, 1), (0, 2), (0, 2)),
        ((0, 0), 0, (3, 1), (0, 3), (0, 3)),
        ((0, 0), 0, (3, 1), (0, 4), (0, 3)),
        ((0, 0), 0, (3, 1), (0, 5), (0, 3)),
        # Single column; going up
        ((0, 0), 2, (3, 1), (0, 10), (0, 3)),
        ((0, 0), 3, (3, 1), (0, 10), (1, 4)),
        ((0, 0), 4, (3, 1), (0, 10), (2, 5)),
        ((0, 0), 5, (3, 1), (0, 10), (3, 6)),
        ((0, 0), 6, (3, 1), (0, 10), (4, 7)),
        # Single column; going down
        ((4, 7), 5, (3, 1), (10, 10), (4, 7)),
        ((4, 7), 4, (3, 1), (10, 10), (4, 7)),
        ((4, 7), 3, (3, 1), (10, 10), (3, 6)),
        ((4, 7), 2, (3, 1), (10, 10), (2, 5)),
        ((4, 7), 1, (3, 1), (10, 10), (1, 4)),
        # Double column; going up
        ((0, 0), 0, (2, 2), (0, 1), (0, 1)),
        ((0, 0), 0, (2, 2), (0, 7), (0, 4)),
        ((0, 0), 3, (2, 2), (0, 7), (0, 4)),
        ((0, 0), 4, (2, 2), (0, 7), (2, 6)),
        ((0, 0), 5, (2, 2), (0, 7), (2, 6)),
        ((0, 0), 6, (2, 2), (10, 10), (4, 8)),
        ((0, 0), 7, (2, 2), (10, 10), (4, 8)),
        # Double column; going down
        ((4, 8), 7, (2, 2), (10, 10), (4, 8)),
        ((4, 8), 6, (2, 2), (10, 10), (4, 8)),
        ((4, 8), 5, (2, 2), (10, 10), (4, 8)),
        ((4, 8), 4, (2, 2), (10, 10), (4, 8)),
        ((4, 8), 3, (2, 2), (10, 10), (2, 6)),
        ((4, 8), 2, (2, 2), (10, 10), (2, 6)),
        # Double column; list gets smaller
        ((4, 8), 0, (2, 2), (10, 6), (0, 4)),
        ((4, 8), 5, (2, 2), (10, 6), (2, 6)),
        ((4, 8), 7, (2, 2), (10, 6), (2, 6)),
        ((4, 8), 7, (2, 2), (10, 5), (2, 5)),
        ((4, 8), 7, (2, 2), (10, 4), (0, 4)),
        ((4, 8), 7, (2, 2), (10, 3), (0, 3)),
        # 3x2 layout;
        ((0, 0), 0, (3, 2), (14, 14), (0, 6)),
        ((0, 0), 4, (3, 2), (14, 14), (0, 6)),
        ((0, 0), 5, (3, 2), (14, 14), (0, 6)),
        ((0, 0), 6, (3, 2), (14, 14), (2, 8)),
        ((2, 8), 3, (3, 2), (14, 14), (2, 8)),
        ((2, 8), 2, (3, 2), (14, 14), (2, 8)),
        ((2, 8), 1, (3, 2), (14, 14), (0, 6)),
        ((2, 8), 8, (3, 2), (14, 14), (4, 10)),
    ],
)
def test_set_skills(
    prev: tuple[int, int],
    cursor: int,
    dim: tuple[int, int],
    list_sizes: tuple[int, int],
    expected: tuple[int, int],
) -> None:
    first, last = compute_visible_area(prev, cursor, dim, list_sizes)

    assert expected[0] == first
    assert expected[1] == last
