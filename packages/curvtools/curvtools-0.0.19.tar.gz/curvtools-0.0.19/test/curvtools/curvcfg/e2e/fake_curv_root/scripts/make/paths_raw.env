#
# This file defines the canonical paths within this repo.
# Before including it, CURV_ROOT_DIR must be defined (abs path) as the root of the repo.
#
# Some vars are in parentheses instead of ${}. With ${} braces, both curvcfg and make can
# read the same value.  With $() parens, curvcfg will replace using the arguments it is given.
#

################################################################################################
# 
# Input paths
#
################################################################################################

# ---------------------------------------------------------------------
# Input directory paths
# ---------------------------------------------------------------------

CURV_REPO_DIR=${CURV_ROOT_DIR}/../..
CURV_CONFIG_DIR=${CURV_ROOT_DIR}/config
CURV_CONFIG_BOARDS_DIR=${CURV_ROOT_DIR}/boards
CURV_RISCV_DIR=${CURV_ROOT_DIR}/riscv
CURV_COMMON_DIR=${CURV_ROOT_DIR}/../common
CURV_FIRMWARE_DIR=${CURV_ROOT_DIR}/riscv/firmware

# CURV_CONFIG_* dirs shared b/t SoC builds and TB builds
CURV_CONFIG_SCHEMA_DIR=${CURV_CONFIG_DIR}/schema
CURV_CONFIG_PROFILES_DIR=${CURV_CONFIG_DIR}/profiles
CURV_CONFIG_PROFILE_OVERLAYS_DIR=${CURV_CONFIG_DIR}/profiles/overlays
CURV_CONFIG_MEMMAP_DIR=${CURV_CONFIG_DIR}/memmap

# SoC-only dirs
CURV_CONFIG_BOARD_DIR=${CURV_CONFIG_BOARDS_DIR}/$(BOARD)
CURV_CONFIG_DEVICES_DIR=${CURV_CONFIG_BOARD_DIR}/devices

# TB-only dirs
# (none yet)

# ---------------------------------------------------------------------
# Input file paths
# ---------------------------------------------------------------------

DEFAULT_PROFILE_TOML_PATH=${CURV_CONFIG_PROFILES_DIR}/$(PROFILE).toml
DEFAULT_TB_OVERLAY_TOML_PATH=${CURV_CONFIG_PROFILE_OVERLAYS_DIR}/tb.toml

DEFAULT_SCHEMA_TOML_PATH=${CURV_CONFIG_SCHEMA_DIR}/schema.toml
DEFAULT_TB_SCHEMA_TOML_PATH=${CURV_CONFIG_SCHEMA_DIR}/tb-extras-schema.toml

CURV_CONFIG_BOARD_SCHEMA_TOML_PATH=${CURV_CONFIG_BOARDS_DIR}/schema.toml
CURV_CONFIG_BOARD_TOML_PATH=${CURV_CONFIG_BOARDS_DIR}/$(BOARD)/board.toml
CURV_CONFIG_DEVICE_TOML_PATH=${CURV_CONFIG_BOARDS_DIR}/$(BOARD)/devices/$(DEVICE).toml

################################################################################################
# 
# Output paths
#
################################################################################################

# ---------------------------------------------------------------------
# Output directory paths
# ---------------------------------------------------------------------

BUILD_GENERATED_DIR=$(BUILD_DIR)/generated
# home of merged_*.toml (generated by curvcfg merge)
BUILD_GENERATED_CONFIG_DIR=${BUILD_GENERATED_DIR}/config

BUILD_FIRMWARE_DIR=$(BUILD_DIR)/fw
BUILD_FW_CACHE_PREFILLS_DIR=${BUILD_FIRMWARE_DIR}/cache-prefills
# >>> equals new location of CACHE_INPUT_HEX_FILE_DIR which equals CACHE_PREFILL_OUTPUT_DIR_ABS
BUILD_FW_CACHE_PREFILLS_BIN_DIR=${BUILD_FW_CACHE_PREFILLS_DIR}/build
# >>> equals CACHE_OUTPUT_HEX_FILES_ROOT_DIR:
BUILD_CACHE_OUTPUT_HEX_FILES_ROOT_DIR=${BUILD_FW_CACHE_PREFILLS_DIR}/hex-files

# fw/build/cache-prefills/hex-files/dcache
BUILD_DCACHE_DIR=${BUILD_CACHE_OUTPUT_HEX_FILES_ROOT_DIR}/dcache
# >>> equals abs version of DCACHE_CACHELINES_DIR
BUILD_DCACHE_CACHELINES_DIR=${BUILD_DCACHE_DIR}/cachelines
# >>> equals abs version DCACHE_TAGRAM_DIR
BUILD_DCACHE_TAGRAM_DIR=${BUILD_DCACHE_DIR}/tagram

# fw/build/cache-prefills/hex-files/icache
BUILD_ICACHE_DIR=${BUILD_CACHE_OUTPUT_HEX_FILES_ROOT_DIR}/icache
BUILD_ICACHE_CACHELINES_DIR=${BUILD_ICACHE_DIR}/cachelines
BUILD_ICACHE_TAGRAM_DIR=${BUILD_ICACHE_DIR}/tagram

# fw/build/bootrom/build
BUILD_FW_BOOTROM_DIR=${BUILD_FIRMWARE_DIR}/bootrom/build
BUILD_BOOTROM_HEX_FILES_DIR=${BUILD_FIRMWARE_DIR}/bootrom/hex-files

# ---------------------------------------------------------------------
# Generated output file paths
# ---------------------------------------------------------------------

# generated/config/merged_*.toml:
DEFAULT_MERGED_BOARD_TOML_PATH=${BUILD_GENERATED_CONFIG_DIR}/merged_board.toml
DEFAULT_MERGED_CFGVARS_TOML_PATH=${BUILD_GENERATED_CONFIG_DIR}/merged_cfgvars.toml

# generated/make includes
CONFIG_MK_DEP=${BUILD_GENERATED_DIR}/make/config.mk.d
BOARD_MK_DEP=${BUILD_GENERATED_DIR}/make/board.mk.d
CONFIG_MK=${BUILD_GENERATED_DIR}/make/curv.mk
BOARD_MK=${BUILD_GENERATED_DIR}/make/board.mk

# generated/hdl
CONFIG_SVPKG=${BUILD_GENERATED_DIR}/hdl/curvcfgpkg.sv
BOARD_SVPKG=${BUILD_GENERATED_DIR}/hdl/boardpkg.sv
CONFIG_SVH=${BUILD_GENERATED_DIR}/hdl/curvcfg.svh
BOARD_SVH=${BUILD_GENERATED_DIR}/hdl/board.svh
MEMMAP_SV=${BUILD_GENERATED_DIR}/hdl/memmappkg.sv

# generated/docs
MEMMAP_MD=${BUILD_GENERATED_DIR}/docs/MEMORY_MAP.md

# generated/shell
CONFIG_ENV=${BUILD_GENERATED_DIR}/shell/curv.env
BOARD_ENV=${BUILD_GENERATED_DIR}/shell/board.env

# generated cache-prefill files
# >>> equals abs version of HEX_OUTPUT_FILE in asm-vars.mk
BUILD_CACHE_PREFILL_HEX_OUTPUT_FILE=${BUILD_FW_CACHE_PREFILLS_BIN_DIR}/cache.hex
BUILD_CACHE_PREFILL_HDL_DIR=${BUILD_FW_CACHE_PREFILLS_DIR}/generated/hdl
BUILD_CACHE_PREFILL_DOCS_DIR=${BUILD_FW_CACHE_PREFILLS_DIR}/generated/docs
BUILD_CACHE_PREFILL_HEX_HDR_FILE=${BUILD_CACHE_PREFILL_HDL_DIR}/cache_hex_files_paths.svh
BUILD_SRC_ICACHE_HEX_FILE=${BUILD_FW_CACHE_PREFILLS_BIN_DIR}/text-section.hex
BUILD_SRC_DCACHE_HEX_FILE=${BUILD_FW_CACHE_PREFILLS_BIN_DIR}/data-section.hex
BUILD_WISHBONE_HEX_FILE=${BUILD_FW_CACHE_PREFILLS_BIN_DIR}/cache.hex
BUILD_CACHE_README_FILE=${BUILD_CACHE_PREFILL_DOCS_DIR}/cache_readme.txt

# generated bootrom files
BUILD_BOOTROM_OBJ_FILES=${BUILD_FW_BOOTROM_DIR}/bootrom.o
BUILD_BOOTROM_HEX_FILES=${BUILD_BOOTROM_HEX_FILES_DIR}/bootrom.hex
