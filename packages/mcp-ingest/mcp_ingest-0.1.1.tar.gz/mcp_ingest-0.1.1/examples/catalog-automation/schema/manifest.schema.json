{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://agent-matrix.io/schemas/mcp-manifest-v1.json",
  "title": "MCP Server Manifest",
  "description": "Canonical schema for MCP server manifests in the Agent-Matrix catalog",
  "type": "object",
  "required": ["id", "name", "type", "schema_version"],
  "properties": {
    "schema_version": {
      "type": "integer",
      "description": "Schema version number",
      "const": 1
    },
    "type": {
      "type": "string",
      "description": "Entity type",
      "enum": ["mcp_server", "agent", "tool"]
    },
    "id": {
      "type": "string",
      "description": "Unique identifier for this server",
      "minLength": 3,
      "pattern": "^[a-zA-Z0-9._-]+$"
    },
    "name": {
      "type": "string",
      "description": "Human-readable name",
      "minLength": 1,
      "maxLength": 100
    },
    "description": {
      "type": "string",
      "description": "Detailed description",
      "maxLength": 1000
    },
    "summary": {
      "type": "string",
      "description": "Short summary (for listings)",
      "maxLength": 200
    },
    "version": {
      "type": "string",
      "description": "Semantic version",
      "pattern": "^\\d+\\.\\d+\\.\\d+(-[a-zA-Z0-9.]+)?$"
    },
    "homepage": {
      "type": "string",
      "description": "Homepage or documentation URL",
      "format": "uri"
    },
    "license": {
      "type": "string",
      "description": "SPDX license identifier or text"
    },
    "provenance": {
      "type": "object",
      "description": "Harvesting and source metadata",
      "properties": {
        "harvested_at": {
          "type": "string",
          "description": "ISO 8601 timestamp of harvest",
          "format": "date-time"
        },
        "source_repo": {
          "type": "string",
          "description": "Source repository URL"
        },
        "source_ref": {
          "type": "string",
          "description": "Git reference (branch/tag/SHA)"
        },
        "source_path": {
          "type": "string",
          "description": "Relative path within repository"
        },
        "detector": {
          "type": "string",
          "description": "Detection method/framework"
        },
        "confidence": {
          "type": "number",
          "description": "Detection confidence score (0.0-1.0)",
          "minimum": 0,
          "maximum": 1
        },
        "stars": {
          "type": "integer",
          "description": "GitHub stars count",
          "minimum": 0
        },
        "forks": {
          "type": "integer",
          "description": "GitHub forks count",
          "minimum": 0
        },
        "harvester": {
          "type": "string",
          "description": "Harvester tool name"
        },
        "harvester_version": {
          "type": "string",
          "description": "Harvester tool version"
        }
      }
    },
    "mcp_registration": {
      "type": "object",
      "description": "MCP-specific registration data",
      "properties": {
        "server": {
          "type": "object",
          "required": ["name", "transport"],
          "properties": {
            "name": {
              "type": "string",
              "minLength": 1
            },
            "description": {
              "type": "string"
            },
            "transport": {
              "type": "string",
              "enum": ["SSE", "STDIO", "HTTP", "WS"]
            },
            "url": {
              "type": "string",
              "description": "Server URL (for SSE/HTTP/WS)"
            },
            "exec": {
              "type": "object",
              "description": "Execution config (for STDIO)",
              "properties": {
                "cmd": {
                  "type": "array",
                  "items": {"type": "string"},
                  "minItems": 1
                },
                "env": {
                  "type": "object",
                  "additionalProperties": {"type": "string"}
                }
              }
            },
            "associated_tools": {
              "type": "array",
              "items": {"type": "string"}
            },
            "associated_resources": {
              "type": "array",
              "items": {"type": "string"}
            },
            "associated_prompts": {
              "type": "array",
              "items": {"type": "string"}
            }
          }
        },
        "resources": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": {"type": "string"},
              "name": {"type": "string"},
              "type": {"type": "string"},
              "uri": {"type": "string"}
            }
          }
        },
        "prompts": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": {"type": "string"},
              "name": {"type": "string"},
              "description": {"type": "string"}
            }
          }
        },
        "tool": {
          "type": "object",
          "properties": {
            "id": {"type": "string"},
            "name": {"type": "string"},
            "description": {"type": "string"},
            "integration_type": {"type": "string"},
            "url": {"type": "string"},
            "input_schema": {"type": "object"}
          }
        }
      }
    },
    "artifacts": {
      "type": "array",
      "description": "Distribution artifacts (git, npm, pypi, etc.)",
      "items": {
        "type": "object",
        "required": ["kind"],
        "properties": {
          "kind": {
            "type": "string",
            "enum": ["git", "npm", "pypi", "docker", "url"]
          },
          "spec": {
            "type": "object",
            "description": "Kind-specific specification"
          }
        }
      }
    },
    "tags": {
      "type": "array",
      "description": "Searchable tags/keywords",
      "items": {
        "type": "string",
        "pattern": "^[a-z0-9-]+$"
      }
    },
    "categories": {
      "type": "array",
      "description": "Primary categories",
      "items": {
        "type": "string",
        "enum": [
          "filesystem",
          "database",
          "api",
          "search",
          "ai",
          "productivity",
          "development",
          "data-analysis",
          "monitoring",
          "communication",
          "other"
        ]
      }
    }
  },
  "additionalProperties": true
}
