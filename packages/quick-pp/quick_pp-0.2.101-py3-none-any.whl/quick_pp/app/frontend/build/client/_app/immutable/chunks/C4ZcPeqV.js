import{_ as de}from"./PPVm8Dsz.js";import{y as ce,p as pe,F as j,o as fe,v as H,l as J,b as ue,i as ve,f as P,n as y,w as L,Q as me,J as M,R as _e,g as t,t as b,c as he,s as ge,H as _,d as Q,m as u,e as p,k as h,S as X,z as ye,r as w,U as be,V as we,X as xe,Y as ze,C as Se,h as Re,N as Pe}from"./Cjo0f8hx.js";import{d as Oe,z as Fe,g as De,c as Ie}from"./CZmdasm_.js";import{D as Ne}from"./D4wk-9zb.js";var ke=P('<label class="text-sm">Interval (ms): <input type="number" class="input w-24 ml-2"/></label>'),Ee=P('<div class="text-sm">Loading well logâ€¦</div>'),$e=P('<div class="text-sm text-red-500"> </div>'),Ae=P('<div class="ws-well-plot"><!> <div class="mb-2 flex items-center gap-2"><button class="btn px-3 py-1 text-sm bg-gray-800 text-white rounded" aria-label="Refresh plot">Refresh</button> <label class="text-sm flex items-center gap-1"><input type="checkbox"/> Auto-refresh</label> <!></div> <!> <div></div></div>');function We(Y,x){pe(x,!1);const n=()=>Q(Oe,"$depthFilter",C),c=()=>Q(Fe,"$zoneFilter",C),[C,G]=ge();let l=j(x,"projectId",8),d=j(x,"wellName",8),z=null,a=u(null),ee=j(x,"minWidth",8,"480px"),O=u(!1),S=u(null),F=u(!1),W=u(5e3),D=null,I=u(null),N=u(null),q=!1;const te="http://localhost:6312";async function re(){if(z)return z;const e=await de(()=>import("./BJMC0GYJ.js").then(r=>r.p),[],import.meta.url);return z=e.default||e,z}async function v(e=!1){if(!(!l()||!d()||!q||!t(a))){p(O,!0),p(S,null);try{const r=JSON.stringify({depth:n(),zone:c()}),s=`${l()}-${d()}-${r}`;let i;const m=De(l(),s);if(!e&&m)i=m.data;else{let g=`${te}/quick_pp/plotter/projects/${l()}/wells/${encodeURIComponent(String(d()))}/log`;const f=new URLSearchParams;if(n()?.enabled&&(n().minDepth!==null&&f.append("min_depth",String(n().minDepth)),n().maxDepth!==null&&f.append("max_depth",String(n().maxDepth))),c()?.enabled&&Array.isArray(c().zones)&&c().zones.length>0){const oe=c().zones.map(ne=>String(ne)).join(",");f.append("zones",oe)}f.toString()&&(g+="?"+f.toString());const A=await fetch(g);if(!A.ok)throw new Error(await A.text());i=await A.json(),Ie(l(),s,i)}const o=await re();if(!o)throw new Error("Failed to load Plotly library");const R={...i.config||{},responsive:!0,scrollZoom:!0},B={...i.layout||{},dragmode:i.layout?.dragmode??"zoom"};if(o.react?o.react(t(a),i.data,B,R):o.newPlot(t(a),i.data,B,R),we&&typeof ResizeObserver<"u"){if(t(a)?._plotlyResizeObserver)try{t(a)._plotlyResizeObserver.disconnect()}catch{}const g=new ResizeObserver(()=>{try{o.Plots&&o.Plots.resize&&o.Plots.resize(t(a))}catch{}});g.observe(t(a)),xe(a,t(a)._plotlyResizeObserver=g)}}catch(r){console.error("Failed to render well plot",r),p(S,String(r?.message??r))}finally{p(O,!1)}}}fe(()=>{q=!0,v()}),H(()=>{try{t(a)&&t(a)._plotlyResizeObserver&&(t(a)._plotlyResizeObserver.disconnect(),delete t(a)._plotlyResizeObserver),D&&(clearInterval(D),D=null)}catch{}});{const e=r=>{try{const s=r.detail;if(!s)return;String(s.projectId)===String(l())&&String(s.wellName)===String(d())&&v(!0)}catch{}};window.addEventListener("qpp:data-updated",e),H(()=>window.removeEventListener("qpp:data-updated",e))}J(()=>(_(l()),_(d())),()=>{l()&&d()&&v()}),J(()=>(n(),t(I),_(l()),_(d())),()=>{n()&&JSON.stringify(n())!==JSON.stringify(t(I))&&(p(I,{...n()}),l()&&d()&&v())}),J(()=>(c(),t(N),_(l()),_(d())),()=>{c()&&JSON.stringify(c())!==JSON.stringify(t(N))&&(p(N,{...c()}),l()&&d()&&v())}),ue(),ve();var k=Ae(),U=y(k);Ne(U,{});var E=h(U,2),K=y(E);K.__click=()=>v(!0);var $=h(K,2),T=y($);X(T),ye(),w($);var ae=h($,2);{var le=e=>{var r=ke(),s=h(y(r));X(s),w(r),ze(s,()=>t(W),i=>p(W,i)),b(e,r)};L(ae,e=>{t(F)&&e(le)})}w(E);var V=h(E,2);{var se=e=>{var r=Ee();b(e,r)},ie=e=>{var r=Se(),s=Re(r);{var i=m=>{var o=$e(),R=y(o);w(o),M(()=>Pe(R,`Error: ${t(S)??""}`)),b(m,o)};L(s,m=>{t(S)&&m(i)},!0)}b(e,r)};L(V,e=>{t(O)?e(se):e(ie,!1)})}var Z=h(V,2);me(Z,e=>p(a,e),()=>t(a)),w(k),M(()=>be(Z,`width:100%; min-width: ${ee()??""}; height:900px;`)),_e(T,()=>t(F),e=>p(F,e)),b(Y,k),he(),G()}ce(["click"]);export{We as default};
