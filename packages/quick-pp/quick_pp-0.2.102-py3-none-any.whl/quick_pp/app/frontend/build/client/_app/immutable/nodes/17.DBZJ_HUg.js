const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/Cjo0f8hx.js","../chunks/BNO5OzLn.js","../chunks/BJMC0GYJ.js","../assets/vendor.S5W4ZllZ.css","../chunks/BRAqxhq-.js","../assets/tables.D_GW5H37.css"])))=>i.map(i=>d[i]);
import{p as ce,F as ne,o as ke,v as ve,l as Y,g as e,m as h,H as de,b as Ee,i as me,f as y,w as J,t as _,c as pe,k as f,n as d,e as r,r as o,S as K,z as Pe,_ as Re,G as se,I as F,Y as X,J as ee,N as te,M as ae,aa as ue,O as re,Q as je}from"../chunks/Cjo0f8hx.js";import{_ as z}from"../chunks/PPVm8Dsz.js";import{B as Ie}from"../chunks/CHHNy2JR.js";import"../chunks/BRAqxhq-.js";import{P as Te}from"../chunks/CNqIdfOw.js";import{w as Ae}from"../chunks/CZmdasm_.js";const Oe=()=>({title:"Reservoir Summary",subtitle:"Reservoir summary and exports for the selected well"}),Je=Object.freeze(Object.defineProperty({__proto__:null,load:Oe},Symbol.toStringTag,{value:"Module"}));var $e=y('<div class="text-sm text-red-600 mb-2"> </div>'),Ve=y('<th class="px-2 py-1 text-xs font-medium"><div class="whitespace-nowrap font-medium"> </div> <div class="mt-1"><input class="dt-filter-input input w-full" type="text"/></div></th>'),Ce=y('<td class="px-2 py-1 text-sm"> </td>'),De=y('<tr class="border-t odd:bg-white even:bg-surface"></tr>'),Le=y('<table class="min-w-full table-auto border-collapse"><thead><tr class="bg-muted text-left"></tr></thead><tbody></tbody></table>'),We=y('<div class="text-sm text-muted-foreground">No results. Click "Generate Report" to compute reservoir summary for the selected well.</div>'),ze=y('<div class="bg-panel rounded p-3"><div class="grid grid-cols-2 gap-3 mb-3"><div><label class="text-sm" for="minPhitInput">Min PHIT (cutoff)</label> <input id="minPhitInput" type="number" class="input w-full" placeholder="min phit"/></div> <div><label class="text-sm" for="maxSwtInput">Max SWT (cutoff)</label> <input id="maxSwtInput" type="number" class="input w-full" placeholder="max swt"/></div> <div><label class="text-sm" for="maxVclayInput">Max VCLAY (cutoff)</label> <input id="maxVclayInput" type="number" class="input w-full" placeholder="max vclay"/></div> <div class="flex items-end gap-2"><!></div></div> <!> <div class="overflow-x-auto"><!></div></div>'),Me=y('<div class="text-sm text-muted-foreground">Select a well to view reservoir summary.</div>'),He=y('<div class="ws-reservoir-summary"><div class="mb-2"><div class="font-semibold">Reservoir Summary</div> <div class="text-sm text-muted-foreground">High-level reservoir summary and exportable reports.</div></div> <!></div>');function Be(G,C){ce(C,!1);const i=h();let w=ne(C,"projectId",8),x=ne(C,"wellName",8);const S="http://localhost:6312";let k=h(!1),u=h(null),E=[],j=h([]),I=h(.01),M=h(.99),H=h(.4),g=h(null),P=null,v=h(null);function le(){if(e(g))try{if(P){try{P.destroy()}catch{}for(;e(g).tBodies.length;)e(g).removeChild(e(g).tBodies[0])}const s=(e(i).length?Object.keys(e(i)[0]):[]).map(t=>({title:t,data:t}));P=e(v)(e(g)).DataTable({data:e(i),columns:s,destroy:!0,paging:!0,searching:!0,dom:"Blfrtip",buttons:[{extend:"csv",text:"Export CSV"},{extend:"colvis",text:"Columns"}],lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],pageLength:10,info:!0,autoWidth:!1,stripeClasses:["odd","even"],rowCallback(t,c,l){return l%2===0?e(v)(t).addClass("even-row"):e(v)(t).addClass("odd-row"),e(v)(t).addClass("hoverable-row"),t}});try{e(v)(e(g)).find("thead").off("input.dt-filter"),e(v)(e(g)).find("thead .dt-filter-input").each(function(t,c){const l=e(v)(c);l.off("keyup.dt-filter change.dt-filter"),l.on("keyup.dt-filter change.dt-filter",function(){const m=this.value||"";P.column(t).search(m).draw()})})}catch{}}catch(a){console.warn("DataTables init error",a)}}ke(async()=>{r(v,(await z(async()=>{const{default:a}=await import("../chunks/Cjo0f8hx.js").then(s=>s.j);return{default:a}},__vite__mapDeps([0,1,2,3]),import.meta.url)).default),await z(()=>import("../chunks/BRAqxhq-.js").then(a=>a.d),__vite__mapDeps([4,0,1,2,3,5]),import.meta.url),await z(()=>import("../chunks/BRAqxhq-.js").then(a=>a.b),__vite__mapDeps([4,0,1,2,3,5]),import.meta.url),await z(()=>import("../chunks/BRAqxhq-.js").then(a=>a.a),__vite__mapDeps([4,0,1,2,3,5]),import.meta.url),await z(()=>import("../chunks/BRAqxhq-.js").then(a=>a.c),__vite__mapDeps([4,0,1,2,3,5]),import.meta.url),window.jQuery=e(v),window.$=e(v),le()}),ve(()=>{try{P&&P.destroy()}catch{}P=null});async function fe(){if(!(!w()||!x())){r(k,!0),r(u,null);try{const a=await fetch(`${S}/quick_pp/database/projects/${w()}/wells/${encodeURIComponent(String(x()))}/merged`);if(!a.ok)throw new Error(await a.text());const s=await a.json(),t=s&&s.data?s.data:s;if(!Array.isArray(t))throw new Error("Unexpected data format from backend");E=t}catch(a){console.warn("Failed to load well data",a),r(u,String(a?.message??a))}finally{r(k,!1)}}}function _e(){const a=Array.isArray(E)?E:[],s=[];for(const t of a){const c=Number(t.depth??t.tvdss??t.TVD??t.TVDSS??t.DEPTH??NaN),l=Number(t.vclay??t.VCLAY??NaN),m=Number(t.phit??t.PHIT??NaN),N=Number(t.swt??t.SWT??NaN),T=Number(t.perm??t.PERM??t.permeability??NaN);let b=t.zones??t.ZONES??t.zone??t.ZONE??null;b==null||String(b).trim()===""?E.some(A=>{const D=A.zones??A.ZONES??A.zone??A.ZONE;return D!=null&&String(D).trim()!==""})?b="UNKNOWN":b="ALL":b=String(b),!(isNaN(c)||isNaN(l)||isNaN(m)||isNaN(N)||isNaN(T))&&s.push({depth:c,vclay:l,phit:m,swt:N,perm:T,zones:b})}return s}async function he(){if(r(u,null),!w()||!x()){r(u,"Select a project and well before generating a report");return}const a=_e(),s=E.length,t=a.length,c=s-t;if(!a.length){r(u,"No valid well rows available to compute reservoir summary (missing required numeric fields)");return}r(k,!0);try{const l={data:a,cut_offs:{}};e(I)!=null&&(l.cut_offs.PHIT=Number(e(I))),e(M)!=null&&(l.cut_offs.SWT=Number(e(M))),e(H)!=null&&(l.cut_offs.VSHALE=Number(e(H)));const m=await fetch(`${S}/quick_pp/ressum`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!m.ok)throw new Error(await m.text());const N=await m.json();r(j,Array.isArray(N)?N:[]),c>0&&(console.warn(`Skipped ${c} / ${s} rows because they lacked required numeric values (depth, vclay, phit, swt, perm).`),r(u,`Report generated. Note: skipped ${c} row(s) with missing numeric values.`))}catch(l){console.warn("Ressum error",l),r(u,String(l?.message??l)),r(j,[])}finally{r(k,!1)}}Y(()=>e(j),()=>{r(i,e(j)??[])}),Y(()=>(e(i),e(v)),()=>{e(i)&&e(v)&&setTimeout(()=>le(),0)}),Y(()=>(de(w()),de(x())),()=>{w()&&x()&&fe()}),Ee(),me();var Q=He(),be=f(d(Q),2);{var ye=a=>{var s=ze(),t=d(s),c=d(t),l=f(d(c),2);K(l),o(c);var m=f(c,2),N=f(d(m),2);K(N),o(m);var T=f(m,2),b=f(d(T),2);K(b),o(T);var U=f(T,2),A=d(U);{let n=se(()=>e(k)?"opacity:0.6; pointer-events:none;":"");Ie(A,{class:"btn btn-primary",onclick:he,get disabled(){return e(k)},get style(){return e(n)},children:(p,O)=>{Pe();var B=Re("Generate Report");_(p,B)},$$slots:{default:!0}})}o(U),o(t);var D=f(t,2);{var ge=n=>{var p=$e(),O=d(p);o(p),ee(()=>te(O,`Error: ${e(u)??""}`)),_(n,p)};J(D,n=>{e(u)&&n(ge)})}var oe=f(D,2),xe=d(oe);{var Ne=n=>{var p=Le(),O=d(p),B=d(O);ae(B,5,()=>(e(i),F(()=>Object.keys(e(i)[0]))),re,(L,$)=>{var R=Ve(),W=d(R),Z=d(W,!0);o(W);var V=f(W,2),q=d(V);o(V),o(R),ee(()=>{te(Z,e($)),ue(q,"placeholder",`Filter ${e($)??""}`),ue(q,"data-col",e($))}),_(L,R)}),o(B),o(O);var ie=f(O);ae(ie,5,()=>e(i),re,(L,$)=>{var R=De();ae(R,5,()=>(e(i),F(()=>Object.keys(e(i)[0]))),re,(W,Z)=>{var V=Ce(),q=d(V,!0);o(V),ee(()=>te(q,(e($),e(Z),F(()=>e($)[e(Z)])))),_(W,V)}),o(R),_(L,R)}),o(ie),o(p),je(p,L=>r(g,L),()=>e(g)),_(n,p)},Se=n=>{var p=We();_(n,p)};J(xe,n=>{e(i),F(()=>e(i)&&e(i).length)?n(Ne):n(Se,!1)})}o(oe),o(s),X(l,()=>e(I),n=>r(I,n)),X(N,()=>e(M),n=>r(M,n)),X(b,()=>e(H),n=>r(H,n)),_(a,s)},we=a=>{var s=Me();_(a,s)};J(be,a=>{x()?a(ye):a(we,!1)})}o(Q),_(G,Q),pe()}var Ze=y('<div slot="left"><!></div>');function Ke(G,C){ce(C,!1);let i=h(null),w=h(null);const x=Ae.subscribe(S=>{r(i,S?.project??null),r(w,S?.selectedWell??null)});ve(()=>x()),me(),Te(G,{get selectedWell(){return e(w)},get project(){return e(i)},$$slots:{left:(S,k)=>{var u=Ze(),E=d(u);{let j=se(()=>e(i)?.project_id??""),I=se(()=>e(w)?.name??"");Be(E,{get projectId(){return e(j)},get wellName(){return e(I)}})}o(u),_(S,u)}}}),pe()}export{Ke as component,Je as universal};
