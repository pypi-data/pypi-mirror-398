import geoph
import numpy as np

X = np.array([[0.17149924, 0.22456874, 0.72716931, 0.21583912],
              [0.79317932, 0.31105711, 0.99952554, 0.98005319],
              [0.40384022, 0.61638302, 0.95019953, 0.34269164],
              [0.90130423, 0.49115659, 0.84658157, 0.29952505],
              [0.75172116, 0.82399481, 0.87624552, 0.62275777],
              [0.25728744, 0.3891624 , 0.91427353, 0.29459316],
              [0.54338742, 0.13958149, 0.38956933, 0.17211698],
              [0.88098924, 0.36555815, 0.94777003, 0.4328942 ],
              [0.45970309, 0.47847312, 0.88854247, 0.09183136],
              [0.05876642, 0.93372777, 0.49332191, 0.26770708],
              [0.31995166, 0.68217509, 0.72335714, 0.54282444],
              [0.85043226, 0.40499767, 0.11096999, 0.7958446 ],
              [0.3007394 , 0.92014352, 0.85170738, 0.32722407],
              [0.17692419, 0.44962452, 0.3846947 , 0.88791042],
              [0.91069579, 0.82537065, 0.95290455, 0.38374788],
              [0.6490678 , 0.23006114, 0.89619223, 0.42389784],
              [0.2983591 , 0.73551406, 0.27369542, 0.44288382],
              [0.09731163, 0.64356509, 0.2880438 , 0.32601566],
              [0.4879542 , 0.23308146, 0.75414107, 0.46955458],
              [0.04001786, 0.53815995, 0.81288721, 0.71741038]])

diagram = [[(0.0, 0.21027149487752209),
            (0.0, 0.21961280564355895),
            (0.0, 0.2504770271060239),
            (0.0, 0.27365708102788666),
            (0.0, 0.27506522159219915),
            (0.0, 0.2769676312012348),
            (0.0, 0.29711472585130394),
            (0.0, 0.2981145315011815),
            (0.0, 0.320743658566324),
            (0.0, 0.33591690903890176),
            (0.0, 0.3608120015606555),
            (0.0, 0.3622417797901216),
            (0.0, 0.3658173276845278),
            (0.0, 0.3709436302344982),
            (0.0, 0.4367125737872954),
            (0.0, 0.48290450999131995),
            (0.0, 0.488877239007356),
            (0.0, 0.5592338853866674),
            (0.0, 0.7341702855420559)],
           [(0.46421447018307954, 0.5100022051163725),
            (0.4861089673057284, 0.5251210680810804),
            (0.553939329995802, 0.555259584916136)],
           [(0.7210576755916756, 0.7309900196438691)],
           [(0.983542789395978, 1.0156495366239406)]]

def test_delrips_diagram4():
    test = geoph.delaunayRipsPersistenceDiagram(X)
    for i in range(len(diagram)):
        assert np.allclose(np.array(test[i]), np.array(diagram[i]))
