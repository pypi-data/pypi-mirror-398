import geoph
import numpy as np

X = np.array([[0.489711,0.556439,0.670181],
              [-0.0404,0.132312,-0.991261],
              [0.721617,-0.690509,0.00798604],
              [-0.706095,0.518274,0.480465],
              [0.422037,0.816127,-0.395834],
              [-0.943782,0.0555558,0.32684],
              [0.354473,0.11623,-0.925662],
              [0.692965,-0.375124,0.616416],
              [-0.803858,0.22838,0.548273],
              [0.916092,-0.360263,-0.176353],
              [0.465965,0.713201,0.523612],
              [0.240312,-0.336156,0.910659],
              [-0.313616,-0.880439,0.359776],
              [-0.789181,0.539344,-0.293351],
              [0.703711,-0.159289,-0.691851],
              [0.892131,-0.436047,-0.126781],
              [0.730152,0.679312,-0.0556313],
              [-0.99235,-0.0375105,0.11681],
              [-0.951869,-0.285937,-0.104426],
              [0.29285,0.065561,0.952923]])

diagram = [[(0.0, 0.09367351472534809),
            (0.0, 0.21591819960577663),
            (0.0, 0.23480372169045788),
            (0.0, 0.3133593149548933),
            (0.0, 0.3138144409848597),
            (0.0, 0.3346462142477659),
            (0.0, 0.33511163059382165),
            (0.0, 0.40060772041237547),
            (0.0, 0.4073365134983604),
            (0.0, 0.47894788290302526),
            (0.0, 0.5025390370170262),
            (0.0, 0.541287526627023),
            (0.0, 0.5926503402859059),
            (0.0, 0.5997153514535042),
            (0.0, 0.6375468891657226),
            (0.0, 0.6859122768653448),
            (0.0, 0.73639038739805),
            (0.0, 0.9521303970370866),
            (0.0, 0.9880703501355559)],
           [(0.8804194536066317, 1.2509459318860627),
            (1.052960716432522, 1.057545592218605),
            (1.1015563549292429, 1.459211484478518),
            (1.1802627192811777, 1.2410944755303683),
            (1.1889419004047255, 1.2113631649992502)],
           [(1.371324025974414, 1.4307906459679562),
            (1.7104422077421966, 1.9294440296820432),
            (1.725360936765685, 1.7584205581504102)]]

delrips_0pairs = [([-1], [9, 15]),
                  ([-1], [0, 10]),
                  ([-1], [5, 17]),
                  ([-1], [3, 8]),
                  ([-1], [5, 8]),
                  ([-1], [2, 15]),
                  ([-1], [17, 18]),
                  ([-1], [1, 6]),
                  ([-1], [11, 19]),
                  ([-1], [4, 16]),
                  ([-1], [6, 14]),
                  ([-1], [7, 11]),
                  ([-1], [9, 14]),
                  ([-1], [0, 19]),
                  ([-1], [10, 16]),
                  ([-1], [2, 7]),
                  ([-1], [13, 17]),
                  ([-1], [11, 12]),
                  ([-1], [12, 18])]
delrips_1pairs = [([14, 16], [4, 14]),
                  ([3, 10], [0, 3]),
                  ([8, 19], [8, 11]),
                  ([4, 6], [7, 16]),
                  ([1, 13], [3, 4])]
delrips_2pairs = [([2, 6, 18], [1, 6, 12]),
                  ([1, 12, 14], [2, 3, 18]),
                  ([2, 16, 19], [0, 2, 19])]

def test_delrips_diagram3():
    test = geoph.delaunayRipsPersistenceDiagram(X)
    for i in range(len(diagram)):
        assert np.allclose(np.array(test[i]), np.array(diagram[i]))
