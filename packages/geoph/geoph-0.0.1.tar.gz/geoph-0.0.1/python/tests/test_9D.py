import geoph
import numpy as np

X = np.array([[0.73679071, 0.1861055 , 0.06945666, 0.06210862, 0.23300039, 0.17758389, 0.1571461 , 0.78266283, 0.84172977],
              [0.19165226, 0.32344486, 0.61421027, 0.87224282, 0.39796827, 0.00672128, 0.68410737, 0.20902905, 0.56888141],
              [0.89117689, 0.27828318, 0.66997089, 0.42880163, 0.31039658, 0.81840524, 0.01796296, 0.9629639 , 0.38018503],
              [0.59330777, 0.24157272, 0.21038281, 0.39968509, 0.38786929, 0.23313   , 0.60753583, 0.11746442, 0.33580851],
              [0.52761598, 0.39585624, 0.34617014, 0.44734577, 0.61071665, 0.60965785, 0.24288987, 0.86855479, 0.51093104],
              [0.37865108, 0.64390992, 0.35119903, 0.5084858 , 0.76047163, 0.92322251, 0.42210755, 0.84737654, 0.18323218],
              [0.25225913, 0.80660106, 0.59757392, 0.13880142, 0.92014949, 0.16384746, 0.26092213, 0.27673258, 0.61211328],
              [0.62274265, 0.19918078, 0.22456062, 0.77882255, 0.0776352 , 0.14174234, 0.11464131, 0.48716757, 0.60345502],
              [0.8651115 , 0.28711802, 0.3287413 , 0.72285917, 0.00630239, 0.8255257 , 0.0907677 , 0.49928952, 0.5576546 ],
              [0.50358074, 0.54480371, 0.79873895, 0.20303555, 0.2177277 , 0.27911337, 0.90469801, 0.87839653, 0.05625235],
              [0.4348031 , 0.87018386, 0.09407201, 0.735842  , 0.63818005, 0.5907229 , 0.22721008, 0.79368411, 0.30276498],
              [0.32523495, 0.33793166, 0.53878454, 0.26639301, 0.67064447, 0.44228415, 0.30831065, 0.6519357 , 0.4992637 ],
              [0.7146983 , 0.77470835, 0.71963696, 0.76954441, 0.20129963, 0.24985081, 0.03480034, 0.83527973, 0.28605022],
              [0.25211713, 0.40324944, 0.8076299 , 0.10010685, 0.35344761, 0.57219617, 0.90951692, 0.00763921, 0.67737749],
              [0.5994826 , 0.4288711 , 0.43934224, 0.49226881, 0.4296035 , 0.42043958, 0.67932357, 0.63333804, 0.0792904 ],
              [0.92916414, 0.62071744, 0.53333786, 0.24552219, 0.78100741, 0.54509108, 0.02689913, 0.30773887, 0.74422044],
              [0.37277442, 0.74552446, 0.05782986, 0.92553921, 0.56857565, 0.23274089, 0.20980381, 0.33305928, 0.01600968],
              [0.05636364, 0.70879047, 0.15979409, 0.48983194, 0.1595081 , 0.52366221, 0.71554122, 0.17582655, 0.43262095],
              [0.12096296, 0.54465174, 0.39166477, 0.93145696, 0.14724597, 0.59864547, 0.5089316 , 0.87870354, 0.33668895],
              [0.78456363, 0.49212763, 0.35934421, 0.62080272, 0.17253055, 0.03730488, 0.53656167, 0.97571367, 0.72879736],
              [0.41190428, 0.27585201, 0.92345403, 0.55365668, 0.23673488, 0.83316929, 0.78410464, 0.70783239, 0.54269214],
              [0.80684093, 0.65927728, 0.42735715, 0.21879012, 0.79220116, 0.57037444, 0.98113358, 0.25722267, 0.91890871],
              [0.01736172, 0.41615444, 0.88970345, 0.92352073, 0.19321117, 0.51855333, 0.45451849, 0.42029923, 0.66969361],
              [0.37070043, 0.49782803, 0.12291778, 0.80029732, 0.74022966, 0.82500221, 0.08942504, 0.06149871, 0.77944998],
              [0.32898252, 0.99302568, 0.86657799, 0.18966477, 0.63565083, 0.42036503, 0.68976173, 0.45592714, 0.8064261 ],
              [0.36929765, 0.23030442, 0.90797364, 0.11218351, 0.70292577, 0.38084111, 0.46543749, 0.41277375, 0.80009195],
              [0.35094876, 0.66976036, 0.68752972, 0.08155664, 0.55425812, 0.80063094, 0.05133154, 0.31903758, 0.18166968],
              [0.45136455, 0.6926473 , 0.98653462, 0.66320627, 0.15182443, 0.82611144, 0.17341674, 0.22935738, 0.18427026],
              [0.36659653, 0.18686587, 0.92921154, 0.71844893, 0.46909124, 0.40776559, 0.13596983, 0.8447841 , 0.83415825],
              [0.85281139, 0.36895422, 0.43562565, 0.88060516, 0.63541561, 0.63442877, 0.34359765, 0.63197926, 0.15040065]])

diagram = [[(0.0, 0.44396247724731125),
            (0.0, 0.5900745296784518),
            (0.0, 0.5922909364820214),
            (0.0, 0.5939909962973502),
            (0.0, 0.6416400208798728),
            (0.0, 0.651540365197625),
            (0.0, 0.6793806752089517),
            (0.0, 0.6855802015077458),
            (0.0, 0.6959804267206378),
            (0.0, 0.706758514785121),
            (0.0, 0.7184032319690874),
            (0.0, 0.7272585060974452),
            (0.0, 0.7350170800570572),
            (0.0, 0.7402559120529211),
            (0.0, 0.7456029467546542),
            (0.0, 0.7659926145869351),
            (0.0, 0.7674679691896146),
            (0.0, 0.7760031630688811),
            (0.0, 0.7793958326850928),
            (0.0, 0.7796571269529743),
            (0.0, 0.7843765301139649),
            (0.0, 0.7884138240926855),
            (0.0, 0.7898630218472803),
            (0.0, 0.823582932669396),
            (0.0, 0.8422701573501344),
            (0.0, 0.8470797333472739),
            (0.0, 0.8518101141559747),
            (0.0, 0.8661308040864435),
            (0.0, 0.9741670807980223)],
           [(0.7192651599148147, 0.7194959170647691),
            (0.8124768612564794, 0.9023943725368626),
            (0.8211886375631615, 0.9966322474964932),
            (0.838132858733484, 0.9838872107476737),
            (0.8393571077091019, 0.860295317914653),
            (0.857640329848868, 0.8903915815227376),
            (0.8699191883323457, 0.9197724715245637),
            (0.8753525889545823, 0.9021537632707272),
            (0.8884617704673377, 1.0450118140048883),
            (0.9119268946842761, 0.9330399565820425),
            (0.9309953916983337, 0.935855680239255),
            (0.9322226282205148, 1.017508718303137),
            (0.9433241811209025, 1.0450118140048883),
            (0.997674429661552, 1.0097412308479174)],
           [(0.9985492777808449, 1.0262855376049906)],
           [(1.107348342056083, 1.1105987787858609)],
           [],
           [],
           [(1.272970097914074, 1.3074905053689831),
            (1.2748570267689014, 1.3074905053689831)],
           [],
           []]

def test_delrips_diagram9():
    test = geoph.delaunayRipsPersistenceDiagram(X)
    for i in range(len(diagram)):
        for j in range(len(diagram[i])):
            assert np.allclose(np.array(test[i])[j], np.array(diagram[i])[j])
