import geoph
import numpy as np

X = np.array(([[0.12442911, 0.44549744],
               [0.20977652, 0.34206818],
               [0.38916225, 0.29213326],
               [0.55729088, 0.34273285],
               [0.09071402, 0.5643182 ],
               [0.13924141, 0.78403313],
               [0.08013068, 0.69660988],
               [0.24254814, 0.81071259],
               [0.3367765 , 0.80244316],
               [0.28915152, 0.30502651],
               [0.46708984, 0.29984146],
               [0.42685905, 0.79588127],
               [0.65163071, 0.40821404],
               [0.69925568, 0.5246307 ],
               [0.72571404, 0.62366234],
               [0.83154732, 0.6542765 ],
               [0.94267235, 0.68602654],
               [0.99029732, 0.77069321],
               [0.95325569, 0.86329735],
               [0.90298485, 0.97706818],
               [0.72989456, 1.0675718 ],
               [0.82625565, 1.0405682 ],
               [0.64369316, 1.0643807 ],
               [0.56748291, 1.0136742 ],
               [0.55537079, 0.9082003 ],
               [0.5202877 , 0.81732285],
               [0.12      , 1.18      ],
               [0.1       , 1.1       ],
               [0.18      , 1.04      ],
               [0.3       , 1.02      ],
               [0.31      , 1.13      ],
               [0.23      , 1.1901    ]]))

diagram_0 = [(0.0, 0.07830788996294115),
             (0.0, 0.08246211251235307),
             (0.0, 0.08626044563512292),
             (0.0, 0.08759267059171619),
             (0.0, 0.09032122793050705),
             (0.0, 0.09153770451192506),
             (0.0, 0.0945905243711784),
             (0.0, 0.09585746707335273),
             (0.0, 0.09714207521146441),
             (0.0, 0.09741423983407448),
             (0.0, 0.09959730253696836),
             (0.0, 0.09973770148843662),
             (0.0, 0.0998794220708836),
             (0.0, 0.10000000000000002),
             (0.0, 0.10006003198080642),
             (0.0, 0.1000732435716366),
             (0.0, 0.10083839551825187),
             (0.0, 0.10250517321081502),
             (0.0, 0.10553152629283533),
             (0.0, 0.10616707131735538),
             (0.0, 0.10669617635690838),
             (0.0, 0.11017218318642873),
             (0.0, 0.11045361017187248),
             (0.0, 0.11046270863961287),
             (0.0, 0.11483810242356404),
             (0.0, 0.11557178432689577),
             (0.0, 0.12351145817569191),
             (0.0, 0.12438231029046896),
             (0.0, 0.12578146323308736),
             (0.0, 0.13271433864800747),
             (0.0, 0.21702980487013235),
             (0.0, float('inf'))]

diagram_1_rips = [(0.1216552506059644, 0.15820875449860533),
                  (0.13409620508372228, 0.4715463421824469),
                  (0.2823196314450267, 0.3751676584265772)]

diagram_1_delrips = [(0.1216552506059644, 0.15820875449860533),
                     (0.13409620508372228, 0.5098056092603911),
                     (0.2675577001091691, 0.2787712562394375),
                     (0.2823196314450267, 0.3751676584265772)]

rips_pairs = [[([-1], [2, 10]), ([-1], [26, 27]), ([-1], [20, 22]), ([-1], [1, 9]), ([-1], [8, 11]), ([-1], [22, 23]), ([-1], [7, 8]), ([-1], [11, 25]), ([-1], [16, 17]), ([-1], [24, 25]), ([-1], [19, 21]), ([-1], [17, 18]), ([-1], [3, 10]), ([-1], [27, 28]), ([-1], [30, 31]), ([-1], [20, 21]), ([-1], [2, 9]), ([-1], [13, 14]), ([-1], [5, 6]), ([-1], [23, 24]), ([-1], [5, 7]), ([-1], [14, 15]), ([-1], [29, 30]), ([-1], [26, 31]), ([-1], [3, 12]), ([-1], [15, 16]), ([-1], [0, 4]), ([-1], [18, 19]), ([-1], [12, 13]), ([-1], [4, 6]), ([-1], [7, 29])],
              [([14, 25], [15, 24]), ([0, 1], [3, 11]), ([28, 29], [28, 31])]]

delrips_pairs = [[([-1], [2, 10]), ([-1], [26, 27]), ([-1], [20, 22]), ([-1], [1, 9]), ([-1], [8, 11]), ([-1], [22, 23]), ([-1], [7, 8]), ([-1], [11, 25]), ([-1], [16, 17]), ([-1], [24, 25]), ([-1], [19, 21]), ([-1], [17, 18]), ([-1], [3, 10]), ([-1], [27, 28]), ([-1], [30, 31]), ([-1], [20, 21]), ([-1], [2, 9]), ([-1], [13, 14]), ([-1], [5, 6]), ([-1], [23, 24]), ([-1], [5, 7]), ([-1], [14, 15]), ([-1], [29, 30]), ([-1], [26, 31]), ([-1], [3, 12]), ([-1], [15, 16]), ([-1], [0, 4]), ([-1], [18, 19]), ([-1], [12, 13]), ([-1], [4, 6]), ([-1], [7, 29])],
                 [([14, 25], [15, 24]), ([23, 29], [24, 29]), ([0, 1], [9, 11]), ([28, 29], [28, 31])]]

def test_rips_diagram2():
    test = geoph.ripsPersistenceDiagram2(X)
    assert np.allclose(np.array(test[0]), np.array(diagram_0))
    assert np.allclose(np.array(test[1]), np.array(diagram_1_rips))

def test_delrips_diagram2():
    test = geoph.delaunayRipsPersistenceDiagram(X)
    assert np.allclose(np.array(test[0]), np.array(diagram_0))
    assert np.allclose(np.array(test[1]), np.array(diagram_1_delrips))
def test_rips_pairs2():
    assert geoph.ripsPersistencePairs2(X) == rips_pairs

def test_delrips_pairs2():
    assert geoph.delaunayRipsPersistencePairs(X) == delrips_pairs
