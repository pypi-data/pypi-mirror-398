[build-system]
requires = ["setuptools>=64", "wheel"]
build-backend = "setuptools.build_meta"

[project]
name = "luxai-magpie"
description = "MAGPIE is a lightweight, modular messaging engine providing high-performance pub/sub and RPC over pluggable transports."
readme = "README.md"
requires-python = ">=3.7.3"
license = { file = "LICENSE" }
authors = [
    { name = "LuxAI S.A." }
]
keywords = ["messaging", "rpc", "pubsub", "zeromq", "distributed-systems", "robotics", "middleware"]
classifiers = [
    "Development Status :: 4 - Beta", 
    "License :: OSI Approved :: GNU General Public License v3 (GPLv3)",   
    "Programming Language :: Python :: 3",
    "Programming Language :: Python :: 3.7",
    "Operating System :: OS Independent",
]
# Important: version is dynamic
dynamic = ["version"]

dependencies = [
    "typing_extensions",
    "python-ulid",
    "msgpack",
    "pyzmq",
]

[project.optional-dependencies]
video = [
    "numpy",
    "simplejpeg",
    "opencv-python",
]
audio = [
    "numpy",
    "soundfile",
]

discovery = [
    "zeroconf"
]

dev = [
    "numpy",
    "opencv-python",
    "simplejpeg",
    "soundfile",
    "pytest",
    "coverage"
]

full = [
    "numpy",
    "opencv-python",
    "simplejpeg",
    "soundfile",
    "zeroconf"
]

cli = [
    "sounddevice",
    "numpy",
    "opencv-python",
    "simplejpeg",
    "soundfile",
]


[project.urls]
"Homepage" = "https://github.com/luxai-qtrobot/magpie"
"Source" = "https://github.com/luxai-qtrobot/magpie"
"Bug Tracker" = "https://github.com/luxai-qtrobot/magpie/issues"


[project.scripts]
magpie-audio-player = "luxai.magpie.tools.zmq_audio_player:main"
magpie-video-viewer = "luxai.magpie.tools.zmq_video_viewer:main"
magpie-video-capture = "luxai.magpie.tools.zmq_video_capture:main"


# -----------------------------
# setuptools configuration
# -----------------------------
[tool.setuptools]
package-dir = { "" = "src" }

[tool.setuptools.packages.find]
where = ["src"]
include = ["luxai.magpie*"]

[tool.setuptools.package-data]
"luxai.magpie" = ["assets/*.png"]

# This tells setuptools how to read version dynamically
[tool.setuptools.dynamic]
version = {attr = "luxai.magpie.__version__"}
